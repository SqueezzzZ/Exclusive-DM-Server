//TransformeR GameMode made by Lomt1k

//|-------------------------------------------------|
//|modifed by [SqueezZ] (2015-2017) for Exclusive DM|
//|-------------------------------------------------|

/*
__________________________________________________________________________________________________________________

||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||EEEEEEEEE||XXXX|||||XXXX||||||OOOO|||||||DD|||||||||UUUU|||UUUU||||||SSS|||||III||VVVVVV||||VVVVVV||EEEEEEEEE|||
||EE|||||||||||XX|||||XX||||||OOO||OOO|||||DD||||||||||UU|||||UU|||||SS|||SS|||III||||VVV||||||VVV||||EE||||||||||
||EE||||||||||||XX|||XX||||||OO||||||||||||DD||||||||||UU|||||UU|||||SS||||||||||||||||VVV||||VVV|||||EE||||||||||
||EEEEEEE||||||||XXXX|||||||OO|||||||||||||DD||||||||||UU|||||UU|||||||SSS|||||III||||||VVV||VVV||||||EEEEEEE|||||
||EE||||||||||||XX|||XX|||||OO|||||||||||||DD||||||||||UU|||||UU|||||||||SS||||III|||||||VV|VV||||||||EE||||||||||
||EE|||||||||||XX|||||XX|||||OO|||OOO||||||DD||||||||||UUU|||UUU||||SS|||SS||||III||||||||VVV|||||||||EE||||||||||
||EEEEEEEEE||XXXX|||||XXXX|||||OOOO||||||||DDDDDDDD||||||UUUUU||||||||SSS||||||III|||||||VVVVV||||||||EEEEEEEEE|||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
__________________________________________________________________________________________________________________

wqszxцйычя
*/

//#include <jit>
#include <crashdetect>
#include <a_samp>
#include <a_natives>

//<<<<<<<----------------- ПРИ НЕОБХОДИМОСТИ НЕ ЗАБУДЬ СМЕНИТЬ!!!------------------->>>>>>>>>>>
#undef MAX_PLAYERS
#define MAX_PLAYERS 200
//#define FOREACH_NO_BOTS 1

#include <Pawn.CMD>
#include <mxINI>
#include <Dini>
#include <a_mysql>
#include <sscanf2>
#include <streamer>
#include <foreach> //циклы для игроков
#include <mSelection> //0.3х меню
#include <GetVehicleColor> //Функция GetVehicleColor(vehicleid, &color1, &color2);
#include <LDate>//Функции для работы с датой
//#include <cp> //Новые функции для работы с чекпоинтами - убрано в версии 3.8
//#include <filemanager> //ПЕРЕНОс!

#pragma tabsize 0//Чтобы не было варнингов loose indentation

new unixtime;
new nowday;
//new Text:CDTD[8];

new MenuMyskin = mS_INVALID_LISTID;//для меню myskin
new MenuFirstCar = mS_INVALID_LISTID;//для меню выбора первого авто
new MenuClass1 = mS_INVALID_LISTID;//для меню выбора avto Class1
new MenuClass2 = mS_INVALID_LISTID;//для меню выбора avto Class2
new MenuClass3 = mS_INVALID_LISTID;//для меню выбора avto Class3
new MenuBuyGun = mS_INVALID_LISTID;//для меню оруж. магазина
new MenuPaintJob = mS_INVALID_LISTID;//для меню выбора avto с PaintJob
new MenuPrestigeCars = mS_INVALID_LISTID;//для меню выбора авто (престиж)
new MenuCarWheels = mS_INVALID_LISTID;//для меню выбора колес
new MenuHousePick = mS_INVALID_LISTID;//для меню выбора пикапа дома
new MenuHouseIcon = mS_INVALID_LISTID;//для меню выбора иконки дома

new MaxVehicleUsed = 0;//Динамическое значение с максимальным существующим ID авто (для циклов)
new MaxPlayerID = 0;//Максимальный ид игрока на сервере. Используется например для рандомного выбора зомби

#define MAX_PROPERTY 501 //Максимум домов. Указывается на 1 больше
#define MAX_BASE 101 //Максимум штабов. Указывается на 1 больше
#define MAX_CLAN 501 //Максимум кланов. Указывается на 1 больше
#define MAX_CMEMBERS 26 //Максимум игроков в клане. Указывается на 1 больше
new MaxClanID = 0;//чтобы если всего 15 кланов, то не делать цикл на 10 000, а делать на 15
#define MAX_GZONE 26 //всего зон +1
#define MAX_ATTACK 3 //кланов одновременно могут быть на капте (1 - защита)

//new NDD;
//0.1 - 1 //0.2 - 2 //0.2.1 - 3
//0.2.2 - 4 //0.2.3 - 5 //0.3 - 6
//3.1 - 6 ?? //3.2 - 7
//3.3 - 8 // 3.4 - 9// 3.5 - 10 // 3.6 - 11
//3.7 - 12 // 3.7.1 - 13 // 3.8 - 14 // 3.9 - 15
//4.0 - 16 // 4.1 - 17 // 4.2 - 18 // 4.3 - 19
//4.4 - 20 // 4.5 - 21 // 4.6 - 22 // 4.7 - 23
//4.8 - 24 // 5.0 - 25 // 5.1 - 26 // 5.2 - 27
//5.3 - 28 // 5.4 - 29 //5.5 - 30 //31 - 5/6 //32 - 5.7
//редактируемые при обновлении величины
//------------------------------------
new Float:DBonus=1.0; 							////умножает донат на эту цифру - c 3.8 в файле////////////
#define SERVER_NAME "Exclusive DM" 		    	////Название сервера, отображаемое при подключении.////////
#define GAMEMODE_NAME "DM/RACE/ZOMBIE/DERBY/RPG"////Название мода, отображаемое в окне SAMP////////////////
#define MOD_VER "5.8"                 	    	////последняя версия///////////////////////////////////////
#define LAST_UPD 32//+1 при обнове          	////номер обновления - зависит от версии///////////////////
#define MAX_PING 300					    	////Максимально допустимый пинг (не к месту, да пойдет)////
//new ServerName[70] = "PUBG | ДЕРБИ [Exclusive DM] ГОНКИ | ЗОМБИ";
//new ServerName[70] = "ЗОМБИ | ДЕРБИ [Exclusive DM] БАТТЛГРАУНДС | ДМ";
new ServerName[70] = "• ДЕРБИ • ЗОМБИ • [Exclusive DM™] • БОНУСЫ И ПОДАРКИ•";
//------------------------------------
new ServConf[6];
new ServerID;
//0 (х2 опыт), 1 (режим разраба),
//цвета (новые)
#define COLOR_LOG 0x1E90FFFF
//марафон
#define MRF_COLOR 0x74DF00FF
//database
#define mysql_empty(%1,%2) mysql_tquery(%1, %2, "", "")
new connects;
//акторы
#define MAX_ACTOR 6 //активные акторы
new Actor[MAX_ACTOR];
#define MAX_AREAS 1500 //поменять если что

#define MAX_STRING 255
#define MAX_FILE_NAME 64
#define MAX_MESSAGE 180
#define MAX_DIALOG_INFO 600
#define MAX_PASSWORD 24
#define MAX_3DTEXT 255
#define MAX_QUESTS 32

#define DIALOG_LOGIN 0
#define DIALOG_REGISTER 1
#define DIALOG_OTHER 25000

#define DIALOG_TUTORIAL 100
#define DIALOG_MYSPAWN 101
#define DIALOG_MYSPAWN2 102
#define DIALOG_MYGUN 103
#define DIALOG_MYGUN1 104
#define DIALOG_MYGUN2 105
#define DIALOG_MYGUN3 106
#define DIALOG_MYGUN4 107
#define DIALOG_MYGUN5 108
#define DIALOG_MYGUN6 109
#define DIALOG_MYGUN7 110
#define DIALOG_MYGUN8 111
#define DIALOG_MYGUN10 112
#define DIALOG_STYLE 113
#define DIALOG_BANK 114
#define DIALOG_BANKTO 115
#define DIALOG_BANKFROM 116
#define DIALOG_HOUSEMENU 117
#define DIALOG_HOUSEMENUPRICE 118
#define DIALOG_CLANCREATE 119
#define DIALOG_CLANCREATECOLOR 120
#define DIALOG_CLANCREATENAME 121
#define DIALOG_CLANMENU 122
#define DIALOG_CLANTAG 123
#define DIALOG_CLANEXIT 124
#define DIALOG_TABMENU 125
#define DIALOG_CLANRANG 126
#define DIALOG_TABGIVECASH 127
#define DIALOG_CLANMANAGER 128
#define DIALOG_CLANCOLOR 129
#define DIALOG_CLANENTERNAME 130
#define DIALOG_CLANDESTROY 131
#define DIALOG_BASEMENU 132
#define DIALOG_INVISIBLE 133
#define DIALOG_CASINORULET 134
#define DIALOG_CASINORULETBETSIZE 135
#define DIALOG_CASINORULETBETNUMBER 136
#define DIALOG_AIRPORT 137
#define DIALOG_APLAY 138
#define DIALOG_STEALCAR 139
#define DIALOG_STEALWATERCAR 140
#define DIALOG_GGSHOP 141
#define DIALOG_SKILLS 142
#define DIALOG_STEALAIRCAR 143
#define DIALOG_CLANENTER 144
#define DIALOG_CLANMESSAGE 145
#define DIALOG_SKILLCHANGE 146
#define DIALOG_PAINTJOB 147
#define DIALOG_PRESTIGE 148
#define DIALOG_SPREST 149
//#define DIALOG_SKILLCHANGE2 150
#define DIALOG_PRESTIGECAR 151
//#define DIALOG_WORKCAPTAIN 152
//#define DIALOG_WORKPILOT 153
//#define DIALOG_CODE 154
#define DIALOG_HELP 155
#define DIALOG_HELPFAQ 156
#define DIALOG_HELPCMD 157
#define DIALOG_HELPMES 158
#define DIALOG_PVP 159
#define DIALOG_PVPMAP 160
#define DIALOG_PVPWEAPON 161
#define DIALOG_PVPHEALTH 162
#define DIALOG_PVPCASH 163
#define DIALOG_CONFIG 164
#define DIALOG_CHANGEPASS 165
//#define DIALOG_CHANGEPASS2 166
#define DIALOG_CHANGENICK 167
#define DIALOG_CHANGENICK2 168
#define DIALOG_MYWEATHER 169
#define DIALOG_MYWEATHER2 170
#define DIALOG_ACHANGEPDM 171
#define DIALOG_HELPLVL 172
#define DIALOG_PRESTIGEGM 173
#define DIALOG_ACHANGE 174
#define DIALOG_ACHANGEDM 175
#define DIALOG_ACHANGEDERBY 176
#define DIALOG_ACHANGEFR 177
#define DIALOG_ACHANGEFR2 178
new ACHANGEFR[MAX_PLAYERS];
#define DIALOG_ACHANGEZM 179
#define DIALOG_ACHANGEFLAG 180
#define DIALOG_ACHANGEGG 181
#define DIALOG_ACHANGEXR 182
#define DIALOG_TURBOSPEED 183
#define DIALOG_TURBOSPEEDDELETE 184
#define DIALOG_TURBOSPEEDNITRO 185
#define DIALOG_TURBOSPEEDNEON 186
#define DIALOG_GPS 187
#define DIALOG_GPSTUNE 188
#define DIALOG_GPSWORK 189
#define DIALOG_WORKGRUZSTOP 190
#define DIALOG_WORKSTOP 191
#define DIALOG_LEAVEZM 192
#define DIALOG_TURBOSPEEDFIRE 193
#define DIALOG_CLANRENAME 194
#define DIALOG_BASEMENUPRICE 195
#define DIALOG_ACTION 196
#define DIALOG_CHATNAME 197
#define DIALOG_PRESTIGECOLOR 198
#define DIALOG_QUESTS 199
#define DIALOG_MEDALTRADE 200
#define DIALOG_ACTIVESKILLPERSON 201
#define DIALOG_ACTIVESKILLCAR1 202
#define DIALOG_ACTIVESKILLCAR2 203
#define DIALOG_ACTIVESKILLHCAR1 204
#define DIALOG_ACTIVESKILLHCAR2 205
#define DIALOG_SELLHOUSE 206
#define DIALOG_SELLBASE 207
#define DIALOG_COMM 208
#define DIALOG_GANGBANK 209
#define DIALOG_GANGTO 210
#define DIALOG_GANGFROM 211
#define DIALOG_TURBOSPEEDSIR 212
#define DIALOG_TURBOSPEEDMIG 213
#define DIALOG_ACHANGEPR 214
#define DIALOG_WINMAR 215
#define DIALOG_CLANTAGCHANGE 216
#define DIALOG_TSVINIL 217
#define DIALOG_SCONF 218
#define DIALOG_EVENTS 219
#define DIALOG_ZINFO 220
#define DIALOG_CLANSTAT 221
#define DIALOG_COMMANDS 222
#define DIALOG_CMDOPTION 223
#define DIALOG_ACHANGEDRACE 224
#define DIALOG_CHANGEPASS1 225
#define DIALOG_CHANGEPASS2 226
#define DIALOG_GOLD 227
#define DIALOG_UPDATE 228
#define DIALOG_TOP 229
#define DIALOG_OPXP 230
#define DIALOG_OPGG 231
#define DIALOG_TOPCL 232
#define DIALOG_HOUSEUPD 233
#define DIALOG_BASEUPD 234
#define DIALOG_INVENT 235

#define TDM_WORLD 478
#define PARK_WORLD 514
#define WORLD_DERBY 664
#define DRACE_WORLD 674
#define XRACE_WORLD 700
#define BATTLE_WORLD 711
#define PDM_WORLD 819

//max maps for events
#define MAX_DM 20
#define MAX_XRACE 21
#define MAX_GG 20
#define MAX_DERBYS 21
#define MAX_ZOMBIE 16
#define MAX_TDM 8
#define MAX_PARK 6
#define MAX_DRACE 7
#define MAX_BTROUTS 6
#define MAX_PDM 2

#define MAX_BASE_INT 10
#define MAX_HOUSE_INT 9

#include "Transformer\Colors"
#define COLOR_CLAN 0x008E00FF //iauee oaao aey nenoaiu eeaia

#include "Transformer\massivs"
#include "Transformer\ADShields"


//Удержание одной клавиши: if (HOLDING( KEY_FIRE ))
//Удержание нескольких клавиш: if (HOLDING( KEY_FIRE | KEY_CROUCH ))
#define HOLDING(%0) \
	((newkeys & (%0)) == (%0))
//Нажатие одной клавиши: if (PRESSED( KEY_FIRE ))
//Нажатие нескольких клавиш: if (PRESSED( KEY_FIRE | KEY_CROUCH ))
#define PRESSED(%0) \
	(((newkeys & (%0)) == (%0)) && ((oldkeys & (%0)) != (%0)))
//Отпускание одной клавиши: if (RELEASED( KEY_FIRE ))
//Отпускание нескольких клавиш: if (RELEASED( KEY_FIRE | KEY_CROUCH ))
#define RELEASED(%0) \
	(((newkeys & (%0)) != (%0)) && ((oldkeys & (%0)) == (%0)))
	
//zamena public warn
#define publics%0(%1) forward%0(%1); public%0(%1)

forward MysqlCheckNameBuyName(playerid, name[]);
forward MysqlUpdatePlayer(playerid);
forward MysqlCheckBanName(playerid, name[], reason[]);
forward MysqlCheckUnBanName(playerid, name[], reason[]);

new XReg[MAX_PLAYERS] = 0;
new Registered[MAX_PLAYERS];
new Errors[MAX_PLAYERS];
new Logged[MAX_PLAYERS];
new PropertyPickup[MAX_PROPERTY];
new PropertyMapIcon[MAX_PROPERTY];
new BasePickup[MAX_BASE];
new BaseMapIcon[MAX_BASE];
new LAFK[MAX_PLAYERS];
new ClickedPid[MAX_PLAYERS] = -1;
new ClanFunks[MAX_PLAYERS];
//new ClanRang[MAX_PLAYERS];
new CMDTime[MAX_PLAYERS];


//zones
new AreaType[MAX_AREAS];
new OnZone[MAX_PLAYERS]={-1,...};
new ClanZoneID[MAX_GZONE]; //цвет-зоны (ганг) на карте
new ClanZoneAreaID[MAX_GZONE]; //арена-зоны (ганг) на карте
new ZoneAttacker[MAX_GZONE][MAX_ATTACK];//атакующий клан
new ZonePrepareTime[MAX_GZONE];//время подготовки
new ZoneWarTime[MAX_GZONE];
new ZBTime = 350;
new ZAtt[MAX_GZONE];
new ClanKills[MAX_CLAN];

//ex7
//new PlayerExt[MAX_PLAYERS];
//new ChatOff = 0;
stock Float:frandom(Float:max)
{
    return floatdiv(float(random(0)), floatdiv(float(cellmax), max));
}
//mrf
new MrfDate = 0;

new APlayTime;
new MusicString[130];

new TopOperationXP[4096];
new TopOperationGG[3100];
new TopClanArray[1200];
new LastTopUpdate[60];

new PlClanID[MAX_PLAYERS]; //переменная для просмотра состава клана из окна статистики

new CreateClanColor[MAX_PLAYERS];
new PlayerColor[MAX_PLAYERS];
new AntiPlus[MAX_PLAYERS]= -1;
new AdminTPCantKill[MAX_PLAYERS] = 0;
new Float: LastPlayerX[MAX_PLAYERS], Float: LastPlayerY[MAX_PLAYERS], Float: LastPlayerZ[MAX_PLAYERS];//Местоположение игрока секунду назад
new LastPlayerTuneStatus[MAX_PLAYERS], TunesPerSecond[MAX_PLAYERS];//для античита на телепорт при въезде выезде из тюнинга
new Float: LastPlayerSHX[MAX_PLAYERS], Float: LastPlayerSHY[MAX_PLAYERS], Float: LastPlayerSHZ[MAX_PLAYERS];//Местоположение игрока пол секунды назад для спидометра
new PDialogID[MAX_PLAYERS];

new LastProperty = 1, OwnedProperty = 0, SuperProperty = 0;
new LastBase = 1, OwnedBase = 0;
new LastZone = 1, OwnedZone = 0;
new RestartDate[32];
new Year, Month, Day, hour,minute,second; //текущие дата и время
new pKick[MAX_PLAYERS] = 0;

new Text3D:PropertyText3D[MAX_PROPERTY];
new Text3D:BaseText3D[MAX_BASE];

new PlayerPass[MAX_PLAYERS][30];//пароль игрока
new BannedBy[MAX_PLAYERS][25], BanReason[MAX_PLAYERS][41], MutedBy[MAX_PLAYERS][25];
new InviteClan[MAX_PLAYERS], InviteTime[MAX_PLAYERS] = -1;
new UGTime = 300;
new ServerWeather, PlayerWeather[MAX_PLAYERS] = -1, PlayerTime[MAX_PLAYERS] = -1;
new InPeacefulZone[MAX_PLAYERS];//Для мирных зон
new GPSUsed[MAX_PLAYERS];//Принадлежит ли активный у игрока чекпоинт к системе G
new ChatName[MAX_PLAYERS][80];//ник для чата
//new FirstSobeitCheck[MAX_PLAYERS], FirstSobeitCheckTimer[MAX_PLAYERS], Text:BlackScreen;//Первичная проверка на собейт после конекта

new WorkPizzaID[MAX_PLAYERS], WorkPizzaCP[MAX_PLAYERS], WorkPizzaCPs[MAX_PLAYERS];//Работа доставщика пиццы: ID маршрута, номер чекпоинта и их количество
new WorkTime[MAX_PLAYERS];//Время, в течение которого уже выполняется 1 заказ на работе
new WorkTimeGruz[MAX_PLAYERS], WorkZoneCombine;
new IsServerRestaring = 0;

new Float:CoordsCP[MAX_PLAYERS][3]; //a/c check tp

new InEvent[MAX_PLAYERS], JoinEvent[MAX_PLAYERS];
#define EVENT_DM 1
#define EVENT_DERBY 2
#define EVENT_ZOMBIE 3
#define EVENT_RACE 4
#define EVENT_XRACE 5
#define EVENT_GUNGAME 6
#define EVENT_PVP 7
#define EVENT_TDM 8
#define EVENT_PARK 9
#define EVENT_DRACE 10
#define EVENT_BATTLE 11
#define EVENT_PDM 12

#define MAX_EVENT_TYPES 11 //добавить +1 при PDM
#define MAX_EVENTS 12

#define MAX_BANKS 6

//текстдравы
new Text:TextDrawEvent[MAX_EVENTS];//время до старта соревнования
new PlayerText:PSpecInfo[MAX_PLAYERS], PlayerText:SpecInfoVeh[MAX_PLAYERS];
new PlayerText:TextDrawSpeedo[MAX_PLAYERS];
new Text:ZoneStateTD[MAX_GZONE];
new Text:TextDrawTime, Text:TextDrawDate; //время и дата
new PlayerText:TextDrawWorkTimer[MAX_PLAYERS];
new Text:IntChangeTD[6]; //выбор интов
new PlayerText:PIntChangeTD[MAX_PLAYERS];
new Text:BTMap; //BT map
new PlayerText:PlayerPosTD[MAX_PLAYERS]; //bt position
new Text:BTMainTD[4],Text:BTLineTD,Text:BTTimeTD,Text:BTPlayersTD;
//new Text:AltMenuTD[16];

//new LogidDialogShowed[MAX_PLAYERS] = 0;
new PlayerCarID[MAX_PLAYERS] = -1;
new CarChanged[MAX_PLAYERS];
new JetpackUsed[MAX_PLAYERS];
new FarmedXP[MAX_PLAYERS];
new FarmedMoney[MAX_PLAYERS];
new SkydiveTime[MAX_PLAYERS];
new HealthTime[MAX_PLAYERS];
new ArmourTime[MAX_PLAYERS];
new RepairTime[MAX_PLAYERS];
new PremiumTime[MAX_PLAYERS];
new SkinChangeMode[MAX_PLAYERS];
new GMTestStage[MAX_PLAYERS] = 0, GMTestTime[MAX_PLAYERS] = 0, Float: GMTestHealthOld[MAX_PLAYERS], Float: GMTestArmourOld[MAX_PLAYERS], GMTesterID[MAX_PLAYERS]; //команда /gmtest
new FloodTime[MAX_PLAYERS], FloodMessages[MAX_PLAYERS];
new OnStartEvent[MAX_PLAYERS];//Нужно, чтобы испавить баг, когда на старте сорев выдавало личное оружие
new UberNitroTime[MAX_PLAYERS];
new PrestigeTPTime[MAX_PLAYERS];
new TimeAfterSpawn[MAX_PLAYERS];
new LastDeathTime[MAX_PLAYERS];
new BadPingTime[MAX_PLAYERS];

new HPRegenTime[MAX_PLAYERS];
new JumpTime[MAX_PLAYERS];
new PBackTime[MAX_PLAYERS];
//new GetCpTime[MAX_PLAYERS];
new SkillNTime[MAX_PLAYERS];
new SkillYTime[MAX_PLAYERS];
new SkillHTime[MAX_PLAYERS];
new CaseBugTime[MAX_PLAYERS];
new SelectedModel[MAX_PLAYERS];
new FlipCount[MAX_PLAYERS] = 0;
new WorldSpawn[MAX_PLAYERS] = 0;
new MapTPTime[MAX_PLAYERS], MapTP[MAX_PLAYERS], MapTPTry[MAX_PLAYERS], Float: MapTPx[MAX_PLAYERS], Float: MapTPy[MAX_PLAYERS]; //телепорт по карте
new LastBaseVisited[MAX_PLAYERS], LastHouseVisited[MAX_PLAYERS];
new WeaponShotsLastSecond[MAX_PLAYERS];
new CasinoBet[MAX_PLAYERS]; //Казино (Рулетка): bet 0 - 36: числа, 37-38: красное, черное, 41: первая треть, 42: вторая треть, 43: третья треть
new Quest[MAX_PLAYERS][3], QuestScore[MAX_PLAYERS][3], QuestTime[MAX_PLAYERS][3];//квесты
new LastDamageFrom[MAX_PLAYERS] = -1;//на соревнованиях будет записывать от какого игрока получен последний урон
new LoginKickTime[MAX_PLAYERS]; //Время до кика (если игрок не успеет авторизоваться вовремя)
new LeaveDM[MAX_PLAYERS], LeaveGG[MAX_PLAYERS];
new TimePTBB[MAX_PLAYERS];
new JumpCount[MAX_PLAYERS];
new PGunTime[MAX_PLAYERS];
new PGunActiv[MAX_PLAYERS];

//new year
new NYGift;

new PlayersOnline = 0;//Используется для определения частоты проведения соревнований
new MaxBank[MAX_PLAYERS];//Максимум денег в банке

//bank
new BankEnterPick[MAX_BANKS];
new BankCassaCP,BankBiletCP;
new BankOut;

//base
new BaseEnterPick[MAX_BASE_INT];
//house
new HouseEnterPick[MAX_HOUSE_INT];

new DMTimer = 150;
new DMTimeToEnd = -1;
new DMid = 8; //Первый дм после рестарта: Minigun Madness
new PrevDM = 8;
new DMPlayers = 0;
new DMKills[MAX_PLAYERS], DMLeaderID, DMLeaderKills;

new DerbyTimer = 180;
new DerbyTimeToEnd = -1;
new DerbyPlayers = 0;
new DerbyPlayersList[25];//Массив с ID игроков, которые участвуют в дерби
new Derbyid = 2; //Первое дерби после рестарта: Great Random
new PrevDerby = 2;
new DerbyModelCar[MAX_PLAYERS];
new DerbyCarID[MAX_PLAYERS];
new DerbyStarted[MAX_PLAYERS];
new DerbyPosition;
new Float:dchealth = 0.0;
new DerbyModelAll;
//new DRocket[MAX_PLAYERS];
/*enum DRemInfo
{
	IsRActived,
    RepZone,
    RepObj,
    Text3D:rtext,
    PCTime,
}
new DRemStats[DRemInfo];*/

new ZMTimer = 390;
new ZMPlayers = 0, ZMHumans = 0, ZMZombies = 0;
new ZMPlayersList[25];//Массив с ID игроков, которые участвуют в зомби
new ZMid = 11, ZMTimeToEnd = -1; //Первое зомби после рестарта: Казино Рояль
new PrevZM = 1;
new ZMStarted[MAX_PLAYERS], ZMIsPlayerIsZombie[MAX_PLAYERS];
new ZMIsPlayerIsTank[MAX_PLAYERS], ZMTimeToFirstZombie;
new ZMTankOn = 0;
new ZMSurvivalTime[MAX_PLAYERS] = 0;
new ZMKillsXP[MAX_PLAYERS];
new ZZones[MAX_ZOMBIE];


new FRTimer = 420;
new FRPlayers = 0;
new FRPlayersList[25];//Массив с ID игроков, которые участвуют в гонке
new FRStart = 4, FRFinish = 5, FRTimeToEnd = -1; //Первая гонка после рестарта: из аэро СФ на гору
new PrevFRStart = 4, PrevFRFinish = 5;//предыдущие старт и финиш
new FRStarted[MAX_PLAYERS];
new FRModelCar = 411, FRCarID[MAX_PLAYERS];//первая гонка после рестарта на Infernus
new FRpos;
new FRTimeTransform = -1;


new XRTimer = 660;
new XRid = 11; //Первая легендарная гонка после рестарта: Into The Wild
new PrevXRid = 11;
new XRPlayers = 0;
new XRPlayersList[25];//Массив с ID игроков, которые участвуют в легендарной гонке
new XRTimeToEnd = -1;
new XRpos;
new XRStarted[MAX_PLAYERS];
new XRCPs = -1;//количество чекпоинтов
new XRPlayerCP[MAX_PLAYERS] = -1;
new XRCarCP[100];//здесь будут модели авто каждого чекпоинта. Максимум чеков: 100!
new XRTypeCP[100];//здесь тип чекпоинта (обычный, финиш, воздушный...) Максимум: 100!
new XRCarID[MAX_PLAYERS] = -1;
new XRPlayerCar[MAX_PLAYERS];//хранит модель текущей машины игрока, чтобы её можно было восстановить
new Float: XRxx[MAX_PLAYERS], Float: XRy[MAX_PLAYERS], Float: XRz[MAX_PLAYERS], Float: XRa[MAX_PLAYERS], Float: XRvx[MAX_PLAYERS], Float: XRvy[MAX_PLAYERS], Float: XRvz[MAX_PLAYERS];


new GGTimer = 690;
new GGTimeToEnd = -1;
new GGid = 10; //Первая гонка вооружений после рестарта: Футбольное поле
new PrevGGid = 10;
new GGPlayers = 0;
new GGKills[MAX_PLAYERS] = 0;

new TDMTimer = 780;   //таймер до начала
new TDMPlayers = 0, TDMGroveKills = 0, TDMBallasKills = 0; //счетчик kills
new TDMGrove = 0, TDMBallas = 0;
new TDMTeam[MAX_PLAYERS];
new TDMKills[MAX_PLAYERS];
//new TDMStarted[MAX_PLAYERS];
new TDMTimeToEnd = -1;
new PrevTDM = 6;
new TDMid = 6;


new PRTimer = 100;
new PRPlayers = 0;
new PRPlayersList[25];//Массив с ID игроков, которые участвуют в паркуре
new PRid = 5, PRTimeToEnd = -1; //Первый
new PrevPR = 5;//предыдущие
new PRStarted[MAX_PLAYERS];
new PRPlayerLastCP[MAX_PLAYERS];
new ParkCPS[] = {0,7,9,9,7,7,7}; //чеки на паркуре (кол-во) //ny - 8
new PRpos;
//new PRPickup[MAX_PLAYERS];

new DRTimer = 900;
new DRTimeToEnd = -1;
new DRPlayers = 0;
new DRPlayersList[25];//Массив с ID игроков, которые участвуют
new DRid = 1; //Первое drace после рестарта
new PrevDR = 1;
new DRModelCar;
new DRCarID[MAX_PLAYERS];
new DRStarted[MAX_PLAYERS];
new DRPosition;
new DRMaxCPs = 10;
new DRLastPlayerCP[MAX_PLAYERS];
new DRPointID[20];
new DRTransform;
new DRpos;
//new DRLastpos;
new DRStartPlayers;


new BTTimer = 90;
//new BTRouteID = 3;
//new BTTimeToEnd = -1;
new BTPlayers = 0;
//new BtVehicle[MAX_BTCARS];
new BTKills[MAX_PLAYERS];
new PlaneObject[3];
new BTStarted[MAX_PLAYERS];
new BTStartPlayers, BTStartTime;
new PlayerInv[MAX_PLAYERS][4];
new ThrowCount[MAX_PLAYERS], Slot1Bullets[MAX_PLAYERS], Slot2Bullets[MAX_PLAYERS];
new LootObj[MAX_AREAS], Text3D:LootObj3D[MAX_AREAS],LootType[MAX_AREAS],LootCount[MAX_AREAS]/*,LootBoxSlots[MAX_AREAS][5]*/;
new FirstZone[4],SecondZone[4];
new Text:FirstZoneTD[4],Text:SecondZoneTD[4];
new Float: CenX, Float: CenY, Float: BOldX, Float: BOldY, Float: OldSize, Float: SecDeleteX, Float: SecDeleteY, Float: SecDeleteS, Float: LineUpd, Float: LineSize;
new BTStage, BTActiveZone, BTTime;
new Float: ZoneXY[4];
enum BTZoneInfo {Float:ZoneSize, PZoneTime, AZoneTime, Float:ZoneDamage }
new BTZone[10][BTZoneInfo] =
{//Расстояние от центра зоны до края, время пассивной зоны, время активной зоны, урон за пределами зоны
    {6000.0, 0, 0, 0.0}, // start size
	{4000.0, 300, 300, 1.0}, //10:00
	{3000.0, 180, 120, 2.0}, //5:00
	{2000.0, 120, 90, 4.0},	//3:30
	{1200.0, 90, 60, 6.0}, //2:30
	{600.0, 60, 30, 8.0}, //1:30
	{300.0, 30, 15, 10.0}, //0:45
	{100.0, 30, 15, 12.5}, //0:45
	{40.0, 15, 5, 15.0}, //0:20
	{0.1, 15, 10, 20.0} //0:15
};

/*new PDMTimer = 180;   //таймер до начала
new PDMPlayers = 0, PDMBluePnt = 0, PDMRedPnt = 0; //счетчик
new PDMBlue = 0, PDMRed = 0;
new PDMTeam[MAX_PLAYERS];
new PDMKills[MAX_PLAYERS];
//new TDMStarted[MAX_PLAYERS];
new PDMTimeToEnd = -1;
new PrevPDM = 1;
new PDMid = 1;
new PDMArea;
new BlueOnPoint, RedOnPoint;
new PDMObject, ObjStatus;*/


//Лимиты (максимум участников)
new DMLimit = 25;//до обновы 1.07 было 30
new DerbyLimit = 25;
new ZMLimit = 25;//до обновы 1.07 было 30
new FRLimit = 25;
new XRLimit = 25;
new GGLimit = 25;//до обновы 1.07 было 30
new TDMLimit = 24;
new PRLimit = 20;
new DRLimit = 25;
//new Limit = 24;

new TutorialStep[MAX_PLAYERS] = 999;
new NeedXP[MAX_PLAYERS] = 9999999;

new LACPanic[MAX_PLAYERS], LACPanicTime[MAX_PLAYERS]; //LAC v2.0
new Float: KarmaX[MAX_PLAYERS], Float: KarmaY[MAX_PLAYERS], Float: KarmaZ[MAX_PLAYERS];

new Weapons[MAX_PLAYERS][47];//LAC на оружие
new PlayerIP[MAX_PLAYERS][16];//IP игроков
new PlayerName[MAX_PLAYERS][25];//ник игрока

//Объекты игроков
new TutorialObject[MAX_PLAYERS] = -1;

//Объекты машин
new NeonObject1[MAX_VEHICLES] = -1, NeonObject2[MAX_VEHICLES] = -1;
new TrailerID[MAX_VEHICLES] = - 1, IsTrailer[MAX_VEHICLES] = 0;
//огненные колеса
new /*Fire1[MAX_VEHICLES]=-1,Fire2[MAX_VEHICLES]=-1,*/Fire3[MAX_VEHICLES]=-1,Fire4[MAX_VEHICLES]=-1,MigObj[MAX_VEHICLES]=-1;
//винил
new VVinil[MAX_VEHICLES][2];

/*enum rankingEnum
{
    r_Score,
    r_ID
}*/

enum Info
{
	SID,
	Model,
	Admin,
	Level,
	Exp,
	Spawn,
	SpawnStyle,
	Invisible,
	Time,
	Cash,
	Bank,
	Banned,
	Muted,
	Slot1, // Оружие
	Slot2,
	Slot3,
	Slot4,
	Slot5,
	Slot6,
	Slot7,
	Slot8,
	Slot9,
	Slot10,
	MyClan,
	Member,
	Leader,
	Home,
	MrfEnd,
	CarSlot1,
	CarSlot1Color1,
	CarSlot1Color2,
	CarSlot1PaintJob,
	CarSlot1Neon,
	CarSlot1Fire,
	CarSlot1Sir,
	CarSlot1Mig,
	CarSlot1Component0,
	CarSlot1Component1,
	CarSlot1Component2,
	CarSlot1Component3,
	CarSlot1Component4,
	CarSlot1Component5,
	CarSlot1Component6,
	CarSlot1Component7,
	CarSlot1Component8,
	CarSlot1Component9,
	CarSlot1Component10,
	CarSlot1Component11,
	CarSlot1Component12,
	CarSlot1Component13,
	CarSlot1NitroX,
	CarSlot2,
	CarSlot2Color1,
	CarSlot2Color2,
	CarSlot2PaintJob,
	CarSlot2Neon,
	CarSlot2Fire,
	CarSlot2Sir,
	CarSlot2Mig,
	CarSlot2Component0,
	CarSlot2Component1,
	CarSlot2Component2,
	CarSlot2Component3,
	CarSlot2Component4,
	CarSlot2Component5,
	CarSlot2Component6,
	CarSlot2Component7,
	CarSlot2Component8,
	CarSlot2Component9,
	CarSlot2Component10,
	CarSlot2Component11,
	CarSlot2Component12,
	CarSlot2Component13,
	CarSlot2NitroX,
	CarSlot3,
	CarSlot3Color1,
	CarSlot3Color2,
	Float: GameGold,
	Float: GameGoldTotal,
	GPremium,
	SkillHP,
	SkillRepair,
	ActiveSkillPerson,
	ActiveSkillCar1,
	ActiveSkillCar2,
	ActiveSkillHCar1,
	ActiveSkillHCar2,
	Prestige,
	PrestigeSkillN,
	PrestigeSkillY,
	PrestigeSkillH,
	Karma,
	KarmaTime,
	Float: PosX,
	Float: PosY,
	Float: PosZ,
	Float: PosA,
	ConPM,
	ConInviteClan,
	ConInvitePVP,
	ConMesPVP,
	ConMesEnterExit,
	ConSpeedo,
	LastHourExp,
	LastHourReferalExp,
	HelpTime,
	EventChangeTime,
	LeaveZM,
	ClanWarTime,
	CasinoBalance,
	//GiveCashBalance,
	BuddhaTime,
	PrestigeColor,
	Medals,
	CompletedQuests,
	Float: GGFromMedals,
	Float: GGFromMedalsTotal,
	Float: GGFromMedalsLastDay,
	FindPack,
	ReadObnovlenie,
	Bonus,
	SlivBlock,
	RadarSwitch,
	Mrf1,
	Type,
	Tag,
	Vinil[30],
	Gold,
	SPN1,
	SPN2,
	SPN3,
	SPN4,
	SPN5,
	SPN6,
	SPN7,
	SPN8,
	SPN9,
	OpXP,
	Float: OpGG,
 	MJAct,
 	SPrest,
 	Lottery,
 	MenuTp,
	//Переменные, которые НЕ сохраняются в файл
	CarActive,
	//Всё, что связано синхронизацией здоровья, брони и нанесением урона
	Float: PHealth,
	Float: PArmour,
	
	DMove, //проверка на передвижение
	UpdTime, // shop update time
	SaveTime,
}
new Player[MAX_PLAYERS][Info];


enum pInfo
{
	HID,
	pOwner[MAX_PLAYER_NAME],
	pName[MAX_PLAYER_NAME],
	pPrice,
	Float:pPosEnterX,
	Float:pPosEnterY,
	Float:pPosEnterZ,
	Float:pPosEnterA,
	Float:pPosRespawnX,
	Float:pPosRespawnY,
	Float:pPosRespawnZ,
	Float:pPosRespawnA,
	pOpened,
	pBuyBlock,
	pPickup,
	pIcon,
	pInter,
}
new Property[MAX_PROPERTY][pInfo];

enum bInfo
{
	BID,
	bClan,
	bPrice,
	bInterior,
	Float:bPosEnterX,
	Float:bPosEnterY,
	Float:bPosEnterZ,
	Float:bPosEnterA,
	Float:bPosRespawnX,
	Float:bPosRespawnY,
	Float:bPosRespawnZ,
	Float:bPosRespawnA,
}
new Base[MAX_BASE][bInfo];


enum cInfo
{
	CID,
	cLevel,
	cLider[MAX_PLAYER_NAME],
	cName[MAX_PLAYER_NAME],
	cMessage[125],
	cColor,
	cBase,
	cXP,
	cLastDay,
	cEnemyClan,
	cCWwin,
	ClanBank,
	ClanZones,
	cTag[20],
	cSlots,
	Imm,
	ChangeLead,
	InfPoints,
	//
	NowWarZone,
	//OnZonePos,
}
new Clan[MAX_CLAN][cInfo];

new CMember[MAX_CLAN][MAX_CMEMBERS][MAX_PLAYER_NAME];
new CRangs[MAX_CLAN][MAX_CMEMBERS];
new COnline[MAX_CLAN][MAX_CMEMBERS];

enum PVPInfo
{
	Status, //0 - не в PVP, 1 - в pvp
	Invite, //ид игрока, с которым pvp. Не выбрано: -1
	Map, //Номер карты pvp.
	Weapon,//id оружия
	Health,//Кол-во здоровья. От 1 до 200.
	PlayMap,//карта, на которой в данный момент играет
	PlayWeapon,//
	PlayHealth,//
	TimeOut,
	Stavka,
}
new PlayerPVP[MAX_PLAYERS][PVPInfo];
new CanStartPVP[MAX_PLAYERS];

enum VehicleInfo
{
	AntiDestroyTime, //кол-во секунд, в течение которых транспорт не может быть уничтожен
	Owner, //id игрока, которому принадлежит транспорт
	Float: Health, //Здоровье транспорта
	VType
}
new Vehicle[MAX_VEHICLES][VehicleInfo];
forward SecVehicleUpdate(vehicleid);

#define MAX_DYNAMIC_PICKUPS 1500
enum DynamicPickupInfo
{//инфа динамических пикапов
	Type, //1 - дом, 2 - штаб, 3 - деньги игрока, 4 - кейс
	ID, //ID дома, ID штаба, сумма денег
	DestroyTimerID, //ID таймера для удаления пикапа (не используется у домов и штабов)
}//инфа динамических пикапов
new DynamicPickup[MAX_DYNAMIC_PICKUPS][DynamicPickupInfo];


enum GZInfo
{
	ZID,
	GZName[MAX_PLAYER_NAME],
	GZOwner,
	GZColor,
	GZLevel,
	Float:GMaxX,
	Float:GMinX,
	Float:GMaxY,
	Float:GMinY,
	GZClanTime,
	GZExp,
	GZCash,
	Float:ZHeigh,
	//
	ZoneAttacked,
	ClanAttacker,
}

new GangZones[MAX_GZONE][GZInfo];
new Float:GPSZone[MAX_GZONE][2]; //навигация
new ZoneGPS[MAX_PLAYERS];
enum AdminStat {Stat, StatName[23],	Color,	StrColor[10],}
new AdminInfo[6][AdminStat]=
{
	{0,	"Игрок",					0xFFFFFFFF,	"{FFFFFF}"},
	{1,	"Модератор",				0x66CDAAFF,	"{66CDAA}"},
	{2,	"Супермодератор",			0x9ACD32FF,	"{9ACD32}"},
	{3,	"Администратор",			0x00BFFFFF,	"{00BFFF}"},
	{4,	"Главный администратор",	0xFF7F50FF,	"{FF7F50}"},
	{5,	"Скрытый администратор",	0xAFAFAFFF,	"{AFAFAF}"}
};

//MARAFON
enum MarafonStat
{
	Intent[50],
	MAmont,
	MPrize[36],
}
new EtapsInfo[7][MarafonStat]=
{
	{"Принять участие в соревнованиях", 2000, 	 "+20.000.000$ в банк"}, 	//0
	{"Заработать опыт", 				1150000, "+1 престиж"},				//1
	{"Выиграть в ивентах", 				230,	 "+35 руб. в /shop"},		//2
	{"Выполнить квесты (/quests)", 		240, 	 "+1 VIP"},			  		//3
	{"Найти кейсы", 					700, 	 "5 лотерейных билетов"},   //4
	{"Заработать деньги на ивентах", 	17000000,"+25 LVL, 10 Медалей"}, 	//5
 	{"Купить деньги для /shop",			350,	 "Супер-навык Махинатор"} 	//6
};
new PlayerMarafon[MAX_PLAYERS][7];
//--------------------------------
//Регистрационные данные
new RegisterDate[MAX_PLAYERS][16];
new RegisterIP[MAX_PLAYERS][16];

new NOPSetPlayerHealth[MAX_PLAYERS];
new NOPSetPlayerArmour[MAX_PLAYERS];
new NOPSetPlayerHealthAndArmourOff[MAX_PLAYERS];

//------- LAC на оружие
new LACWeaponOff[MAX_PLAYERS];
stock ResetWeapons(playerid)
{
    for(new i=0;i<47;i++) Weapons[playerid][i] = 0;
	LACWeaponOff[playerid] = 3;
	return ResetPlayerWeapons(playerid);
}
#define ResetPlayerWeapons ResetWeapons //LAC на оружие

stock GiveWeapon(playerid,weapid,ammo)
{
	if (ammo > 0) Weapons[playerid][weapid]= 1;
	return GivePlayerWeapon(playerid,weapid,ammo);
	//return ;
}
#define GivePlayerWeapon GiveWeapon //LAC на оружие

//------- LAC на телепорт
new LACTeleportOff[MAX_PLAYERS], TimeWithZeroSpeed[MAX_PLAYERS];
stock SetPos(playerid, Float:x, Float:y, Float:z)
{
	LastPlayerX[playerid] = x; LastPlayerY[playerid] = y; LastPlayerZ[playerid] = z;
	LACTeleportOff[playerid] = 3;
	if (IsPlayerInAnyVehicle(playerid) && GetPlayerVehicleSeat(playerid) == 0) DestroyVehicle(GetPlayerVehicleID(playerid));//исправляет баг, игрок, который в авто, не перемещается и кикается античитом на тп
	SetPlayerPos(playerid, x, y, z);
	return 1;
}
#define SetPlayerPos SetPos
stock SetPosFindZ(playerid, Float:x, Float:y, Float:z)
{
	LastPlayerX[playerid] = x; LastPlayerY[playerid] = y; LastPlayerZ[playerid] = z;
	LACTeleportOff[playerid] = 3;
	SetPlayerPosFindZ(playerid, x, y, z);
	return 1;
}
#define SetPlayerPosFindZ SetPosFindZ
stock SetVPos(vehicleid, Float:x, Float:y, Float:z)
{
	foreach(Player, cid)
	{
	    if(GetPlayerVehicleID(cid) == vehicleid){LastPlayerX[cid] = x; LastPlayerY[cid] = y; LastPlayerZ[cid] = z; LACTeleportOff[cid] = 3;}
	}
	SetVehiclePos(vehicleid, x, y, z);
	return 1;
}
#define SetVehiclePos SetVPos
stock PutInVehicle(playerid,vehicleid,seatid)
{
    if (vehicleid == -1) return 1;
    GetVehiclePos(vehicleid, LastPlayerX[playerid], LastPlayerY[playerid], LastPlayerZ[playerid]);
	LACTeleportOff[playerid] = 3;
	PutPlayerInVehicle(playerid,vehicleid,seatid);
	if (seatid == 0) Vehicle[vehicleid][Owner] = playerid;//присваеваем машине ид владельца авто
	return 1;
}
#define PutPlayerInVehicle PutInVehicle
//------- LAC на телепорт

stock LDestroyVehicle(vehicleid)
{
    if (vehicleid == -1) return 1; //несуществующее авто
    //if (Vehicle[vehicleid][VType] == 1) return 1; //авто на бт не уни4тожаем, а только респавним
	//
    deleteproperty(_, "", PROPERTY_OFFSET(vehicleid));//GetVehicleColor
    //
	//Уничтожение неона
	if (NeonObject1[vehicleid] != -1){DestroyDynamicObject(NeonObject1[vehicleid]);NeonObject1[vehicleid] = -1;}
	if (NeonObject2[vehicleid] != -1){DestroyDynamicObject(NeonObject2[vehicleid]);NeonObject2[vehicleid] = -1;}
	//огненные колеса
	if (Fire3[vehicleid] != -1){DestroyDynamicObject(Fire3[vehicleid]);Fire3[vehicleid] = -1;}
	if (Fire4[vehicleid] != -1){DestroyDynamicObject(Fire4[vehicleid]);Fire4[vehicleid] = -1;}
	//migalka
	if (MigObj[vehicleid] != -1){DestroyDynamicObject(MigObj[vehicleid]);MigObj[vehicleid] = -1;}
	//vinil
	if (VVinil[vehicleid][0] != -1){DestroyDynamicObject(VVinil[vehicleid][0]);VVinil[vehicleid][0] = -1;}
	if (VVinil[vehicleid][1] != -1){DestroyDynamicObject(VVinil[vehicleid][1]);VVinil[vehicleid][1] = -1;}

	if (TrailerID[vehicleid] > -1) LDestroyVehicle(TrailerID[vehicleid]);//Если у авто есть трейлер - уничтожаем его
	TrailerID[vehicleid] = -1; IsTrailer[vehicleid] = 0;
	if (Vehicle[vehicleid][Owner] > -1)
	{
	    new ownerid = Vehicle[vehicleid][Owner];
		if (IsPlayerInVehicle(ownerid, vehicleid)) RemovePlayerFromVehicle(ownerid);
		PlayerCarID[ownerid] = -1;
		Vehicle[vehicleid][Owner] = -1;
	} //исправление бага
	return DestroyVehicle(vehicleid);
}
#define DestroyVehicle LDestroyVehicle

//LAC на рассинхронизацию здоровья и брони
stock SetHealth(playerid, Float: health)
{
	Player[playerid][PHealth] = health;
	return SetPlayerHealth(playerid, health);
}
#define SetPlayerHealth SetHealth
stock SetArmour(playerid, Float: armour)
{
	Player[playerid][PArmour] = armour;
	return SetPlayerArmour(playerid, armour);
}
#define SetPlayerArmour SetArmour
//LAC на рассинхронизацию здоровья и брони

//LAC на ремонт транспорта
new LACRepair[MAX_VEHICLES] = 0;
stock SetVHealth(vehicleid, Float: health)
{
	Vehicle[vehicleid][Health] = health;
	return SetVehicleHealth(vehicleid, health);
}
#define SetVehicleHealth SetVHealth

stock RepairVeh(vehicleid)
{
	Vehicle[vehicleid][Health] = 1000.0;
	return RepairVehicle(vehicleid);
}
#define RepairVehicle RepairVeh
//LAC на ремонт транспорта

//Авто-удаление старого чекпоинта при создании нового. Задержка между удалением и созданием в 100мс чтобы не было бага с размером чека
stock SetCheckpoint(playerid, Float:x, Float:y, Float:z, Float:size)
{
    CoordsCP[playerid][0] = x;
	CoordsCP[playerid][1] = y;
	CoordsCP[playerid][2] = z;
    DisablePlayerCheckpoint(playerid); DisablePlayerRaceCheckpoint(playerid); GPSUsed[playerid] = 0;
    return SetTimerEx("LSetPlayerCheckpoint" , 100, false, "iffff", playerid, x, y, z, size);
}
forward LSetPlayerCheckpoint(playerid, Float:x, Float:y, Float:z, Float:size);
public LSetPlayerCheckpoint(playerid, Float:x, Float:y, Float:z, Float:size) return SetPlayerCheckpoint(playerid, Float:x, Float:y, Float:z, Float:size);
#define SetPlayerCheckpoint SetCheckpoint
//А теперь тоже самое для гоночных чекпоинтов
stock SetRaceCheckpoint(playerid, type, Float:x, Float:y, Float:z, Float:nextx, Float:nexty, Float:nextz, Float:size)
{
    CoordsCP[playerid][0] = x;
	CoordsCP[playerid][1] = y;
	CoordsCP[playerid][2] = z;
    DisablePlayerCheckpoint(playerid); DisablePlayerRaceCheckpoint(playerid); GPSUsed[playerid] = 0;
	return SetTimerEx("LSetPlayerRaceCheckpoint" , 100, false, "iifffffff", playerid, type, x, y, z, nextx, nexty, nextz, size);
}
forward LSetPlayerRaceCheckpoint(playerid, type, Float:x, Float:y, Float:z, Float:nextx, Float:nexty, Float:nextz, Float:size);
public LSetPlayerRaceCheckpoint(playerid, type, Float:x, Float:y, Float:z, Float:nextx, Float:nexty, Float:nextz, Float:size) return SetPlayerRaceCheckpoint(playerid, type, x, y, z, nextx, nexty, nextz, size);
#define SetPlayerRaceCheckpoint SetRaceCheckpoint
//Авто-удаление старого чекпоинта при создании нового. Задержка между удалением и созданием в 100мс чтобы не было бага с размером чека

stock ShowDialog(playerid, dialogid, style, caption[], info[], button1[], button2[])
{
	PDialogID[playerid] = dialogid;
	return ShowPlayerDialog(playerid, dialogid, style, caption, info, button1, button2);
}
#define ShowPlayerDialog ShowDialog

//////////////------------- Русский GetWeaponName
new WeaponName[47][] = {// http://wiki.sa-mp.com/wiki/Weapons_RU
"Нет",
"Knuckles",
"Golf Club",
"Nightstick",
"Knife",
"Baseball Bat",
"Shovel",
"Pool Cue",
"Katana",
"Chainsaw",
"Purple Dildo",
"Dildo",
"Vibrator",
"Silver Vibrator",
"Flowers",
"Cane",
"Grenades",
"Tear Gas",
"Molotov",
"Vehicle Rocket",
"Hydra Gas",
"JetPack",
"9mm Pistol",
"Silenced 9mm Pistol",
"Desert Eagle",
"Shotgun",
"Sawnoff Shotgun",
"Combat Shotgun",
"UZI",
"MP5",
"AK-47",
"M4",
"Tec-9",
"Country Rifle",
"Sniper Rifle",
"RPG",
"HS Rocket",
"Flamethrower",
"Minigun",
"Satchel Charge",
"Detonator",
"Spraycan",
"Fire Extinguisher",
"Camera",
"Night Vis Goggles",
"Thermal Goggles",
"Parachute"
 };
stock GetWeaponNameEx(weaponid, weapon[], len = sizeof(weapon))
{
    if (0 <= weaponid <= 46) return weapon[0] = 0, strcat(weapon, WeaponName[weaponid], len), true;
    else return weapon[0] = 0, strcat(weapon, "{FF0000}Неизвестное оружие", len), true;
}
#define GetWeaponName GetWeaponNameEx
//////////////------------- Русский GetWeaponName


new CheatFlySec[MAX_PLAYERS] = 0, LACFlyOff[MAX_PLAYERS] = 0;//LAC на FlyHack
new LACPedSHOff[MAX_PLAYERS] = 0, LACPedSHTime[MAX_PLAYERS] = 0;//LAC на SpeedHack (пешком)

new ClanTextShowed[MAX_PLAYERS] = 0;

new TimeTransform[MAX_PLAYERS], Float:carhealth = 0.0;//задержка трансформации

#include "Transformer\PLAYERSpawns"
#include "Transformer\EVENTSpawns"
#include "Transformer\WeaponsData" //урон от оружия
#include "Transformer\Levels" //XP, необходимый для уровня
#include "Transformer\LevelUp" //Функция повышения уровня
new DMName[][] =
{
"0id",
"Последний Самурай",
"Зона 69",
"Sniper Elite",
"Кладбище",
"Зона 69 (Внутри)",
"Emerald Isle",
"Sniper Assault",
"Minigun Madness",
"Мясорубка",
"RocketMania",
"Ферма",
"UnderWater",
"Dead Air",
"Диллимор",
"Буря в Пустыне",
"Бассейн",
"Полигон",
"Ангар",
"Авианосец",
"Дом Удовольствий"
};

new DerbyName[][] =
{
"0id",
"Честная Битва",
"Great Random",
"Выживает Сильнейший",
"Разрушительная Битва",
"На Грани",
"Без Гарантий",
"Перекрестки",
"Пять Башен",
"World Of Tanks",
"На пирамидах",
"Свободное падение",
"Parkour",
"Explode Jeep",
"Тишина",
"Багажное безумие",
"Tornado",
"Заварушка",
"Battle Ship",
"Полигон А",
"Ave Maria",
"Vertigo"
//"New Year 2017"
};

new ZMName[][] =
{
"0id",
"Поселок Блуберри",
"Форт Карсон",
"Angel Pine",
"Доки (Лос Сантос)",
"Зона 69",
"Пустынный округ",
"Диллимор",
"Grove Street",
"Свалка",
"Город - Призрак",
"Казино Рояль",
"Стройка",
"Склады",
"Нефтезавод",
"Две Крыши",
"Dead by Daylight"
};

new FRName[][] =
{
"0id",
"Заброшенный аэро (Восток)",
"Заброшенный аэро (Запад)",
"Великий Трамплин",
"Аэропорт (СФ)",
"Гора Чиллиад",
"Радиовышка (СФ)",
"Клуб Джиззи (СФ)",
"Карьер",
"Groove Street (ЛС)",
"Иделвуд (ЛС)",
"Маяк (ЛС)",
"Доки (ЛС)",
"Аэропорт ЛС",
"Полиция (ЛС)",
"Казино Калигула",
"Бейсбольное поле (ЛВ)",
"Отель Rock (ЛВ)",
"Автострада (Паломино)",
"Завод Блуберри",
"Автошкола (СФ)",
"Медицинский центр (СФ)",
"Военная база (СФ)",
"Причал (ЛС)",
"Автострада Джулиус (ЛВ)",
"Ж/Д вокзал (ЛВ)",
"Военная база (ЛВ)",
"Зона 69",
"Стадион (ЛВ)",
"Причал Бейсайд",
"Стадион (ЛС)",
"Обсерватория (ЛС)",
"Химический завод (СФ)",
"Старый склад (СФ)",
"Аэропорт ЛС",
"Angel Pine",
"Стадион (СФ)",
"Центр (СФ)",
"Церковь (СФ)",
"Аэропорт (ЛВ)",
"Дамба Шермана"
//Можно добавить "Аэропорт Сан Фиерро" и "Аэропорт Лас Вентурас" (не взлетные полосы)
};

new GGName[][] =
{
"0id",
"Golf Club",
"Зона 69",
"Four Dragons",
"Кладбище",
"Зона 69 (внутри)",
"Emerald Isle",
"Диллимор",
"Стройка",
"Заброшенный Завод",
"Футбольное Поле",
"Ферма",
"UnderWater",
"Dead Air",
"Скалы",
"Пустынный округ",
"Бассейн",
"Полигон",
"Ангар",
"Авианосец",
"Дом Удовольствий"
};

new XRName[][] =
{
"0id",
"Around San Andreas",
"Bon Voyage",
"Up And Down",
"Riders On The Storm",
"Crazy Turns",
"Vegas Race",
"Dead Air",
"Road To Farm",
"UnderGround",
"San Fierro Tour",
"Into The Wild",
"Drag Race",
"Need For Speed",
"Восьмерка",
"San Fierro Drift",
"Mountain",
"Не для слабаков",
"Dirt And Dust",
"Los Santos Highway",
"Fast And Furious",
"Путь гепарда"
};

new TDMName[][] =
{
"0id",
"War Ground",
"Factory Battle",
"Выхода нет",
"Deserted Airport",
"Forest",
"Тир",
"Parking Front",
"На холме"
};

new PRName[][] =
{
"0id",
"Base Jumper",
"Up The Sky",
"Extreme Run",
"Street Workout",
"Руферы",
"Восхождение"
//"King Of 2017"
};

new DRName[][] =
{
"0id",
"АТОМ",
"Стартрек",
"Undercover",
"Форт Боярд",
"Sky Cubes",
"4x4 Offroad",
"Бездорожье"
};

/*new PDMName[][] =
/{
"0id",
"Вальгалла",
"Not Found"
};*/

//----- кейсы
#include "Transformer\Packages"
new CasePickup[23], CaseMapIcon[23];
#define MAX_CASES 20 // максимум кейсов на карте
//new year
new casemodel = 19057;//Модель кейса standart 1210 ng 19057



//новые пакеты
//#include "packages"

//---- Угон авто
#include "Transformer\CarStealSpawn"
new StealCar[36], StealCarMapIcon[36], cscol1, cscol2, csmodel;
new csrand1, csrand2, csrand3, csrand4, csrand5, csrand6, csrand7, csrand8, csrand9, csrand10;
new csrand11, csrand12, csrand13, csrand14, csrand15, csrand16, csrand17, csrand18, csrand19, csrand20;
new csrand21, csrand22, csrand23, csrand24, csrand25, csrand26, csrand27, csrand28, csrand29, csrand30;
new csrand31, csrand32, csrand33, csrand34, csrand35;
new StealCarTimer[MAX_VEHICLES], StealCarModel[MAX_PLAYERS];

new QuestCar[MAX_PLAYERS] = -1, QuestActive[MAX_PLAYERS] = 0;
new AirportID[MAX_PLAYERS], AirportTime[MAX_PLAYERS];//аэропорты

//spec
new LSpecID[MAX_PLAYERS] = {-1,...}, LSpecMode[MAX_PLAYERS] = SPECTATE_MODE_NORMAL, LSpecCanFastChange[MAX_PLAYERS] = 0;
new LSpectators[MAX_PLAYERS];
new LSpecCount[MAX_PLAYERS], Float: SpecVector[MAX_PLAYERS][3];

//spec

new rampid[MAX_PLAYERS];
new NeedLSpawn[MAX_PLAYERS] = 0;
new PrestigeGM[MAX_PLAYERS] = 0;

new ServerLimitXPDate[80], PlayerLimitXPDate[MAX_PLAYERS][80];//Для обнуления лимита ХР каждый час

forward SecUpdate();
forward UnFreeze(playerid);
forward ParaEnd(playerid);
forward PrestigeCarTP(playerid, class, seat1, seat2, seat3);
forward PrestigeCarTPx(playerid, class, seat1, seat2, seat3, Float: vel1,  Float: vel2, Float: vel3);
forward SpecTextDrawPub(playerid);
forward SpeedoUpdate(playerid); new LastSpeed[MAX_PLAYERS] = 999, LACSH[MAX_PLAYERS] = 3, Float: LastVHealth[MAX_PLAYERS], NeedSpeedDown[MAX_PLAYERS];
forward SecPlayerUpdate(playerid);
forward UnLock(playerid,vehicleid);
forward LSpawnPlayer(playerid);
//forward SobeitCamCheck(playerid);
forward DestroyCashPickup(pickupid);
forward SideCameraSpecpUpdate(playerid, vehicleid);

//mysql
forward FindPlayerInTable(playerid);
forward UploadPlayerAccountNumber(playerid);
forward LoadPlayerAccount(playerid);
forward LoadAllClans();
forward LoadAllProperty();
forward LoadAllBase();
forward LoadGangZones();
forward OffHUpdate(owner[],pid);

//Отложенный на 100мс кик, чтобы игрок увидел сообщение о кике
forward KickTimer(playerid);//кик через 100мс
stock GKick(playerid){SavePlayer(playerid); return SetTimerEx("KickTimer" , 100, false, "i", playerid);}
public KickTimer(playerid) return Kick(playerid);//кик через 100мс

forward RemoveRamp(playerid);
forward Float:GetOptimumRampDistance(playerid);
forward Float:GetXYInFrontOfPlayer(playerid, &Float:x, &Float:y, Float:distance);
//forward GivePlayerPara(playerid);

#include <fly> //Полет супер-мена (Престиж 2)
#include <vehfly> //Полет на авто (Престиж 4)


//stock Translit(playerid, text[]) {PC_EmulateCommand(playerid, text); return 1;}
#include "Transformer\Commands" 	//команды
#include "Transformer\ACommands" 	//admin команды


// --------------- Время в секундах ---------------------------------
#define MAX_AFK_TIME 3600    // максимально время AFK до кика
#define FIRST_CHECK 2400    // первое предупреждение
#define SECOND_CHECK 3000    // второе предупреждение
#define AFK_TEXT_SET 20    // время до появления надписи AFK над головой

// --------------- Цвета --------------------------------------------
#define T_COLOR 0xFF000080    // цвет 3Д текста
#define M1_COLOR 0xFF0000FF // цвет текста первого предупреждения
#define M2_COLOR 0xFF0000FF // цвет текста второго предупреждения
#define MK_COLOR 0xFF0000FF // цвет текста оповещения о кике

// --------------- Прочее -------------------------------------------
#define T_DIST 20.0 // расстояние с которого видно 3Д текст

// --------------- Структура данных ---------------------------------
enum afk_info {
	AFK_Time,            // время AFK
Float:AFK_Coord,    // последняя координата
	AFK_Stat            // статус 3Д текста
}

// --------------- Объявление переменных ----------------------------
new PlayerAFK[MAX_PLAYERS][afk_info];    // данные AFK игроков
new Text3D:AFK_3DT[MAX_PLAYERS]; // 3Д тексты над головами игроков

main() {}

PlayerToPoint(Float:radius, playerid, Float:x, Float:y, Float:z)
{
	if(IsPlayerConnected(playerid))
	{
		new Float:oldposx, Float:oldposy, Float:oldposz;
		new Float:tempposx, Float:tempposy, Float:tempposz;
		GetPlayerPos(playerid, oldposx, oldposy, oldposz);
		tempposx = (oldposx -x);
		tempposy = (oldposy -y);
		tempposz = (oldposz -z);
		if (((tempposx < radius) && (tempposx > -radius)) && ((tempposy < radius) && (tempposy > -radius)) && ((tempposz < radius) && (tempposz > -radius)))
		{
			return 1;
		}
	}
	return 0;
}

stock ResetPlayer(playerid)
{
    Player[playerid][SID] = 0;
	Player[playerid][Model] = 0;
	Player[playerid][Admin] = 0;
	Player[playerid][Level] = 0;
	Player[playerid][Exp] = 0;
	Player[playerid][Spawn] = 0;
	Player[playerid][SpawnStyle] = 0;
	Player[playerid][Invisible] = 0;
	Player[playerid][Time] = 0;
	Player[playerid][Cash] = 0;
	Player[playerid][Bank] = 0;
	Player[playerid][Slot1] = 0;
	Player[playerid][Slot2] = 0;
	Player[playerid][Slot3] = 0;
	Player[playerid][Slot4] = 0;
	Player[playerid][Slot5] = 0;
	Player[playerid][Slot6] = 0;
	Player[playerid][Slot7] = 0;
	Player[playerid][Slot8] = 0;
	Player[playerid][Slot9] = 0;
	Player[playerid][Slot10] = 0;
	Player[playerid][MyClan] = 0;
	Player[playerid][Member] = 0;
	Player[playerid][Leader] = 0;
	Player[playerid][Home] = 0;
	Player[playerid][MrfEnd] = 0;
	Player[playerid][Banned] = 0;
	strmid(BannedBy[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5);
	strmid(BanReason[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5);
	Player[playerid][Muted] = 0;
	strmid(MutedBy[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5);
	Player[playerid][CarSlot1] = 462;
	Player[playerid][CarSlot1Color1] = 0;
	Player[playerid][CarSlot1Color2] = 0;
	Player[playerid][CarSlot1PaintJob] = -1;
	Player[playerid][CarSlot1Neon] = 0;
	Player[playerid][CarSlot1Fire] = 0;
	Player[playerid][CarSlot1Sir] = 0;
	Player[playerid][CarSlot1Mig] = 0;
	Player[playerid][CarSlot1Component0] = 0;
	Player[playerid][CarSlot1Component1] = 0;
	Player[playerid][CarSlot1Component2] = 0;
	Player[playerid][CarSlot1Component3] = 0;
	Player[playerid][CarSlot1Component4] = 0;
	Player[playerid][CarSlot1Component5] = 0;
	Player[playerid][CarSlot1Component6] = 0;
	Player[playerid][CarSlot1Component7] = 0;
	Player[playerid][CarSlot1Component8] = 0;
	Player[playerid][CarSlot1Component9] = 0;
	Player[playerid][CarSlot1Component10] = 0;
	Player[playerid][CarSlot1Component11] = 0;
	Player[playerid][CarSlot1Component12] = 0;
	Player[playerid][CarSlot1Component13] = 0;
	Player[playerid][CarSlot1NitroX] = 0;
	Player[playerid][CarSlot2] = 0;
	Player[playerid][CarSlot2Color1] = 0;
	Player[playerid][CarSlot2Color2] = 0;
	Player[playerid][CarSlot2PaintJob] = -1;
	Player[playerid][CarSlot2Neon] = 0;
	Player[playerid][CarSlot2Fire] = 0;
	Player[playerid][CarSlot2Sir] = 0;
	Player[playerid][CarSlot2Mig] = 0;
	Player[playerid][CarSlot2Component0] = 0;
	Player[playerid][CarSlot2Component1] = 0;
	Player[playerid][CarSlot2Component2] = 0;
	Player[playerid][CarSlot2Component3] = 0;
	Player[playerid][CarSlot2Component4] = 0;
	Player[playerid][CarSlot2Component5] = 0;
	Player[playerid][CarSlot2Component6] = 0;
	Player[playerid][CarSlot2Component7] = 0;
	Player[playerid][CarSlot2Component8] = 0;
	Player[playerid][CarSlot2Component9] = 0;
	Player[playerid][CarSlot2Component10] = 0;
	Player[playerid][CarSlot2Component11] = 0;
	Player[playerid][CarSlot2Component12] = 0;
	Player[playerid][CarSlot2Component13] = 0;
	Player[playerid][CarSlot2NitroX] = 0;
	Player[playerid][CarSlot3] = 0;
	Player[playerid][CarSlot3Color1] = 0;
	Player[playerid][CarSlot3Color2] = 0;
	Player[playerid][GameGold] = 0;
	Player[playerid][GameGoldTotal] = 0;
	Player[playerid][GPremium] = 0;
	Player[playerid][SkillHP] = 0;
	Player[playerid][SkillRepair] = 0;
	Player[playerid][ActiveSkillPerson] = 0;
	Player[playerid][ActiveSkillCar1] = 0;
	Player[playerid][ActiveSkillCar2] = 0;
	Player[playerid][ActiveSkillHCar1] = 0;
	Player[playerid][ActiveSkillHCar2] = 0;
	Player[playerid][Prestige] = 0;
	Player[playerid][Karma] = 250;
	Player[playerid][KarmaTime] = 0;
	Player[playerid][PosX] = 0.0;
	Player[playerid][PosY] = 0.0;
	Player[playerid][PosZ] = 0.0;
	Player[playerid][PosA] = 0.0;
	Player[playerid][ConPM] = 1;
	Player[playerid][FindPack] = 1;
	Player[playerid][SlivBlock] = -1;
	Player[playerid][ReadObnovlenie] = 0;
	Player[playerid][Bonus] = 0;
	Player[playerid][ConInviteClan] = 1;
	Player[playerid][ConInvitePVP] = 1;
	Player[playerid][ConMesPVP] = 1;
	Player[playerid][ConMesEnterExit] = 0; //По умолчанию сообщения о входе/выходе на сервер не отображаются
	Player[playerid][ConSpeedo] = 1;
	Player[playerid][RadarSwitch] = 1;
	Player[playerid][Mrf1] = 0;
	Player[playerid][Gold] = 0;
	Player[playerid][SPN1] = 0;
	Player[playerid][SPN2] = 0;
	Player[playerid][SPN3] = 0;
	Player[playerid][SPN4] = 0;
	Player[playerid][SPN5] = 0;
	Player[playerid][SPN6] = 0;
	Player[playerid][SPN7] = 0;
	Player[playerid][SPN8] = 0;
	Player[playerid][SPN9] = 0;
	Player[playerid][Type] = 0;
	Player[playerid][Tag] = 0;
	Player[playerid][LastHourExp] = 0;
	Player[playerid][LastHourReferalExp] = 0;
	Player[playerid][HelpTime] = 100;
	Player[playerid][SPrest] = 0;
	Player[playerid][EventChangeTime] = 0;
	Player[playerid][LeaveZM] = 0;
	Player[playerid][ClanWarTime] = 0;
	Player[playerid][CasinoBalance] = 0;
	//Player[playerid][GiveCashBalance] = 0;
	Player[playerid][BuddhaTime] = 0;
	Player[playerid][PrestigeColor] = -1;
	Quest[playerid][0] = random(10) + 1;
	QuestScore[playerid][0] = 0;
	QuestTime[playerid][0] = 0;
	Quest[playerid][1] = random(10) + 11;
	QuestScore[playerid][1] = 0;
	QuestTime[playerid][1] = 0;
	Quest[playerid][2] = 25;//quest: Проведите на сервере 60 минут.
	QuestScore[playerid][2] = 0;
	QuestTime[playerid][2] = 0;
	Player[playerid][Medals] = 0;
	Player[playerid][CompletedQuests] = 0;
	Player[playerid][GGFromMedals] = 0;
	Player[playerid][GGFromMedalsTotal] = 0;
	Player[playerid][GGFromMedalsLastDay] = nowday;
	Player[playerid][OpXP] = 0;
	Player[playerid][OpGG] = 0.0;
	Player[playerid][MJAct] = 0;
    Player[playerid][Lottery] = 0;
    Player[playerid][MenuTp] = 0;

	//Переменные, которые НЕ сохраняются в файл
	Player[playerid][CarActive] = 0;
	Player[playerid][PHealth] = 100.0;
	Player[playerid][PArmour] = 100.0;
 	Player[playerid][DMove] = 0;
 	Player[playerid][UpdTime] = 0;
 	Player[playerid][SaveTime] = gettime()+600;
 	rampid[playerid] = -1;
 	ZoneGPS[playerid] = -1;
 	SetPVarInt(playerid, "ChInt", 0);
 	//InPlane[playerid] = 0;

	//О регистрации
	RegisterDate[playerid] = "Null";
	RegisterIP[playerid] = "Null";
	
	for(new x; x<sizeof(EtapsInfo); x++)
	{
	    PlayerMarafon[playerid][x] = 0;
	}
	
	PGunActiv[playerid] = 0;
	LSpecCount[playerid] = 0;
}


stock SavePlayer(playerid)
{
	if (ServConf[1] == 1) return 1;
	if (Logged[playerid] == 0 || Player[playerid][Level] == 0) return 1; //Проверка на ненулевой лвл исправляет баг с обнулением аккаунта
	new query[2600];
	query = "UPDATE `accounts` SET ";
	//acc_str_strcat(query, sizeof(query), "Password", PlayerPass[playerid]);
	acc_int_strcat(query, sizeof(query), "Model", Player[playerid][Model]);//
	//acc_int_strcat(query, sizeof(query), "Admin", Player[playerid][Admin]);
	acc_int_strcat(query, sizeof(query), "Level", Player[playerid][Level]);//
	acc_int_strcat(query, sizeof(query), "Exp", Player[playerid][Exp]);//
	acc_int_strcat(query, sizeof(query), "Spawn", Player[playerid][Spawn]);//
	acc_int_strcat(query, sizeof(query), "SpawnStyle", Player[playerid][SpawnStyle]);//
	acc_int_strcat(query, sizeof(query), "Invisible", Player[playerid][Invisible]);//
	acc_int_strcat(query, sizeof(query), "Time", Player[playerid][Time]);//
	acc_int_strcat(query, sizeof(query), "Cash", Player[playerid][Cash]);//
	acc_int_strcat(query, sizeof(query), "Bank", Player[playerid][Bank]);//
	acc_int_strcat(query, sizeof(query), "Banned", Player[playerid][Banned]);
	acc_str_strcat(query, sizeof(query), "BannedBy", BannedBy[playerid]);
	acc_str_strcat(query, sizeof(query), "BanReason", BanReason[playerid]);
	acc_int_strcat(query, sizeof(query), "Muted", Player[playerid][Muted]);
	acc_str_strcat(query, sizeof(query), "MutedBy", MutedBy[playerid]);
	acc_int_strcat(query, sizeof(query), "Slot1", Player[playerid][Slot1]);//
	acc_int_strcat(query, sizeof(query), "Slot2", Player[playerid][Slot2]);//
	acc_int_strcat(query, sizeof(query), "Slot3", Player[playerid][Slot3]);//
	acc_int_strcat(query, sizeof(query), "Slot4", Player[playerid][Slot4]);//
	acc_int_strcat(query, sizeof(query), "Slot5", Player[playerid][Slot5]);//
	acc_int_strcat(query, sizeof(query), "Slot6", Player[playerid][Slot6]);//
	acc_int_strcat(query, sizeof(query), "Slot7", Player[playerid][Slot7]);//
	acc_int_strcat(query, sizeof(query), "Slot8", Player[playerid][Slot8]);//
	acc_int_strcat(query, sizeof(query), "Slot9", Player[playerid][Slot9]);//
	acc_int_strcat(query, sizeof(query), "Slot10", Player[playerid][Slot10]);//
	acc_int_strcat(query, sizeof(query), "MyClan", Player[playerid][MyClan]);
	acc_int_strcat(query, sizeof(query), "Member", Player[playerid][Member]);
	acc_int_strcat(query, sizeof(query), "Leader", Player[playerid][Leader]);
	acc_int_strcat(query, sizeof(query), "Home", Player[playerid][Home]);
	acc_int_strcat(query, sizeof(query), "Account", Player[playerid][MrfEnd]);
	acc_int_strcat(query, sizeof(query), "CarSlot1", Player[playerid][CarSlot1]);
	acc_int_strcat(query, sizeof(query), "CS1Cl1", Player[playerid][CarSlot1Color1]);
	acc_int_strcat(query, sizeof(query), "CS1Cl2", Player[playerid][CarSlot1Color2]);
	acc_int_strcat(query, sizeof(query), "CarSlot2", Player[playerid][CarSlot2]);
	acc_int_strcat(query, sizeof(query), "CS2Cl1", Player[playerid][CarSlot2Color1]);
	acc_int_strcat(query, sizeof(query), "CS2Cl2", Player[playerid][CarSlot2Color2]);
	acc_int_strcat(query, sizeof(query), "CarSlot3", Player[playerid][CarSlot3]);
	acc_int_strcat(query, sizeof(query), "CS3Cl1", Player[playerid][CarSlot3Color1]);
	acc_int_strcat(query, sizeof(query), "CS3Cl2", Player[playerid][CarSlot3Color2]);
	acc_float_strcat(query, sizeof(query), "GameGold", Player[playerid][GameGold]);
	acc_float_strcat(query, sizeof(query), "GGTotal", Player[playerid][GameGoldTotal]);
	acc_int_strcat(query, sizeof(query), "GPremium", Player[playerid][GPremium]);
	acc_int_strcat(query, sizeof(query), "SkillHP", Player[playerid][SkillHP]);
	acc_int_strcat(query, sizeof(query), "SkillRepair", Player[playerid][SkillRepair]);
	acc_int_strcat(query, sizeof(query), "ASPerson", Player[playerid][ActiveSkillPerson]);
	acc_int_strcat(query, sizeof(query), "ASCar1", Player[playerid][ActiveSkillCar1]);
    acc_int_strcat(query, sizeof(query), "ASCar2", Player[playerid][ActiveSkillCar2]);
    acc_int_strcat(query, sizeof(query), "ASHCar1", Player[playerid][ActiveSkillHCar1]);
    acc_int_strcat(query, sizeof(query), "ASHCar2", Player[playerid][ActiveSkillHCar2]);
	acc_int_strcat(query, sizeof(query), "Prestige", Player[playerid][Prestige]);
	acc_int_strcat(query, sizeof(query), "Karma", Player[playerid][Karma]);
	acc_int_strcat(query, sizeof(query), "KarmaTime", Player[playerid][KarmaTime]);
	acc_float_strcat(query, sizeof(query), "PosX", Player[playerid][PosX]);
	acc_float_strcat(query, sizeof(query), "PosY", Player[playerid][PosY]);
	acc_float_strcat(query, sizeof(query), "PosZ", Player[playerid][PosZ]);
	acc_float_strcat(query, sizeof(query), "PosA", Player[playerid][PosA]);
	acc_int_strcat(query, sizeof(query), "Mrf2", Player[playerid][Mrf1]);
	acc_int_strcat(query, sizeof(query), "Types", Player[playerid][Type]);
	acc_int_strcat(query, sizeof(query), "LHxp", Player[playerid][LastHourExp]);
	acc_int_strcat(query, sizeof(query), "LHRefxp", Player[playerid][LastHourReferalExp]);
	acc_str_strcat(query, sizeof(query), "LDate", PlayerLimitXPDate[playerid]);
	acc_str_strcat(query, sizeof(query), "LastIP", PlayerIP[playerid]);
	acc_int_strcat(query, sizeof(query), "SPrest", Player[playerid][SPrest]);
	acc_int_strcat(query, sizeof(query), "ECTime", Player[playerid][EventChangeTime]);
	acc_int_strcat(query, sizeof(query), "LeaveZM", Player[playerid][LeaveZM]);
	acc_int_strcat(query, sizeof(query), "ClanWarTime", Player[playerid][ClanWarTime]);
	acc_int_strcat(query, sizeof(query), "CasinoBalance", Player[playerid][CasinoBalance]);
	//acc_int_strcat(query, sizeof(query), "GiveCashBalance", Player[playerid][GiveCashBalance]);
	acc_str_strcat(query, sizeof(query), "ChatName", ChatName[playerid]);
	acc_int_strcat(query, sizeof(query), "BuddhaTime", Player[playerid][BuddhaTime]);
	acc_int_strcat(query, sizeof(query), "PrestigeColor", Player[playerid][PrestigeColor]);
   	acc_int_strcat(query, sizeof(query), "Quest1", Quest[playerid][0]);
    acc_int_strcat(query, sizeof(query), "Quest1Score", QuestScore[playerid][0]);
    acc_int_strcat(query, sizeof(query), "Quest1Time", QuestTime[playerid][0]);
    acc_int_strcat(query, sizeof(query), "Quest2", Quest[playerid][1]);
    acc_int_strcat(query, sizeof(query), "Quest2Score", QuestScore[playerid][1]);
    acc_int_strcat(query, sizeof(query), "Quest2Time", QuestTime[playerid][1]);
    acc_int_strcat(query, sizeof(query), "Quest3", Quest[playerid][2]);
    acc_int_strcat(query, sizeof(query), "Quest3Score", QuestScore[playerid][2]);
    acc_int_strcat(query, sizeof(query), "Quest3Time", QuestTime[playerid][2]);
    acc_int_strcat(query, sizeof(query), "Medals", Player[playerid][Medals]);
    acc_int_strcat(query, sizeof(query), "CQuests", Player[playerid][CompletedQuests]);
    acc_float_strcat(query, sizeof(query), "GGFM", Player[playerid][GGFromMedals]);
    acc_float_strcat(query, sizeof(query), "GGMT", Player[playerid][GGFromMedalsTotal]);
    acc_float_strcat(query, sizeof(query), "GGLD", Player[playerid][GGFromMedalsLastDay]);
    acc_int_strcat(query, sizeof(query), "FindPack", Player[playerid][FindPack]);
    acc_int_strcat(query, sizeof(query), "ReadObnov", Player[playerid][ReadObnovlenie]);
    acc_int_strcat(query, sizeof(query), "Bonus", Player[playerid][Bonus]);
    acc_int_strcat(query, sizeof(query), "SlivBlock", Player[playerid][SlivBlock]);
    
    new MStr[50];
    for(new i;i<sizeof(EtapsInfo);i++)
    {
        if(i==0) format(MStr,sizeof(MStr),"%d",PlayerMarafon[playerid][0]);
        else format(MStr,sizeof(MStr),"%s %d",MStr,PlayerMarafon[playerid][i]);
    }
    
    acc_str_strcat(query, sizeof(query), "Mrfon", MStr);
    acc_int_strcat(query, sizeof(query), "Gold", Player[playerid][Gold]);
    acc_int_strcat(query, sizeof(query), "SPNav1", Player[playerid][SPN1]);
    acc_int_strcat(query, sizeof(query), "SPNav2", Player[playerid][SPN2]);
    acc_int_strcat(query, sizeof(query), "SPNav3", Player[playerid][SPN3]);
    acc_int_strcat(query, sizeof(query), "SPNav4", Player[playerid][SPN4]);
    acc_int_strcat(query, sizeof(query), "SPNav5", Player[playerid][SPN5]);
    acc_int_strcat(query, sizeof(query), "SPNav6", Player[playerid][SPN6]);
    acc_int_strcat(query, sizeof(query), "SPNav7", Player[playerid][SPN7]);
    acc_int_strcat(query, sizeof(query), "SPNav8", Player[playerid][SPN8]);
    acc_int_strcat(query, sizeof(query), "SPN9", Player[playerid][SPN9]);
    acc_int_strcat(query, sizeof(query), "OpXP", Player[playerid][OpXP]);
    acc_float_strcat(query, sizeof(query), "OpGG", Player[playerid][OpGG]);
    acc_int_strcat(query, sizeof(query), "Lotr", Player[playerid][Lottery]);
    acc_int_strcat(query, sizeof(query), "MenuTp", Player[playerid][MenuTp]);
    //acc_int_strcat(query, sizeof(query), "Tag", Player[playerid][Tag]);
    strdel(query, strlen(query)-1, strlen(query));//удалить запятую
    format(query,sizeof(query),"%s WHERE `SID`='%i';",query,Player[playerid][SID]);
	mysql_tquery(connects, query);
	//printf(query);
	/*new strr[2900];
 	new File:hFile = fopen("MysqlUpdates.txt", io_append);
	format(strr, sizeof(strr), "%s;\r\n",query);
	for(new i; i < strlen(strr); i ++) fputchar(hFile, strr[i], false);
	fclose(hFile);*/
	return 1;
}

stock SavePlayerConfig(playerid)
{
    if (ServConf[1] == 1) return 1;
    if (Logged[playerid] == 0) return 1;
    new query[200];
	query = "UPDATE `accounts` SET ";
    acc_int_strcat(query, sizeof(query), "ConPM", Player[playerid][ConPM]);
	acc_int_strcat(query, sizeof(query), "ConInviteClan", Player[playerid][ConInviteClan]);
	acc_int_strcat(query, sizeof(query), "InvPVP", Player[playerid][ConInvitePVP]);
	acc_int_strcat(query, sizeof(query), "ConMesPVP", Player[playerid][ConMesPVP]);
	acc_int_strcat(query, sizeof(query), "InvEnEx", Player[playerid][ConMesEnterExit]);
	acc_int_strcat(query, sizeof(query), "ConSpeedo", Player[playerid][ConSpeedo]);
	acc_int_strcat(query, sizeof(query), "Radar", Player[playerid][RadarSwitch]);
	acc_int_strcat(query, sizeof(query), "Tag", Player[playerid][Tag]);
	strdel(query, strlen(query)-1, strlen(query));//удалить запятую
    format(query,sizeof(query),"%s WHERE `SID`='%i'",query,Player[playerid][SID]);
	mysql_tquery(connects, query);
	return 1;
}

stock SaveTune(playerid)
{
    if (ServConf[1] == 1) return 1;
	if (Logged[playerid] == 0) return 1;
    new query[900];
	query = "UPDATE `accounts` SET ";
	acc_int_strcat(query, sizeof(query), "CS1PJ", Player[playerid][CarSlot1PaintJob]);
	acc_int_strcat(query, sizeof(query), "CS1Neon", Player[playerid][CarSlot1Neon]);
	acc_int_strcat(query, sizeof(query), "CS1Fire", Player[playerid][CarSlot1Fire]);
	acc_int_strcat(query, sizeof(query), "CS1Sir", Player[playerid][CarSlot1Sir]);
	acc_int_strcat(query, sizeof(query), "CS1Mig", Player[playerid][CarSlot1Mig]);
	acc_int_strcat(query, sizeof(query), "CS1C0", Player[playerid][CarSlot1Component0]);
	acc_int_strcat(query, sizeof(query), "CS1C1", Player[playerid][CarSlot1Component1]);
	acc_int_strcat(query, sizeof(query), "CS1C2", Player[playerid][CarSlot1Component2]);
	acc_int_strcat(query, sizeof(query), "CS1C3", Player[playerid][CarSlot1Component3]);
	acc_int_strcat(query, sizeof(query), "CS1C4", Player[playerid][CarSlot1Component4]);
	acc_int_strcat(query, sizeof(query), "CS1C5", Player[playerid][CarSlot1Component5]);
	acc_int_strcat(query, sizeof(query), "CS1C6", Player[playerid][CarSlot1Component6]);
	acc_int_strcat(query, sizeof(query), "CS1C7", Player[playerid][CarSlot1Component7]);
	acc_int_strcat(query, sizeof(query), "CS1C8", Player[playerid][CarSlot1Component8]);
	acc_int_strcat(query, sizeof(query), "CS1C9", Player[playerid][CarSlot1Component9]);
	acc_int_strcat(query, sizeof(query), "CS1C10", Player[playerid][CarSlot1Component10]);
	acc_int_strcat(query, sizeof(query), "CS1C11", Player[playerid][CarSlot1Component11]);
	acc_int_strcat(query, sizeof(query), "CS1C12", Player[playerid][CarSlot1Component12]);
	acc_int_strcat(query, sizeof(query), "CS1C13", Player[playerid][CarSlot1Component13]);
	acc_int_strcat(query, sizeof(query), "CS1NitroX", Player[playerid][CarSlot1NitroX]);
	acc_int_strcat(query, sizeof(query), "CS2PJ", Player[playerid][CarSlot2PaintJob]);
	acc_int_strcat(query, sizeof(query), "CS2Neon", Player[playerid][CarSlot2Neon]);
	acc_int_strcat(query, sizeof(query), "CS2Fire", Player[playerid][CarSlot2Fire]);
	acc_int_strcat(query, sizeof(query), "CS2Sir", Player[playerid][CarSlot2Sir]);
	acc_int_strcat(query, sizeof(query), "CS2Mig", Player[playerid][CarSlot2Mig]);
	acc_int_strcat(query, sizeof(query), "CS2C0", Player[playerid][CarSlot2Component0]);
	acc_int_strcat(query, sizeof(query), "CS2C1", Player[playerid][CarSlot2Component1]);
	acc_int_strcat(query, sizeof(query), "CS2C2", Player[playerid][CarSlot2Component2]);
	acc_int_strcat(query, sizeof(query), "CS2C3", Player[playerid][CarSlot2Component3]);
	acc_int_strcat(query, sizeof(query), "CS2C4", Player[playerid][CarSlot2Component4]);
	acc_int_strcat(query, sizeof(query), "CS2C5", Player[playerid][CarSlot2Component5]);
	acc_int_strcat(query, sizeof(query), "CS2C6", Player[playerid][CarSlot2Component6]);
	acc_int_strcat(query, sizeof(query), "CS2C7", Player[playerid][CarSlot2Component7]);
	acc_int_strcat(query, sizeof(query), "CS2C8", Player[playerid][CarSlot2Component8]);
	acc_int_strcat(query, sizeof(query), "CS2C9", Player[playerid][CarSlot2Component9]);
	acc_int_strcat(query, sizeof(query), "CS2C10", Player[playerid][CarSlot2Component10]);
	acc_int_strcat(query, sizeof(query), "CS2C11", Player[playerid][CarSlot2Component11]);
	acc_int_strcat(query, sizeof(query), "CS2C12", Player[playerid][CarSlot2Component12]);
	acc_int_strcat(query, sizeof(query), "CS2C13", Player[playerid][CarSlot2Component13]);
	acc_int_strcat(query, sizeof(query), "CS2NitroX", Player[playerid][CarSlot2NitroX]);
	strdel(query, strlen(query)-1, strlen(query));//удалить запятую
    format(query,sizeof(query),"%s WHERE `SID`='%i'",query,Player[playerid][SID]);
	mysql_tquery(connects, query);
	return 1;
}
/*
stock SavePlayerINI(playerid)
{
	if (Logged[playerid] == 0 || Player[playerid][Level] == 0) return 1; //Проверка на ненулевой лвл исправляет баг с обнулением аккаунта
	
	new filename[MAX_FILE_NAME], file;
	format(filename, sizeof(filename), "accounts/%s.ini", PlayerName[playerid]);
	file = ini_openFile(filename);
	ini_setString(file,"Password", PlayerPass[playerid]);
	ini_setInteger(file, "Model", Player[playerid][Model]);//
	ini_setInteger(file, "Admin", Player[playerid][Admin]);
	ini_setInteger(file, "Level", Player[playerid][Level]);//
	ini_setInteger(file, "Exp", Player[playerid][Exp]);//
	ini_setInteger(file, "Spawn", Player[playerid][Spawn]);//
	ini_setInteger(file, "SpawnStyle", Player[playerid][SpawnStyle]);//
	ini_setInteger(file, "Invisible", Player[playerid][Invisible]);//
	ini_setInteger(file, "Time", Player[playerid][Time]);//
	ini_setInteger(file, "Cash", Player[playerid][Cash]);//
	ini_setInteger(file, "Bank", Player[playerid][Bank]);//
	ini_setInteger(file, "Banned", Player[playerid][Banned]);
	ini_setString(file,"BannedBy", BannedBy[playerid]);
	ini_setString(file,"BanReason", BanReason[playerid]);
	ini_setInteger(file, "Muted", Player[playerid][Muted]);
	ini_setString(file,"MutedBy", MutedBy[playerid]);
	ini_setInteger(file, "Slot1", Player[playerid][Slot1]);//
	ini_setInteger(file, "Slot2", Player[playerid][Slot2]);//
	ini_setInteger(file, "Slot3", Player[playerid][Slot3]);//
	ini_setInteger(file, "Slot4", Player[playerid][Slot4]);//
	ini_setInteger(file, "Slot5", Player[playerid][Slot5]);//
	ini_setInteger(file, "Slot6", Player[playerid][Slot6]);//
	ini_setInteger(file, "Slot7", Player[playerid][Slot7]);//
	ini_setInteger(file, "Slot8", Player[playerid][Slot8]);//
	ini_setInteger(file, "Slot9", Player[playerid][Slot9]);//
	ini_setInteger(file, "Slot10", Player[playerid][Slot10]);//
	ini_setInteger(file, "MyClan", Player[playerid][MyClan]);
	ini_setInteger(file, "Member", Player[playerid][Member]);
	ini_setInteger(file, "Leader", Player[playerid][Leader]);
	ini_setInteger(file, "Home", Player[playerid][Home]);
	ini_setInteger(file, "Account", Player[playerid][Account]);
	ini_setInteger(file, "CarSlot1", Player[playerid][CarSlot1]);
	ini_setInteger(file, "CarSlot1Color1", Player[playerid][CarSlot1Color1]);
	ini_setInteger(file, "CarSlot1Color2", Player[playerid][CarSlot1Color2]);
	ini_setInteger(file, "CarSlot2", Player[playerid][CarSlot2]);
	ini_setInteger(file, "CarSlot2Color1", Player[playerid][CarSlot2Color1]);
	ini_setInteger(file, "CarSlot2Color2", Player[playerid][CarSlot2Color2]);
	ini_setInteger(file, "CarSlot3", Player[playerid][CarSlot3]);
	ini_setInteger(file, "CarSlot3Color1", Player[playerid][CarSlot3Color1]);
	ini_setInteger(file, "CarSlot3Color2", Player[playerid][CarSlot3Color2]);
	ini_setFloat(file, "GameGold", Player[playerid][GameGold]);
	ini_setFloat(file, "GameGoldTotal", Player[playerid][GameGoldTotal]);
	ini_setInteger(file, "GPremium", Player[playerid][GPremium]);
	ini_setInteger(file, "SkillHP", Player[playerid][SkillHP]);
	ini_setInteger(file, "SkillRepair", Player[playerid][SkillRepair]);
	ini_setInteger(file, "ActiveSkillPerson", Player[playerid][ActiveSkillPerson]);
	ini_setInteger(file, "ActiveSkillCar1", Player[playerid][ActiveSkillCar1]);
    ini_setInteger(file, "ActiveSkillCar2", Player[playerid][ActiveSkillCar2]);
    ini_setInteger(file, "ActiveSkillHCar1", Player[playerid][ActiveSkillHCar1]);
    ini_setInteger(file, "ActiveSkillHCar2", Player[playerid][ActiveSkillHCar2]);
	ini_setInteger(file, "Prestige", Player[playerid][Prestige]);
	ini_setInteger(file, "Karma", Player[playerid][Karma]);
	ini_setInteger(file, "KarmaTime", Player[playerid][KarmaTime]);
	ini_setFloat(file, "PosX", Player[playerid][PosX]);
	ini_setFloat(file, "PosY", Player[playerid][PosY]);
	ini_setFloat(file, "PosZ", Player[playerid][PosZ]);
	ini_setFloat(file, "PosA", Player[playerid][PosA]);
	ini_setInteger(file, "ConPM", Player[playerid][ConPM]);
	ini_setInteger(file, "ConInviteClan", Player[playerid][ConInviteClan]);
	ini_setInteger(file, "ConInvitePVP", Player[playerid][ConInvitePVP]);
	ini_setInteger(file, "ConMesPVP", Player[playerid][ConMesPVP]);
	ini_setInteger(file, "ConMesEnterExit", Player[playerid][ConMesEnterExit]);
	ini_setInteger(file, "ConSpeedo", Player[playerid][ConSpeedo]);
	ini_setInteger(file, "Radar", Player[playerid][RadarSwitch]);
	ini_setInteger(file, "Mrf2", Player[playerid][Mrf1]);
	ini_setInteger(file, "Types", Player[playerid][Type]);
	ini_setInteger(file, "LastHourExp", Player[playerid][LastHourExp]);
	ini_setInteger(file, "LastHourReferalExp", Player[playerid][LastHourReferalExp]);
	ini_setString(file,"PlayerLimitXPDate", PlayerLimitXPDate[playerid]);
	ini_setString(file,"LastIP", PlayerIP[playerid]);
	ini_setInteger(file, "HelpTime", Player[playerid][HelpTime]);
	ini_setInteger(file, "EventChangeTime", Player[playerid][EventChangeTime]);
	ini_setInteger(file, "LeaveZM", Player[playerid][LeaveZM]);
	ini_setInteger(file, "ClanWarTime", Player[playerid][ClanWarTime]);
	ini_setInteger(file, "CasinoBalance", Player[playerid][CasinoBalance]);
	ini_setInteger(file, "GiveCashBalance", Player[playerid][GiveCashBalance]);
	ini_setString(file,"ChatName", ChatName[playerid]);
	ini_setInteger(file, "BuddhaTime", Player[playerid][BuddhaTime]);
	ini_setInteger(file, "PrestigeColor", Player[playerid][PrestigeColor]);
   ini_setInteger(file, "Quest1", Quest[playerid][0]);
    ini_setInteger(file, "Quest1Score", QuestScore[playerid][0]);
    ini_setInteger(file, "Quest1Time", QuestTime[playerid][0]);
    ini_setInteger(file, "Quest2", Quest[playerid][1]);
    ini_setInteger(file, "Quest2Score", QuestScore[playerid][1]);
    ini_setInteger(file, "Quest2Time", QuestTime[playerid][1]);
    ini_setInteger(file, "Quest3", Quest[playerid][2]);
    ini_setInteger(file, "Quest3Score", QuestScore[playerid][2]);
    ini_setInteger(file, "Quest3Time", QuestTime[playerid][2]);
    ini_setInteger(file, "Medals", Player[playerid][Medals]);
    ini_setInteger(file, "CompletedQuests", Player[playerid][CompletedQuests]);
    ini_setFloat(file, "GGFromMedals", Player[playerid][GGFromMedals]);
    ini_setFloat(file, "GGFromMedalsTotal", Player[playerid][GGFromMedalsTotal]);
    ini_setFloat(file, "GGFromMedalsLastDay", Player[playerid][GGFromMedalsLastDay]);
    ini_setInteger(file, "FindPack", Player[playerid][FindPack]);
    ini_setInteger(file, "ReadObnov", Player[playerid][ReadObnovlenie]);
    ini_setInteger(file, "Bonus", Player[playerid][Bonus]);
    ini_setInteger(file, "SlivBlock", Player[playerid][SlivBlock]);
    ini_setInteger(file, "Tag", Player[playerid][Tag]);
	ini_closeFile(file);
	return 1;
}
*/


stock ResetTuneClass1(playerid)
{
	Player[playerid][CarSlot1PaintJob] = -1;
	Player[playerid][CarSlot1Component0] = 0;Player[playerid][CarSlot1Component1] = 0;Player[playerid][CarSlot1Component2] = 0;
	Player[playerid][CarSlot1Component3] = 0;Player[playerid][CarSlot1Component4] = 0;Player[playerid][CarSlot1Component5] = 0;
	Player[playerid][CarSlot1Component6] = 0;Player[playerid][CarSlot1Component7] = 0;Player[playerid][CarSlot1Component8] = 0;
	Player[playerid][CarSlot1Component9] = 0;Player[playerid][CarSlot1Component10] = 0;Player[playerid][CarSlot1Component11] = 0;
	Player[playerid][CarSlot1Component12] = 0;Player[playerid][CarSlot1Component13] = 0;
	Player[playerid][CarSlot1NitroX] = 0;Player[playerid][CarSlot1Neon] = 0;Player[playerid][CarSlot1Fire] = 0;
	Player[playerid][CarSlot1Sir] = 0;Player[playerid][CarSlot1Mig] = 0;
	SaveTune(playerid); return 1;
}

stock ResetTuneClass2(playerid)
{
    Player[playerid][CarSlot2PaintJob] = -1;
	Player[playerid][CarSlot2Component0] = 0;Player[playerid][CarSlot2Component1] = 0;Player[playerid][CarSlot2Component2] = 0;
	Player[playerid][CarSlot2Component3] = 0;Player[playerid][CarSlot2Component4] = 0;Player[playerid][CarSlot2Component5] = 0;
	Player[playerid][CarSlot2Component6] = 0;Player[playerid][CarSlot2Component7] = 0;Player[playerid][CarSlot2Component8] = 0;
	Player[playerid][CarSlot2Component9] = 0;Player[playerid][CarSlot2Component10] = 0;Player[playerid][CarSlot2Component11] = 0;
	Player[playerid][CarSlot2Component12] = 0;Player[playerid][CarSlot2Component13] = 0;
	Player[playerid][CarSlot2NitroX] = 0;Player[playerid][CarSlot2Neon] = 0;Player[playerid][CarSlot2Fire] = 0;
	Player[playerid][CarSlot2Sir] = 0;Player[playerid][CarSlot2Mig] = 0;
	
	if(strcmp(Player[playerid][Vinil], "Null"))
	{
	    strmid(Player[playerid][Vinil], "Null", 0, strlen("Null"), 30);
		new query[100];
		mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Vinil` = 'Null' WHERE `SID` = '%d'",Player[playerid][SID]);
		mysql_tquery(connects, query);
	}
	
	SaveTune(playerid); return 1;
}

stock UpdatePlayer(playerid)
{
	new query[120];
    mysql_format(connects,query, sizeof(query), "SELECT * FROM `pupdate` WHERE `SID` = '%d'", Player[playerid][SID]);
    mysql_tquery(connects, query, "MysqlUpdatePlayer", "d", playerid);
	return 1;
}

public MysqlUpdatePlayer(playerid)
{
    if(cache_get_row_count(connects)>0)
    {
		new ChangeInt, Float:ChangeFloat,str[140],Cnd=0;
		
        ChangeInt = cache_get_field_content_int(0, "ALevel", connects);
        if(ChangeInt > 0)
        {
            Player[playerid][Level] += ChangeInt;
			format(str, sizeof str, "SHOP: Вам зачислено %d уровней.", ChangeInt);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			if (Player[playerid][Level] > 100 && Player[playerid][Prestige] < 10) Player[playerid][Level] = 100;
			else if (Player[playerid][Level] < 1) Player[playerid][Level] = 1;
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | LEVEL %s [%d] ДОБАВЛЕНО '%d' [СУММА = %d]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeInt,Player[playerid][Level]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}

		ChangeInt = cache_get_field_content_int(0, "AExp", connects);
        if(ChangeInt > 0)
        {
            Player[playerid][Exp] += ChangeInt;
			format(str, sizeof str, "SHOP: Вам зачислено %d опыта.", ChangeInt);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			if (Player[playerid][Exp] >= NeedXP[playerid]) PlayerLevelUp(playerid);
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | EXP %s [%d] ДОБАВЛЕНО '%d' [СУММА = %d]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeInt,Player[playerid][Exp]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}
		
		ChangeInt = cache_get_field_content_int(0, "ABank", connects);
        if(ChangeInt > 0)
        {
            Player[playerid][Bank] += ChangeInt;
			format(str, sizeof str, "SHOP: Вам зачислено %d$ денег в банк.", ChangeInt);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | BANK %s [%d] ДОБАВЛЕНО '%d' [СУММА = %d]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeInt,Player[playerid][Bank]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}
		
		ChangeFloat = cache_get_field_content_float(0, "ADonate", connects);
        if(ChangeFloat > 0)
        {
   			new Float: Koeff = 1.0;
   			if (ChangeFloat >= 2000) Koeff = 1.5;
   			else if (ChangeFloat >= 1500) Koeff = 1.3;
   			else if (ChangeFloat >= 700) Koeff = 1.2;
   			else if (ChangeFloat >= 300) Koeff = 1.1;
   			
   			ChangeFloat = ChangeFloat*Koeff*DBonus;
   			
            Player[playerid][GameGold] += ChangeFloat;
			Player[playerid][GameGoldTotal] += ChangeFloat;
			Player[playerid][OpGG] += ChangeFloat;
			
			format(str, sizeof str, "SHOP: Вам зачислено %.2f рублей для /shop.", ChangeFloat);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			
			MarafonUpdate(playerid, 6, floatround(ChangeFloat, floatround_ceil));
			
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | DONATE %s [%d] ДОБАВЛЕНО '%.2f' [СУММА = %.2f]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeFloat,Player[playerid][GameGold]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}
		
		ChangeInt = cache_get_field_content_int(0, "AVip", connects);
        if(ChangeInt > 0)
        {
            Player[playerid][GPremium] += ChangeInt;
			format(str, sizeof str, "SHOP: Вам зачислено %d уровней VIP.", ChangeInt);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | VIP %s [%d] ДОБАВЛЕНО '%d' [СУММА = %d]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeInt,Player[playerid][GPremium]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}
		
		ChangeInt = cache_get_field_content_int(0, "APrestige", connects);
        if(ChangeInt > 0)
        {
            Player[playerid][Prestige] += ChangeInt;
			format(str, sizeof str, "SHOP: Вам зачислено %d уровней престижа.", ChangeInt);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | PRESTIGE %s [%d] ДОБАВЛЕНО '%d' [СУММА = %d]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeInt,Player[playerid][Prestige]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}
		
		ChangeInt = cache_get_field_content_int(0, "AGold", connects);
        if(ChangeInt > 0)
        {
            Player[playerid][Gold] += ChangeInt;
			format(str, sizeof str, "SHOP: Вам зачислено %d золота для /gold.", ChangeInt);
			SendClientMessage(playerid, COLOR_YELLOW, str);
			format(str, sizeof str, "%d.%d.%d в %d:%d:%d | GOLD %s [%d] ДОБАВЛЕНО '%d' [СУММА = %d]", Day, Month, Year, hour, minute, second,PlayerName[playerid],Player[playerid][SID], ChangeInt,Player[playerid][Gold]);
			WriteLog("UpdatePlayer", str);
			Cnd=1;
		}
		
		if(Cnd == 1)
		{
		    SavePlayer(playerid);
		    new query[160];
			mysql_format(connects,query, sizeof(query), "UPDATE `pupdate` SET `ALevel`='0',`AExp`='0',`ABank`='0',`ADonate`='0',`AVip`='0',`APrestige`='0',`AGold`='0' WHERE `SID` = '%d'", Player[playerid][SID]);
			mysql_empty(connects, query);
		}
	}
    else
	{
	    new stringer[100];
	    mysql_format(connects, stringer, sizeof stringer, "INSERT INTO `pupdate` (`SID`, `PName`) VALUES ('%d', '%s')", Player[playerid][SID], PlayerName[playerid]);
		mysql_empty(connects, stringer);
	}
	return 1;
}


stock ResetProperty(houseid)
{
	Property[houseid][pOwner] = 0;
	Property[houseid][pName] = 0;
	Property[houseid][pPrice] = 1;
	Property[houseid][pPosEnterX] = 0.0;
	Property[houseid][pPosEnterY] = 0.0;
	Property[houseid][pPosEnterZ] = 0.0;
	Property[houseid][pPosEnterA] = 0.0;
	Property[houseid][pPosRespawnX] = 0.0;
	Property[houseid][pPosRespawnY] = 0.0;
	Property[houseid][pPosRespawnZ] = 0.0;
	Property[houseid][pPosRespawnA] = 0.0;
	Property[houseid][pOpened] = 0;
	Property[houseid][pBuyBlock] = 0;
	Property[houseid][pInter] = 0;
}

public LoadAllProperty()
{
	new cnt = cache_get_row_count(connects);
	if(!cnt) return printf("ОШИБКА! Дома не загружены.");
	
    new text3d[MAX_3DTEXT],i=0;
    for(new j; j < cnt; j++)
    {
        i=j+1;//чтоб номер строки совпадал с бд-идом
        Property[i][HID] = cache_get_field_content_int(j, "HID", connects);
        cache_get_field_content(j, "Owner", Property[i][pOwner], connects, 32);
        cache_get_field_content(j, "Name", Property[i][pName], connects, 32);
        Property[i][pPrice] = cache_get_field_content_int(j, "Price", connects);
        Property[i][pPosEnterX] = cache_get_field_content_float(j, "PosEnterX", connects);
        Property[i][pPosEnterY] = cache_get_field_content_float(j, "PosEnterY", connects);
        Property[i][pPosEnterZ] = cache_get_field_content_float(j, "PosEnterZ", connects);
        Property[i][pPosEnterA] = cache_get_field_content_float(j, "PosEnterA", connects);
        Property[i][pPosRespawnX] = cache_get_field_content_float(j, "PosRespawnX", connects);
        Property[i][pPosRespawnY] = cache_get_field_content_float(j, "PosRespawnY", connects);
        Property[i][pPosRespawnZ] = cache_get_field_content_float(j, "PosRespawnZ", connects);
        Property[i][pPosRespawnA] = cache_get_field_content_float(j, "PosRespawnA", connects);
        Property[i][pOpened] = cache_get_field_content_int(j, "Opened", connects);
        Property[i][pBuyBlock] = cache_get_field_content_int(j, "BuyBlock", connects);
        Property[i][pPickup] = cache_get_field_content_int(j, "Pick", connects);
        Property[i][pIcon] = cache_get_field_content_int(j, "Icon", connects);
        Property[i][pInter] = cache_get_field_content_int(j, "Inter", connects);

		if(Property[i][pBuyBlock] <= 0)
		{
			format(text3d, sizeof(text3d), "{00FF00}Дом ({FFFFFF}%d${00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[i][pPrice], Property[i][pOwner]);
			PropertyText3D[i] = CreateDynamic3DTextLabel(text3d, COLOR_WHITE, Property[i][pPosEnterX], Property[i][pPosEnterY], Property[i][pPosEnterZ], 10.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, 0, 0, 0, -1, 11.0);
		}
		else
		{
			format(text3d, sizeof(text3d), "{00FF00}Дом ({FF0000}Не продается{00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[i][pOwner]);
			PropertyText3D[i] = CreateDynamic3DTextLabel(text3d, COLOR_WHITE, Property[i][pPosEnterX], Property[i][pPosEnterY], Property[i][pPosEnterZ], 10.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, 0, 0, 0, -1, 11.0);
			SuperProperty++;//статистика - кол-во неперекупаемых домов
		}
		UpdatePropertyInterior(i);
		PropertyPickup[i] = CreateDynamicPickup(Property[i][pPickup], 1, Property[i][pPosEnterX], Property[i][pPosEnterY], Property[i][pPosEnterZ], -1, -1, -1, 100.0);
		PropertyMapIcon[i] = CreateDynamicMapIcon(Property[i][pPosEnterX], Property[i][pPosEnterY], Property[i][pPosEnterZ], Property[i][pIcon], 0, -1, -1, -1, 100.0);
		new DynamicPickupID = PropertyPickup[i];
		DynamicPickup[DynamicPickupID][Type] = 1;//тип пикапа - дом
		DynamicPickup[DynamicPickupID][ID] = i;//id дома пикапа

		if(strcmp(Property[i][pOwner], "Unknown")){OwnedProperty++;}//статистика - купленных домов
		LastProperty++;
	}
	new log[MAX_MESSAGE];

	format(log, sizeof(log), "[Houses] Дома загружены. Всего: %i. Занято: %i. Неперекупаемых: %i.", LastProperty - 1, OwnedProperty, SuperProperty);
	print(log);
	return 1;
}

public LoadAllBase()
{
	new cnt = cache_get_row_count(connects);
	if(!cnt) return printf("ОШИБКА! Штабы не загружены.");
	new i=0,text3d[MAX_3DTEXT];
	for(new j; j < cnt; j++)
	{
	    i=j+1; //чтоб BID совпадал с идом
	    Base[i][BID] = cache_get_field_content_int(j, "BID", connects);
	    Base[i][bClan] = cache_get_field_content_int(j, "Clan", connects);
	    Base[i][bPrice] = cache_get_field_content_int(j, "Price", connects);
	    Base[i][bInterior] = cache_get_field_content_int(j, "BInt", connects);
	    Base[i][bPosEnterX] = cache_get_field_content_float(j, "PosEnterX", connects);
        Base[i][bPosEnterY] = cache_get_field_content_float(j, "PosEnterY", connects);
        Base[i][bPosEnterZ] = cache_get_field_content_float(j, "PosEnterZ", connects);
        Base[i][bPosEnterA] = cache_get_field_content_float(j, "PosEnterA", connects);
        Base[i][bPosRespawnX] = cache_get_field_content_float(j, "PosRespawnX", connects);
        Base[i][bPosRespawnY] = cache_get_field_content_float(j, "PosRespawnY", connects);
        Base[i][bPosRespawnZ] = cache_get_field_content_float(j, "PosRespawnZ", connects);
        Base[i][bPosRespawnA] = cache_get_field_content_float(j, "PosRespawnA", connects);

		new clanid = Base[i][bClan];
		if(Base[i][bPrice] >= 0)
		{
			if (clanid > 0) format(text3d, sizeof(text3d), "{007FFF}Штаб ({FFFFFF}%d${007FFF})\n{008E00}Клан:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Base[i][bPrice], Clan[clanid][cName]);
			else format(text3d, sizeof(text3d), "{007FFF}Штаб ({FFFFFF}%d${007FFF})\n{008E00}Клан:{FFFFFF} Никто\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Base[i][bPrice]);
			BaseText3D[i] = CreateDynamic3DTextLabel(text3d, COLOR_WHITE, Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ], 10.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, 0, 0, 0, -1, 11.0);
		}
		else if(Base[i][bPrice] < 0)
		{
			if (clanid > 0) format(text3d, sizeof(text3d), "{007FFF}Штаб ({AFAFAF}Не продается{007FFF})\n{008E00}Клан:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Clan[clanid][cName]);
            else format(text3d, sizeof(text3d), "{007FFF}Штаб ({FFFFFF}%d${007FFF})\n{008E00}Клан:{FFFFFF} Никто\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Base[i][bPrice]);
			BaseText3D[i] = CreateDynamic3DTextLabel(text3d, COLOR_WHITE, Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ], 10.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, 0, 0, 0, -1, 11.0);
		}
		BasePickup[i] = CreateDynamicPickup(1272, 1, Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ], -1, -1, -1, 100.0);
		BaseMapIcon[i] = CreateDynamicMapIcon(Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ], 32, 0, -1, -1, -1, 100.0);
        new DynamicPickupID = BasePickup[i];
		DynamicPickup[DynamicPickupID][Type] = 2;//тип пикапа - штаб
		DynamicPickup[DynamicPickupID][ID] = i;//id штаба пикапа

		if(Base[i][bClan] > 0) OwnedBase++;
		LastBase++;
	}
	new log[MAX_MESSAGE];

	format(log, sizeof(log), "[Bases] Штабы загружены. Всего: %d. Занято: %d.", LastBase - 1, OwnedBase);
	print(log);
	return 1;
}
/*
stock LoadGangZonesINI()
{
	for(new i = 1; i < MAX_GZONE; i++)
	{
		new filename[MAX_FILE_NAME], file;
		format(filename, sizeof(filename), "GangZones/%i.ini", i);
		if(!fexist(filename)) continue;
		file = ini_openFile(filename);
		ini_getString(file, "ZName", GangZones[i][GZName], 32);
		ini_getInteger(file, "ZOwner", GangZones[i][GZOwner]);
		ini_getInteger(file, "ZColor", GangZones[i][GZColor]);
		ini_getInteger(file, "ZLevel", GangZones[i][GZLevel]);
		ini_getFloat(file, "MinX", GangZones[i][GMinX]);
		ini_getFloat(file, "MaxX", GangZones[i][GMaxX]);
		ini_getFloat(file, "MinY", GangZones[i][GMinY]);
		ini_getFloat(file, "MaxY", GangZones[i][GMaxY]);
        ini_getInteger(file, "ZCost", GangZones[i][GZCost]);
        ini_getInteger(file, "ZCTime", GangZones[i][GZClanTime]);
        ini_getInteger(file, "ZExp", GangZones[i][GZExp]);
        ini_getInteger(file, "ZCash", GangZones[i][GZCash]);
		ini_closeFile(file);
		new clanid = GangZones[i][GZOwner];
		
		ZoneStateTD[i] = TextDrawCreate(591.259460, 426.833312, "Zone_FREE");
		TextDrawLetterSize(ZoneStateTD[i], 0.439355, 2.084168);
		TextDrawAlignment(ZoneStateTD[i], 3);
		TextDrawColor(ZoneStateTD[i], 15401215);
		TextDrawSetShadow(ZoneStateTD[i], 0);
		TextDrawSetOutline(ZoneStateTD[i], -1);
		TextDrawBackgroundColor(ZoneStateTD[i], 255);
		TextDrawFont(ZoneStateTD[i], 1);
		TextDrawSetProportional(ZoneStateTD[i], 1);
		TextDrawSetShadow(ZoneStateTD[i], 0);
		

        ClanZoneID[i] = GangZoneCreate(GangZones[i][GMinX], GangZones[i][GMinY], GangZones[i][GMaxX], GangZones[i][GMaxY]);
		ClanZoneAreaID[i] = CreateDynamicRectangle(GangZones[i][GMinX], GangZones[i][GMinY], GangZones[i][GMaxX], GangZones[i][GMaxY], 0, 0, -1);
		if(clanid > 0) OwnedZone++;
		LastZone++;
	}
	new log[MAX_MESSAGE];

	format(log, sizeof(log), "Система зон загружена: Всего: %d. Занято: %d.", LastZone - 1, OwnedZone);
	print(log);
}
*/
public LoadGangZones()
{
    new cnt = cache_get_row_count(connects);
	if(!cnt) {printf("ОШИБКА! Зоны не загружены."); CreateAnotherAreas(); return 1;}
	new i=0;
	for(new j; j < cnt; j++)
	{
	    i=j+1;
		GangZones[i][ZID] = cache_get_field_content_int(j, "ZID", connects);
		cache_get_field_content(j, "ZName", GangZones[i][GZName], connects, 32);
		GangZones[i][GZOwner] = cache_get_field_content_int(j, "ZOwner", connects);
		GangZones[i][GZColor] = cache_get_field_content_int(j, "ZColor", connects);
		GangZones[i][GZLevel] = cache_get_field_content_int(j, "ZLevel", connects);
		GangZones[i][GMinX] = cache_get_field_content_float(j, "MinX", connects);
		GangZones[i][GMaxX] = cache_get_field_content_float(j, "MaxX", connects);
		GangZones[i][GMinY] = cache_get_field_content_float(j, "MinY", connects);
		GangZones[i][GMaxY] = cache_get_field_content_float(j, "MaxY", connects);
        GangZones[i][GZClanTime] = cache_get_field_content_int(j, "ZCTime", connects);
        GangZones[i][GZExp] = cache_get_field_content_int(j, "ZExp", connects);
        GangZones[i][GZCash] = cache_get_field_content_int(j, "ZCash", connects);
        GangZones[i][ZHeigh] = cache_get_field_content_float(j, "ZHeigh", connects);
        

		new clanid = GangZones[i][GZOwner];
		//ZoneStateTD[i] = TextDrawCreate(591.259460, 426.833312, "Zone_FREE");
		//TextDrawLetterSize(ZoneStateTD[i], 0.439355, 2.084168);
		//TextDrawAlignment(ZoneStateTD[i], 3);
		//TextDrawColor(ZoneStateTD[i], 15401215);
		//TextDrawSetShadow(ZoneStateTD[i], 0);
		//TextDrawSetOutline(ZoneStateTD[i], -1);
		//TextDrawBackgroundColor(ZoneStateTD[i], 255);
		//TextDrawFont(ZoneStateTD[i], 1);
		//TextDrawSetProportional(ZoneStateTD[i], 1);
		//TextDrawSetShadow(ZoneStateTD[i], 0);
		
		ZoneStateTD[i] = TextDrawCreate(620.308044, 376.083465, "Zone_FREE");
		TextDrawLetterSize(ZoneStateTD[i], 0.400000, 1.600000);
		TextDrawAlignment(ZoneStateTD[i], 3);
		TextDrawColor(ZoneStateTD[i], 15401215);
		TextDrawSetShadow(ZoneStateTD[i], 0);
		TextDrawSetOutline(ZoneStateTD[i], 1);
		TextDrawBackgroundColor(ZoneStateTD[i], 255);
		TextDrawFont(ZoneStateTD[i], 2);
		TextDrawSetProportional(ZoneStateTD[i], 1);
		TextDrawSetShadow(ZoneStateTD[i], 0);
		
		if(GangZones[i][GZClanTime] < unixtime && GangZones[i][GZClanTime] != -10) GangZones[i][GZClanTime] = -10; //спасет от флуда после рестарта, если вдруг у многих зон выйдет время
		if(GangZones[i][GZClanTime] >= unixtime) {TextDrawColor(ZoneStateTD[i], 0x2E64FEFF); TextDrawSetString(ZoneStateTD[i], "CAPT_LOCKED");}
		
		GPSZone[i][0] = GangZones[i][GMinX]+((GangZones[i][GMaxX]-GangZones[i][GMinX])/2); //x
		GPSZone[i][1] = GangZones[i][GMinY]+((GangZones[i][GMaxY]-GangZones[i][GMinY])/2); //y

        ClanZoneID[i] = GangZoneCreate(GangZones[i][GMinX], GangZones[i][GMinY], GangZones[i][GMaxX], GangZones[i][GMaxY]);
		//ClanZoneAreaID[i] = CreateDynamicRectangle(GangZones[i][GMinX], GangZones[i][GMinY], GangZones[i][GMaxX], GangZones[i][GMaxY], 0, 0, -1);
		ClanZoneAreaID[i] = CreateDynamicCuboid(GangZones[i][GMinX], GangZones[i][GMinY], GangZones[i][ZHeigh]-70, GangZones[i][GMaxX], GangZones[i][GMaxY], GangZones[i][ZHeigh]+70, 0, 0, -1);
		AreaType[ClanZoneAreaID[i]] = 1;
		if(clanid > 0) OwnedZone++;
		LastZone++;
	}
	CreateAnotherAreas(); //создаем остальные арены
	
	//фиксим терры
	for(new ij = 1; ij <= MaxClanID; ij++) {if (Clan[ij][cLevel] > 0) Clan[ij][ClanZones]=0;}
	for (new Zone=1; Zone<MAX_GZONE;Zone++)
 	{
 	    if(GangZones[Zone][GZOwner] > 0) {Clan[GangZones[Zone][GZOwner]][ClanZones]++;}
 	}
	
	new log[MAX_MESSAGE];
	format(log, sizeof(log), "[Zones] Зоны загружены: Всего: %d. Занято: %d.", LastZone - 1, OwnedZone);
	print(log);
	
	
	
	return 1;
}
/*
stock LoadAllClansINI()
{
    new filename[MAX_FILE_NAME], file, clans = 0, LastClan = 0;
	for(new i = 1; i < MAX_CLAN; i++)
	{
		format(filename, sizeof(filename), "Clans/%d.ini", i); LastClan++;
		if(!fexist(filename)) {Clan[i][cLevel] = 0; continue;} //несуществующий клан
		else
		{//клан существует
		    file = ini_openFile(filename);
		    ini_getInteger(file, "Level", Clan[i][cLevel]);
			ini_getString(file, "Lider", Clan[i][cLider], MAX_PLAYER_NAME);
			ini_getString(file, "Name", Clan[i][cName], MAX_PLAYER_NAME);
			ini_getString(file, "Message", Clan[i][cMessage], 125);
			ini_getInteger(file, "Color", Clan[i][cColor]);
			ini_getInteger(file, "Base", Clan[i][cBase]);
			ini_getInteger(file, "XP", Clan[i][cXP]);
			ini_getInteger(file, "LastDay", Clan[i][cLastDay]);
			ini_getInteger(file, "EnemyClan", Clan[i][cEnemyClan]);
			ini_getInteger(file, "CWwin", Clan[i][cCWwin]);

			for(new memb=1; memb<21; memb++)
			{
				new str[16];
				format(str, sizeof(str), "Member%d", memb);
				ini_getString(file, str, CMember[i][memb], MAX_PLAYER_NAME);
			}

			ini_getInteger(file, "ClanBank", Clan[i][ClanBank]);
			ini_getInteger(file, "ClanZones", Clan[i][ClanZones]);
			ini_getString(file, "CTag", Clan[i][cTag], 20);
			if(strlen(Clan[i][cTag]) == 0) {strmid(Clan[i][cTag], "Пусто", 0, strlen("Пусто"), 6);}
		    ini_closeFile(file);
		    clans++; MaxClanID = i;
		}//клан существует
	}
	new log[MAX_MESSAGE];

	format(log, sizeof(log), "Система кланов загружена. Всего кланов: %d. Максимум: %d.", clans, LastClan);
	print(log);
}
*/
public LoadAllClans()
{
    new cnt = cache_get_row_count(connects);
	if(!cnt) return printf("[Clans] Кланы не обнаружены.");
	
    new j;
    
	for(new i; i < cnt; i++)
	{
	    j = cache_get_field_content_int(i, "CID", connects);
		if(j < 1 || j > 500) {printf("Обнаружен неисправный клан! Строка: %d",i); continue;}
	    Clan[j][CID] = j;
	    Clan[j][cLevel] = cache_get_field_content_int(i, "Level", connects);
		cache_get_field_content(i, "Lider", Clan[j][cLider], connects, MAX_PLAYER_NAME);
		cache_get_field_content(i, "Name", Clan[j][cName], connects, MAX_PLAYER_NAME);
		cache_get_field_content(i, "Message", Clan[j][cMessage], connects, 125);
		Clan[j][cColor] = cache_get_field_content_int(i, "Color", connects);
		Clan[j][cBase] = cache_get_field_content_int(i, "Base", connects);
		Clan[j][cXP] = cache_get_field_content_int(i, "XP", connects);
		Clan[j][cLastDay] = cache_get_field_content_int(i, "LastDay", connects);
		Clan[j][cEnemyClan] = cache_get_field_content_int(i, "EClan", connects);
		Clan[j][cCWwin] = cache_get_field_content_int(i, "CWwin", connects);
		Clan[j][ClanBank] = cache_get_field_content_int(i, "CBank", connects);
		Clan[j][ClanZones] = cache_get_field_content_int(i, "CZones", connects);
		cache_get_field_content(i, "CTag", Clan[j][cTag], connects, 20);
 		Clan[j][cSlots] = cache_get_field_content_int(i, "Slots", connects);
 		Clan[j][Imm] = cache_get_field_content_int(i, "Immun", connects);
 		Clan[j][ChangeLead] = cache_get_field_content_int(i, "LidCh", connects);
 		Clan[j][InfPoints] = cache_get_field_content_int(i, "InfPoints", connects);
 		
 		new str[16];
		for(new memb=1; memb<MAX_CMEMBERS; memb++)
		{
			format(str, sizeof(str), "m%d", memb);
			cache_get_field_content(i, str, CMember[j][memb], connects, MAX_PLAYER_NAME);
			format(str, sizeof(str), "r%d", memb);
			CRangs[j][memb] = cache_get_field_content_int(i, str, connects);
		}

		if(strlen(Clan[j][cTag]) == 0) {strmid(Clan[j][cTag], "Пусто", 0, strlen("Пусто"), 20);}
  		if(Clan[j][cSlots] < 20) {Clan[j][cSlots] = 20;}//фикс бага, иногда вылезает. Не понятно, но факт
		if(j > MaxClanID) MaxClanID = j;
		//printf("%d %d",i, j);
	}
	
	new log[MAX_MESSAGE];
	format(log, sizeof(log), "[Clans] Кланы загружены. Всего: %d. Макс. ID: %d.", cnt, MaxClanID);
	print(log);
	return 1;
}

//CRangs[MAX_CLAN][MAX_CMEMBERS]

stock SaveZone(zone)
{
    if (ServConf[1] == 1) return 1;
	new query[200];
	mysql_format(connects,query, sizeof(query), "UPDATE `zones` SET `ZOwner`='%d',`ZColor`='%d',`ZCTime`='%d' WHERE `ZID`='%d'",GangZones[zone][GZOwner],GangZones[zone][GZColor],GangZones[zone][GZClanTime], zone);
	mysql_tquery(connects, query);
	return 1;
}
stock SaveAllZones() for(new i=1; i < MAX_GZONE; i++) SaveZone(i);

stock SaveBase(baseid)
{
    if (ServConf[1] == 1) return 1;
	new query[120];
	mysql_format(connects,query, sizeof(query), "UPDATE `bases` SET `Clan`='%d',`Price`='%d',`BInt`='%d' WHERE `BID` = '%d'",Base[baseid][bClan],Base[baseid][bPrice],Base[baseid][bInterior],baseid);
	mysql_tquery(connects, query);
	return 1;
}
stock SaveAllBase()	for(new i=1; i < MAX_BASE; i++) SaveBase(i);

stock SaveProperty(houseid)
{
    if (ServConf[1] == 1) return 1;
	new query[300];
	mysql_format(connects,query, sizeof(query), "UPDATE `houses` SET `Owner` = '%s',`Name` = '%s',`Price` = '%d',`Opened` = '%d',`BuyBlock` = '%d',`Inter` = '%d' WHERE `HID` = '%d'",
	Property[houseid][pOwner],Property[houseid][pName],Property[houseid][pPrice],Property[houseid][pOpened],Property[houseid][pBuyBlock],Property[houseid][pInter],houseid);
	mysql_tquery(connects, query);
	return 1;
}
stock SaveAllProperty() for(new i = 1; i < MAX_PROPERTY; i++) SaveProperty(i);

stock SaveClan(clanid)
{
    if (ServConf[1] == 1) return 1;
	new query[640];
	format(query, sizeof(query), "UPDATE `clans` SET `Name`='%s',`Lider`='%s',`Level`='%d',`Message`='%s',`Color`='%d',`Base`='%d',`XP`='%d',", Clan[clanid][cName],Clan[clanid][cLider],Clan[clanid][cLevel],Clan[clanid][cMessage],Clan[clanid][cColor],Clan[clanid][cBase],Clan[clanid][cXP]);
	mysql_format(connects,query, sizeof(query), "%s`LastDay`='%d',`EClan`='%d',`CWwin`='%d',`CBank`='%d',`CZones`='%d',`CTag`='%s',`Slots`='%d',`Immun`='%d',`LidCh`='%d',`InfPoints`='%d' WHERE `CID`='%d';",query,Clan[clanid][cLastDay],Clan[clanid][cEnemyClan], Clan[clanid][cCWwin], Clan[clanid][ClanBank], Clan[clanid][ClanZones],Clan[clanid][cTag],Clan[clanid][cSlots],Clan[clanid][Imm],Clan[clanid][ChangeLead],Clan[clanid][InfPoints],clanid);
	mysql_tquery(connects, query);
	return 1;
}
stock SaveAllClans() for(new i = 1; i <= MaxClanID; i++) if (Clan[i][cLevel] > 0) SaveClan(i);

stock ClansUpdate()
{//Удаление кланов, которые не купили штаб вовремя
	new xDay = DateToIntDate(Day, Month, Year);
    for(new i = 1; i <= MaxClanID; i++) if (Clan[i][cLevel] > 0)
    {//Существующий клан
        if ((0 < Clan[i][cLastDay] <= xDay) && Clan[i][Imm] == 0)
        {//Клан нужно распустить
        	new StringX[120];
			format(StringX,sizeof(StringX),"Клан '{FFFFFF}%s{008E00}' был автоматически распущен из-за отсутствия штаба.",Clan[i][cName]);
			SendClientMessageToAll(COLOR_CLAN,StringX);
			
			format(StringX, sizeof(StringX), "DELETE FROM `clans` WHERE `CID`='%d';", Clan[i][CID]);
			if (ServConf[1] == 0) mysql_tquery(connects, StringX);
			
			Clan[i][cLevel] = 0;//Чтобы клан был недействителеьным
			foreach(Player, cid)
			{//цикл
				if (Player[cid][Member] != 0 && Player[cid][MyClan] == i)
				{//соклан
					Player[cid][MyClan] = 0;
					Player[cid][Member] = 0;
					Player[cid][Leader] = 0;
					PlayerColor[cid] = 0;
					SavePlayer(cid);
				}//соклан
			}//цикл
			//убирает ID этого клана из списка врагов у всех кланов (если у кого есть)
			for(new i2 = 0; i2 < MaxClanID; i2++) {if (Clan[i2][cEnemyClan] == i) {Clan[i2][cEnemyClan] = 0; SaveClan(i2);}}
			
			
			new str[140]; format(str, sizeof str, "%d.%d.%d в %d:%d:%d | Клан %s [%d] распущен (отсутсвие штаба)", Day, Month, Year, hour, minute, second,Clan[i][cName],i);
			WriteLog("ClanLog", str);
        }//Клан нужно распустить
    }//Существующий клан
}//Удаление кланов, которые не купили штаб вовремя

HousesUpdate()
{//Снятие неперекупайки с тех домов, у кого она кончилась
    new xDay = DateToIntDate(Day, Month, Year), text3d[MAX_3DTEXT];
    for(new i = 1; i < MAX_PROPERTY; i++) if (Property[i][pBuyBlock] > 0 && Property[i][pBuyBlock] < xDay)
    {//Вышло время неперекупайки
        Property[i][pBuyBlock] = -1;
        UpdatePropertyInterior(i);
		SaveProperty(i);
        format(text3d, sizeof(text3d), "{00FF00}Дом ({FFFFFF}%d${00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[i][pPrice], Property[i][pOwner]);
		UpdateDynamic3DTextLabelText(PropertyText3D[i], 0xFFFFFFFF, text3d);
    }//Вышло время неперекупайки
}//Снятие неперекупайки с тех домов, у кого она кончилась

///-------------------------------------- Новые функции

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

new PlayerVehicleName[212][] = {
"Landstalker", "Bravura", "Buffalo", "Linerunner", "Perrenial", "Sentinel", "Dumper", "Firetruck", "Trashmaster", "Stretch", "Manana",
"Infernus", "Voodoo", "Pony", "Mule", "Cheetah", "Ambulance", "Leviathan", "Moonbeam", "Esperanto", "Taxi", "Washington", "Bobcat",
"Whoopee", "BF Injection", "Hunter", "Premier", "Enforcer", "Securicar", "Banshee", "Predator", "Bus", "Rhino", "Barracks", "Hotknife",
"Trailer 1", "Previon", "Coach", "Cabbie", "Stallion", "Rumpo", "RC Bandit", "Romero", "Packer", "Monster", "Admiral", "Squalo",
"Seasparrow", "Pizzaboy", "Tram", "Trailer 2", "Turismo", "Speeder", "Reefer", "Tropic", "Flatbed", "Yankee", "Caddy", "Solair",
"Berkley's RC Van", "Skimmer", "PCJ-600", "Faggio", "Freeway", "RC Baron", "RC Raider", "Glendale", "Oceanic", "Sanchez", "Sparrow",
"Patriot", "Quad", "Coastguard", "Dinghy", "Hermes", "Sabre", "Rustler", "ZR-350", "Walton", "Regina", "Comet", "BMX", "Burrito",
"Camper", "Marquis", "Baggage", "Dozer", "Maverick", "News Chopper", "Rancher", "FBI Rancher", "Virgo", "Greenwood", "Jetmax", "Hotring",
"Sandking", "Blista Compact", "Police Maverick", "Boxvillde", "Benson", "Mesa", "RC Goblin", "Hotring Racer A", "Hotring Racer B",
"Bloodring Banger", "Rancher", "Super GT", "Elegant", "Journey", "Bike", "Mountain Bike", "Beagle", "Cropduster","Stunt",  "Tanker",
"Roadtrain", "Nebula", "Majestic", "Buccaneer", "Shamal", "Hydra", "FCR-900", "NRG-500", "HPV1000", "Cement Truck", "Tow Truck", "Fortune",
"Cadrona", "FBI Truck", "Willard", "Forklift", "Tractor", "Combine", "Feltzer", "Remington", "Slamvan", "Blade", "Freight", "Streak",
"Vortex", "Vincent", "Bullet", "Clover", "Sadler", "Firetruck LA", "Hustler", "Intruder", "Primo", "Cargobob", "Tampa", "Sunrise", "Merit",
"Utility", "Nevada", "Yosemite", "Windsor", "Monster A", "Monster B", "Uranus", "Jester", "Sultan", "Stratum", "Elegy", "Raindance",
"RC Tiger", "Flash", "Tahoma", "Savanna", "Bandito", "Freight Flat", "Streak Carriage", "Kart", "Mower", "Dune", "Sweeper", "Broadway",
"Tornado", "AT-400", "DFT-30", "Huntley", "Stafford", "BF-400", "News Van", "Tug", "Trailer 3", "Emperor", "Wayfarer", "Euros", "Hotdog",
"Club", "Freight Carriage", "Trailer 4", "Andromada", "Dodo", "RC Cam", "Launch", "Police Car (LSPD)", "Police Car (SFPD)",
"Police Car (LVPD)", "Police Ranger", "Picador", "S.W.A.T", "Alpha", "Phoenix", "Glendale", "Sadler", "Luggage Trailer A",
"Luggage Trailer B", "Stairs", "Boxville", "Tiller", "Utility Trailer" };

#include "VehicleMaxSpeed"
stock GetVehicleMaxSpeed(vehicleid)
{//Получить макс. скорость автомобиля
	new model = GetVehicleModel(vehicleid) - 400;
	if (model < 0) return 300;//Если авто не существует - возвращаем 300
	else return VehicleMaxSpeed[model];
}//Получить макс. скорость автомобиля

stock SetVehicleSpeed(vehicleid, Float:Speed)
{
	new Float:X, Float:Y, Float:Z, Float:Angle;
    GetVehicleZAngle(vehicleid, Angle);
    Speed = Speed/200;
    X = Speed * floatsin(-Angle, degrees);
    Y = Speed * floatcos(-Angle, degrees);
    SetVehicleVelocity(vehicleid, X, Y, Z);
    return 1;
}
/////////////
//огненные
//new fireinfo[MAX_PLAYERS]=0;
//new bool:fireEnable[MAX_PLAYERS];
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//Функция возвращает самое большое число из заданных в аргументах.
stock GetHighNumber(...)
{
	new high;
	for (new i = 0; i< numargs(); i++)
	if (getarg(i) > high) high = getarg(i);
	return high;
}

stock LCreateVehicle(modelid, Float:x, Float:y, Float:z, Float:angle, color1 = 0, color2 = 0, respawn_delay = -1, addsiren=0)
{
	new vehicleid = CreateVehicle(modelid, Float:x, Float:y, Float:z, Float:angle, color1, color2, respawn_delay, addsiren);
					//CreateVehicle(modelid, Float:x, Float:y, Float:z, Float:angle, color1, color2, respawn_delay, addsiren=0)
    if (vehicleid > MaxVehicleUsed) MaxVehicleUsed = vehicleid;
    //Уничтожение неона
    if (NeonObject1[vehicleid] != -1){DestroyDynamicObject(NeonObject1[vehicleid]);NeonObject1[vehicleid] = -1;}
	if (NeonObject2[vehicleid] != -1){DestroyDynamicObject(NeonObject2[vehicleid]);NeonObject2[vehicleid] = -1;}
	//огненные колеса

	//if (Fire1[vehicleid] != -1){DestroyDynamicObject(Fire1[vehicleid]);Fire1[vehicleid] = -1;}
	//if (Fire2[vehicleid] != -1){DestroyDynamicObject(Fire2[vehicleid]);Fire2[vehicleid] = -1;}
	if (Fire3[vehicleid] != -1){DestroyDynamicObject(Fire3[vehicleid]);Fire3[vehicleid] = -1;}
	if (Fire4[vehicleid] != -1){DestroyDynamicObject(Fire4[vehicleid]);Fire4[vehicleid] = -1;}
	//migalka
	if (MigObj[vehicleid] != -1){DestroyDynamicObject(MigObj[vehicleid]);MigObj[vehicleid] = -1;}
	//vinil
	if (VVinil[vehicleid][0] != -1){DestroyDynamicObject(VVinil[vehicleid][0]);VVinil[vehicleid][0] = -1;}
	if (VVinil[vehicleid][1] != -1){DestroyDynamicObject(VVinil[vehicleid][1]);VVinil[vehicleid][1] = -1;}

	TrailerID[vehicleid] = -1; IsTrailer[vehicleid] = 0;//Машина не имеет трейлера и не является трейлером
    StealCarTimer[vehicleid] = unixtime+600;//Нужен только для авто для угона (ид 1-35)
    //ResetVehicle
    Vehicle[vehicleid][AntiDestroyTime] = 5;
    Vehicle[vehicleid][Owner] = -1;
    Vehicle[vehicleid][Health] = 1000.0; LACRepair[vehicleid] = 0;
    Vehicle[vehicleid][VType] = 0; //тип авто
    return vehicleid;
}

stock CallTrailer(vehicleid, trailermodel)
{//Вызов трейлера для авто
	new Float:x, Float: y, Float: z, Float:Angle, trailer; GetVehiclePos(vehicleid, x, y, z); GetVehicleZAngle(vehicleid, Angle);
	trailer = LCreateVehicle(trailermodel, x, y, z + 50, Angle, 0, 0, 0, 0);
	TrailerID[vehicleid] = trailer; IsTrailer[trailer] = 1;
	SetTimerEx("TrailerUpdate" , 1000, false, "ii", vehicleid, trailermodel);
	return 1;
}//Вызов трейлера для авто

forward TrailerUpdate(vehicleid, trailermodel);
public TrailerUpdate(vehicleid, trailermodel)
{//обновление трейлера машины
	if (TrailerID[vehicleid] == -1) return 1;//Если у машины не должно быть трейлера - прекращаем
	new trailer = TrailerID[vehicleid];
	if (IsTrailer[trailer] == 0) return CallTrailer(vehicleid, trailermodel); //Если трейлера не существует - прекращаем и идем его создавать
	SetTimerEx("TrailerUpdate" , 1000, false, "ii", vehicleid, trailermodel);
	if (!IsTrailerAttachedToVehicle(vehicleid)) AttachTrailerToVehicle(trailer, vehicleid);
	Vehicle[trailer][AntiDestroyTime] = 5;//Чтобы трейлер не уничтожался пока он успешно прицеплен
	return 1;
}//обновление трейлера машины

public LSpawnPlayer(playerid)//вот тут вот
{//Выполняется в момент до самого респавна игрока
    if (IsPlayerInAnyVehicle(playerid) && GetPlayerVehicleSeat(playerid) == 0) DestroyVehicle(GetPlayerVehicleID(playerid));//исправляет баг, игрок, который в авто, не перемещается и кикается античитом на тп
	new Float: x, Float: y, Float: z, Float: Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo;
    ResetPlayerWeapons(playerid);
    LACSH[playerid] = 3;LACTeleportOff[playerid] = 4;
	LACWeaponOff[playerid] = 3;
	CheatFlySec[playerid] = 0;
	SetPlayerInterior(playerid,0);SetPlayerVirtualWorld(playerid,0);
	WorldSpawn[playerid] = 0; TogglePlayerSpectating(playerid, 0);

	if (Logged[playerid] == 0)
	{//игрок не залогинился
		SetSpawnInfo(playerid, 0, Player[playerid][Model], -1878.6398, 821.1522, 125.6778, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
		SpawnPlayer(playerid); SetPlayerVirtualWorld(playerid, playerid + 1);
	}//игрок не залогинился
	//
	if (JoinEvent[playerid] == EVENT_DM && DMTimeToEnd > 0)
	{//дм-режим спавн
		#include "Transformer\DMPlayerSpawn"
		Weapons[playerid][w1] = 1;Weapons[playerid][w2] = 1;Weapons[playerid][w3] = 1;
		SetSpawnInfo(playerid, 0, Player[playerid][Model], x, y, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
        if (TimeAfterSpawn[playerid] < 5) TimeAfterSpawn[playerid] = 5;
		return SpawnPlayer(playerid);
	}//дм-режим спавн

	if (ZMStarted[playerid] == 1)
	{//зомби-режим спавн
        #include "Transformer\ZombiePlayerSpawn"
        Weapons[playerid][w1] = 1;Weapons[playerid][w2] = 1;Weapons[playerid][w3] = 1;
        SetSpawnInfo(playerid, 0, Player[playerid][Model], x, y, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
        if (TimeAfterSpawn[playerid] < 5) TimeAfterSpawn[playerid] = 5;
		return SpawnPlayer(playerid);
	}//зомби-режим спавн

	if (JoinEvent[playerid] == EVENT_GUNGAME && GGTimeToEnd > 0)
	{//гангейм спавн
		#include "Transformer\GGPlayerSpawn"
		Weapons[playerid][w1] = 1;Weapons[playerid][w2] = 1;Weapons[playerid][w3] = 1;
		SetSpawnInfo(playerid, 0, Player[playerid][Model], x, y, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
		if (TimeAfterSpawn[playerid] < 5) TimeAfterSpawn[playerid] = 5;
		return SpawnPlayer(playerid);
	}//гангейм спавн

	if (InEvent[playerid] == EVENT_TDM)
	{//tdm-режим спавн
		#include "Transformer\TDMPlayerSpawn"
		new tskin = random(6);
		if(TDMTeam[playerid] == 1) tskin = WhiteSkins[tskin];
		else if(TDMTeam[playerid] == 2) tskin = BlackSkins[tskin];
		Weapons[playerid][w1] = 1;Weapons[playerid][w2] = 1;Weapons[playerid][w3] = 1;
		SetSpawnInfo(playerid, 0, tskin, x, y, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
        if (TimeAfterSpawn[playerid] < 5) TimeAfterSpawn[playerid] = 5;
		return SpawnPlayer(playerid);
	}//tdm-режим спавн
	
	/*if (InEvent[playerid] == EVENT_PDM)
	{//pdm-режим спавн
		#include "Transformer\PDMPlayerSpawn"
		Weapons[playerid][w1] = 1;Weapons[playerid][w2] = 1;Weapons[playerid][w3] = 1;
		SetSpawnInfo(playerid, 0, Player[playerid][Model], x, y, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
        if (TimeAfterSpawn[playerid] < 5) TimeAfterSpawn[playerid] = 5;
		return SpawnPlayer(playerid);
	}//pdm-режим спавн
*/
    TimeAfterSpawn[playerid] = 0; SetPlayerChatBubble(playerid, "Зареспавнился\nЗащита от убийства", COLOR_GREEN, 300.0, 3000);
    if(Logged[playerid] == 1) {SetPlayerHealth(playerid, 0x7F800000); AdminTPCantKill[playerid] = 3;}

	//war zone spawn
	if (Player[playerid][MyClan] > 0)
	{
	    new PlayerClan = Player[playerid][MyClan];
	    if(Clan[PlayerClan][NowWarZone] > 0 && GangZones[Clan[PlayerClan][NowWarZone]][ZoneAttacked] == 2)
	    {
		    new Float: rnd = float(random(20)-10);
	        //new spwid = Clan[PlayerClan][NowWarZone]*3-(2-Clan[PlayerClan][OnZonePos]);  //расчитываем место (у каждого клана свое)
	        new spwid = Clan[PlayerClan][NowWarZone]*3 - random(3); //рандом спавн на терре (1 из 3 мест)
	        x = ZoneSpawn[spwid][0]; y = ZoneSpawn[spwid][1]; z = ZoneSpawn[spwid][2]; Angle = ZoneSpawn[spwid][3];
	        SetSpawnInfo(playerid, 0, Player[playerid][Model], x+rnd, y+rnd, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
            return SpawnPlayer(playerid);
	    }
  	}

	if (Player[playerid][Level] == 0)
	{//первый спавн - грув
	    x = 2491.1553; y = -1667.5907; z = 13.0260; Angle = 90;
		SetPlayerInterior(playerid,0);
		SetPlayerVirtualWorld(playerid,playerid+1);//вирт. ворлд в обучении
	}//первый спавн - грув

    
	//------ Spawn и SpawnStyle
    if (Player[playerid][Spawn] == 4 || Player[playerid][Spawn] == 6  || Player[playerid][Spawn] == 7) {if (Player[playerid][Home] == 0) Player[playerid][Spawn] = 0;}
    //Исправление, когда стоит спавн "Личный дом", а дома у игрока нет

	if (Player[playerid][Spawn] == 4)
	{//спавн в доме
		new rand = Player[playerid][Home];
		x = Property[rand][pPosRespawnX]; y = Property[rand][pPosRespawnY]; z =Property[rand][pPosRespawnZ]; Angle = Property[rand][pPosRespawnA];
	}//спавн в доме

	if (Player[playerid][Spawn] == 5)
	{//спавн в штабе
		new clanid = Player[playerid][MyClan];
		if(Clan[clanid][cBase] < 1 || Clan[clanid][cBase] > MAX_BASE)
		{
		    SendClientMessage(playerid,COLOR_RED,"Внимание! У вашего клана больше нет штаба.");
		    Player[playerid][Spawn] = 0;
		}
		else
		{
			new rand = Clan[clanid][cBase];
			x = Base[rand][bPosRespawnX]; y = Base[rand][bPosRespawnY]; z = Base[rand][bPosRespawnZ]; Angle = Base[rand][bPosRespawnA];
		}
	}//спавн в штабе

	if (Player[playerid][Spawn] == 6)
	{//Спавн внутри дома
	    new i = Player[playerid][Home];
	    new j = Property[i][pInter];
		x = HIntInfo[j][inX]; y = HIntInfo[j][inY]; z = HIntInfo[j][inZ]; Angle = HIntInfo[j][inA]; SetPlayerInterior(playerid,HIntInfo[j][binter]);
		SetPlayerVirtualWorld(playerid, 1000 + i); WorldSpawn[playerid] = 1000 + i;
	}//Спавн внутри дома

 	if (Player[playerid][Spawn] == 7)
	{//личная позиция
		x = Player[playerid][PosX]; y = Player[playerid][PosY]; z = Player[playerid][PosZ];	Angle = Player[playerid][PosA];
		SetPlayerChatBubble(playerid, "Зареспавнился (Личная позиция)", COLOR_YELLOW, 300.0, 5000); WorldSpawn[playerid] = 0;
	}//личная позиция

	if (Player[playerid][Spawn] == 8)
	{//Спавн внутри штаба
	    new clanid = Player[playerid][MyClan];
		if(Clan[clanid][cBase] < 1 || Clan[clanid][cBase] >= MAX_BASE)
		{
		    SendClientMessage(playerid,COLOR_RED,"Внимание! У вашего клана больше нет штаба.");
		    Player[playerid][Spawn] = 0;
		}
		else
		{
			new baseid = Clan[clanid][cBase];
			new cint = Base[baseid][bInterior];
			SetPlayerVirtualWorld(playerid, 2000 + baseid);
			WorldSpawn[playerid] = 2000 + baseid;
			SetPlayerInterior(playerid,BIntInfo[cint][binter]);
			x = BIntInfo[cint][inX]; y = BIntInfo[cint][inY]; z = BIntInfo[cint][inZ]; Angle = BIntInfo[cint][inA];
		}
	}//Спавн внутри штаба

 	if (Player[playerid][Spawn] == 0)
	{//Стандартный спавн
	    if (Player[playerid][Level] == 0)
		{//Спавн на грув 0 лвл
			new rand = random(sizeof(GroveSpawn));
			x = GroveSpawn[rand][0]; y = GroveSpawn[rand][1]; z = GroveSpawn[rand][2]; Angle = GroveSpawn[rand][3];
		}//Спавн на грув 0 лвл
		else if (Player[playerid][Level] < 15)
		{//Спавн в LS 1-14 лвл
		    new rand = random(sizeof(LSSPAWN));
			x = LSSPAWN[rand][0]; y = LSSPAWN[rand][1]; z = LSSPAWN[rand][2]; Angle = LSSPAWN[rand][3];
		}//Спавн в LS 1-14 лвл
		else if (Player[playerid][Level] < 25)
		{//Спавн в SF 15-24 лвл
		    new rand = random(sizeof(SFSPAWN));
			x = SFSPAWN[rand][0]; y = SFSPAWN[rand][1]; z = SFSPAWN[rand][2]; Angle = SFSPAWN[rand][3];
		}//Спавн в SF 15-24 лвл
		else if (Player[playerid][Level] < 69)
		{//Спавн в LV 25-68 лвл
			new rand = random(sizeof(LVSPAWN));
			x = LVSPAWN[rand][0]; y = LVSPAWN[rand][1]; z = LVSPAWN[rand][2]; Angle = LVSPAWN[rand][3];
		}//Спавн в LV 25-68 лвл
  		else
		{//Спавн Chilliad 69+ лвл
		    new rand = random(sizeof(ChilliadSpawn));
			x = ChilliadSpawn[rand][0]; y = ChilliadSpawn[rand][1]; z = ChilliadSpawn[rand][2]; Angle = ChilliadSpawn[rand][3];
		}//Спавн Chilliad 73+ лвл
		WorldSpawn[playerid] = 0;
	}//Стандартный спавн
	
	

	SetSpawnInfo(playerid, 0, Player[playerid][Model], x, y, z, Angle, w1, w1ammo, w2, w2ammo, w3, w3ammo);
	return SpawnPlayer(playerid);
}//Выполняется в момент до самого респавна игрока

stock WriteLog(LogName[], string[])
{//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
	new entry[256], LogWay[120], i;
	format(entry,sizeof entry,"\r\n%s",string);format(LogWay,sizeof LogWay, "Logs/%s.log",LogName);
	new File: hfile = fopen(LogWay, io_append);
	while (entry[i] != EOS) {fputchar(hfile,entry[i],false); i++;}
	fclose(hfile);
}//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"

stock LoadPlayerClan(playerid)
{//Загрузка клана игрока при логине
    if (Player[playerid][MyClan] != 0 && ClanTextShowed[playerid] == 0)
	{//загрузка клана
	    new clanid = Player[playerid][MyClan], bool:PlayerInClan = false; ClanTextShowed[playerid] = 1;
  		if(Clan[clanid][cLevel] == 0)
		{//клан был удален
			SendClientMessage(playerid,COLOR_RED,"Вас исключили из клана или он был удален.");
			Player[playerid][Member] = 0;
			Player[playerid][Leader] = 0;
			Player[playerid][MyClan] = 0;
			if (Player[playerid][Spawn] == 5) Player[playerid][Spawn] = 0;
			SavePlayer(playerid);
			return 1;
		}//клан был удален
        if(!strcmp(Clan[clanid][cLider], PlayerName[playerid], true)) PlayerInClan = true;

		if(PlayerInClan != true)
		{
        	for(new memb=1; memb<MAX_CMEMBERS; memb++)
			{
				if(!strcmp(CMember[clanid][memb], PlayerName[playerid], true)) {PlayerInClan = true; continue;}
			}
		}
		
 		if (PlayerInClan == false)
		{//игрока исключили из клана
			SendClientMessage(playerid,COLOR_RED,"Вас исключили из клана или он был удален.");
			Player[playerid][Member] = 0;
			Player[playerid][Leader] = 0;
			Player[playerid][MyClan] = 0;
			if (Player[playerid][Spawn] == 5) Player[playerid][Spawn] = 0;
			SavePlayer(playerid);
			return 1;
		}//игрока исключили из клана
		PlayerColor[playerid] = Clan[clanid][cColor];//установка цвета клана
		
		///////////////////delete
		if(!strcmp(Clan[clanid][cLider], PlayerName[playerid], true)) //если совпадает //убрать потом
		{
			if(Player[playerid][Leader] != 100) {Player[playerid][Leader] = 100;Player[playerid][Member] = -1;}
		}
		else
		{
		    if(Player[playerid][Leader] == 100)
		    {
		        Player[playerid][Leader] = 0;
				Player[playerid][Member] = 0;
				Player[playerid][MyClan] = 0;
				if (Player[playerid][Spawn] == 5) Player[playerid][Spawn] = 0;
				
				new entry[140];
				format(entry,sizeof entry,"Внимание! Вы были удалены из клана (несовпадение данных). Обратитесь к лидеру: {ff0000}%s",Clan[clanid][cLider]);
				SendClientMessage(playerid,COLOR_RED,entry);
				
				SavePlayer(playerid);
				return 1;
			}
		}
		/////////////////////DELETE
		
	    new cOnline = 0, cMes[140], ccolor = Clan[clanid][cColor];
		if(strcmp(Clan[clanid][cMessage], "ПУСТО", true))
		{//если сообщение у клана есть
		    format(cMes,sizeof(cMes),"СООБЩЕНИЕ КЛАНА: {FFFFFF}%s",Clan[clanid][cMessage]);
			SendClientMessage(playerid,ClanColor[ccolor],cMes);
		}//если сообщение у клана есть
		format(cMes, sizeof cMes, "Соклановец %s[%d] вошел в игру.", PlayerName[playerid], playerid);
		foreach(Player, cid) if (Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1 && cid != playerid) {SendClientMessage(cid,ClanColor[ccolor],cMes); cOnline += 1;}
		format(cMes,sizeof(cMes),"Ваших соклановцев в сети: %d", cOnline); SendClientMessage(playerid,ClanColor[ccolor],cMes);
		
		
		
		if(Clan[clanid][cBase] > MAX_BASE && Player[playerid][Leader] == 100)
		{//Штаб перекупили. Возвращаем лидеру деньги за штаб
  	        if (Player[playerid][Spawn] == 5 || Player[playerid][Spawn] == 8) Player[playerid][Spawn] = 0;
			new String[140]; format(String, sizeof String, "Ваш штаб перекупили! На ваш банковский счет было возвращено {FFFFFF}%d{FF0000}$", Clan[clanid][cBase]);
	        Player[playerid][Bank] += Clan[clanid][cBase];
			SavePlayer(playerid);
            Clan[clanid][cBase] = 0;
			SaveClan(clanid);
			SendClientMessage(playerid,COLOR_RED,String);
		}//Штаб перекупили. Возвращаем лидеру деньги за штаб
		
		new member = Player[playerid][Member];
		if(Player[playerid][Leader] == 100) {COnline[clanid][0] = 1; return 1;}
		else if(member > 0 && member < 26) {COnline[clanid][member] = 1;} //защита от бага, иногда вылазит, хз почему
		//фикс рангов (убрать потом)
		if(Player[playerid][Leader] < 6 && Player[playerid][Leader] > -1 && member > 0 && member < 26)
		{
			if(Player[playerid][Leader] != CRangs[clanid][member]) {CRangs[clanid][member] = Player[playerid][Leader]; MysqlSaveMember(clanid,member,Player[playerid][Leader],PlayerName[playerid]);}
		}
	}//загрузка клана
	return 1;
}//Загрузка клана игрока при логине

stock ShowClanZones(playerid)
{
	for(new i=1; i<MAX_GZONE;i++)
	{
	    new colorid = GangZones[i][GZColor];
	    GangZoneShowForPlayer(playerid, ClanZoneID[i], ClanZoneColor[colorid]);

		if(GangZones[i][ZoneAttacked] != 0)
		{
		    GangZoneFlashForPlayer(playerid,ClanZoneID[i],0xFF000070);
		}
	}
}

stock HideClanZones(playerid)
{
	for(new i=1; i<MAX_GZONE;i++) GangZoneHideForPlayer(playerid,ClanZoneID[i]);
}

stock ClanZoneShowForFree(gangzone,clr,flash,flashcolor)
{
	foreach(Player,i)
	{
	    if(InEvent[i] != 0) continue;
		GangZoneShowForPlayer(i, gangzone, clr);
	    if(flash == 1) GangZoneFlashForPlayer(i,gangzone,flashcolor);
	}
}

/*new elka;
public OnPlayerShootDynamicObject(playerid, weaponid, objectid, Float:x, Float:y, Float:z)
{
	if(objectid == elka) SendClientMessage(playerid,-1,"Elka damaged!");
	return 1;
}
*/
public OnGameModeInit()
{
	new b;//Anti DeAMX
	#emit LOAD.pri b//Anti DeAMX
	#emit STOR.pri b//Anti DeAMX
	unixtime = gettime();
	///------------MySQL connecton---------------
    //connects = mysql_connect("127.0.0.1", "samp", "samp_dm", "n18Agubm"); //2 сервер
	//connects = mysql_connect("127.0.0.1", "root", "exdm", ""); //локалка
    connects = mysql_connect("triniti.ru-hoster.com", "exrolf2n", "exrolf2n", "4fFe72gHq22"); //1 сервер
	mysql_empty(connects, "SET CHARACTER SET cp1251");
	mysql_log(LOG_ERROR | LOG_WARNING, LOG_TYPE_TEXT);
	if(!mysql_errno()) printf("Подключение к базе успешно");
	else return printf("Подключиться к базе не удалось");
	///------------MySQL connecton---------------


	for(new i = 0; i < MAX_PLAYERS; i++) ResetPlayer(i);
	

    mysql_tquery(connects,"SELECT * FROM `clans`", "LoadAllClans", "");
	mysql_tquery(connects,"SELECT * FROM `houses`", "LoadAllProperty", "");
	mysql_tquery(connects,"SELECT * FROM `bases`", "LoadAllBase", "");
	mysql_tquery(connects,"SELECT * FROM `zones`", "LoadGangZones", "");

	new Cfile;
	Cfile = ini_openFile("config.ini");
	ini_getFloat(Cfile, "DBonus", DBonus);  //donate bonus
	ini_getInteger(Cfile, "DoubleXP", ServConf[0]); //xp x2
	ini_getInteger(Cfile, "SPrize", ServConf[2]); //moder in marafon
	ini_getInteger(Cfile, "DoubleXPTop", ServConf[3]); //x2 xp in top
	ini_getInteger(Cfile, "DoubleMrf", ServConf[4]); //x1.5 marafon DONT WORK
	ini_getInteger(Cfile, "Lottery", ServConf[5]); //lottery on/off
	ini_getInteger(Cfile, "ServID", ServerID); //server 1 or 2
	ini_getInteger(Cfile, "Razrab", ServConf[1]); //developer
	ini_closeFile(Cfile);
	
	SetGameModeText(GAMEMODE_NAME);
	DisableInteriorEnterExits();

	new stringn[60];
	format(stringn,sizeof stringn, "hostname %s", ServerName);
	SendRconCommand(stringn);

	//Время и дата
	getdate(Year, Month, Day); gettime(hour,minute,second);
	format(RestartDate,sizeof RestartDate, "%d/%d/%d в %d:%d:%d", Day, Month, Year, hour, minute, second);
	format(ServerLimitXPDate,sizeof ServerLimitXPDate, "%d/%d/%d в %d:00", Day, Month, Year, hour);
	//mrf
	nowday = DateToIntDate(Day, Month, Year);
    MrfDate = DateToIntDate(10,9,2018)-nowday;
    

	//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
	for (new i = 1; i < 11; i++) WriteLog("GlobalLog","");
	new String[120];format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   Сервер запущен.", Day, Month, Year, hour, minute, second);WriteLog("GlobalLog", String);

	//Меню
	MenuMyskin = LoadModelSelectionMenu("MenuLists/skins.txt");
	MenuFirstCar = LoadModelSelectionMenu("MenuLists/firstcar.txt");
	MenuClass1 = LoadModelSelectionMenu("MenuLists/class1.txt");
	MenuClass2 = LoadModelSelectionMenu("MenuLists/class2.txt");
	MenuClass3 = LoadModelSelectionMenu("MenuLists/class3.txt");
	MenuBuyGun = LoadModelSelectionMenu("MenuLists/buygun.txt");
	MenuPaintJob = LoadModelSelectionMenu("MenuLists/paintjob.txt");
	MenuPrestigeCars = LoadModelSelectionMenu("MenuLists/PrestigeCars.txt");
	MenuCarWheels = LoadModelSelectionMenu("MenuLists/CarWheels.txt");
	MenuHousePick = LoadModelSelectionMenu("MenuLists/HousePick.txt");
	MenuHouseIcon = LoadModelSelectionMenu("MenuLists/HouseIcon.txt");
	//---------
	//загрузим топ
	UpdateTopOperationXP();//обновим топ по хп
	UpdateTopOperationGG();//обновим топ по донату
	UpdateTopClans();//обновим топ кланов
	
	format(LastTopUpdate, sizeof LastTopUpdate, "От %s%d:%s%d:%s%d", (hour < 10) ? ("0") : (""), hour, (minute < 10) ? ("0") : (""), minute, (second < 10) ? ("0") : (""), second);
    printf("Топ загружен!");
	
	#include "Transformer\GlobalTD" //общие текстдравы
	
	//elka = CreateDynamicObject(19076, 0.5, 0.5, 2.0, 0.0, 0.0, 0.0, -1, -1, -1, 300.0);
	
/*	CDTD[0] = TextDrawCreate(643.500000, 154.333343, "usebox");
TextDrawLetterSize(CDTD[0], 0.000000, 14.396292);
TextDrawTextSize(CDTD[0], -2.000000, 0.000000);
TextDrawAlignment(CDTD[0], 1);
TextDrawColor(CDTD[0], 0);
TextDrawUseBox(CDTD[0], true);
TextDrawBoxColor(CDTD[0], 1941040400);
TextDrawSetShadow(CDTD[0], 0);
TextDrawSetOutline(CDTD[0], 0);
TextDrawFont(CDTD[0], 0);
CDTD[1] = TextDrawCreate(643.000000, 164.250000, "usebox");
TextDrawLetterSize(CDTD[1], 0.000000, 12.127778);
TextDrawTextSize(CDTD[1], -2.000000, 0.000000);
TextDrawAlignment(CDTD[1], 1);
TextDrawColor(CDTD[1], 0);
TextDrawUseBox(CDTD[1], true);
TextDrawBoxColor(CDTD[1], 1941040416);
TextDrawSetShadow(CDTD[1], 0);
TextDrawSetOutline(CDTD[1], 0);
TextDrawFont(CDTD[1], 0);
CDTD[2] = TextDrawCreate(642.500000, 172.416656, "usebox");
TextDrawLetterSize(CDTD[2], 0.000000, 10.198146);
TextDrawTextSize(CDTD[2], -2.000000, 0.000000);
TextDrawAlignment(CDTD[2], 1);
TextDrawColor(CDTD[2], 0);
TextDrawUseBox(CDTD[2], true);
TextDrawBoxColor(CDTD[2], 1941040432);
TextDrawSetShadow(CDTD[2], 0);
TextDrawSetOutline(CDTD[2], 0);
TextDrawFont(CDTD[2], 0);
CDTD[3] = TextDrawCreate(642.500000, 181.749984, "usebox");
TextDrawLetterSize(CDTD[3], 0.000000, 8.044445);
TextDrawTextSize(CDTD[3], -2.000000, 0.000000);
TextDrawAlignment(CDTD[3], 1);
TextDrawColor(CDTD[3], 0);
TextDrawUseBox(CDTD[3], true);
TextDrawBoxColor(CDTD[3], 1941040448);
TextDrawSetShadow(CDTD[3], 0);
TextDrawSetOutline(CDTD[3], 0);
TextDrawFont(CDTD[3], 0);
CDTD[4] = TextDrawCreate(320.000000, 160.999984, "3");
TextDrawLetterSize(CDTD[4], 2.224498, 11.248331);
TextDrawAlignment(CDTD[4], 2);
TextDrawColor(CDTD[4], -1);
TextDrawSetShadow(CDTD[4], 0);
TextDrawSetOutline(CDTD[4], 0);
TextDrawBackgroundColor(CDTD[4], 51);
TextDrawFont(CDTD[4], 2);
TextDrawSetProportional(CDTD[4], 1);
CDTD[5] = TextDrawCreate(320.000000, 160.999984, "2");
TextDrawLetterSize(CDTD[5], 2.224498, 11.248331);
TextDrawAlignment(CDTD[5], 2);
TextDrawColor(CDTD[5], -1);
TextDrawSetShadow(CDTD[5], 0);
TextDrawSetOutline(CDTD[5], 0);
TextDrawBackgroundColor(CDTD[5], 51);
TextDrawFont(CDTD[5], 2);
TextDrawSetProportional(CDTD[4], 1);
CDTD[6] = TextDrawCreate(320.000000, 160.999984, "1");
TextDrawLetterSize(CDTD[6], 2.224498, 11.248331);
TextDrawAlignment(CDTD[6], 2);
TextDrawColor(CDTD[6], -1);
TextDrawSetShadow(CDTD[6], 0);
TextDrawSetOutline(CDTD[6], 0);
TextDrawBackgroundColor(CDTD[6], 51);
TextDrawFont(CDTD[6], 2);
TextDrawSetProportional(CDTD[6], 1);
CDTD[7] = TextDrawCreate(320.000000, 160.999984, "GO");
TextDrawLetterSize(CDTD[7], 2.224498, 11.248331);
TextDrawAlignment(CDTD[7], 2);
TextDrawColor(CDTD[7], -1);
TextDrawSetShadow(CDTD[7], 0);
TextDrawSetOutline(CDTD[7], 0);
TextDrawBackgroundColor(CDTD[7], 51);
TextDrawFont(CDTD[7], 2);
TextDrawSetProportional(CDTD[7], 1);*/
	//-----------
	
	
	
	
	new ADShieldID;
	for (new i = 0; i < sizeof(ADShields_4238); i++)
	{//Загрузка рекламных щитов
	    ADShieldID = CreateDynamicObjectEx(4238, ADShields_4238[i][0], ADShields_4238[i][1], ADShields_4238[i][2], ADShields_4238[i][3], ADShields_4238[i][4], ADShields_4238[i][5], 1000.000, 1000.000);
	    SetDynamicObjectMaterialText(ADShieldID, 0, "ВК:  {FFFF00}vk.com/esampdm\n{ffffff}Игровой магазин: {00ff00}/shop", OBJECT_MATERIAL_SIZE_256x128, "Arial", 24, 1, 0xFFFFFFFF, 1, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
	}//Загрузка рекламных щитов
	for (new i = 0; i < sizeof(ADShields_7913); i++)
	{//Загрузка рекламных щитов
		ADShieldID = CreateDynamicObjectEx(7913, ADShields_7913[i][0], ADShields_7913[i][1], ADShields_7913[i][2], ADShields_7913[i][3], ADShields_7913[i][4], ADShields_7913[i][5], 1000.000, 1000.000);
		SetDynamicObjectMaterialText(ADShieldID, 0, "ВК:  {FFFF00}vk.com/esampdm\n{ffffff}Игровой магазин: {00ff00}/shop", OBJECT_MATERIAL_SIZE_256x128, "Arial", 24, 1, 0xFFFFFFFF, 1, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
	}//Загрузка рекламных щитов
	
    new tmpobjid;
    #include "Transformer\Objects\bank_new"//банк
	#include "Transformer\Objects\Other"//всякие важные объекты
	#include "Transformer\Objects\farcry"//FarCry остров
	#include "Transformer\Objects\new_year"//0.3 new year // новогодние объекты
	#include "Transformer\Objects\pahom"//гаупвахта
	
	#include "Transformer\Objects\ex_houses"//спец. дома
	
	#include "Transformer\Objects\zombie9"//zombie 9 карта
	#include "Transformer\Objects\zombie10"//zombie 10 карта
	#include "Transformer\Objects\zombie11"//zombie 11 Казино Рояль
	#include "Transformer\Objects\zombie12"//zombie 12 Стройка
	#include "Transformer\Objects\zombie14"//zombie 14 Нефтезавод
	#include "Transformer\Objects\zombie15"//zombie 15 Две Крыши
	#include "Transformer\Objects\zombie16"//zombie 15 Dead by Daylight
	
	#include "Transformer\Objects\derby5"//derby 5 карта "На Грани"
	#include "Transformer\Objects\derby6"//derby 6 карта "Без Гарантий"
	#include "Transformer\Objects\derby7"//derby 7 карта "Перекрестки"
	#include "Transformer\Objects\derby8"//derby 8 карта "Пять Башен"
	#include "Transformer\Objects\derby9"//derby 9 карта "World of Tanks"
	#include "Transformer\Objects\derby10"//derby 10 0.2.1 - дерби "4 пирамиды" замена -> 5.7 - дерби "На пирамидах"
	#include "Transformer\Objects\derby11"//derby 11 0.2.1 - дерби "Свободное падение"
	#include "Transformer\Objects\derby12"//derby 12 0.2.3 - дерби "Parkour"
	//#include "Transformer\Objects\derby13ny"//derby NY 3.2 - дерби "King Of 2016"
	#include "Transformer\Objects\derby13"//derby 13 3.3 - дерби "Big Explode"
	#include "Transformer\Objects\derby14"//derby 14 3.8 - дерби "Тишина"
	#include "Transformer\Objects\derby15"//derby 15 3.8 - дерби "Багажное безумие", будет убрано
	#include "Transformer\Objects\derby16"//derby 16 4.1 - дерби "Tornado" //by Lomt1k
	#include "Transformer\Objects\derby17"//derby 17 4.1 - дерби "Заварушка" //by Lomt1k
	#include "Transformer\Objects\derby18"//derby 18 4.4 - дерби "BattleShip"
	#include "Transformer\Objects\derby19"//derby 19 4.6 - дерби "Полигон А"
	#include "Transformer\Objects\derby20"//derby 19 5.2 - дерби "Ave Maria" //by rocker
	#include "Transformer\Objects\derby21"//derby 19 5.2 - дерби "Vertigo" //by rocker
	
	#include "Transformer\Objects\Casino"//Казино
	
	#include "Transformer\Objects\tdm1"//tdm 1 "War Ground" 0.2
	#include "Transformer\Objects\tdm2"//tdm 2 "8 Bit" 		0.2.1
	#include "Transformer\Objects\tdm3"//tdm 3 "Выхода нет" 0.2.2
	#include "Transformer\Objects\tdm4"//tdm 4 "Deserted airport" 0.2.3
	#include "Transformer\Objects\tdm5"//tdm 5 "Forest" 0.3
	#include "Transformer\Objects\tdm6"//tdm 6 "Тир" 5.0
	#include "Transformer\Objects\tdm7"//tdm 7 "Parking Front" 5.0
	#include "Transformer\Objects\tdm8"//tdm 8 "На холме" 5.0
	
	#include "Transformer\Objects\park1"//parkour 1 "Base Jumper" 0.3
	#include "Transformer\Objects\park2"//parkour 2 "Up The Sky" 3.1
	#include "Transformer\Objects\park3"//parkour 3 "Extreme Run" 3.1
	#include "Transformer\Objects\park4"//parkour 4 "Street Workout" 3.2
	#include "Transformer\Objects\park5"//parkour 5 "Руферы" 4.4
	#include "Transformer\Objects\park6"//parkour 6 "Восхождение" 5.2
	//#include "Transformer\Objects\park4ny"
	
	#include "Transformer\Objects\drace1"//drace "ATOM" 4.2
	#include "Transformer\Objects\drace2"//drace "Стартрек" 4.2
	#include "Transformer\Objects\drace3"//drace "Undercover" 4.4
	#include "Transformer\Objects\drace4"//drace "Форд Боярд" 4.4
	#include "Transformer\Objects\drace5"//drace "Sky Cubes" 4.7
	#include "Transformer\Objects\drace6"//drace "4x4 Offroad" 4.7
	#include "Transformer\Objects\drace7"//drace "Бездорожье" 5.6
	
	#include "Transformer\Objects\xrace21"//xrace "Путь гепарда" 5.2
	
	//#include "Transformer\Objects\pdmmaps"//карты для захвата точек
	
	#include "Transformer\Objects\StaticActors" //Статичные NPC

	//pubg
	PlaneObject[0] = CreateObject(1681, 0.0, 0.0, 6000.0, 12.0, 0.0, 90.0, 200.0); //14553
	PlaneObject[1] = CreateObject(19300, 0.0, 0.0, 6000.0, 12.0, 0.0, 90.0, 200.0);
	PlaneObject[2] = CreateObject(19482, 0.0, 0.0, 6000.0, 0.0, 0.0, 0.0);
    SetObjectMaterialText(PlaneObject[2], "{ffff00}Нажмите {04B404}Enter(F)\n{ffff00}Десантироваться", 0, OBJECT_MATERIAL_SIZE_512x512, "Tahoma", 50, 1, 0xFFFFFFFF, 0x00, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
	AttachObjectToObject(PlaneObject[1], PlaneObject[0], 0.0, -12.0, 3.0, 0.0, 0.0, 0.0);
	AttachObjectToObject(PlaneObject[2], PlaneObject[0], 0.0, -6.0, 2.4, 0.0, 0.0, 270.0);
	for(new i; i<4;i++) {SecondZone[i] = GangZoneCreate(-1.0, 1.0, -1.0, 1.0); FirstZone[i] = GangZoneCreate(-1.0, 1.0, -1.0, 1.0); }
	
	
	//pubg
	
	Create3DTextLabel("{008E00}Банк\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1104.7926,1528.5916,4452.4810, 61, 648);
    Create3DTextLabel("{008E00}Перелет в другой город\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1112.4061,1528.1237,4452.4810, 61, 648);
    Create3DTextLabel("{ffffff}[{008E00}ВЫХОД{ffffff}]", COLOR_WHITE, 1104.8020,1515.6584,4452.8071, 61, 648);
	//BankOut = CreateDynamicPickup( 1318, 1, 1097.6642,1528.0289,4452.481,-1,61);

	//PDMObject = CreateDynamicObject(10932, 3465.83032, -3295.36035, -0.02832,   0.00000, 0.00000, 0.00000, PDM_WORLD, -1, -1, 500.0);
    
    //CreateDynamic3DTextLabel(const text[], color, Float:x, Float:y, Float:z, Float:drawdistance, attachedplayer = INVALID_PLAYER_ID, attachedvehicle = INVALID_VEHICLE_ID, testlos = 0, worldid = -1, interiorid = -1, playerid = -1, Float:streamdistance = STREAMER_3D_TEXT_LABEL_SD, areaid = -1, priority = 0)
    
    
	for(new i; i<MAX_BANKS;i++)
	{
		BankEnterPick[i] = CreateDynamicPickup( 1318, 1, BANKENTERS[i][0],BANKENTERS[i][1],BANKENTERS[i][2]);
		DynamicPickup[BankEnterPick[i]][Type] = 5;
		DynamicPickup[BankEnterPick[i]][ID] = i;
		CreateDynamicMapIcon(BANKENTERS[i][0],BANKENTERS[i][1],BANKENTERS[i][2], 52, -1, 0, 0, -1, 200.0);
		Create3DTextLabel("[БАНК]", 0x008E00FF, BANKENTERS[i][0],BANKENTERS[i][1],BANKENTERS[i][2], 50, 0);
	}
	
	//farcry
    CreateDynamicMapIcon(-245.9217,-1720.6550,3.0766, 40, -1, 0, 0, -1, 500.0);

    for(new i = 0; i < 4; i++)
	{//Магазины одежды
        CreateDynamicMapIcon(CLOTHESENTERS[i][0], CLOTHESENTERS[i][1], CLOTHESENTERS[i][2], 45, 0, -1, -1, -1, 300 );
		CreateDynamicPickup(1275, 1, CLOTHESENTERS[i][0], CLOTHESENTERS[i][1], CLOTHESENTERS[i][2], 0);
		Create3DTextLabel("{007FFF}Магазин Одежды\n{FFFF00}Стоимость: {FFFFFF}10 000$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, CLOTHESENTERS[i][0], CLOTHESENTERS[i][1], CLOTHESENTERS[i][2], 50, 0);
	}//Магазины одежды
	for(new i; i<MAX_VEHICLES;i++) //ну быдлокод, да пофиг
	{
    	VVinil[i][0]=-1;
    	VVinil[i][1]=-1;
    }
	//new year
	Create3DTextLabel("{ff00ff}Подойди ближе и забери свой {ff0000}Новогодний подарок{ff00ff}!", COLOR_WHITE, 2122.1238,1277.2410,10.3003, 50, 0);
	NYGift = CreateDynamicPickup(19055, 2, 2122.1238,1277.2410,10.3003, 0);

	for (new i;i<MAX_ZOMBIE;i++) ZZones[i] = GangZoneCreate(ZombieZones[i][0],ZombieZones[i][1],ZombieZones[i][2],ZombieZones[i][3]); //zones zombie

	WorkZoneCombine = GangZoneCreate(-1198.7462, -1066.4282, -1001.5065, -908.7125);//Поле комбайнера

	SetTimer("SecUpdate", 1000, true);

	//Цвета текстдравов о старте соревнований
	TextDrawColor(TextDrawEvent[EVENT_DM], COLOR_DM);
	TextDrawColor(TextDrawEvent[EVENT_DERBY], COLOR_DERBY);
	TextDrawColor(TextDrawEvent[EVENT_ZOMBIE], COLOR_ZOMBIE);
	TextDrawColor(TextDrawEvent[EVENT_RACE], COLOR_RACE);
	TextDrawColor(TextDrawEvent[EVENT_XRACE], COLOR_XR);
	TextDrawColor(TextDrawEvent[EVENT_GUNGAME], COLOR_GG);
	TextDrawColor(TextDrawEvent[EVENT_TDM], COLOR_TDM);
	TextDrawColor(TextDrawEvent[EVENT_PARK], COLOR_PARK);
	TextDrawColor(TextDrawEvent[EVENT_DRACE], COLOR_DRACE);
	TextDrawColor(TextDrawEvent[EVENT_BATTLE], COLOR_BATTLE);
	//TextDrawColor(TextDrawEvent[EVENT_BATTLE], COLOR_PDM);

	//--------- Pay N Spray Icons
	CreateDynamicMapIcon(2064.5986,-1831.6934,13.5469, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(1024.8928,-1024.6052,32.1016, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(487.3758,-1741.0320,11.1321, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(-1904.6287,285.5661,41.0469, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(-2425.6978,1020.8086,50.3977, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(1976.5468,2162.4783,11.0703, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(720.0233,-456.4514,16.3359, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(-99.9693,1118.9204,19.7417, 63, -1, 0, 0, -1, 350.0);
	CreateDynamicMapIcon(-1420.1829,2583.6006,55.8433, 63, -1, 0, 0, -1, 350.0);
	//--------- Pay N Spray TextLabel
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,2064.5986,-1831.6934,13.5469, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,1024.8928,-1024.6052,32.1016, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,487.3758,-1741.0320,11.1321, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,-1904.6287,285.5661,41.0469, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,-2425.6978,1020.8086,50.3977, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,1976.5468,2162.4783,11.0703, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,720.0233,-456.4514,16.3359, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,-99.9693,1118.9204,19.7417, 50, 0);
	Create3DTextLabel("{007FFF}Перекрасить машину\n{FFFF00}Стоимость: {FFFFFF}100$\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать\n\n{AFAFAF}Бесплатный ремонт при заезде!", COLOR_WHITE,-1420.1829,2583.6006,55.8433, 50, 0);

    //--------- Автомастерские Icons
    CreateDynamicMapIcon(2644.6580,-2044.3076,13.6352, 27, -1, 0, 0, -1, 350.0); // Tune Lowrider
	CreateDynamicMapIcon(1041.5431,-1016.8201,32.1075, 27, -1, 0, 0, -1, 350.0); // Tune Transfender Los Santos
	CreateDynamicMapIcon(-1936.0847,245.9636,34.4609, 27, -1, 0, 0, -1, 350.0); // Tune Transfender San Fierro
	CreateDynamicMapIcon(-2723.5532,217.1511,4.4844, 27, -1, 0, 0, -1, 350.0); // Tune Arch Angels
	CreateDynamicMapIcon(2386.7300,1051.5768,10.8203, 27, -1, 0, 0, -1, 350.0); // Tune Transfender Las Venturas 1
    CreateDynamicMapIcon(-2026.9791,124.2575,29.1300, 27, -1, 0, 0, -1, 350.0); // Tune TurboSpeed (2 gorod)
    CreateDynamicMapIcon(889.3679,1903.3181,10.8203, 27, -1, 0, 0, -1, 350.0); // Tune TurboSpeed (3 gorod)
    CreateDynamicMapIcon(1830.1392,-1398.6440,13.4297, 27, -1, 0, 0, -1, 350.0); // Tune TurboSpeed (1 gorod)
    //--------- Автомастерские TextLabel
    Create3DTextLabel("{007FFF}Автомастерская\n{FFFFFF}Lowrider", COLOR_WHITE,2644.6580,-2044.3076,13.6352, 50, 0);// Tune Lowrider
	Create3DTextLabel("{007FFF}Автомастерская\n{FFFFFF}Transfender", COLOR_WHITE,1041.5431,-1016.8201,32.1075, 50, 0);// Tune Transfender Los Santos
	Create3DTextLabel("{007FFF}Автомастерская\n{FFFFFF}Transfender", COLOR_WHITE,-1936.0847,245.9636,34.4609, 50, 0);// Tune Transfender San Fierro
	Create3DTextLabel("{007FFF}Автомастерская\n{FFFFFF}Arch Angels", COLOR_WHITE,-2723.5532,217.1511,4.4844, 50, 0);// Tune Arch Angels
	Create3DTextLabel("{007FFF}Автомастерская\n{FFFFFF}Transfender", COLOR_WHITE,2386.7300,1051.5768,10.8203, 50, 0);// Tune Transfender Las Venturas 1
	Create3DTextLabel("{007FFF}Автомастерская\n{9966CC}TurboSpeed\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE,-2026.9791,124.2575,29.1300, 50, 0);// Tune TurboSpeed
	Create3DTextLabel("{007FFF}Автомастерская\n{9966CC}TurboSpeed\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE,889.3679,1903.3181,10.8203, 50, 0);// Tune TurboSpeed
	Create3DTextLabel("{007FFF}Автомастерская\n{9966CC}TurboSpeed\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE,1830.1392,-1398.6440,13.4297, 50, 0);// Tune TurboSpeed

	//Работа - Доставщик пиццы
	Create3DTextLabel("{FFCC00}Доставщик Пиццы\n{007FFF}2400 XP и 144 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, 2397.7632, -1899.1389, 13.5469, 50, 0);
	CreateDynamicPickup( 1318, 1, 2397.7632, -1899.1389, 13.5469,-1,-1,-1,100);
	CreateDynamicMapIcon(2397.7632, -1899.1389, 13.5469, 14, -1, 0, 0, -1, 200.0);
	//Работа - Грузчик
	Create3DTextLabel("{FFCC00}Грузчик\n{007FFF}2700 XP и 108 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, 2729.3267, -2451.4578, 17.5937, 50, 0);
	CreateDynamicPickup( 1318, 1, 2729.3267, -2451.4578, 17.5937,-1,-1,-1,100);
	CreateDynamicMapIcon(2729.3267, -2451.4578, 17.5937, 54, -1, 0, 0, -1, 200.0);
	//Работа - Домушник
	Create3DTextLabel("{FFCC00}Домушник\n{007FFF}2880 XP и 360 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, -1972.5024,-1020.2568,32.1719, 50, 0);
	CreateDynamicPickup( 1318, 1, -1972.5024,-1020.2568,32.1719,-1,-1,-1,100);
	CreateDynamicMapIcon(-1972.5024,-1020.2568,32.1719, 51, -1, 0, 0, -1, 200.0);
	//Работа - Комбайнер
	Create3DTextLabel("{FFCC00}Комбайнер\n{007FFF}3240 XP и 270 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, -1061.6104,-1195.4755,129.8281, 50, 0);
	CreateDynamicPickup( 1318, 1, -1061.6104,-1195.4755,129.8281,-1,-1,-1,100);
	CreateDynamicMapIcon(-1061.6104,-1195.4755,129.8281, 11, -1, 0, 0, -1, 200.0);
	//Работа - Дальнобойщик
	Create3DTextLabel("{FFCC00}Дальнобойщик\n{007FFF}3420 XP и 540 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, 2484.6682,-2120.8743,13.5469, 50, 0);
	CreateDynamicPickup( 1318, 1, 2484.6682,-2120.8743,13.5469,-1,-1,-1,100);
	CreateDynamicMapIcon(2484.6682,-2120.8743,13.5469, 51, -1, 0, 0, -1, 200.0);
	//Работа - Капитан Корабля
	Create3DTextLabel("{FFCC00}Капитан Корабля\n{007FFF}3600 XP и 396 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, -1713.1389,-61.8556,3.5547, 50, 0);
	CreateDynamicPickup( 1318, 1, -1713.1389,-61.8556,3.5547,-1,-1,-1,100);
	CreateDynamicMapIcon(-1713.1389,-61.8556,3.5547, 9, -1, 0, 0, -1, 200.0);
	//Работа - Инкассатор
	Create3DTextLabel("{FFCC00}Инкассатор\n{007FFF}2400 XP и 900 000$ / Час\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы начать работу", COLOR_WHITE, 2364.8955, 2382.8770, 10.8203, 50, 0);
	CreateDynamicPickup( 1318, 1, 2364.8955, 2382.8770, 10.8203, -1, -1, -1, 100);

	//Интерьеры домов - выходы
/*	CreateDynamicPickup( 1318, 1, 2324.4902,-1149.5474,1050.7101,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2324.4902,-1149.5474,1050.7101, 15, 0);
	CreateDynamicPickup( 1318, 1, 243.7173,304.9818,999.1484,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 243.7173,304.9818,999.1484, 15, 0);
	CreateDynamicPickup( 1318, 1, 2218.4033,-1076.2634,1050.4844,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2218.4033,-1076.2634,1050.4844, 15, 0);
	CreateDynamicPickup( 1318, 1, 2365.3140,-1135.5983,1050.8826,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2365.3140,-1135.5983,1050.8826, 15, 0);
	CreateDynamicPickup( 1318, 1, 2496.0002,-1692.0852,1014.7422,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2496.0002,-1692.0852,1014.7422, 15, 0);
	CreateDynamicPickup( 1318, 1, 2270.4172,-1210.4956,1047.5625,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2270.4172,-1210.4956,1047.5625, 15, 0);
*/
    //Интерьеры домов - смена скина
    CreateDynamicPickup( 1275, 1, 2332.5144,-1144.4189,1054.3047,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Изменить модель персонажа\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2332.5144,-1144.4189,1054.3047, 15, 0);
    CreateDynamicPickup( 1275, 1, 2215.7893,-1074.6979,1050.4844,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Изменить модель персонажа\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2215.7893,-1074.6979,1050.4844, 15, 0);
    CreateDynamicPickup( 1275, 1, 2363.7717,-1127.3329,1050.8826,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Изменить модель персонажа\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2363.7717,-1127.3329,1050.8826, 15, 0);
    CreateDynamicPickup( 1275, 1, 2492.4016,-1708.5626,1018.3368,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Изменить модель персонажа\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2492.4016,-1708.5626,1018.3368, 15, 0);
    CreateDynamicPickup( 1275, 1, 2262.7871,-1216.8030,1049.0234,-1,-1,-1,100);
	Create3DTextLabel("{007FFF}Изменить модель персонажа\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2262.7871,-1216.8030,1049.0234, 15, 0);

    //Интерьеры штабов - выходы
    for(new i; i<MAX_BASE_INT; i++)
	{
		BaseEnterPick[i] = CreateDynamicPickup( 1318, 1, BIntInfo[i][otX],BIntInfo[i][otY],BIntInfo[i][otZ],-1,-1,-1,100);
		DynamicPickup[BaseEnterPick[i]][Type] = 6;
    }

    //Интерьеры домов - выходы
    for(new i; i<MAX_HOUSE_INT; i++)
	{
		HouseEnterPick[i] = CreateDynamicPickup( 1318, 1, HIntInfo[i][otX],HIntInfo[i][otY],HIntInfo[i][otZ],-1,-1,-1,100);
		DynamicPickup[HouseEnterPick[i]][Type] = 7;
    }
    
	//Казино - Рулетка
	Create3DTextLabel("{9966CC}Рулетка\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы сыграть", COLOR_WHITE, 1962.3420, 1009.6814, 992.4688, 20, 10);
	Create3DTextLabel("{9966CC}Рулетка\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы сыграть", COLOR_WHITE, 1958.0320, 1009.6746, 992.4688, 20, 10);
	Create3DTextLabel("{9966CC}Рулетка\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы сыграть", COLOR_WHITE, 1962.3417, 1025.3008, 992.4688, 20, 10);
	Create3DTextLabel("{9966CC}Рулетка\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы сыграть", COLOR_WHITE, 1958.0321, 1025.2384, 992.4688, 20, 10);
    //Казино - Весёлый Будда
    Create3DTextLabel("{FFCC00}Веселый Будда\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы рискнуть", COLOR_WHITE, 1954.1530, 995.4341, 992.8594, 50, 10);

	//Казино 4 дракона - вход слева
	CreateDynamicPickup( 1318, 1, 1958.3613, 953.2741, 10.8203);
	CreateDynamicMapIcon(1958.3613, 953.2741, 10.8203, 25, -1, 0, 0, -1, 200.0);
	Create3DTextLabel("{9966CC}Казино\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1958.3613, 953.2741, 10.8203, 50, 0);
	//Казино 4 дракона - вход центральный
	CreateDynamicPickup(1318, 1, 2019.3174, 1007.8547, 10.8203);
	CreateDynamicMapIcon(2019.3174, 1007.8547, 10.8203, 25, -1, 0, 0, -1, 200.0);
	Create3DTextLabel("{9966CC}Казино\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2019.3174, 1007.8547, 10.8203, 50, 0);
	//Казино 4 дракона - вход справа
	CreateDynamicPickup(1318, 1, 1944.2803, 1076.0552, 10.8203);
	CreateDynamicMapIcon(1944.2803, 1076.0552, 10.8203, 25, -1, 0, 0, -1, 200.0);
	Create3DTextLabel("{9966CC}Казино\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1944.2803, 1076.0552, 10.8203, 50, 0);
	//Казино 4 дракона - выход слева
	CreateDynamicPickup( 1318, 1, 1963.7800, 972.4600, 994.4688);
	Create3DTextLabel("{9966CC}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1963.7800, 972.4600, 994.4688, 50, 10);
	//Казино 4 дракона - выход центральный
	CreateDynamicPickup( 1318, 1, 2018.9702, 1017.8456, 996.8750);
	Create3DTextLabel("{9966CC}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 2018.9702, 1017.8456, 996.8750, 50, 10);
	//Казино 4 дракона - выход справа
	CreateDynamicPickup( 1318, 1, 1963.6882, 1063.2550, 994.4688);
	Create3DTextLabel("{9966CC}Выход\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1963.6882, 1063.2550, 994.4688, 50, 10);

	//Аэропорты
	CreateDynamicPickup( 1318, 1, 1451.6349, -2287.0703, 13.5469);
	CreateDynamicMapIcon(1451.6349, -2287.0703, 13.5469, 5, -1, 0, 0, -1, 200.0);
	Create3DTextLabel("{007FFF}Аэропорт\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1451.6349, -2287.0703, 13.5469, 50, 0);
	CreateDynamicPickup( 1318, 1, -1404.6575, -303.7458, 14.1484);
	CreateDynamicMapIcon(-1404.6575, -303.7458, 14.1484, 5, -1, 0, 0, -1, 200.0);
	Create3DTextLabel("{007FFF}Аэропорт\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, -1404.6575, -303.7458, 14.1484, 50, 0);
	CreateDynamicPickup( 1318, 1, 1672.9861, 1447.9349, 10.7868);
	CreateDynamicMapIcon(1672.9861, 1447.9349, 10.7868, 5, -1, 0, 0, -1, 200.0);
	Create3DTextLabel("{007FFF}Аэропорт\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", COLOR_WHITE, 1672.9861, 1447.9349, 10.7868, 50, 0);

	new RndID;
	for(new i=1; i<MAX_CASES;i++)
	{
	    RndID = random(sizeof(CaseSpawn));
	    CasePickup[i] = CreateDynamicPickup ( casemodel, 2, CaseSpawn[RndID][0], CaseSpawn[RndID][1], CaseSpawn[RndID][2] );
		CaseMapIcon[i] = CreateDynamicMapIcon(CaseSpawn[RndID][0], CaseSpawn[RndID][1], CaseSpawn[RndID][2], 56, COLOR_QUEST, 0, 0, -1, 350.0);
		DynamicPickup[CasePickup[i]][Type] = 4;
	}

	
	//Авто для угона
	new modeld;
	csrand1 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[1] = LCreateVehicle(csmodel, CarStealSpawns[csrand1][0], CarStealSpawns[csrand1][1], CarStealSpawns[csrand1][2], CarStealSpawns[csrand1][3], cscol1, cscol2, 0);
    StealCarMapIcon[1] = CreateDynamicMapIcon(CarStealSpawns[csrand1][0], CarStealSpawns[csrand1][1], CarStealSpawns[csrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand2 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
    StealCar[2] = LCreateVehicle(csmodel, CarStealSpawns[csrand2][0], CarStealSpawns[csrand2][1], CarStealSpawns[csrand2][2], CarStealSpawns[csrand2][3], cscol1, cscol2, 0);
	StealCarMapIcon[2] = CreateDynamicMapIcon(CarStealSpawns[csrand2][0], CarStealSpawns[csrand2][1], CarStealSpawns[csrand2][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand3 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[3] = LCreateVehicle(csmodel, CarStealSpawns[csrand3][0], CarStealSpawns[csrand3][1], CarStealSpawns[csrand3][2], CarStealSpawns[csrand3][3], cscol1, cscol2, 0);
	StealCarMapIcon[3] = CreateDynamicMapIcon(CarStealSpawns[csrand3][0], CarStealSpawns[csrand3][1], CarStealSpawns[csrand3][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand4 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[4] = LCreateVehicle(csmodel, CarStealSpawns[csrand4][0], CarStealSpawns[csrand4][1], CarStealSpawns[csrand4][2], CarStealSpawns[csrand4][3], cscol1, cscol2, 0);
	StealCarMapIcon[4] = CreateDynamicMapIcon(CarStealSpawns[csrand4][0], CarStealSpawns[csrand4][1], CarStealSpawns[csrand4][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand5 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[5] = LCreateVehicle(csmodel, CarStealSpawns[csrand5][0], CarStealSpawns[csrand5][1], CarStealSpawns[csrand5][2], CarStealSpawns[csrand5][3], cscol1, cscol2, 0);
	StealCarMapIcon[5] = CreateDynamicMapIcon(CarStealSpawns[csrand5][0], CarStealSpawns[csrand5][1], CarStealSpawns[csrand5][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand6 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[6] = LCreateVehicle(csmodel, CarStealSpawns[csrand6][0], CarStealSpawns[csrand6][1], CarStealSpawns[csrand6][2], CarStealSpawns[csrand6][3], cscol1, cscol2, 0);
	StealCarMapIcon[6] = CreateDynamicMapIcon(CarStealSpawns[csrand6][0], CarStealSpawns[csrand6][1], CarStealSpawns[csrand6][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand7 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[7] = LCreateVehicle(csmodel, CarStealSpawns[csrand7][0], CarStealSpawns[csrand7][1], CarStealSpawns[csrand7][2], CarStealSpawns[csrand7][3], cscol1, cscol2, 0);
	StealCarMapIcon[7] = CreateDynamicMapIcon(CarStealSpawns[csrand7][0], CarStealSpawns[csrand7][1], CarStealSpawns[csrand7][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand8 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[8] = LCreateVehicle(csmodel, CarStealSpawns[csrand8][0], CarStealSpawns[csrand8][1], CarStealSpawns[csrand8][2], CarStealSpawns[csrand8][3], cscol1, cscol2, 0);
	StealCarMapIcon[8] = CreateDynamicMapIcon(CarStealSpawns[csrand8][0], CarStealSpawns[csrand8][1], CarStealSpawns[csrand8][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand9 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[9] = LCreateVehicle(csmodel, CarStealSpawns[csrand9][0], CarStealSpawns[csrand9][1], CarStealSpawns[csrand9][2], CarStealSpawns[csrand9][3], cscol1, cscol2, 0);
	StealCarMapIcon[9] = CreateDynamicMapIcon(CarStealSpawns[csrand9][0], CarStealSpawns[csrand9][1], CarStealSpawns[csrand9][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand10 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[10] = LCreateVehicle(csmodel, CarStealSpawns[csrand10][0], CarStealSpawns[csrand10][1], CarStealSpawns[csrand10][2], CarStealSpawns[csrand10][3], cscol1, cscol2, 0);
	StealCarMapIcon[10] = CreateDynamicMapIcon(CarStealSpawns[csrand10][0], CarStealSpawns[csrand10][1], CarStealSpawns[csrand10][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand11 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[11] = LCreateVehicle(csmodel, CarStealSpawns[csrand11][0], CarStealSpawns[csrand11][1], CarStealSpawns[csrand11][2], CarStealSpawns[csrand11][3], cscol1, cscol2, 0);
	StealCarMapIcon[11] = CreateDynamicMapIcon(CarStealSpawns[csrand11][0], CarStealSpawns[csrand11][1], CarStealSpawns[csrand11][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand12 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[12] = LCreateVehicle(csmodel, CarStealSpawns[csrand12][0], CarStealSpawns[csrand12][1], CarStealSpawns[csrand12][2], CarStealSpawns[csrand12][3], cscol1, cscol2, 0);
	StealCarMapIcon[12] = CreateDynamicMapIcon(CarStealSpawns[csrand12][0], CarStealSpawns[csrand12][1], CarStealSpawns[csrand12][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand13 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[13] = LCreateVehicle(csmodel, CarStealSpawns[csrand13][0], CarStealSpawns[csrand13][1], CarStealSpawns[csrand13][2], CarStealSpawns[csrand13][3], cscol1, cscol2, 0);
	StealCarMapIcon[13] = CreateDynamicMapIcon(CarStealSpawns[csrand13][0], CarStealSpawns[csrand13][1], CarStealSpawns[csrand13][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand14 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[14] = LCreateVehicle(csmodel, CarStealSpawns[csrand14][0], CarStealSpawns[csrand14][1], CarStealSpawns[csrand14][2], CarStealSpawns[csrand14][3], cscol1, cscol2, 0);
	StealCarMapIcon[14] = CreateDynamicMapIcon(CarStealSpawns[csrand14][0], CarStealSpawns[csrand14][1], CarStealSpawns[csrand14][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

    csrand15 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[15] = LCreateVehicle(csmodel, CarStealSpawns[csrand15][0], CarStealSpawns[csrand15][1], CarStealSpawns[csrand15][2], CarStealSpawns[csrand15][3], cscol1, cscol2, 0);
	StealCarMapIcon[15] = CreateDynamicMapIcon(CarStealSpawns[csrand15][0], CarStealSpawns[csrand15][1], CarStealSpawns[csrand15][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand16 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[16] = LCreateVehicle(csmodel, CarStealSpawns[csrand16][0], CarStealSpawns[csrand16][1], CarStealSpawns[csrand16][2], CarStealSpawns[csrand16][3], cscol1, cscol2, 0);
	StealCarMapIcon[16] = CreateDynamicMapIcon(CarStealSpawns[csrand16][0], CarStealSpawns[csrand16][1], CarStealSpawns[csrand16][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand17 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[17] = LCreateVehicle(csmodel, CarStealSpawns[csrand17][0], CarStealSpawns[csrand17][1], CarStealSpawns[csrand17][2], CarStealSpawns[csrand17][3], cscol1, cscol2, 0);
	StealCarMapIcon[17] = CreateDynamicMapIcon(CarStealSpawns[csrand17][0], CarStealSpawns[csrand17][1], CarStealSpawns[csrand17][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand18 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[18] = LCreateVehicle(csmodel, CarStealSpawns[csrand18][0], CarStealSpawns[csrand18][1], CarStealSpawns[csrand18][2], CarStealSpawns[csrand18][3], cscol1, cscol2, 0);
	StealCarMapIcon[18] = CreateDynamicMapIcon(CarStealSpawns[csrand18][0], CarStealSpawns[csrand18][1], CarStealSpawns[csrand18][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand19 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[19] = LCreateVehicle(csmodel, CarStealSpawns[csrand19][0], CarStealSpawns[csrand19][1], CarStealSpawns[csrand19][2], CarStealSpawns[csrand19][3], cscol1, cscol2, 0);
	StealCarMapIcon[19] = CreateDynamicMapIcon(CarStealSpawns[csrand19][0], CarStealSpawns[csrand19][1], CarStealSpawns[csrand19][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand20 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[20] = LCreateVehicle(csmodel, CarStealSpawns[csrand20][0], CarStealSpawns[csrand20][1], CarStealSpawns[csrand20][2], CarStealSpawns[csrand20][3], cscol1, cscol2, 0);
	StealCarMapIcon[20] = CreateDynamicMapIcon(CarStealSpawns[csrand20][0], CarStealSpawns[csrand20][1], CarStealSpawns[csrand20][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand21 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[21] = LCreateVehicle(csmodel, CarStealSpawns[csrand21][0], CarStealSpawns[csrand21][1], CarStealSpawns[csrand21][2], CarStealSpawns[csrand21][3], cscol1, cscol2, 0);
	StealCarMapIcon[21] = CreateDynamicMapIcon(CarStealSpawns[csrand21][0], CarStealSpawns[csrand21][1], CarStealSpawns[csrand21][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand22 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[22] = LCreateVehicle(csmodel, CarStealSpawns[csrand22][0], CarStealSpawns[csrand22][1], CarStealSpawns[csrand22][2], CarStealSpawns[csrand22][3], cscol1, cscol2, 0);
	StealCarMapIcon[22] = CreateDynamicMapIcon(CarStealSpawns[csrand22][0], CarStealSpawns[csrand22][1], CarStealSpawns[csrand22][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand23 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[23] = LCreateVehicle(csmodel, CarStealSpawns[csrand23][0], CarStealSpawns[csrand23][1], CarStealSpawns[csrand23][2], CarStealSpawns[csrand23][3], cscol1, cscol2, 0);
	StealCarMapIcon[23] = CreateDynamicMapIcon(CarStealSpawns[csrand23][0], CarStealSpawns[csrand23][1], CarStealSpawns[csrand23][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand24 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[24] = LCreateVehicle(csmodel, CarStealSpawns[csrand24][0], CarStealSpawns[csrand24][1], CarStealSpawns[csrand24][2], CarStealSpawns[csrand24][3], cscol1, cscol2, 0);
	StealCarMapIcon[24] = CreateDynamicMapIcon(CarStealSpawns[csrand24][0], CarStealSpawns[csrand24][1], CarStealSpawns[csrand24][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand25 = random(sizeof(CarStealSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(133); csmodel = StealCars[modeld];
	StealCar[25] = LCreateVehicle(csmodel, CarStealSpawns[csrand25][0], CarStealSpawns[csrand25][1], CarStealSpawns[csrand25][2], CarStealSpawns[csrand25][3], cscol1, cscol2, 0);
	StealCarMapIcon[25] = CreateDynamicMapIcon(CarStealSpawns[csrand25][0], CarStealSpawns[csrand25][1], CarStealSpawns[csrand25][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	//Водные авто для угона
	csrand26 = random(sizeof(CarStealWaterSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(11); csmodel = StealWaterCars[modeld];
	StealCar[26] = LCreateVehicle(csmodel, CarStealWaterSpawns[csrand26][0], CarStealWaterSpawns[csrand26][1], CarStealWaterSpawns[csrand26][2], CarStealWaterSpawns[csrand26][3], cscol1, cscol2, 0);
	StealCarMapIcon[26] = CreateDynamicMapIcon(CarStealWaterSpawns[csrand26][0], CarStealWaterSpawns[csrand26][1], CarStealWaterSpawns[csrand26][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand27 = random(sizeof(CarStealWaterSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(11); csmodel = StealWaterCars[modeld];
	StealCar[27] = LCreateVehicle(csmodel, CarStealWaterSpawns[csrand27][0], CarStealWaterSpawns[csrand27][1], CarStealWaterSpawns[csrand27][2], CarStealWaterSpawns[csrand27][3], cscol1, cscol2, 0);
	StealCarMapIcon[27] = CreateDynamicMapIcon(CarStealWaterSpawns[csrand27][0], CarStealWaterSpawns[csrand27][1], CarStealWaterSpawns[csrand27][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand28 = random(sizeof(CarStealWaterSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(11); csmodel = StealWaterCars[modeld];
	StealCar[28] = LCreateVehicle(csmodel, CarStealWaterSpawns[csrand28][0], CarStealWaterSpawns[csrand28][1], CarStealWaterSpawns[csrand28][2], CarStealWaterSpawns[csrand28][3], cscol1, cscol2, 0);
	StealCarMapIcon[28] = CreateDynamicMapIcon(CarStealWaterSpawns[csrand28][0], CarStealWaterSpawns[csrand28][1], CarStealWaterSpawns[csrand28][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand29 = random(sizeof(CarStealWaterSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(11); csmodel = StealWaterCars[modeld];
	StealCar[29] = LCreateVehicle(csmodel, CarStealWaterSpawns[csrand29][0], CarStealWaterSpawns[csrand29][1], CarStealWaterSpawns[csrand29][2], CarStealWaterSpawns[csrand29][3], cscol1, cscol2, 0);
	StealCarMapIcon[29] = CreateDynamicMapIcon(CarStealWaterSpawns[csrand29][0], CarStealWaterSpawns[csrand29][1], CarStealWaterSpawns[csrand29][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand30 = random(sizeof(CarStealWaterSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(11); csmodel = StealWaterCars[modeld];
	StealCar[30] = LCreateVehicle(csmodel, CarStealWaterSpawns[csrand30][0], CarStealWaterSpawns[csrand30][1], CarStealWaterSpawns[csrand30][2], CarStealWaterSpawns[csrand30][3], cscol1, cscol2, 0);
	StealCarMapIcon[30] = CreateDynamicMapIcon(CarStealWaterSpawns[csrand30][0], CarStealWaterSpawns[csrand30][1], CarStealWaterSpawns[csrand30][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	//Воздушные авто для угона
	csrand31 = random(sizeof(CarStealAirSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(13); csmodel = StealAirCars[modeld];
	StealCar[31] = LCreateVehicle(csmodel, CarStealAirSpawns[csrand31][0], CarStealAirSpawns[csrand31][1], CarStealAirSpawns[csrand31][2], CarStealAirSpawns[csrand31][3], cscol1, cscol2, 0);
	StealCarMapIcon[31] = CreateDynamicMapIcon(CarStealAirSpawns[csrand31][0], CarStealAirSpawns[csrand31][1], CarStealAirSpawns[csrand31][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand32 = random(sizeof(CarStealAirSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(13); csmodel = StealAirCars[modeld];
	StealCar[32] = LCreateVehicle(csmodel, CarStealAirSpawns[csrand32][0], CarStealAirSpawns[csrand32][1], CarStealAirSpawns[csrand32][2], CarStealAirSpawns[csrand32][3], cscol1, cscol2, 0);
	StealCarMapIcon[32] = CreateDynamicMapIcon(CarStealAirSpawns[csrand32][0], CarStealAirSpawns[csrand32][1], CarStealAirSpawns[csrand32][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand33 = random(sizeof(CarStealAirSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(13); csmodel = StealAirCars[modeld];
	StealCar[33] = LCreateVehicle(csmodel, CarStealAirSpawns[csrand33][0], CarStealAirSpawns[csrand33][1], CarStealAirSpawns[csrand33][2], CarStealAirSpawns[csrand33][3], cscol1, cscol2, 0);
	StealCarMapIcon[33] = CreateDynamicMapIcon(CarStealAirSpawns[csrand33][0], CarStealAirSpawns[csrand33][1], CarStealAirSpawns[csrand33][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand34 = random(sizeof(CarStealAirSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(13); csmodel = StealAirCars[modeld];
	StealCar[34] = LCreateVehicle(csmodel, CarStealAirSpawns[csrand34][0], CarStealAirSpawns[csrand34][1], CarStealAirSpawns[csrand34][2], CarStealAirSpawns[csrand34][3], cscol1, cscol2, 0);
	StealCarMapIcon[34] = CreateDynamicMapIcon(CarStealAirSpawns[csrand34][0], CarStealAirSpawns[csrand34][1], CarStealAirSpawns[csrand34][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	csrand35 = random(sizeof(CarStealAirSpawns));cscol1 = random(256);cscol2 = random(256);modeld = random(13); csmodel = StealAirCars[modeld];
	StealCar[35] = LCreateVehicle(csmodel, CarStealAirSpawns[csrand35][0], CarStealAirSpawns[csrand35][1], CarStealAirSpawns[csrand35][2], CarStealAirSpawns[csrand35][3], cscol1, cscol2, 0);
	StealCarMapIcon[35] = CreateDynamicMapIcon(CarStealAirSpawns[csrand35][0], CarStealAirSpawns[csrand35][1], CarStealAirSpawns[csrand35][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

	//авто для битвы до последнего
    
    //авто для битвы до последнего

	UsePlayerPedAnims();
	EnableStuntBonusForAll(0);
	AllowInteriorWeapons(1);
	
	//Погода при старте сервера
	ServerWeather = random(20);
	if (ServerWeather == 8 || ServerWeather == 16 || ServerWeather == 19) ServerWeather -= 1;//Удаление погоды с дождем и с бурей
    if (ServerWeather == 9) ServerWeather = 10;
	SetWeather(ServerWeather);
	
	new modelid = random(sizeof(DRFastCars));
	DRModelCar = DRFastCars[modelid];
	//new Test[80]; format(Test, sizeof Test, "Dynamic Pickups: %d", CountDynamicPickups()); print(Test);
	return 1;
}

public OnGameModeExit()
{
	SaveServerConfig();
	SaveAllClans();
	SaveAllProperty();
	SaveAllBase();
	SaveAllZones();
	foreach(Player, gid) if (Logged[gid] == 1) {SavePlayer(gid); Logged[gid] = 0;}

	//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
	new String[120];format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   Сервер выключен.", Day, Month, Year, hour, minute, second);WriteLog("GlobalLog", String);
    mysql_close();
	return 1;
}

stock StartLogin(playerid)
{
    SendClientMessage(playerid,0xA9C4E4FF," ");
    SendClientMessage(playerid,0xA9C4E4FF,"SERVER: Загрузка аккаунта...");
	new query_string[49+MAX_PLAYER_NAME-4];
	format(query_string, sizeof(query_string), "SELECT * FROM `accounts` WHERE `PName` = '%s'", PlayerName[playerid]);
	mysql_function_query(connects, query_string, true, "FindPlayerInTable","i", playerid);
	return 1;
}

public OnPlayerRequestClass(playerid, classid)
{
    LSpawnPlayer(playerid);
	if (Logged[playerid] == 0) StartLogin(playerid);
	return 1;
}

public OnPlayerConnect(playerid)
{
    //if(IsPlayerNPC(playerid)) return 0;
	//--- не больше 3 игроков с 1 IP
	new ip[2][16];
    GetPlayerIp(playerid,ip[0],16);
	GetPlayerIp(playerid,PlayerIP[playerid],16);

    for(new i, m = GetMaxPlayers(), x; i != m; i++)
    {//--- не больше 3 игроков с 1 IP
        if(!IsPlayerConnected(i) || i == playerid) continue;
        GetPlayerIp(i,ip[1],16);
        if(!strcmp(ip[0],ip[1],true)) x++;
        if(x > 3) return Kick(i);
    }//--- не больше 3 игроков с 1 IP

	//--- Цифры в нике
	new PlName[MAX_PLAYER_NAME],count;
	GetPlayerName(playerid,PlName,sizeof(PlName));
	for (new i; i < strlen(PlName); i++)
	{
	    if (PlName[i] >= '0' && PlName[i] <= '9')
	    {
	        count++;
	        if(count == 6)
	        {
	            for (new ii = 1; ii <= 5; ii++) SendClientMessage(playerid,COLOR_RED,"ОШИБКА: В вашем нике больше 5 цифр!");
	            return GKick(playerid);
	        }
	    }
	}//--- Цифры в нике
	//new year
    PlayAudioStreamForPlayer(playerid, "https://drive.google.com/uc?export=download&id=0B5QybhvTfm7GaVhJSG1ibHotT00");
	ClanTextShowed[playerid] = 0;
	Player[playerid][MyClan] = 0;
	Player[playerid][SID] = -1;
	if (playerid > MaxPlayerID) MaxPlayerID = playerid;

	XReg[playerid] = 0;
	pKick[playerid] = 0;

	LSpecID[playerid] = -1;
	LSpectators[playerid] = 0;

	//обнуление LAC
	ResetPlayerWeapons(playerid);
	LACSH[playerid] = 3;LACTeleportOff[playerid] = 10;
	LACWeaponOff[playerid] = 3;
	CheatFlySec[playerid] = 0; LACFlyOff[playerid] = 0;//на FlyHack
	LACPedSHOff[playerid] = 0; LACPedSHTime[playerid] = 0;//на SH пешком и Slapper
	LACPanic[playerid] = 0; LACPanicTime[playerid] = 0;//LAC v2.0
	PlayerColor[playerid] = 0; //обнуление цвета

	Registered[playerid] = 0;
	Errors[playerid] = 3;
	Logged[playerid] = 0;
	DerbyStarted[playerid] = 0;
	DRStarted[playerid]=0;
	TimeTransform[playerid] = 0;
	TutorialStep[playerid] = 999;
	SkydiveTime[playerid] = 0;
	HealthTime[playerid] = 0;
	ArmourTime[playerid] = 0;
	RepairTime[playerid] = 0;
	PremiumTime[playerid] = 0;
	SkinChangeMode[playerid] = 0;
	SetPlayerColor(playerid,COLOR_GREY);//ставит игроку серый цвет
	HPRegenTime[playerid] = 0;
	JumpTime[playerid] = 0;
	//GetCpTime[playerid] = 0;
	PBackTime[playerid] = 0;
	SkillNTime[playerid] = 0;
	SkillYTime[playerid] = 0;
	SkillHTime[playerid] = 0;
	MapTPTime[playerid] = 0;
	CaseBugTime[playerid] = 0;
	GMTestStage[playerid] = 0;GMTestTime[playerid] = 0;
	FloodTime[playerid] = 0;FloodMessages[playerid] = 0;
	OnStartEvent[playerid] = 0;
	LACSH[playerid] = 3;
	PrestigeGM[playerid] = 0;
	LastPlayerTuneStatus[playerid] = 0;TunesPerSecond[playerid] = 0;

	UberNitroTime[playerid] = 0;
	GPSUsed[playerid] = 0;
	PrestigeTPTime[playerid] = 0;
	MapTP[playerid] = 0;
	LastBaseVisited[playerid] = 0; LastHouseVisited[playerid] = 0;//Для меню домов и штабов
	BadPingTime[playerid] = 0;
	LeaveDM[playerid] = 0; LeaveGG[playerid] = 0;

	InEvent[playerid] = 0; JoinEvent[playerid] = 0;
	ZMStarted[playerid] = 0; ZMIsPlayerIsZombie[playerid] = 0; ZMIsPlayerIsTank[playerid] = 0;
	FRStarted[playerid] = 0; XRStarted[playerid] = 0; GGKills[playerid] = 0; BTStarted[playerid] = 0;

	NOPSetPlayerHealth[playerid] = 0;
	NOPSetPlayerArmour[playerid] = 0;

	QuestActive[playerid] = 0;QuestCar[playerid] = -1;
	JetpackUsed[playerid] = 0;

	//ex7
	//PlayerExt[playerid] = 0;

	PlayerAFK[playerid][AFK_Time] = 0;
	PlayerAFK[playerid][AFK_Stat] = 0;
	//FirstSobeitCheck[playerid] = 0;//Первичная проверка на Sobeit

	TimePTBB[playerid] = 0;  // pt/bb timer
	//PVP
	 PlayerPVP[playerid][Status] = 0;
	 PlayerPVP[playerid][Invite] = -1;
	 PlayerPVP[playerid][Map] = 1;
	 PlayerPVP[playerid][Weapon] = 24;
	 PlayerPVP[playerid][Health] = 200;
	 PlayerPVP[playerid][PlayMap] = 0;
	 PlayerPVP[playerid][PlayWeapon] = 0;
	 PlayerPVP[playerid][PlayHealth] = 0;
	 PlayerPVP[playerid][TimeOut] = 0;
	 CanStartPVP[playerid] = 0;
     PlayerPVP[playerid][Stavka] = 500;


	InitFly(playerid);//Для полета супер-мена (Престиж 2)
	OnVehFly[playerid] = 0;//Для полета на авто (Престиж 4)

	DisablePlayerCheckpoint(playerid);
	DisablePlayerRaceCheckpoint(playerid);
    GetPlayerName(playerid, PlayerName[playerid], 25);

	PlayerWeather[playerid] = 17; PlayerTime[playerid] = 23;//Погода до логина
	
	OnZone[playerid]=-1;

    CreatePlayerTDS(playerid); //speedo, spec, work

	//packs
	//Pack_OnPlayerConnect(playerid);

	strmid(ChatName[playerid], PlayerName[playerid], 0, strlen(PlayerName[playerid]), 24);
	SetTimerEx("SecPlayerUpdate" , 1000, false, "i", playerid);
	#include "Transformer\Objects\RemoveBuilding" //Удаление объектов с карты
	return 1;
}

public OnPlayerDisconnect(playerid, reason)
{
	new OldMaxPlayerID = MaxPlayerID;
	for (new vid = 1; vid <= OldMaxPlayerID; vid++)
	{//цикл
	    if (IsPlayerConnected(vid) != 0)	MaxPlayerID = vid;
	}//цикл

	PlayerAFK[playerid][AFK_Time] = 0;
	if(PlayerAFK[playerid][AFK_Stat] != 0) { Delete3DTextLabel(AFK_3DT[playerid]); PlayerAFK[playerid][AFK_Stat] = 0; }

	if (PlayerPVP[playerid][Status] >= 2) FailPVP(playerid);

	ClanTextShowed[playerid] = 0;

	if (Logged[playerid] == 1)
	{//------------сообщение о выходе игрока с сервера
		new ChatMes[140], clanid = Player[playerid][MyClan], ccolor = Clan[clanid][cColor];
		switch (reason)
		{
			case 0:
				{
		           	foreach(Player, gid)
					{//цикл
						if (clanid > 0 && Player[gid][MyClan] == clanid)
						{
    					    format(ChatMes, sizeof ChatMes, "Соклановец %s[%d] покинул сервер (Вылет).", PlayerName[playerid], playerid);
							SendClientMessage(gid,ClanColor[ccolor],ChatMes);
						}
						if (Logged[gid] == 1 && Player[gid][Admin] > 0)
						{//если модер и выше
						    format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] покинул сервер (Вылет)[IP-Адрес:{FFFFFF} %s{AFAFAF}].", PlayerName[playerid], playerid, PlayerIP[playerid]);
						}//если модер и выше
						else{format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] покинул сервер (Вылет).", PlayerName[playerid], playerid);}
						if (Player[gid][ConMesEnterExit] == 1 && IsServerRestaring == 0) SendClientMessage(gid, COLOR_GREY, ChatMes);
					}//цикл
					//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
					format(ChatMes, sizeof ChatMes, "%d.%d.%d в %d:%d:%d |   %s[%d] покинул сервер (Вылет)[IP-Адрес: %s].", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, PlayerIP[playerid]);WriteLog("GlobalLog", ChatMes);
				}
			case 1:
				{
					foreach(Player, gid)
					{//цикл
						if (clanid > 0 && Player[gid][MyClan] == clanid)
						{
    					    format(ChatMes, sizeof ChatMes, "Соклановец %s[%d] покинул сервер.", PlayerName[playerid], playerid);
							SendClientMessage(gid,ClanColor[ccolor],ChatMes);
						}
						if (Logged[gid] == 1 && Player[gid][Admin] > 0)
						{//если модер и выше
						    format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] покинул сервер [IP-Адрес:{FFFFFF} %s{AFAFAF}].", PlayerName[playerid], playerid, PlayerIP[playerid]);
						}//если модер и выше
						else{format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] покинул сервер.", PlayerName[playerid], playerid);}
						if (Player[gid][ConMesEnterExit] == 1 && IsServerRestaring == 0) SendClientMessage(gid, COLOR_GREY, ChatMes);
					}//цикл
					if (InEvent[playerid] == EVENT_ZOMBIE && ZMTimeToFirstZombie == 0) Player[playerid][LeaveZM] = 1800;//час не может участвовать в зомби-выживании если подставил своих товарищей
	                //Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
					format(ChatMes, sizeof ChatMes, "%d.%d.%d в %d:%d:%d |   %s[%d] покинул сервер [IP-Адрес: %s].", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, PlayerIP[playerid]);WriteLog("GlobalLog", ChatMes);
				}
			case 2:
				{
					foreach(Player, gid)
					{//цикл
						if (clanid > 0 && Player[gid][MyClan] == clanid)
						{
    					    format(ChatMes, sizeof ChatMes, "Соклановец %s[%d] покинул сервер (Кик/Бан).", PlayerName[playerid], playerid);
							SendClientMessage(gid,ClanColor[ccolor],ChatMes);
						}
						if (Logged[gid] == 1 && Player[gid][Admin] > 0)
						{//если модер и выше
						    format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] покинул сервер (Кик/Бан)[IP-Адрес:{FFFFFF} %s{AFAFAF}].", PlayerName[playerid], playerid, PlayerIP[playerid]);
						}//если модер и выше
						else{format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] покинул сервер (Кик/Бан).", PlayerName[playerid], playerid);}
						if (Player[gid][ConMesEnterExit] == 1 && IsServerRestaring == 0) SendClientMessage(gid, COLOR_GREY, ChatMes);
					}//цикл
					//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
					format(ChatMes, sizeof ChatMes, "%d.%d.%d в %d:%d:%d |   %s[%d] покинул сервер (Кик/Бан)[IP-Адрес: %s].", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, PlayerIP[playerid]);WriteLog("GlobalLog", ChatMes);
				}
			}
        if (clanid != 0)
		{
		    new member = Player[playerid][Member];
		    if(Player[playerid][Leader] > 5) {COnline[clanid][0] = 0;}
			else if(member > 0 && member < MAX_CMEMBERS) {COnline[clanid][member] = 0;}
        	//if(Clan[clanid][NowWarZone] == OnZone[playerid] && GangZones[OnZone[playerid]][ZoneAttacked] == 2)	{MembersOnZone[clanid]--;}
		}
	}//------------сообщение о выходе игрока с сервера

	//LogidDialogShowed[playerid] = 0;
	Player[playerid][CarActive] = 0;
	JetpackUsed[playerid] = 0;
	if (Logged[playerid] == 1) {SavePlayer(playerid);}//сохранение акка
	DerbyStarted[playerid] = 0;
	
	ZMStarted[playerid] = 0;

	//TDMStarted[playerid] = 0;
	FRStarted[playerid] = 0;DisablePlayerCheckpoint(playerid);
	XRStarted[playerid] = 0;DisablePlayerRaceCheckpoint(playerid);
	PRStarted[playerid] = 0;
    DRStarted[playerid] = 0;
    BTStarted[playerid] = 0;
	if(Player[playerid][RadarSwitch] == 1) {TextDrawHideForPlayer(playerid, TextDrawTime), TextDrawHideForPlayer(playerid, TextDrawDate);}

    //отключение спектра у тех, кто следил за игроком
 foreach(Player, i)
	{//отключение спектра у тех, кто следил за игроком
	    if (LSpecID[i] == playerid)
	    {
	        TogglePlayerSpectating(i, 0);
			LSpecID[i] = -1;
			PlayerWeather[i] = -1;
			LSpawnPlayer(i);
	        SendClientMessage(i,COLOR_YELLOW,"Игрок, за которым вы следили, покинул сервер.");
	    }
	}//отключение спектра у тех, кто следил за игроком
	
	//отключение спектра у тех, кто следил за игроком
	if(LSpectators[playerid])
 	{
		foreach(Player, i)
		{//отключение спектра у тех, кто следил за игроком
	    	if (LSpecID[i] == playerid)
	    	{
	        	SendClientMessage(i,COLOR_YELLOW,"Игрок, за которым вы следили, покинул сервер");
	        	if (Player[i][Admin] > 0 && LSpecCount[i] > 0)
				{
			    	new str[140];
					format(str, sizeof str, "Вы получили за слежку %d XP и %d$", LSpecCount[i] * 2, LSpecCount[i] * 67);
			    	SendClientMessage(i, COLOR_YELLOW, str);
			    	LGiveXP(i, LSpecCount[i] * 2);
					Player[i][Cash] += LSpecCount[i] * 67;
			    	LSpecCount[i] = 0;
					PlayerPlaySound(i,1083,0.0,0.0,0.0);
				}
         	callcmd::specoff(i, "");
	    	}
   		}
	}//отключение спектра у тех, кто следил за игроком
	if (LSpecID[playerid] > -1) {new id = LSpecID[playerid]; LSpectators[id]--;}

	//Удаление связанных с игроком объектов
	if (TutorialObject[playerid] != -1){DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;}
	

	Logged[playerid] = 0; ResetPlayer(playerid);
	PDialogID[playerid] = -1;
	return 1;
}

public OnPlayerSpawn(playerid)
{
	if (NeedLSpawn[playerid] > 0){NeedLSpawn[playerid] = 0;LSpawnPlayer(playerid);}
	LACSH[playerid] = 3;LACTeleportOff[playerid] = 3;
	LACWeaponOff[playerid] = 3; CheatFlySec[playerid] = 0;
	if(InEvent[playerid] > 0) SetPlayerHealth(playerid, 100.0);
	SetPlayerArmour(playerid, 0.0);
	NOPSetPlayerHealth[playerid] = 0; NOPSetPlayerArmour[playerid] = 0;
	if (Logged[playerid] > 0) SetCameraBehindPlayer(playerid);
	if (InEvent[playerid] == EVENT_GUNGAME) GiveGGWeapon(playerid);//гангейм спавн
	//if (BTStarted[playerid] > 0) {BTStarted[playerid] = 0; InEvent[playerid] = 0; JoinEvent[playerid] = 0;}

	if (LSpectators[playerid] > 0) {SpecUpdate(playerid);}

	Player[playerid][CarActive] = 0;
	PlayerCarID[playerid] = -1;
	DerbyStarted[playerid] = 0;
	DRStarted[playerid] = 0;
	LastDamageFrom[playerid] = -1;

	//----- Стили драки
	if (Player[playerid][Slot9] == 0){SetPlayerFightingStyle (playerid, FIGHT_STYLE_NORMAL);}
	if (Player[playerid][Slot9] == 1){SetPlayerFightingStyle (playerid, FIGHT_STYLE_BOXING);}
	if (Player[playerid][Slot9] == 2){SetPlayerFightingStyle (playerid, FIGHT_STYLE_KUNGFU);}
	if (Player[playerid][Slot9] == 3){SetPlayerFightingStyle (playerid, FIGHT_STYLE_KNEEHEAD);}
	if (Player[playerid][Slot9] == 4){SetPlayerFightingStyle (playerid, FIGHT_STYLE_GRABKICK);}
	if (Player[playerid][Slot9] == 5){SetPlayerFightingStyle (playerid, FIGHT_STYLE_ELBOW);}

    //PVars
	SetPVarInt(playerid, "CashBag", 0);//Для мешка денег за спиной
	SetPVarInt(playerid, "CrHat", 0);//new year

	if (TutorialStep[playerid] != 999){SetPlayerVirtualWorld(playerid,playerid+1);}//только зарегистрировался
	if (Logged[playerid] > 0)
	{
	    TogglePlayerControllable(playerid, 1);
		SetTimerEx("SpawnStylePub" , 650, false, "i", playerid);//спавн со стилем, личное оружие
	} else TogglePlayerControllable(playerid, 0);
	return 1;
}

public OnPlayerDeath(playerid, killerid, reason)
{//стандартная смерть (синхронизация от playerid)
 /*if (Player[playerid][SlivBlock] == -1)
    {
	if(reason !=255)
		{
		if (InEvent[playerid] == 0 && JoinEvent[playerid] != EVENT_RACE && JoinEvent[playerid] != EVENT_XRACE)
        	{
        	if (Player[playerid][Exp] != 0)
				{
        		new String[128];
        		format(String, sizeof String, "Потеряно {ffffff}-%d ХП!{ff0000} Не хотите терять ХП при смерти? Купите 'Несливайку' в {ffffff}/shop!", Player[playerid][Exp]);
				SendClientMessage(playerid, COLOR_RED, String);
				format(String, sizeof String, "~r~-%d XP", Player[playerid][Exp]);
				GameTextForPlayer(playerid, String, 2000, 6);
				Player[playerid][Exp] = 0;
				}
			}
		}
	}*/
	LACWeaponOff[playerid] = 3; NOPSetPlayerHealthAndArmourOff[playerid] = 3;
	NeedLSpawn[playerid] = 1;
	if (OnFly[playerid] == 1) StopFly(playerid);//Выключает режим супермена (престиж)

	if (InEvent[playerid] == EVENT_RACE || InEvent[playerid] == EVENT_XRACE || InEvent[playerid] == EVENT_PARK) LeaveEvent(playerid,JoinEvent[playerid]); //чтобы после респавна нельзя было дальше участвовать
	//Анти-обход слива фрага путем самоубийства на соревновании
	if (InEvent[playerid] == EVENT_DM || InEvent[playerid] == EVENT_GUNGAME || (InEvent[playerid] == EVENT_ZOMBIE && ZMIsPlayerIsZombie[playerid] > 0) || BTStarted[playerid] > 0)
		if (killerid != LastDamageFrom[playerid] && IsPlayerConnected(LastDamageFrom[playerid])) OnPlayerDeathFromPlayer(playerid, LastDamageFrom[playerid], 54);

	if (InEvent[playerid] == EVENT_BATTLE)
 	{
 	    //киллист
 	    //foreach(Player, i) {if(InEvent[i] == EVENT_BATTLE) SendDeathMessageToPlayer(i, killerid, playerid, reason);}
 	    //выпадение лута
 	    new Float: ps[3]; GetPlayerPos(playerid, ps[0], ps[1], ps[2]);
        if(PlayerInv[playerid][0] != -1 && Slot1Bullets[playerid] > 0) CreateLoot(ps[0], ps[1], ps[2]-0.87, float(random(360)), PlayerInv[playerid][0], Slot1Bullets[playerid]); //огнесрел 1 слот
        if(PlayerInv[playerid][1] != -1 && Slot2Bullets[playerid] > 0) CreateLoot(ps[0], ps[1]+1.3, ps[2]-0.87, float(random(360)), PlayerInv[playerid][1], Slot2Bullets[playerid]); //огнестрел 2 слот
        if(PlayerInv[playerid][2] != -1) CreateLoot(ps[0], ps[1]-1.3, ps[2]-0.87, float(random(360)), PlayerInv[playerid][2], 1); //холодное
        if(PlayerInv[playerid][3] != -1) CreateLoot(ps[0]+1.3, ps[1], ps[2]-0.87, float(random(360)), PlayerInv[playerid][3], ThrowCount[playerid]); //метательное
        if(GetPVarInt(playerid,"BThls") > 0) CreateLoot(ps[0]-1.3, ps[1], ps[2]-0.87, float(random(360)), 16, GetPVarInt(playerid,"BThls")); //аптечки
 	}
	PUBGRewardPlayer(playerid);
	return 1;
}//стандартная смерть (синхронизация от playerid)

stock OnPlayerDeathFromPlayer(playerid, killerid, weaponid)
{//Смерть от рук игрока (синхронизация от killerid)
	if (unixtime-LastDeathTime[playerid] < 4 || playerid == killerid) return 1;
    LastDeathTime[playerid] = unixtime;

    if (ZMIsPlayerIsZombie[playerid] == 0 && ZMIsPlayerIsZombie[killerid] > 0)
	{//превращение в зомби зараженного
		ZMIsPlayerIsZombie[playerid] = 1; SendDeathMessage(killerid, playerid, 52);
		FarmedXP[killerid] += 100; FarmedMoney[killerid] += 800; //100 XP и 800$ за каждый удар
		GameTextForPlayer(killerid, "~Y~+~W~100 ~Y~XP   +~W~800~Y~$", 3000, 6);
		return SendClientMessage(playerid, COLOR_ZOMBIE, "Вы стали зомби! Атакуйте выживших!");
	}//превращение в зомби зараженного

    if (TimeAfterSpawn[playerid] < 5)
    {//Убили в течение 5 сек после респавна
        SendClientMessage(playerid,COLOR_YELLOW,"SERVER: Вас убили в течение 5 секунд после респавна. Не переживайте, убийство не засчитано.");
		return SendClientMessage(killerid,COLOR_RED,"SERVER: Нельзя убивать игроков в течение 5 секунд после респавна! Убийство не засчитано.");
    }//Убили в течение 5 сек после респавна
    if (weaponid == 38 && Player[playerid][Level] < 60 && InEvent[playerid] == 0)
	{//Убийство нуба с минигана
	    SendClientMessage(playerid,COLOR_YELLOW,"SERVER: Вас убил при помощи минигана игрок высокого уровня. Не переживайте, убийство не засчитано.");
		return SendClientMessage(killerid,COLOR_RED,"SERVER: С минигана нельзя убивать игроков, не достигших 60-го уровня! Убийство не засчитано.");
    }//Убийство нуба с минигана
    if (AdminTPCantKill[killerid] > 0)
    {//Убийцу недавно телепортировал модератор
        SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вас убил игрок, который использовал телепортацию.. Не переживайте, убийство не засчитано.");
        return SendClientMessage(killerid, COLOR_RED, "SERVER: Запрещено убивать игроков после телепортации! Убийство не засчитано.");
    }//Убийцу недавно телепортировал модератор

    new Float: x, Float: y, Float: z; GetPlayerPos(playerid, x, y, z);
	foreach(Player, cid)
	{
	    if (Player[cid][Admin] > 0 && cid != killerid) SendDeathMessageToPlayer(cid, killerid, playerid, weaponid);
		else if (GetPlayerDistanceFromPoint(cid, x, y ,z) < 300.0 && GetPlayerVirtualWorld(cid) == GetPlayerVirtualWorld(playerid) && cid != killerid) SendDeathMessageToPlayer(cid, killerid, playerid, weaponid);
	}
	SendDeathMessageToPlayer(killerid, killerid, playerid, weaponid);
	
	//синхронизация киллиста
	/*if(BTStarted[playerid] == 0) //на бт свой киллист
	{
		if(InEvent[playerid] > 0 && InEvent[playerid] != EVENT_PVP) //свой киллист в ивентах
		{
		    foreach(Player, i)
	  	  	{
				if(InEvent[i] == InEvent[playerid]) SendDeathMessageToPlayer(i, killerid, playerid, weaponid);
			}
 		}
		else //киллист в общем мире
		{
	    	new Float: ps[3]; GetPlayerPos(playerid, ps[0], ps[1], ps[2]);
			foreach(Player, cid)
			{
				if (GetPlayerDistanceFromPoint(cid, ps[0], ps[1] ,ps[2]) < 300.0 && GetPlayerVirtualWorld(cid) == GetPlayerVirtualWorld(playerid) && cid != killerid)
				SendDeathMessageToPlayer(cid, killerid, playerid, weaponid);
			}
			SendDeathMessageToPlayer(killerid, killerid, playerid, weaponid);
		}
	}*/
	
    QuestUpdate(killerid, 6, 1);//Обновление квеста Убить 50 человек
    if (weaponid <= 15 && weaponid > 0) QuestUpdate(killerid, 2, 1);//Обновление квеста Убить 5 человек при помощи холодного оружия
    else if (weaponid >= 22 && weaponid <= 24) QuestUpdate(killerid, 7, 1);//Обновление квеста Убить 10 человек из пистолета
    else if (weaponid >= 25 && weaponid <= 27) QuestUpdate(killerid, 8, 1);//Обновление квеста Убить 10 человек из дробовика
	else if (weaponid == 28 || weaponid == 29 || weaponid == 32) QuestUpdate(killerid, 9, 1);//Обновление квеста Убить 10 человек из ПП
	else if (weaponid == 30 || weaponid == 31) QuestUpdate(killerid, 10, 1);//Обновление квеста Убить 10 человек из автомата

	if (PlayerPVP[playerid][Status] > 2 && PlayerPVP[killerid][Status] > 2) return FailPVP(playerid);

	if (JoinEvent[killerid] == EVENT_DM && JoinEvent[playerid] == EVENT_DM && DMTimeToEnd > 0)
	{//убийство в десматче
		new StringZ[140]; DMKills[killerid]++;
		format(StringZ, sizeof StringZ, "~Y~KILLS: ~W~%d", DMKills[killerid]);
		GameTextForPlayer(killerid, StringZ, 3000, 6);
		if (DMKills[killerid] > DMLeaderKills) {DMLeaderID = killerid; DMLeaderKills = DMKills[killerid];}
        QuestUpdate(killerid, 1, 1);//Обновление квеста 40 убийств в дм
		return 1;
	}//убийство в десматче

	if (JoinEvent[killerid] == EVENT_TDM && JoinEvent[playerid] == EVENT_TDM && killerid != playerid && TDMTeam[killerid] != TDMTeam[playerid] && TDMTimeToEnd > 0)
	{//убийство в tdm
		TDMKills[killerid]++;
		if(TDMTeam[killerid] == 1) TDMGroveKills++;
		else if(TDMTeam[killerid] == 2) TDMBallasKills++;
		GameTextForPlayer(killerid, "+30XP +500$", 1000, 6);
		return 1;
	}//убийство в tdm
	
	/*if (JoinEvent[killerid] == EVENT_PDM && JoinEvent[playerid] == EVENT_PDM && killerid != playerid && PDMTeam[killerid] != PDMTeam[playerid] && PDMTimeToEnd > 0)
	{//убийство в PDM
		PDMKills[killerid]++;
		//if(PDMTeam[killerid] == 1) PDMBlueKills++;
		//else if(PDMTeam[killerid] == 2) PDMRedKills++;
		GameTextForPlayer(killerid, "+30XP +500$", 1000, 6);
		return 1;
	}//убийство в PDM*/
	
	if(BTStarted[playerid] > 0 && BTStarted[killerid] > 0)
	{
		new StringZ[20]; BTKills[killerid]++;
		format(StringZ, sizeof StringZ, "~Y~KILLS: ~W~%d", BTKills[killerid]);
		GameTextForPlayer(killerid, StringZ, 3000, 6);
		return 1;
	}
	
	if (ZMStarted[killerid] == 1 && ZMIsPlayerIsZombie[playerid] > 0 && ZMIsPlayerIsZombie[killerid] == 0)
	{//убийство человеком зомби на выживании
	    if (ZMKillsXP[killerid] < 300)
	    {
			FarmedXP[killerid] += 15; ZMKillsXP[killerid] += 15; FarmedMoney[killerid] += 250;
			GameTextForPlayer(killerid, "~Y~+~W~15 ~Y~XP   +~W~250~Y~$", 3000, 6);
		}//убийство игрока чужой команды
		else
		{//Достигнут лимит ХР за убийство зомби
		    FarmedMoney[killerid] += 250; GameTextForPlayer(killerid, "~Y~+~W~250~Y~$", 3000, 6);
		}//Достигнут лимит ХР за убийство зомби
		QuestUpdate(killerid, 3, 1);//Обновление квеста 15 убийств зомби в зомби-выживании
		return 1;
	}//убийство человеком зомби на выживании
	if (killerid != playerid && ZMIsPlayerIsZombie[killerid] == 0 && ZMIsPlayerIsZombie[playerid] == 0 && ZMStarted[killerid] == 1 && ZMStarted[playerid] == 1)
	{//тимкилл на Зомби-Выживании
		ZMStarted[killerid] = 0; ZMIsPlayerIsZombie[killerid] = 0; ZMIsPlayerIsTank[killerid] = 0;
		ResetPlayerWeapons(killerid);LSpawnPlayer(killerid);
		SendClientMessage(killerid,COLOR_RED,"Вы были выброшены из Зомби-Выживания за убийство игрока своей команды");
		GangZoneHideForPlayer(killerid,ZZones[ZMid-1]);
	}//тимкилл на Зомби-Выживании
	if (InEvent[killerid] == EVENT_GUNGAME && InEvent[playerid] == EVENT_GUNGAME)
	{//убийство игрока в gg
	    new String[140], BonusXP, BonusCash;
		GGKills[killerid]++; GiveGGWeapon(killerid);
		format(String, sizeof String, "~Y~KILLS: ~W~%d", GGKills[killerid]);
		GameTextForPlayer(killerid, String, 3000, 6);
		QuestUpdate(killerid, 4, 1);//Обновление квеста 15 убийств в гонке вооружений
		if (GGKills[killerid] == 15)
		{//убийца победил. Конец GunGame
            MarafonUpdate(killerid, 2, 1);
		    format(String,sizeof(String),"%s[%d] победил в гонке вооружений и получил 800 XP и 25 000$",PlayerName[killerid], killerid);
			SendClientMessageToAll(COLOR_GG,String);
		    foreach(Player, did)
			{//цикл
				if(JoinEvent[did] == EVENT_GUNGAME)
				{
					InEvent[did] = 0; JoinEvent[did] = 0;
					if (GGKills[did] >= 15) {BonusXP = 800; BonusCash = 25000;}
					else {BonusXP = 80 + GGKills[did] * 40; BonusCash = GGKills[did] * 1000;}
					format(String,sizeof(String),"Вы получили %d ХР и %d$ за участие в Гонке Вооружений (Убийств: %d).", BonusXP, BonusCash, GGKills[did]);
					SendClientMessage(did,COLOR_YELLOW,String); LSpawnPlayer(did);
					LGiveXP(did, BonusXP); Player[did][Cash] += BonusCash;
					ShowClanZones(did); // покажем клановые зоны
					QuestUpdate(did, 17, 1);//Обновление квеста Примите участие в 3 гонках вооружений
					QuestUpdate(did, 18, 1);//Обновление квеста Примите участие в 5 соревнованиях
					//mrf
					MarafonUpdate(did, 5, BonusCash);
					MarafonUpdate(did, 0, 1);
				}
			}//цикл
			GGTimeToEnd = -1;
		}//убийца победил. Конец GunGame
		return 1;
	}//убийство игрока в gg

	if (Player[killerid][MyClan] != 0 && Player[killerid][MyClan] == Player[playerid][MyClan]) return 1; //Убийство соклановца
	if (InEvent[playerid] > 0 || InEvent[killerid] > 0) return 1;
	
	//битва на терре
	if (Player[killerid][MyClan] > 0 && Player[playerid][MyClan] > 0)
	{
		new wzone = Clan[Player[killerid][MyClan]][NowWarZone];
	    if(wzone > 0 && GangZones[wzone][ZoneAttacked] == 2)
	    {
	        if(wzone == OnZone[killerid] && wzone == Clan[Player[playerid][MyClan]][NowWarZone]) {GameTextForPlayer(killerid, "~r~killed", 1000, 6); ClanKills[Player[killerid][MyClan]]++; return 1;}
	    }
  	}
	//if (Player[killerid][MyClan] > 0 && wzone == OnZone[killerid] && GangZones[OnZone[killerid]][ZoneAttacked] == 2) return 1;
	//if (Player[playerid][MyClan] > 0 && Clan[Player[playerid][MyClan]][NowWarZone] == OnZone[playerid] && GangZones[OnZone[playerid]][ZoneAttacked] == 2) return 1;
	
	
	QuestUpdate(killerid, 5, 1);//Обновление квеста 5 убийств за пределами соревнований

	//Понижение кармы
    new clanid = Player[playerid][MyClan], killerclanid = Player[killerid][MyClan], ChangeCarma = 1;
	if (clanid > 0 && clanid == killerclanid) return 1; //При убийстве соклана не теряются деньги и карма
	if (clanid > 0 && killerclanid > 0  && (Clan[clanid][cEnemyClan] == killerclanid || Clan[killerclanid][cEnemyClan] == clanid)) ChangeCarma = 0; //на войне карму не сливать
	

   	if (ChangeCarma == 1)
	{//Если надо сливать карму
	    Player[killerid][Karma] -= 15; Player[killerid][KarmaTime] = 0; //Сброс таймера до повышения кармы
		SendClientMessage(killerid,COLOR_RED,"Вы потеряли 15 очков кармы! Зачем нужна карма смотри в {FFFFFF}/karma");
		if (Player[killerid][Karma] <= -400 && Player[killerid][Invisible] > 0) {Player[killerid][Invisible] = 0; SendClientMessage(killerid,COLOR_RED,"Невидимость была отключена из-за слишком низкой кармы.");}
	}//Если надо сливать карму

	//передача денег
	if (Player[playerid][Cash] <= 0 || Player[playerid][Banned] != 0) return 1;
	if (Player[playerid][SlivBlock] != -1) return 1;
	if (InEvent[playerid] > 0) return 1;
	new GrabMoney, SaveMoney = 0, String[180];
	
	
	
	GrabMoney = Player[playerid][Cash] / 2;//Из игрока выпадает 50% от денег, остальная сумма сгорает
	if (Player[playerid][GPremium] >= 13) SaveMoney = Player[playerid][Cash] / 4;//25% денег не сгорает (нужен vip 13)
	format(String, sizeof String, "Вы потеряли %d$ за смерть от рук другого игрока! Чтобы не терять деньги, купите 'Несливайку' в /shop!", Player[playerid][Cash] - SaveMoney);
	SendClientMessage(playerid, COLOR_RED, String);
	if (Player[playerid][Bank] == 0) SendClientMessage(playerid,COLOR_YELLOW,"Или храните деньги в банке... Найти его можно через {FFFFFF}/gps");
	Player[playerid][Cash] = 0 + SaveMoney;


	//format(String, sizeof String, "Потеряно -%d ХП! Не хотите терять ХП при смерти? Купите 'Несливайку' в /shop!", Player[playerid][Exp]);
	//SendClientMessage(playerid, COLOR_RED, String);
	//Player[playerid][Exp] = 0;

	if (GrabMoney > 0)
	{
	    if(Player[killerid][SPN4] > 0)
	    {
			Player[killerid][Cash] += GrabMoney;
			QuestUpdate(killerid, 19, GrabMoney);//Обновление квеста Ограбьте других игроков на сумму 10 000$
			format(String, sizeof String, "{FFFF00}SERVER: Вы получили {ffffff}%d${FFFF00} после убийства игрока {FFFFFF}%s{FFFF00}[{FFFFFF}%d{FFFF00}] (Навык Грабитель)!", GrabMoney, PlayerName[playerid], playerid);
			SendClientMessage(killerid, COLOR_YELLOW, String);
			format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   CASH: %s[%d] убил игрока %s[%d]. Из него выпало %d$ (навык грабитель)", Day, Month, Year, hour, minute, second, PlayerName[killerid], killerid, PlayerName[playerid], playerid, GrabMoney);
			WriteLog("GlobalLog", String); WriteLog("CashOperations", String);
		}
	    else
	    {
	    	new Float: DeathPosX, Float: DeathPosY, Float: DeathPosZ; GetPlayerPos(playerid, DeathPosX, DeathPosY, DeathPosZ);
			new CashPickup = CreateDynamicPickup(1550, 1, DeathPosX, DeathPosY, DeathPosZ, GetPlayerVirtualWorld(playerid), -1, -1, 300.0);
			DynamicPickup[CashPickup][Type] = 3;//тип пикапа - деньги
			DynamicPickup[CashPickup][ID] = GrabMoney;//сумма денег
			DynamicPickup[CashPickup][DestroyTimerID] = SetTimerEx("DestroyCashPickup" , 60 * 1000, false, "i", CashPickup);

			format(String, sizeof String, "{FFFF00}SERVER: Из убитого вами игрока {FFFFFF}%s{FFFF00}[{FFFFFF}%d{FFFF00}] выпали деньги! Подберите их!", PlayerName[playerid], playerid);
			SendClientMessage(killerid, COLOR_YELLOW, String);
			format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   CASH: %s[%d] убил игрока %s[%d]. Из него выпало %d$", Day, Month, Year, hour, minute, second, PlayerName[killerid], killerid, PlayerName[playerid], playerid, GrabMoney);
			WriteLog("GlobalLog", String); WriteLog("CashOperations", String);
		}
	}

	return 1;
}//Смерть от рук игрока (синхронизация от killerid)

public OnVehicleSpawn(vehicleid)
{
	if (vehicleid > MaxVehicleUsed) MaxVehicleUsed = vehicleid;//используется в циклах вместо MAX_VEHICLES
	return 1;
}


public OnVehicleDeath(vehicleid, killerid)
{
	if (!IsPlayerInVehicle(killerid, vehicleid) || (GetPlayerVehicleSeat(killerid) != 0 && GetPlayerVehicleSeat(killerid) != 128))
	{
	    new String[140];
	    LACPanic[killerid]++;
		format(String,sizeof(String), "[АДМИНАМ]LAC:{AFAFAF} %s[%d] возможно использует чит на спавн авто",PlayerName[killerid], killerid);
		foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
		format(String, 140, "%d.%d.%d a %d:%d:%d |   LAC: %s[%d] возможно использует чит на спавн авто", Day, Month, Year, hour, minute, second, PlayerName[killerid], killerid);
		WriteLog("GlobalLog", String);WriteLog("LAC", String);
	}
	return 1;
}



public OnPlayerText(playerid, text[])
{
	//if (text[0] == '.') {strdel(text, 0, 1); Translit(playerid, text); return 0;}
	//Если начал вводить команду не с '/', а с '.' (русская раскладка) - переводим в команды
	if (text[0] == '.') {text[0] = '/'; PC_EmulateCommand(playerid, text); return 0;}

	if (Logged[playerid] == 0){SendClientMessage(playerid,COLOR_RED, "Ошибка: Чтобы писать в чат нужно авторизироваться");return 0;}
	else if (Player[playerid][Muted] != 0)
	{//мута
	    if (Player[playerid][Muted] == -1) SendClientMessage(playerid,COLOR_RED,"Вам запрещено писать в чат");
	    else
	    {
		    new StringM[100], hourM;
		    if (Player[playerid][Muted] >= 60){hourM = Player[playerid][Muted] / 60;format(StringM,sizeof(StringM),"Вам запрещено писать в чат еще %d минут %d секунд", hourM, Player[playerid][Muted] - hourM * 60);}
		    else{format(StringM,sizeof(StringM),"Вам запрещено писать в чат еще %d секунд", Player[playerid][Muted]);}
		    SendClientMessage(playerid,COLOR_RED,StringM);
	    }
	    return 0;
	}//мута
	
	if (strfind(text, "internationaldm", true)!=-1) {BanEx(playerid, "пидорок"); return 0;} //убрать как угомонтс

	new Name[30];GetPlayerName(playerid, Name, MAX_PLAYER_NAME);
	new itext[300], Need60Sec = 0;strcat(itext,text);

	//--- Цифры в тексте
	new count, AntiCaps = 0;
	for (new i; i < strlen(itext); i++)
	{
	    if (itext[i] >= '0' && itext[i] <= '9')
	    {
	        count++;
	        if(count > 5) {SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Сообщение не должно содержать больше 5 цифр!"); return 0;}
	    }

	    //AntiCapsLock
	    if (itext[i] > 64 && itext[i] < 91 && AntiCaps == 0) AntiCaps = 1; //eng
	    if (itext[i] > 191 && itext[i] < 224 && AntiCaps == 0) AntiCaps = 1;//rus
	    if(itext[i] == 168 && AntiCaps == 0) AntiCaps = 1;//
	    if (itext[i] == ':' && itext[i++] == 'D') AntiCaps = 0;//Спасение смайла ':D'
	    //Предыдущие три проверки проверяют, что символ в верхнем регистре
	    if (AntiCaps == 1)
	    {//Если символ в верхнем регистре
	        if (itext[i++] > 64 && itext[i++] < 91) AntiCaps = 2; //Если два символа подряд в верхнем регистре eng
		    if (itext[i] > 191 && itext[i] < 224) AntiCaps = 2; //Если два символа подряд в верхнем регистре rus
		    if(itext[i++] == 168) AntiCaps = 184; //Если два символа подряд в верхнем регистре Ё
		    if (AntiCaps == 1) AntiCaps = 0;//Если второй символ был маленьким (например "Текст")
	    }//Если символ в верхнем регистре
	}//--- Цифры в тексте

	if (AntiCaps == 2)
	{//Если два символа подряд были написаны в верхнем регистре
	    for (new i; i < strlen(itext); i++)
		{
			if (itext[i] > 64 && itext[i] < 91) itext[i] += 32; //eng
			if (itext[i] > 191 && itext[i] < 224) itext[i] += 32;//rus
			if(itext[i] == 168) itext[i] = 184;//Ё
		}
	}//Если два символа подряд были написаны в верхнем регистре
	
	//антифлуд
	if (FloodTime[playerid] == 0) FloodTime[playerid] = 5;
	FloodMessages[playerid] += 1;
	if (FloodMessages[playerid] >= 3)
	{
		SendClientMessage(playerid, COLOR_GREY, "Не флуди!");
		return 0;
	}
	//антифлуд

	if(strfind(text, "!", true) == 0)
	{//клану
		if (Player[playerid][Member] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане."); return 0;}
		strdel(text, 0, 1);new stext[300]/*,clanid = Player[playerid][MyClan],ccolor = Clan[clanid][cColor]*/;
		format(stext, 300, "%s(%d) [БАНДЕ]: %s", Name, playerid, text);
		foreach(Player, cid) if (Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1){SendClientMessage(cid, COLOUR_GANG_CHAT, stext);}
		//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
        format(text, 300, "%d.%d.%d в %d:%d:%d |   [КЛАНУ]%s[%d]: %s", Day, Month, Year, hour, minute, second, Name, playerid, text);WriteLog("GlobalLog", text);
		return 0;
	}//клану

	if(strfind(text, "#", true) == 0 || strfind(text, "№", true) == 0)
	{//шепот
	    if (LSpecID[playerid] != -1 && Player[playerid][Admin] < 1){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Только модераторы и выше могут писать шепотом в режиме слежки."); return 0;}
		new Float: sx, Float: sy, Float: sz;strdel(text, 0, 1);
		if(LSpecID[playerid] == -1) SetPlayerChatBubble(playerid, text, 0xB5BBFDFF, 50.0, 4000);
		new stext[300];format(stext, 300, "{B5BBFD}# [ШЕПОТОМ]%s[{FFFFFF}%d{B5BBFD}]: {FFFFFF}%s", Name, playerid, text);
		GetPlayerPos(playerid,sx,sy,sz);
		foreach(Player, cid) if (PlayerToPoint(50.0, cid, sx, sy, sz) && GetPlayerVirtualWorld(cid) == GetPlayerVirtualWorld(playerid)) SendClientMessage(cid, -1, stext);
		//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
        format(text, 300, "%d.%d.%d в %d:%d:%d |   [ШЕПОТОМ]%s[%d]: %s", Day, Month, Year, hour, minute, second, Name, playerid, text);WriteLog("GlobalLog", text);
		return 0;
	}//шепот

	if(strfind(text, "@", true) == 0 || text[0] == 34)
	{//админам
		if(GetPVarInt(playerid, "AdmKD") > unixtime)
		{
		    new string[120];
			format(string, sizeof(string), "{00BFFF}Репорт будет доступен через {FFFFFF}%d{00BFFF} секунд.", GetPVarInt(playerid, "AdmKD") - unixtime);
			SendClientMessage(playerid,-1,string);
			return 0;
		}
		strdel(text, 0, 1);
		new stext[300];
		format(stext, 300, "{FFFFFF}@ {00BFFF}[АДМИНАМ]%s[%d]: %s", Name, playerid, text);
		if (Player[playerid][Admin] == 0){SendClientMessage(playerid,COLOR_ADMIN,"Ваше сообщение отправлено администраторам"); SetPVarInt(playerid, "AdmKD", unixtime+15);}
		foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1){SendClientMessage(cid, -1, stext);}
		//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
        format(text, 300, "%d.%d.%d в %d:%d:%d |   [АДМИНАМ]%s[%d]: %s", Day, Month, Year, hour, minute, second, Name, playerid, text);WriteLog("GlobalLog", text);
		return 0;
	}//админам

	if (Player[playerid][GPremium] >= 2)
	{//--- Р Р°Р·РЅРѕС†РІРµС‚РЅС‹Р№ С‡Р°С‚
	    new counter = 0;
		while (strfind(itext, "*", true) != -1 && counter < 5) //РЅРµ Р±РѕР»РµРµ 5 С†РІРµС‚РѕРІ - СЌС‚Рѕ РІР°Р¶РЅРѕ!
		{//Р•СЃР»Рё РЅР°С€Р»Рѕ "*" РІ С‚РµРєСЃС‚Рµ
		    new i = strfind(itext, "*", true),rtime = PremiumTime[playerid] - unixtime;
			counter++;
			if (rtime > 0)
			{
				new string[120];
				format(string, sizeof(string), "{FF0000}Цветной чат доступен через {FFFFFF}%d{FF0000} секунд.", rtime);
				SendClientMessage(playerid,COLOR_RED,string);
				break;
			}
			if (Player[playerid][Admin] < 4) Need60Sec = 1;

		    if (itext[i + 1] == '1')
		    {// *1 - красный
				strdel(itext, i, i + 2);//удал. код цвета
				strins(itext, "{FF0000}", i, 300);continue;
		    }// *1 - красный
			if (itext[i + 1] == '2')
			{// *2 - синий
				strdel(itext, i, i + 2);
				strins(itext, "{3399FF}", i, 300);continue;
			}// *2 - синий
			if (itext[i + 1] == '3')
			{// *3 - Р·РµР»РµРЅС‹Р№
				strdel(itext, i, i + 2);
				strins(itext, "{00FF00}", i, 300);continue;
			}// *3 - Р·РµР»РµРЅС‹Р№
			if (itext[i + 1] == '4')
			{// *4 - Р¶РµР»С‚С‹Р№
				strdel(itext, i, i + 2);
				strins(itext, "{FFFF00}", i, 300);continue;
			}// *4 - Р¶РµР»С‚С‹Р№
			if (itext[i + 1] == '5')
			{// *5 - РєРёРІРё
				strdel(itext, i, i + 2);
				strins(itext, "{CCFF00}", i, 300);continue;
			}// *5 - РєРёРІРё
			if (itext[i + 1] == '6')
			{// *6 - Р°РєРІР°
				strdel(itext, i, i + 2);
				strins(itext, "{24F7FE}", i, 300);continue;
			}// *6 - Р°РєРІР°
			if (itext[i + 1] == '7')
			{// *7 - СЂРѕР·РѕРІС‹Р№
				strdel(itext, i, i + 2);
				strins(itext, "{F935F9}", i, 300);continue;
			}// *7 - СЂРѕР·РѕРІС‹Р№
			if (itext[i + 1] == '8')
			{// *8 - РєРІРµСЃС‚
				strdel(itext, i, i + 2);
				strins(itext, "{FFCC00}", i, 300);continue;
			}// *8 - РєРІРµСЃС‚
			if (itext[i + 1] == '9')
			{// *9 - РєРѕСЂРёС‡РЅРµРІС‹Р№
				strdel(itext, i, i + 2);
				strins(itext, "{976D3D}", i, 300);continue;
			}// *9 - РєРѕСЂРёС‡РЅРµРІС‹Р№

           if (itext[i + 1] == '!' && itext[i + 2] == '1')
		   {// **1 - РґРј
				strdel(itext, i, i + 3);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
				strins(itext, "{FF8C00}", i, 300);continue;
		    }// **1 - РґРј
		    if (itext[i + 1] == '!' && itext[i + 2] == '2')
			{// **2 - РґРµСЂР±Рё
				strdel(itext, i, i + 3);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
				strins(itext, "{9966CC}", i, 300);continue;
		    }// **2 - РґРµСЂР±Рё
		    if (itext[i + 1] == '!' && itext[i + 2] == '3')
			{// **3 - Р·РѕРјР±Рё
				strdel(itext, i, i + 3);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
				strins(itext, "{E60020}", i, 300);continue;
		    }// **3 - Р·РѕРјР±Рё
		    if (itext[i + 1] == '!' && itext[i + 2] == '4')
			{// **4 - РіРѕРЅРєР°
				strdel(itext, i, i + 3);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
				strins(itext, "{007FFF}", i, 300);continue;
		    }// **4 - РіРѕРЅРєР°
		    if (itext[i + 1] == '!' && itext[i + 2] == '5')
		    {// **5 - Р»РµРіРµРЅРґР°СЂРЅР°СЏ РіРѕРЅРєР°
				strdel(itext, i, i + 3);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
				strins(itext, "{FFD700}", i, 300);continue;
		    }// **5 - Р»РµРіРµРЅРґР°СЂРЅР°СЏ РіРѕРЅРєР°
		    if (itext[i + 1] == '!' && itext[i + 2] == '6')
		    {// **6 - РіР°РЅРіРµР№Рј
				strdel(itext, i, i + 3);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
				strins(itext, "{FF6666}", i, 300);continue;
		    }// **6 - РіР°РЅРіРµР№Рј
			if (itext[i + 1] == '!' && itext[i + 2] == '7')
		    {// **7 - tdm
				strdel(itext, i, i + 3);//ГіГ¤Г Г«ГїГҐГІГ±Гї ГЄГ®Г¤ Г¶ГўГҐГІГ 
				strins(itext, "{04B486}", i, 300);continue;
		    }// **7 - tdm
			//Р•СЃР»Рё РЅРµ Р±С‹Р» РІРІРµРґРµРЅ РЅРё РѕРґРёРЅ РёР· РєРѕРґРѕРІ РІС‹С€Рµ (РїСЂРѕСЃС‚Рѕ * СЃ С‚РµРєСЃС‚РѕРј)
			strdel(itext, i, i + 1);//СѓРґР°Р»СЏРµС‚СЃСЏ РєРѕРґ С†РІРµС‚Р°
			strins(itext, "{FFFFFF}", i, 300);//Р±РµР»С‹Р№
		}//Р•СЃР»Рё РЅР°С€Р»Рѕ "*" РІ С‚РµРєСЃС‚Рµ
	}//--- Р Р°Р·РЅРѕС†РІРµС‚РЅС‹Р№ С‡Р°С‚
	new colorid = PlayerColor[playerid], clanid = Player[playerid][MyClan];
	if(clanid == 0 || Clan[clanid][cLevel] < 20 || Player[playerid][Tag] == 0)
	{
		format(itext, 300, "%s{FFFFFF}[%d]: %s", ChatName[playerid], playerid, itext);
	}
	else
	{
		if(strcmp(Clan[clanid][cTag], "Пусто", true)) format(itext, 300, "%s %s{FFFFFF}[%d]: %s", Clan[clanid][cTag], ChatName[playerid], playerid, itext);
		else format(itext, 300, "%s{FFFFFF}[%d]: %s", ChatName[playerid], playerid, itext);
	}
	
	if (clanid < 1 || Clan[clanid][cBase] < 1) colorid = 0; //Если игрок не в клане или если у клана нет штаба - цвет ника будет серым

	if(strlen(itext) > 140)
	{
		new itext2[165];
		strmid(itext2, itext, 140, 300);
		strdel(itext,140,300);
		strins(itext2,"~ {FFFFFF}",0,10);
		SendClientMessageToAll(ClanColor[colorid], itext);
		SendClientMessageToAll(COLOR_RED, itext2);
	}
	else SendClientMessageToAll(ClanColor[colorid], itext);
	//else
	//	{
	//		if(ChatOff == 0 || Player[playerid][Level] > 9)
	//		{
	//else			SendClientMessageToAll(ClanColor[colorid], itext);
	//		}
			//else ChatHere(playerid, itext, ClanColor[colorid]);
	//	}

	if (Need60Sec == 1)
	{
		if(Player[playerid][SPN3] == 0) PremiumTime[playerid] = unixtime+60;
		else PremiumTime[playerid] = unixtime+10;
		Need60Sec = 0;
	}
	//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
	format(text, 300, "%d.%d.%d в %d:%d:%d |   %s[%d]: %s", Day, Month, Year, hour, minute, second, Name, playerid, text);WriteLog("GlobalLog", text);
	return 0;
}

public OnPlayerEnterVehicle(playerid, vehicleid, ispassenger)
{
	/*new String2[140];
	format(String2,sizeof(String2), "Player: %d, Vehicle: %d, Passenger: %d",playerid, vehicleid, ispassenger);
	SendClientMessageToAll(COLOR_GREY,String2);*/

    if (OnFly[playerid] == 1) StopFly(playerid);

    if (ispassenger == 0)
    {//Садится на водительское сидение
        foreach(Player, cid)
        {
            if (IsPlayerInVehicle(cid, vehicleid) && GetPlayerVehicleSeat(cid) == 0)
            {//кто-то уже сидит за рулем
                SetVehicleParamsForPlayer(vehicleid, playerid, 0, 1);SetVehicleParamsForPlayer(vehicleid, cid, 0, 1);
				SetTimerEx("UnLock" , 5000, false, "dd", playerid,vehicleid);SetTimerEx("UnLock" , 5000, false, "dd", cid,vehicleid);
				SendClientMessage(playerid,COLOR_RED,"Нельзя отбирать транспорт у других игроков! Нажмите {FFFFFF}Alt{FF0000} чтобы вызвать свой!");
            }//кто-то уже сидит за рулем
        }
    }//Садится на водительское сидение

    for(new vid = 1; vid <= 35; vid++)
	{//угон авто - наземный транспорт
	    if (vehicleid == StealCar[vid])
	    {//если игрок оказался в авто, которое надо угнать
	        StealCarModel[playerid] = GetVehicleModel(vehicleid);
	        if (vid <= 25)
	        {//Наземные авто
				new qcol1, qcol2, qmodel = GetVehicleModel(StealCar[vid]);GetVehicleColor(StealCar[vid],qcol1,qcol2);
				new Float: qx, Float: qy, Float: qz, Float: qa;GetVehiclePos(StealCar[vid],qx,qy,qz);GetVehicleZAngle(StealCar[vid], qa);
				DestroyVehicle(StealCar[vid]);DestroyDynamicMapIcon(StealCarMapIcon[vid]);

				//пересоздание того авто в другом месте
				new rrand1 = random(sizeof(CarStealSpawns)), rcol1 = random(256), rcol2 = random(256), rmodeld = random(133); new rmodel = StealCars[rmodeld];
				StealCar[vid] = LCreateVehicle(rmodel, CarStealSpawns[rrand1][0], CarStealSpawns[rrand1][1], CarStealSpawns[rrand1][2], CarStealSpawns[rrand1][3], rcol1, rcol2, 0);
	  		 	StealCarMapIcon[vid] = CreateDynamicMapIcon(CarStealSpawns[rrand1][0], CarStealSpawns[rrand1][1], CarStealSpawns[rrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

				//Авто для игрока для выполнения задания
				if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя угонять транспорт во время выполнения работы!");
				QuestCar[playerid] = LCreateVehicle(qmodel, qx, qy, qz, qa, qcol1, qcol2, 0);
				PutPlayerInVehicle(playerid, QuestCar[playerid], 0); PlayerCarID[playerid] = -1;

		        new modelid = qmodel - 400, String[120];
				format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[modelid], GetVehicleMaxSpeed(QuestCar[playerid]) * 500);
		        ShowPlayerDialog(playerid, DIALOG_STEALCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}1{FFFFFF}-го класса\nСделать личным транспортом {007FFF}2{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
			}//Наземные авто
			else if (vid <= 30)
			{//Водные авто
			    new qcol1, qcol2, qmodel = GetVehicleModel(StealCar[vid]);GetVehicleColor(StealCar[vid],qcol1,qcol2);
				new Float: qx, Float: qy, Float: qz, Float: qa;GetVehiclePos(StealCar[vid],qx,qy,qz);GetVehicleZAngle(StealCar[vid], qa);
				DestroyVehicle(StealCar[vid]);DestroyDynamicMapIcon(StealCarMapIcon[vid]);

				//пересоздание того авто в другом месте
				new rrand1 = random(sizeof(CarStealWaterSpawns)), rcol1 = random(256), rcol2 = random(256), rmodeld = random(11); new rmodel = StealWaterCars[rmodeld];
				StealCar[vid] = LCreateVehicle(rmodel, CarStealWaterSpawns[rrand1][0], CarStealWaterSpawns[rrand1][1], CarStealWaterSpawns[rrand1][2], CarStealWaterSpawns[rrand1][3], rcol1, rcol2, 0);
	  		 	StealCarMapIcon[vid] = CreateDynamicMapIcon(CarStealWaterSpawns[rrand1][0], CarStealWaterSpawns[rrand1][1], CarStealWaterSpawns[rrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

				//Авто для игрока для выполнения задания
				if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя угонять транспорт во время выполнения работы!");
				QuestCar[playerid] = LCreateVehicle(qmodel, qx, qy, qz, qa, qcol1, qcol2, 0);
				PutPlayerInVehicle(playerid, QuestCar[playerid], 0); PlayerCarID[playerid] = -1;

		        new modelid = qmodel - 400, String[120];
				format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[modelid], GetVehicleMaxSpeed(QuestCar[playerid]) * 500);
		        ShowPlayerDialog(playerid, DIALOG_STEALWATERCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}3{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
			}//Водные авто
			else if (vid <= 35)
			{//Воздушное авто
			    new qcol1, qcol2, qmodel = GetVehicleModel(StealCar[vid]);GetVehicleColor(StealCar[vid],qcol1,qcol2);
				new Float: qx, Float: qy, Float: qz, Float: qa;GetVehiclePos(StealCar[vid],qx,qy,qz);GetVehicleZAngle(StealCar[vid], qa);
				DestroyVehicle(StealCar[vid]);DestroyDynamicMapIcon(StealCarMapIcon[vid]);

				//пересоздание того авто в другом месте
				new rrand1 = random(sizeof(CarStealAirSpawns)), rcol1 = random(256), rcol2 = random(256), rmodeld = random(13); new rmodel = StealAirCars[rmodeld];
				StealCar[vid] = LCreateVehicle(rmodel, CarStealAirSpawns[rrand1][0], CarStealAirSpawns[rrand1][1], CarStealAirSpawns[rrand1][2], CarStealAirSpawns[rrand1][3], rcol1, rcol2, 0);
	  		 	StealCarMapIcon[vid] = CreateDynamicMapIcon(CarStealAirSpawns[rrand1][0], CarStealAirSpawns[rrand1][1], CarStealAirSpawns[rrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);

				//Авто для игрока для выполнения задания
				if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя угонять транспорт во время выполнения работы!");
				QuestCar[playerid] = LCreateVehicle(qmodel, qx, qy, qz, qa, qcol1, qcol2, 0);
				PutPlayerInVehicle(playerid, QuestCar[playerid], 0); PlayerCarID[playerid] = -1;

		        new modelid = qmodel - 400, String[120];
				format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[modelid], GetVehicleMaxSpeed(QuestCar[playerid]) * 2000);
		        ShowPlayerDialog(playerid, DIALOG_STEALAIRCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}3{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
			}//Воздушное авто
		}//если игрок оказался в авто, которое надо угнать
	}//угон авто - наземный транспорт

	return 1;
}

public OnPlayerExitVehicle(playerid, vehicleid)
{
    if (Player[playerid][Level] == 0)
	{//Игрок вышел из машины в режиме обучения.
	    if (TutorialObject[playerid] != -1){DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;}
	    TutorialObject[playerid] = CreateObject(19482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
    	SetObjectMaterialText(TutorialObject[playerid], "{FFFF00}Обучение\n{FFFFFF}Нажмите {00FF00}Alt", 0, OBJECT_MATERIAL_SIZE_512x512, "Tahoma", 50, 1, 0xFFFFFFFF, 0x00, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
        AttachObjectToPlayer(TutorialObject[playerid], playerid, 0.0, 0.0, 1.2, 0.0, 0.0, 270);
	}//Игрок вышел из машины в режиме обучения.
	return 1;
}

public OnPlayerStateChange(playerid, newstate, oldstate)
{
    if ((oldstate != 1 && newstate == 1) && (JoinEvent[playerid] == EVENT_RACE || JoinEvent[playerid] == EVENT_XRACE)) return SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Нажмите клавишу {FFFFFF}Alt{00CCCC} чтобы вызвать транспорт в гонке.");
	if (LSpectators[playerid] > 0) {SpecUpdate(playerid);}//обновление спектра у тех, кто за игроком следил
    if (oldstate == PLAYER_STATE_DRIVER) Player[playerid][CarActive] = 0; //Исправляет возможность использования навыков после выхода из своего авто

	if(newstate == PLAYER_STATE_DRIVER || newstate == PLAYER_STATE_PASSENGER)
    {//делает возможным пользоваться только смг, находясь в транспорте
        new Weap[2];
        GetPlayerWeaponData(playerid, 4, Weap[0], Weap[1]); // Get the players SMG weapon in slot 4
        SetPlayerArmedWeapon(playerid, Weap[0]); // Set the player to driveby with SMG
        SetTimerEx("SpeedoUpdate" , 500, false, "i", playerid);//включает спидометр
    }//делает возможным пользоваться только смг, находясь в транспорте

	if ((newstate == 0) && Player[playerid][Level] == 0)
	{//Игрок вышел из машины в режиме обучения.
	    if (TutorialObject[playerid] != -1){DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;}
	    TutorialObject[playerid] = CreateObject(19482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
    	SetObjectMaterialText(TutorialObject[playerid], "{FFFF00}Обучение\n{FFFFFF}Нажмите {00FF00}Alt", 0, OBJECT_MATERIAL_SIZE_512x512, "Tahoma", 50, 1, 0xFFFFFFFF, 0x00, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
        AttachObjectToPlayer(TutorialObject[playerid], playerid, 0, 0, 1.2, 0, 0, 270);
	}//Игрок вышел из машины в режиме обучения.

	return 1;
}

public OnPlayerEnterCheckpoint(playerid)
{
    //new String2[140], Float: dist;
	//format(String2,sizeof(String2), "CoordX: %.3f, CoordY: %.3f, CoordZ: %.3f",CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]);
	//SendClientMessageToAll(COLOR_GREY,String2);
	//GetPlayerPos(playerid,x1,y1,z1);
	//format(String2,sizeof(String2), "PX: %.3f, PY: %.3f, PZ: %.3f",x1,y1,z1);
	//SendClientMessageToAll(COLOR_GREY,String2);
	//dist = GetPlayerDistanceFromPoint(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]);
	//format(String2,sizeof(String2), "Distance: %.3f",dist);
	//SendClientMessageToAll(COLOR_GREY,String2);

	if (GetPlayerDistanceFromPoint(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]) > 16.0 || GetPlayerDistanceFromPoint(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]) <= 1.0) return 0;
	//if (GetPlayerDistanceFromPoint(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]) > 16.0) return 0;

	if (GPSUsed[playerid] == 1)
	{//GPS чекпоинт
	    DisablePlayerCheckpoint(playerid); GPSUsed[playerid] = 0; PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
	    return SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Вы достигли места назначения.");
	}//GPS чекпоинт

	if (FRTimer <= -1 && FRStarted[playerid] == 1)
	{//чекпоинт финиша гонки
		new String[140];FarmedXP[playerid] = 200 + 35 * (FRPlayers-1); FarmedMoney[playerid] = 2500 + 500 * (FRPlayers-1);FRpos += 1;
		if (FRpos == 1){FarmedXP[playerid] += 200;format(String,sizeof(String),"%s[%d] выиграл гонку и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_RACE,String); MarafonUpdate(playerid, 2, 1);}
		if (FRpos == 2){FarmedXP[playerid] += 130;format(String,sizeof(String),"%s[%d] финишировал вторым в гонке и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_RACE,String);}
		if (FRpos == 3){FarmedXP[playerid] += 65;format(String,sizeof(String),"%s[%d] финишировал третьим в гонке и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_RACE,String);}
		if (FRpos > 3)
		{
			//FarmedXP[playerid] = 200; FarmedMoney[playerid] = 2500;
			format(String,sizeof(String),"Вы финишировали %d-ым и получили %d XP и %d$",FRpos,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessage(playerid,COLOR_RACE,String);
		}
		FRPlayers -= 1;Player[playerid][Cash] += FarmedMoney[playerid]; LGiveXP(playerid, FarmedXP[playerid]);

		MarafonUpdate(playerid, 5, FarmedMoney[playerid]);
		MarafonUpdate(playerid, 0, 1);

		FRStarted[playerid] = 0; JoinEvent[playerid] = 0; InEvent[playerid] = 0;
		DestroyVehicle(FRCarID[playerid]); FRCarID[playerid] = 0;
		SetPlayerVirtualWorld(playerid,0);DisablePlayerCheckpoint(playerid);LSpawnPlayer(playerid);
        //DisableRemoteVehicleCollisions(playerid, 0);
        ShowClanZones(playerid); // покажем клановые зоны
		PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
		QuestUpdate(playerid, 14, 1);//Обновление квеста Примите участие в 3 гонках
		QuestUpdate(playerid, 18, 1);//Обновление квеста Примите участие в 3 соревнованиях
		//mrf

		return 1;
	}//чекпоинт финиша гонки


	if (PRTimer <= -1 && PRStarted[playerid] == 1)
	{// parkour
	   	PRPlayerLastCP[playerid]++;
    	//DestroyDynamicPickup(PRPickup[playerid]);
    	if(PRPlayerLastCP[playerid] == ParkCPS[PRid]-1)
	    {
			new String[140];
			FarmedXP[playerid] = 300 + 35 * (PRPlayers-1);
			FarmedMoney[playerid] = 2500 + 700 * (PRPlayers-1);
			PRpos += 1;
			//new year
			//if(PRid == 6) {FarmedXP[playerid] = FarmedXP[playerid]*2; FarmedMoney[playerid] = FarmedMoney[playerid]*2;}

			if (PRpos == 1){FarmedXP[playerid] += 300;format(String,sizeof(String),"%s[%d] выиграл паркур и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_PARK,String); MarafonUpdate(playerid, 2, 1);}
			if (PRpos == 2){FarmedXP[playerid] += 160;format(String,sizeof(String),"%s[%d] финишировал вторым в паркуре и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_PARK,String);}
			if (PRpos == 3){FarmedXP[playerid] += 100;format(String,sizeof(String),"%s[%d] финишировал третьим в паркуре и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_PARK,String);}
			if (PRpos > 3)
			{
				format(String,sizeof(String),"Вы финишировали %d-ым и получили %d XP и %d$",PRpos,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessage(playerid,COLOR_RACE,String);
			}

			MarafonUpdate(playerid, 5, FarmedMoney[playerid]);
			MarafonUpdate(playerid, 0, 1);

            DisablePlayerCheckpoint(playerid);
			PRPlayers -= 1;
			Player[playerid][Cash] += FarmedMoney[playerid];
			LGiveXP(playerid, FarmedXP[playerid]);
			PRStarted[playerid] = 0; JoinEvent[playerid] = 0; InEvent[playerid] = 0;
			SetPlayerVirtualWorld(playerid,0);

			LSpawnPlayer(playerid);
			ShowClanZones(playerid); // покажем клановые зоны
			PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
			QuestUpdate(playerid, 18, 1);//Обновление квеста Примите участие в 3 соревнованиях
			QuestUpdate(playerid, 32, 1);//Обновление квеста Примите участие в 3 паркурах
		}
		else
		{
	    	new CPid = PRPlayerLastCP[playerid]+1;
	    	new string[140];
			format(string, sizeof string, "Контрольная точка: {ff0000}%d {58FAF4}/ {ff0000}%d",CPid,ParkCPS[PRid]);
			SendClientMessage(playerid,COLOR_PARK,string);
			//format(string, sizeof string, "PickupID: %d", PRPickup[playerid]);
			//SendClientMessage(playerid,COLOR_PARK,string);
			PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
			switch (PRid)
			{
				case 1: SetPlayerCheckpoint(playerid, ParkCoord1[CPid][0], ParkCoord1[CPid][1], ParkCoord1[CPid][2], 8.0);
				case 2:	SetPlayerCheckpoint(playerid, ParkCoord2[CPid][0], ParkCoord2[CPid][1], ParkCoord2[CPid][2], 8.0);
   				case 3: SetPlayerCheckpoint(playerid, ParkCoord3[CPid][0], ParkCoord3[CPid][1], ParkCoord3[CPid][2], 8.0);
   				case 4: SetPlayerCheckpoint(playerid, ParkCoord4[CPid][0], ParkCoord4[CPid][1], ParkCoord4[CPid][2], 8.0);
   				case 5: SetPlayerCheckpoint(playerid, ParkCoord5[CPid][0], ParkCoord5[CPid][1], ParkCoord5[CPid][2], 8.0);
   				case 6: SetPlayerCheckpoint(playerid, ParkCoord6[CPid][0], ParkCoord6[CPid][1], ParkCoord6[CPid][2], 8.0);
			}
		}
	}


	if (QuestActive[playerid] == 3 && InEvent[playerid] == 0)
	{//Грузчик
		if(GetPVarInt(playerid,"WorkStage") == 1)// Если момент работы игрока 1..
	    {//взл груз
	    	new checku = random(sizeof GRUZTO);// Рандомно выдаём координаты куда нести груз
	        SetPlayerCheckpoint(playerid,GRUZTO[checku][0],GRUZTO[checku][1],GRUZTO[checku][2],1.5);// Создаём один из чекпоинтов
	        ApplyAnimation(playerid,"CARRY","crry_prtial",4.1,0,1,1,1,1);// Анимация, типо что то несём..
	        SetPVarInt(playerid,"WorkStage",2);// Устанавливаем момент работы игрока на 2..
	        new objectr = random(3);// Выдаём в руки объект
	        if(objectr == 0) return SetPlayerAttachedObject(playerid,8,1221,1,0.135011,0.463495,-0.024351,357.460632,87.350753,88.068374,0.434164,0.491270,0.368655);
	        if(objectr == 1) return SetPlayerAttachedObject(playerid,8,2226,1,0.000708,0.356461,0.000000,186.670364,87.529838,0.000000,1.000000,1.000000,1.000000);
	        if(objectr == 2) return SetPlayerAttachedObject(playerid,8,1750,1,0.013829,0.131155,0.145773,185.651550,86.201354,345.922180,0.693442,0.873942,0.577291);
	    }//взл груз
	    if(GetPVarInt(playerid,"WorkStage") == 2)
	    {//отдал груз
	        new checkp = random(sizeof GRUZFROM); WorkTimeGruz[playerid] = 0;
	        SetPlayerCheckpoint(playerid,GRUZFROM[checkp][0],GRUZFROM[checkp][1],GRUZFROM[checkp][2],1.5);// Создаём один из чекпоинтов
	        RemovePlayerAttachedObject(playerid,8);// Удаляем объект из рук
	        ApplyAnimation(playerid,"PED","IDLE_tired",4.1,0,1,1,0,1);// Обнуляем анимацию
	        SetPVarInt(playerid,"WorkStage",1);// Устанавливаем момент работы игрока на 1..
	        SetPVarInt(playerid,"WorkCount",GetPVarInt(playerid,"WorkCount")+1);// Прибавим к вещам игрока 1
	 		if (GetPVarInt(playerid,"WorkCount") == 10)
	 		{//Перенес 10 грузов
	 		    new str[128], wxp = WorkTime[playerid] * 3/4, wcash = WorkTime[playerid] * 30;
	 		    SetPVarInt(playerid,"WorkCount", 0); WorkTime[playerid] = 0;
		        format(str,sizeof(str),"Работа: Вы получили %d XP и %d$ за перенос 10 грузов.", wxp, wcash);
		        SendClientMessage(playerid,COLOR_QUEST, str); LGiveXP(playerid, wxp); Player[playerid][Cash] += wcash;
		        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
	        }//Перенес 10 грузов
	    }//отдал груз
    }//Грузчик

    if (QuestActive[playerid] == 4 && InEvent[playerid] == 0)
    {//Домушник
        if (GetPVarInt(playerid, "WorkDomStage") == 1)
        {//Подошел к дому, который нужно обокрасть
            SetPlayerAttachedObject(playerid,8,3026,1,-0.176000, -0.066000, 0.0000,0.0000, 0.0000, 0.0000, 1.07600, 1.079999, 1.029000);//Рюкзак с краденым
			SetPVarInt(playerid, "WorkDomStage", 2); SetPlayerCheckpoint(playerid, -1945.5354, -1085.3024, 30.8479, 8.0);
			return SendClientMessage(playerid,COLOR_QUEST, "Работа: Ты обчистил дом! Вези награбленное к {FF0000}скупщику{FFCC00}.");
        }//Подошел к дому, который нужно обокрасть
        if (GetPVarInt(playerid, "WorkDomStage") == 2)
        {//Привез товар к скупщику
            RemovePlayerAttachedObject(playerid,8);// Удаляем рюкзак с краденым
            new String[120], wxp, wcash; //Зарплата в час: 2880 xp и 360 000$ => в секунду: 4/5xp и 100$
			if (WorkTime[playerid] <= 720) {wxp = WorkTime[playerid] * 4/5; wcash = WorkTime[playerid] * 100;}
			else {wxp = 576; wcash = 36000;}//Не более 12 минут на один заход. Если больше - выдаем хр за 12 минут и вдвое меньше денег
			format(String, sizeof String, "Работа: Вы получили %d XP и %d$ за сбыт краденых вещей.", wxp, wcash);
			SendClientMessage(playerid, COLOR_QUEST, String); LGiveXP(playerid, wxp); Player[playerid][Cash] += wcash;
			PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
            //Ниже выдаем новый заказ
            new rand = random(MAX_PROPERTY); if (rand == 0) rand++;//Выбираем дом для ограбления
            if (rand == Player[playerid][Home]) {if (rand > 1) rand--; else rand++;}//Выбрался дом грабителя - исправляем
            SetPVarInt(playerid, "WorkDomStage", 1); WorkTime[playerid] = 0;
            if (QuestCar[playerid] != -1) {RepairVehicle(QuestCar[playerid]); SetVehicleZAngle(QuestCar[playerid], 0); SetPlayerChatBubble(playerid, "Транспорт отремонтирован", COLOR_GREEN, 300.0, 3000);}
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Обчисти {FF0000}дом{FFCC00} и привези награбленное сюда!");
            SetPlayerCheckpoint(playerid,Property[rand][pPosEnterX],Property[rand][pPosEnterY],Property[rand][pPosEnterZ],2);
        }//Привез товар к скупщику
    }//Домушник

    if (QuestActive[playerid] == 6 && InEvent[playerid] == 0)
    {//Дальнобойщик
        if (GetPVarInt(playerid, "WorkTruckStage") == 1)
        {//Доставил груз
            new vehicleid = GetPlayerVehicleID(playerid);
            if (TrailerID[vehicleid] > -1) {DestroyVehicle(TrailerID[vehicleid]); TrailerID[vehicleid] = -1;}//Убираем трейлер у фуры
			SetPVarInt(playerid, "WorkTruckStage", 2); SetPlayerCheckpoint(playerid, 2453.7183, -2089.3940, 14.5622, 8.0);
			return SendClientMessage(playerid,COLOR_QUEST, "Работа: Ты доставил груз. Возвращайся за {FF0000}зарплатой{FFCC00}.");
        }//Доставил груз
        if (GetPVarInt(playerid, "WorkTruckStage") == 2)
        {//Приехал за зарплатой
            new String[120], wxp, wcash; // 3420xp/час   540 000$/час   19/20хр в секунду   150$ в секунду
			if (WorkTime[playerid] <= 720) {wxp = WorkTime[playerid] * 19/20; wcash = WorkTime[playerid] * 150;}
			else {wxp = 684; wcash = 54000;}//Не более 12 минут на один заход. Если больше - выдаем хр за 12 минут и вдвое меньше денег
			format(String, sizeof String, "Работа: Вы получили %d XP и %d$ за доставку груза.", wxp, wcash);
			SendClientMessage(playerid, COLOR_QUEST, String); LGiveXP(playerid, wxp); Player[playerid][Cash] += wcash;
			PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
            //Ниже выдаем новый заказ
            if (QuestCar[playerid] != -1) {SetVehicleZAngle(QuestCar[playerid], 90); CallTrailer(QuestCar[playerid], 584); RepairVehicle(QuestCar[playerid]); SetPlayerChatBubble(playerid, "Транспорт отремонтирован", COLOR_GREEN, 300.0, 3000);}
            SetPVarInt(playerid, "WorkTruckStage", 1); WorkTime[playerid] = 0;
            new rand = random(sizeof WORKTRUCK);//Выбираем место доставки груза
            SetPlayerCheckpoint(playerid,WORKTRUCK[rand][0], WORKTRUCK[rand][1], WORKTRUCK[rand][2], 10);
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Доставь груз до {FF0000}места назначения{FFCC00} и вернись за зарплатой!");
        }//Приехал за зарплатой
    }//Дальнобойщик

    if (QuestActive[playerid] == 7 && InEvent[playerid] == 0)
    {//Капитан Корабля
        if (GetPVarInt(playerid, "WorkWaterStage") == 1)
        {//Доставил груз
 			SetPVarInt(playerid, "WorkWaterStage", 2); SetPlayerCheckpoint(playerid, -1759.8169,-192.7360,0.0, 8.0);
			return SendClientMessage(playerid,COLOR_QUEST, "Работа: Ты доставил груз. Возвращайся за {FF0000}зарплатой{FFCC00}.");
        }//Доставил груз
        if (GetPVarInt(playerid, "WorkWaterStage") == 2)
        {//Приехал за зарплатой
            new String[120], wxp, wcash; // 3600xp/час   396 000$/час   1хр в секунду   110$ в секунду
			if (WorkTime[playerid] <= 480) {wxp = WorkTime[playerid]; wcash = WorkTime[playerid] * 110;}
			else {wxp = 480; wcash = 26400;}//Не более 12 минут на один заход. Если больше - выдаем хр за 12 минут и вдвое меньше денег
			format(String, sizeof String, "Работа: Вы получили %d XP и %d$ за доставку груза.", wxp, wcash);
			SendClientMessage(playerid, COLOR_QUEST, String); LGiveXP(playerid, wxp); Player[playerid][Cash] += wcash;
			PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
            //Ниже выдаем новый заказ
		    if (QuestCar[playerid] != -1) {SetVehicleZAngle(QuestCar[playerid], 270); RepairVehicle(QuestCar[playerid]); SetPlayerChatBubble(playerid, "Транспорт отремонтирован", COLOR_GREEN, 300.0, 3000);}
            SetPVarInt(playerid, "WorkWaterStage", 1); WorkTime[playerid] = 0;
			new rand = random(sizeof WORKWATER);//Выбираем место доставки груза
            SetPlayerCheckpoint(playerid,WORKWATER[rand][0], WORKWATER[rand][1], WORKWATER[rand][2], 10);
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Доставь груз до {FF0000}места назначения{FFCC00} и вернись за зарплатой!");
        }//Приехал за зарплатой
    }//Капитан Корабля

    if (QuestActive[playerid] == 8 && InEvent[playerid] == 0)
    {//Инкассатор
        if (GetPVarInt(playerid, "WorkBankStage") == 1)
        {//Подошел к штабу, с которого нужно взять деньги
			SetPVarInt(playerid, "WorkBankStage", 2); SetPlayerCheckpoint(playerid, 2361.7593, 2397.3511, 10.9471, 8.0);
			return SendClientMessage(playerid,COLOR_QUEST, "Работа: Ты забрал деньги! Отвези их в {FF0000}банк{FFCC00}.");
        }//Подошел к штабу, с которого нужно взять деньги
        if (GetPVarInt(playerid, "WorkBankStage") == 2)
        {//Привез товар к скупщику
            new String[120], wxp, wcash; //Зарплата в час: 2400 xp и 900 000$ => в секунду: 2/3xp и 250$
			if (WorkTime[playerid] <= 600) {wxp = WorkTime[playerid] * 2/3; wcash = WorkTime[playerid] * 250;}
			else {wxp = 400; wcash = 75000;}//Не более 10 минут на один заход. Если больше - выдаем хр за 10 минут и вдвое меньше денег
			format(String, sizeof String, "Работа: Вы получили %d XP и %d$ за проделанную работу.", wxp, wcash);
			SendClientMessage(playerid, COLOR_QUEST, String); LGiveXP(playerid, wxp); Player[playerid][Cash] += wcash;
			PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
            //Ниже выдаем новый заказ
            new rand = random(MAX_BASE); if (rand == 0) rand++;//Выбираем штаб для сбора денег
            SetPVarInt(playerid, "WorkBankStage", 1); WorkTime[playerid] = 0;
            if (QuestCar[playerid] != -1) {RepairVehicle(QuestCar[playerid]); SetVehicleZAngle(QuestCar[playerid], 0); SetPlayerChatBubble(playerid, "Транспорт отремонтирован", COLOR_GREEN, 300.0, 3000);}
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Собери деньги со {FF0000}штаба{FFCC00} и привези их сюда!");
            SetPlayerCheckpoint(playerid,Base[rand][bPosEnterX],Base[rand][bPosEnterY],Base[rand][bPosEnterZ],2);
        }//Привез товар к скупщику
    }//Инкассатор

	return 1;
}

public OnPlayerLeaveCheckpoint(playerid)
{
	return 1;
}

public OnPlayerEnterRaceCheckpoint(playerid)
{
   	if (GetPlayerDistanceFromPoint(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]) > 16.0 || GetPlayerDistanceFromPoint(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]) <= 1.0) return 0;
	if (QuestActive[playerid] == 2 && InEvent[playerid] == 0)
	{//Работа - Доставщик Пиццы
	    new target,next;
	    if (WorkPizzaCP[playerid] == WorkPizzaCPs[playerid] - 1)
	    {//конец маршрута
  			RepairVehicle(QuestCar[playerid]); SetPlayerChatBubble(playerid, "Транспорт отремонтирован", COLOR_GREEN, 300.0, 3000);
	        new String[120], wxp, wcash;
			//Зарплата в час: 2400 xp и 144 000$ => в секунду: 2/3xp и 40$
			if (WorkTime[playerid] <= 300) {wxp = WorkTime[playerid] * 2/3; wcash = WorkTime[playerid] * 40;}
			else {wxp = 200;}//Не более 5 минут на один круг. Если больше 5 минут - выдаем как за 5 минут.
			format(String, sizeof String, "Работа: Вы получили %d XP и %d$ за доставку пиццы.", wxp, wcash);
			SendClientMessage(playerid, COLOR_QUEST, String); LGiveXP(playerid, wxp); Player[playerid][Cash] += wcash;
            PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			WorkPizzaID[playerid] = random(8) + 1; WorkPizzaCP[playerid] = 0; WorkTime[playerid] = 0;
			switch(WorkPizzaID[playerid])
			{
			    case 1: {WorkPizzaCPs[playerid] = 18; SetPlayerRaceCheckpoint(playerid, 0, PIZZA1[0][0], PIZZA1[0][1], PIZZA1[0][2], PIZZA1[1][0], PIZZA1[1][1], PIZZA1[1][2], 7);}
			    case 2: {WorkPizzaCPs[playerid] = 19; SetPlayerRaceCheckpoint(playerid, 0, PIZZA2[0][0], PIZZA2[0][1], PIZZA2[0][2], PIZZA2[1][0], PIZZA2[1][1], PIZZA2[1][2], 7);}
			    case 3: {WorkPizzaCPs[playerid] = 20; SetPlayerRaceCheckpoint(playerid, 0, PIZZA3[0][0], PIZZA3[0][1], PIZZA3[0][2], PIZZA3[1][0], PIZZA3[1][1], PIZZA3[1][2], 7);}
			    case 4: {WorkPizzaCPs[playerid] = 21; SetPlayerRaceCheckpoint(playerid, 0, PIZZA4[0][0], PIZZA4[0][1], PIZZA4[0][2], PIZZA4[1][0], PIZZA4[1][1], PIZZA4[1][2], 7);}
			    case 5: {WorkPizzaCPs[playerid] = 20; SetPlayerRaceCheckpoint(playerid, 0, PIZZA5[0][0], PIZZA5[0][1], PIZZA5[0][2], PIZZA5[1][0], PIZZA5[1][1], PIZZA5[1][2], 7);}
			    case 6: {WorkPizzaCPs[playerid] = 25; SetPlayerRaceCheckpoint(playerid, 0, PIZZA6[0][0], PIZZA6[0][1], PIZZA6[0][2], PIZZA6[1][0], PIZZA6[1][1], PIZZA6[1][2], 7);}
			    case 7: {WorkPizzaCPs[playerid] = 22; SetPlayerRaceCheckpoint(playerid, 0, PIZZA7[0][0], PIZZA7[0][1], PIZZA7[0][2], PIZZA7[1][0], PIZZA7[1][1], PIZZA7[1][2], 7);}
			    case 8: {WorkPizzaCPs[playerid] = 20; SetPlayerRaceCheckpoint(playerid, 0, PIZZA8[0][0], PIZZA8[0][1], PIZZA8[0][2], PIZZA8[1][0], PIZZA8[1][1], PIZZA8[1][2], 7);}
			}
			return 1;
	    }//конец маршрута
	    if (WorkPizzaCP[playerid] == WorkPizzaCPs[playerid] - 2)
	    {//предпоследний CP
	        WorkPizzaCP[playerid] += 1;
	        SetPlayerRaceCheckpoint(playerid, 1, 2386.8760, -1921.9377, 12.9784, 0.0, 0.0, 0.0, 7);
	    }//предпоследний CP
	    else
	    {//обычный CP
	        WorkPizzaCP[playerid] += 1;target = WorkPizzaCP[playerid]; next = WorkPizzaCP[playerid] + 1;
	        switch(WorkPizzaID[playerid])
	        {
	            case 1: SetPlayerRaceCheckpoint(playerid, 0, PIZZA1[target][0], PIZZA1[target][1], PIZZA1[target][2], PIZZA1[next][0], PIZZA1[next][1], PIZZA1[next][2], 7);
                case 2: SetPlayerRaceCheckpoint(playerid, 0, PIZZA2[target][0], PIZZA2[target][1], PIZZA2[target][2], PIZZA2[next][0], PIZZA2[next][1], PIZZA2[next][2], 7);
				case 3: SetPlayerRaceCheckpoint(playerid, 0, PIZZA3[target][0], PIZZA3[target][1], PIZZA3[target][2], PIZZA3[next][0], PIZZA3[next][1], PIZZA3[next][2], 7);
				case 4: SetPlayerRaceCheckpoint(playerid, 0, PIZZA4[target][0], PIZZA4[target][1], PIZZA4[target][2], PIZZA4[next][0], PIZZA4[next][1], PIZZA4[next][2], 7);
				case 5: SetPlayerRaceCheckpoint(playerid, 0, PIZZA5[target][0], PIZZA5[target][1], PIZZA5[target][2], PIZZA5[next][0], PIZZA5[next][1], PIZZA5[next][2], 7);
				case 6: SetPlayerRaceCheckpoint(playerid, 0, PIZZA6[target][0], PIZZA6[target][1], PIZZA6[target][2], PIZZA6[next][0], PIZZA6[next][1], PIZZA6[next][2], 7);
				case 7: SetPlayerRaceCheckpoint(playerid, 0, PIZZA7[target][0], PIZZA7[target][1], PIZZA7[target][2], PIZZA7[next][0], PIZZA7[next][1], PIZZA7[next][2], 7);
				case 8: SetPlayerRaceCheckpoint(playerid, 0, PIZZA8[target][0], PIZZA8[target][1], PIZZA8[target][2], PIZZA8[next][0], PIZZA8[next][1], PIZZA8[next][2], 7);
	        }
	        new id = WorkPizzaID[playerid], rand = random(5);
	        if (WorkPizzaCP[playerid] == PIZZAHOUSES[id][0] || WorkPizzaCP[playerid] == PIZZAHOUSES[id][1] || WorkPizzaCP[playerid] == PIZZAHOUSES[id][2])
	        {//Чекпоинт - дом клиента
	            switch(rand)
	            {
		            case 0: SendClientMessage(playerid, COLOR_QUEST, "Клиент: {AFAFAF}Благодарю! У вас лучшая пицца во всем городе!");
		            case 1: SendClientMessage(playerid, COLOR_QUEST, "Клиент: {AFAFAF}А нельзя было побыстрее приехать?!");
		            case 2: SendClientMessage(playerid, COLOR_QUEST, "Клиент: {AFAFAF}А вот и моя пицца! Спасибо!");
		            case 3: SendClientMessage(playerid, COLOR_QUEST, "Клиент: {AFAFAF}Так быстро?! Спасибо!");
		            case 4: SendClientMessage(playerid, COLOR_QUEST, "Клиент: {AFAFAF}Очень вкусно, спасибо!");
	            }
	        }//Чекпоинт - дом клиента
	    }//обычный CP
	}//Работа - Доставщик Пиццы

    if (XRTimeToEnd > 0 && XRStarted[playerid] == 1)
	{//чекпоинт легендарной гонки
	    new target,next,used;
	    if (XRPlayerCP[playerid] == XRCPs - 1)
	    {//финишный чекпоинт
			new String[120];FarmedXP[playerid] = 200 + 35 * (XRPlayers-1); FarmedMoney[playerid] = 25000 + 5000 * (XRPlayers);
			XRpos += 1;
			if (XRpos == 1){FarmedXP[playerid] += 300;format(String,sizeof(String),"%s[%d] выиграл легендарную гонку и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_XR,String); MarafonUpdate(playerid, 2, 1);}
			if (XRpos == 2){FarmedXP[playerid] += 200;format(String,sizeof(String),"%s[%d] финишировал вторым в легендарной гонке и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_XR,String);}
			if (XRpos == 3){FarmedXP[playerid] += 100;format(String,sizeof(String),"%s[%d] финишировал третьим в легендарной гонке и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_XR,String);}
			if (XRpos > 3)
			{
				format(String,sizeof(String),"Вы финишировали %d-ым и получили %d XP и %d$",XRpos,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessage(playerid,COLOR_XR,String);
			}
			XRPlayers -= 1;Player[playerid][Cash] += FarmedMoney[playerid]; LGiveXP(playerid, FarmedXP[playerid]);

			MarafonUpdate(playerid, 5, FarmedMoney[playerid]);
			MarafonUpdate(playerid, 0, 1);

			XRStarted[playerid] = 0; JoinEvent[playerid] = 0; InEvent[playerid] = 0;
			DestroyVehicle(XRCarID[playerid]); XRCarID[playerid] = 0;LSpawnPlayer(playerid);
			ShowClanZones(playerid); // покажем клановые зоны
			SetPlayerVirtualWorld(playerid,0);PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
			//DisableRemoteVehicleCollisions(playerid, 0);
			DisablePlayerRaceCheckpoint(playerid);
			QuestUpdate(playerid, 16, 1);//Обновление квеста Примите участие в 3 легендарных гонках
			QuestUpdate(playerid, 18, 1);//Обновление квеста Примите участие в 5 соревнованиях
			//MarafonUpdate(playerid);
			return 1;
	    }//финишный чекпоинт
	    if (XRPlayerCP[playerid] == XRCPs - 2)
	    {//предпоследний чекпоинт
	        XRPlayerCP[playerid] += 1;target = XRPlayerCP[playerid]; next = XRPlayerCP[playerid] + 1; used = XRPlayerCP[playerid] - 1;
	        if (XRid == 1){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE1[target][0], XRACE1[target][1], XRACE1[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 2){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE2[target][0], XRACE2[target][1], XRACE2[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 3){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE3[target][0], XRACE3[target][1], XRACE3[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 4){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE4[target][0], XRACE4[target][1], XRACE4[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 5){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE5[target][0], XRACE5[target][1], XRACE5[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 6){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE6[target][0], XRACE6[target][1], XRACE6[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 7){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE7[target][0], XRACE7[target][1], XRACE7[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 8){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE8[target][0], XRACE8[target][1], XRACE8[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 9){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE9[target][0], XRACE9[target][1], XRACE9[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 10){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE10[target][0], XRACE10[target][1], XRACE10[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 11){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE11[target][0], XRACE11[target][1], XRACE11[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 12){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE12[target][0], XRACE12[target][1], XRACE12[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 13){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE13[target][0], XRACE13[target][1], XRACE13[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 14){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE14[target][0], XRACE14[target][1], XRACE14[target][2], 1483.6304, 1130.1642, 10.7147, 7);}
            if (XRid == 15){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE15[target][0], XRACE15[target][1], XRACE15[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 16){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE16[target][0], XRACE16[target][1], XRACE16[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 17){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE17[target][0], XRACE17[target][1], XRACE17[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 18){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE18[target][0], XRACE18[target][1], XRACE18[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 19){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE19[target][0], XRACE19[target][1], XRACE19[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 20){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE20[target][0], XRACE20[target][1], XRACE20[target][2], 0.0, 0.0, 0.0, 7);}
            if (XRid == 21){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE21[target][0], XRACE21[target][1], XRACE21[target][2], 0.0, 0.0, 0.0, 7);}
            new Float: x, Float: y, Float: z, Float: Angle, Float: vx, Float: vy, Float: vz;
			GetPlayerPos(playerid,x,y,z);GetVehicleVelocity(XRCarID[playerid], vx, vy, vz);GetVehicleZAngle(XRCarID[playerid], Angle);
			if (XRCarCP[used] != -1)
	        {//если в этом чекпоинте нужно менять авто
	            NeedSpeedDown[playerid] = 1; LACSH[playerid] = 3; LastSpeed[playerid] = 999;//чтобы 2 сек не работал LAC на SpeedHack (ложные срабатывания)
				DestroyVehicle(XRCarID[playerid]);new col1 = random(187), col2 = random(187);
				XRCarID[playerid] = LCreateVehicle(XRCarCP[used], x, y, z, Angle, col1, col2, 0);
				SetVehicleVirtualWorld(XRCarID[playerid], 700);PutPlayerInVehicle(playerid, XRCarID[playerid], 0);
				SetVehicleVelocity(XRCarID[playerid], vx, vy, vz);
				if (LSpectators[playerid] > 0) SpecUpdate(playerid);
				new rand = random(3);ChangeVehiclePaintjob(GetPlayerVehicleID(playerid), rand);//случайный paintjob
				XRPlayerCar[playerid] = XRCarCP[used];//Сохраняет модель машины для её восстановления в дальнейшем
				//Ниже закрываем двери
				new engine, lights, alarm, doors, bonnet, boot, objective;
			    GetVehicleParamsEx(XRCarID[playerid], engine, lights, alarm, doors, bonnet, boot, objective);
			    SetVehicleParamsEx(XRCarID[playerid], engine, lights, alarm, true, bonnet, boot, objective);
      		}//если в этом чекпоинте нужно менять авто
	        PlayerPlaySound(playerid,1056,0.0,0.0,0.0);
	        XRxx[playerid] = x;XRy[playerid] = y;XRz[playerid] = z;XRa[playerid] = Angle;XRvx[playerid] = vx;XRvy[playerid] = vy;XRvz[playerid] = vz;//для восстановления с чекпоинта
	    }//предпоследний чекпоинт
	    else
	    {//обычный чекпоинт
	        XRPlayerCP[playerid] += 1;target = XRPlayerCP[playerid]; next = XRPlayerCP[playerid] + 1; used = XRPlayerCP[playerid] - 1;
	        if (XRid == 1){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE1[target][0], XRACE1[target][1], XRACE1[target][2], XRACE1[next][0], XRACE1[next][1], XRACE1[next][2], 7);}
            if (XRid == 2){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE2[target][0], XRACE2[target][1], XRACE2[target][2], XRACE2[next][0], XRACE2[next][1], XRACE2[next][2], 7);}
            if (XRid == 3){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE3[target][0], XRACE3[target][1], XRACE3[target][2], XRACE3[next][0], XRACE3[next][1], XRACE3[next][2], 7);}
            if (XRid == 4){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE4[target][0], XRACE4[target][1], XRACE4[target][2], XRACE4[next][0], XRACE4[next][1], XRACE4[next][2], 7);}
            if (XRid == 5){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE5[target][0], XRACE5[target][1], XRACE5[target][2], XRACE5[next][0], XRACE5[next][1], XRACE5[next][2], 7);}
            if (XRid == 6){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE6[target][0], XRACE6[target][1], XRACE6[target][2], XRACE6[next][0], XRACE6[next][1], XRACE6[next][2], 7);}
            if (XRid == 7){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE7[target][0], XRACE7[target][1], XRACE7[target][2], XRACE7[next][0], XRACE7[next][1], XRACE7[next][2], 7);}
            if (XRid == 8){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE8[target][0], XRACE8[target][1], XRACE8[target][2], XRACE8[next][0], XRACE8[next][1], XRACE8[next][2], 7);}
            if (XRid == 9){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE9[target][0], XRACE9[target][1], XRACE9[target][2], XRACE9[next][0], XRACE9[next][1], XRACE9[next][2], 7);}
            if (XRid == 10){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE10[target][0], XRACE10[target][1], XRACE10[target][2], XRACE10[next][0], XRACE10[next][1], XRACE10[next][2], 7);}
            if (XRid == 11){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE11[target][0], XRACE11[target][1], XRACE11[target][2], XRACE11[next][0], XRACE11[next][1], XRACE11[next][2], 7);}
            if (XRid == 12){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE12[target][0], XRACE12[target][1], XRACE12[target][2], XRACE12[next][0], XRACE12[next][1], XRACE12[next][2], 7);}
            if (XRid == 13){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE13[target][0], XRACE13[target][1], XRACE13[target][2], XRACE13[next][0], XRACE13[next][1], XRACE13[next][2], 7);}
            if (XRid == 14){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE14[target][0], XRACE14[target][1], XRACE14[target][2], XRACE14[next][0], XRACE14[next][1], XRACE14[next][2], 15);}
            if (XRid == 15){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE15[target][0], XRACE15[target][1], XRACE15[target][2], XRACE15[next][0], XRACE15[next][1], XRACE15[next][2], 7);}
            if (XRid == 16){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE16[target][0], XRACE16[target][1], XRACE16[target][2], XRACE16[next][0], XRACE16[next][1], XRACE16[next][2], 3.5);}
            if (XRid == 17){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE17[target][0], XRACE17[target][1], XRACE17[target][2], XRACE17[next][0], XRACE17[next][1], XRACE17[next][2], 7);}
            if (XRid == 18){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE18[target][0], XRACE18[target][1], XRACE18[target][2], XRACE18[next][0], XRACE18[next][1], XRACE18[next][2], 7);}
            if (XRid == 19){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE19[target][0], XRACE19[target][1], XRACE19[target][2], XRACE19[next][0], XRACE19[next][1], XRACE19[next][2], 15);}
            if (XRid == 20){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE20[target][0], XRACE20[target][1], XRACE20[target][2], XRACE20[next][0], XRACE20[next][1], XRACE20[next][2], 7);}
            if (XRid == 21){SetPlayerRaceCheckpoint(playerid, XRTypeCP[target], XRACE21[target][0], XRACE21[target][1], XRACE21[target][2], XRACE21[next][0], XRACE21[next][1], XRACE21[next][2], 10.0);}
			new Float: x, Float: y, Float: z, Float: Angle, Float: vx, Float: vy, Float: vz;
			GetPlayerPos(playerid,x,y,z);GetVehicleVelocity(XRCarID[playerid], vx, vy, vz);GetVehicleZAngle(XRCarID[playerid], Angle);
			if (XRCarCP[used] != -1)
	        {//если в этом чекпоинте нужно менять авто
	            NeedSpeedDown[playerid] = 1; LACSH[playerid] = 3; LastSpeed[playerid] = 999;//чтобы 2 сек не работал LAC на SpeedHack (ложные срабатывания)
	            DestroyVehicle(XRCarID[playerid]);new col1 = random(187), col2 = random(187);
				XRCarID[playerid] = LCreateVehicle(XRCarCP[used], x, y, z, Angle, col1, col2, 0);
				SetVehicleVirtualWorld(XRCarID[playerid], 700);PutPlayerInVehicle(playerid, XRCarID[playerid], 0);
				SetVehicleVelocity(XRCarID[playerid], vx, vy, vz);
				if (LSpectators[playerid] > 0) SpecUpdate(playerid);
				new rand = random(3);ChangeVehiclePaintjob(GetPlayerVehicleID(playerid), rand);//случайный paintjob
				XRPlayerCar[playerid] = XRCarCP[used];//Сохраняет модель машины для её восстановления в дальнейшем
                //Ниже закрываем двери
				new engine, lights, alarm, doors, bonnet, boot, objective;
			    GetVehicleParamsEx(XRCarID[playerid], engine, lights, alarm, doors, bonnet, boot, objective);
			    SetVehicleParamsEx(XRCarID[playerid], engine, lights, alarm, true, bonnet, boot, objective);
       		}//если в этом чекпоинте нужно менять авто
	        PlayerPlaySound(playerid,1056,0.0,0.0,0.0);
	        XRxx[playerid] = x;XRy[playerid] = y;XRz[playerid] = z;XRa[playerid] = Angle;XRvx[playerid] = vx;XRvy[playerid] = vy;XRvz[playerid] = vz;//для восстановления с чекпоинта
	    }//обычный чекпоинт
	    return 1;
	}//чекпоинт легендарной гонки
	
	if (DRTimeToEnd > 0 && DRStarted[playerid] == 1)
	{
	    if(DRLastPlayerCP[playerid] == DRMaxCPs-1)
		{
		    new String[120];
			FarmedXP[playerid] = 200 + 35 * (DRStartPlayers-1);
			FarmedMoney[playerid] = 24000 + 3100 * (DRStartPlayers);
		    DRpos++;
			if (DRpos == 1){FarmedXP[playerid] += 300;format(String,sizeof(String),"%s[%d] выиграл в гонке на выживание и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_DRACE,String); MarafonUpdate(playerid, 2, 1);}
			if (DRpos == 2){FarmedXP[playerid] += 200;format(String,sizeof(String),"%s[%d] финишировал вторым в гонке на выживание и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_DRACE,String);}
			if (DRpos == 3){FarmedXP[playerid] += 100;format(String,sizeof(String),"%s[%d] финишировал третьим в гонке на выживание и получил %d XP и %d$",PlayerName[playerid],playerid,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessageToAll(COLOR_DRACE,String);}
			if (DRpos > 3)
			{
				format(String,sizeof(String),"Вы финишировали %d-ым и получили %d XP и %d$",DRpos,FarmedXP[playerid],FarmedMoney[playerid]);SendClientMessage(playerid,COLOR_DRACE,String);
			}
			DRPlayers--;
            DRStartPlayers--;
            
			Player[playerid][Cash] += FarmedMoney[playerid]; LGiveXP(playerid, FarmedXP[playerid]);
		
		    PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
		    DRStarted[playerid] = 0;JoinEvent[playerid] = 0;InEvent[playerid] = 0;
			DestroyVehicle(DRCarID[playerid]);
			DRCarID[playerid] = 0;
			LSpawnPlayer(playerid);
			SetPlayerVirtualWorld(playerid,0);
			PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
		    DisablePlayerRaceCheckpoint(playerid);
		    ShowClanZones(playerid); // покажем клановые зоны
		    QuestUpdate(playerid, 18, 1);//Обновление квеста Примите участие в 5 соревнованиях
		    QuestUpdate(playerid, 31, 1);//принять участие в дрейс
		    MarafonUpdate(playerid, 5, FarmedMoney[playerid]);
		    MarafonUpdate(playerid, 0, 1);
			return 1;
		}
		else
		{
			DRLastPlayerCP[playerid]++;
			RepairVehicle(GetPlayerVehicleID(playerid));
			PlayerPlaySound(playerid,1133,0.0,0.0,0.0);

			new PointId = DRPointID[DRLastPlayerCP[playerid]];
	    	switch(DRid)
	    	{
	        	case 1: SetPlayerRaceCheckpoint(playerid, 3, DRACE1CP[PointId][0], DRACE1CP[PointId][1], DRACE1CP[PointId][2], DRACE1CP[PointId+1][0], DRACE1CP[PointId+1][1], DRACE1CP[PointId+1][2], 8.0);
	        	case 2: SetPlayerRaceCheckpoint(playerid, 3, DRACE2CP[PointId][0], DRACE2CP[PointId][1], DRACE2CP[PointId][2], DRACE2CP[PointId+1][0], DRACE2CP[PointId+1][1], DRACE2CP[PointId+1][2], 8.0);
	        	case 3: SetPlayerRaceCheckpoint(playerid, 3, DRACE3CP[PointId][0], DRACE3CP[PointId][1], DRACE3CP[PointId][2], DRACE3CP[PointId+1][0], DRACE3CP[PointId+1][1], DRACE3CP[PointId+1][2], 8.0);
	        	case 4: SetPlayerRaceCheckpoint(playerid, 3, DRACE4CP[PointId][0], DRACE4CP[PointId][1], DRACE4CP[PointId][2], DRACE4CP[PointId+1][0], DRACE4CP[PointId+1][1], DRACE4CP[PointId+1][2], 8.0);
	        	case 5: SetPlayerRaceCheckpoint(playerid, 3, DRACE5CP[PointId][0], DRACE5CP[PointId][1], DRACE5CP[PointId][2], DRACE5CP[PointId+1][0], DRACE5CP[PointId+1][1], DRACE5CP[PointId+1][2], 8.0);
	        	case 6: SetPlayerRaceCheckpoint(playerid, 3, DRACE6CP[PointId][0], DRACE6CP[PointId][1], DRACE6CP[PointId][2], DRACE6CP[PointId+1][0], DRACE6CP[PointId+1][1], DRACE6CP[PointId+1][2], 8.0);
                case 7: SetPlayerRaceCheckpoint(playerid, 3, DRACE7CP[PointId][0], DRACE7CP[PointId][1], DRACE7CP[PointId][2], DRACE7CP[PointId+1][0], DRACE7CP[PointId+1][1], DRACE7CP[PointId+1][2], 8.0);

			}

			/*new String[140];
			format(String, sizeof String, "Ид чека: %d Сумма: ", PointId,DRLastPlayerCP[playerid]);
			SendClientMessageToAll(COLOR_DRACE,String);*/
		}
	}
	
	return 1;
}

public OnPlayerLeaveRaceCheckpoint(playerid)
{
	return 1;
}

public OnRconCommand(cmd[])
{
	return 1;
}

public OnObjectMoved(objectid)
{
	if(objectid == PlaneObject[0])
	{
	    foreach(Player, cid)
		{
			if(BTStarted[cid] == 1 && GetPVarInt(cid, "inplane") == 1)
			{
			    SetPVarInt(cid, "inplane", 0);
            	new Float:x, Float:y, Float:z, Float: a, Float: dist;
            	GetObjectRot(PlaneObject[0], x, y, a); GetObjectPos(PlaneObject[0], x, y, z);
            	dist = 80.0 + float(random(8)); x -= (dist * floatsin(-a, degrees)); y -= (dist * floatcos(-a, degrees));
				TogglePlayerSpectating(cid, 0); SetPlayerPos(cid, x, y, z-30.0);
				SetPlayerFacingAngle(cid,a);SetCameraBehindPlayer(cid);
				PlayerPlaySound(cid,1039,0.0,0.0,0.0);
				ShowHideBTMap(cid, 0); GivePlayerWeapon(cid,46,1);
				return 1;
			}
		}
	}
	return 1;
}

public OnPlayerObjectMoved(playerid, objectid)
{
	return 1;
}

public OnPlayerPickUpDynamicPickup(playerid, pickupid)
{
	switch(DynamicPickup[pickupid][Type])
	{
	    case 1:
	    {//дом
	    	new id = DynamicPickup[pickupid][ID];
	    	if (PlayerToPoint(3.0,playerid, Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ])) LastHouseVisited[playerid] = id;
		}//дом
		case 2:
		{//штаб
	    	new id = DynamicPickup[pickupid][ID];
	    	if (PlayerToPoint(3.0,playerid, Base[id][bPosEnterX], Base[id][bPosEnterY], Base[id][bPosEnterZ])) LastBaseVisited[playerid] = id;
		}//штаб
		case 3:
		{//чьи-то деньги
	    	new String[140];
			Player[playerid][Cash] += DynamicPickup[pickupid][ID];
			format(String, sizeof String, "{FFFF00}SERVER: Вы подобрали {FFFFFF}%d{FFFF00}$", DynamicPickup[pickupid][ID]);
			SendClientMessage(playerid, COLOR_YELLOW, String);
			format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   CASH: %s[%d] подобрал %d$", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, DynamicPickup[pickupid][ID]);
			WriteLog("GlobalLog", String); WriteLog("CashOperations", String);
			QuestUpdate(playerid, 19, DynamicPickup[pickupid][ID]);//Обновление квеста Ограбьте других игроков на сумму 10 000$
			//удаляем пикап
			KillTimer(DynamicPickup[pickupid][DestroyTimerID]);
			DestroyCashPickup(pickupid);
		}//чьи-то деньги
		case 4:
		{//кейс
		    new Pid=-1;
	    	for(new i; i<MAX_CASES;i++) if(CasePickup[i] == pickupid) {Pid = i; break;}
	    	if(Pid == -1) return print("Произошла ошибка при подборе пикапа");
	    	DestroyDynamicPickup(CasePickup[Pid]);
			DestroyDynamicMapIcon(CaseMapIcon[Pid]);
			new case1 = random(sizeof(CaseSpawn));
			CasePickup[Pid] = CreateDynamicPickup ( casemodel, 2, CaseSpawn[case1][0], CaseSpawn[case1][1], CaseSpawn[case1][2] );
			CaseMapIcon[Pid] = CreateDynamicMapIcon(CaseSpawn[case1][0], CaseSpawn[case1][1], CaseSpawn[case1][2], 56, COLOR_QUEST, 0, 0, -1, 350.0);
			DynamicPickup[CasePickup[Pid]][Type] = 4; //перестрахуемся, если вдруг свободен ид меньше

			if (CaseBugTime[playerid]-unixtime > 0) return 1;
			if (GetPlayerVirtualWorld(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Подбирать кейсы можно только в общем игровом мире!");
			new String[140], Priz = 3000 + random(69) * 250;//От 3 000 до 20 000. Всегда кратно 250
			Player[playerid][Cash] += Priz; CaseBugTime[playerid] = unixtime+3;
			MarafonUpdate(playerid, 4, 1);
			QuestUpdate(playerid, 21, 1);//Обновление квеста Найдите 5 кейсов
			//new year
			format(String, sizeof String, "Содержимое подарка: {FFFFFF}%d{FFCC00}$", Priz);
			return SendClientMessage(playerid,COLOR_QUEST,String);
		}//кейс
		case 5:
  		{//банк
  		    if(GetPlayerVirtualWorld(playerid) != 0 || GetPlayerInterior(playerid) != 0 || Player[playerid][Banned] > 0) return 1;
	    	SetPlayerInterior(playerid, 61);
	    	SetPlayerVirtualWorld(playerid,648);
	    	SetPlayerPos(playerid, 1104.7524,1518.2837,4452.4810);
	    	SetPlayerFacingAngle(playerid,0.0);
	    	SetPVarInt(playerid, "LastBank", DynamicPickup[pickupid][ID]);
	    	SetPlayerArmedWeapon(playerid, 0);
	    	return 1;
  		}//банк
		case 6:
		{//выход из штаба
			if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
			new baseid = GetPlayerVirtualWorld(playerid) - 2000;
			if (baseid > 0 && baseid <= MAX_BASE)
			{//Корректный ID штаба
				SetPlayerPos(playerid, Base[baseid][bPosEnterX], Base[baseid][bPosEnterY], Base[baseid][bPosEnterZ]);
				SetPlayerFacingAngle(playerid, Base[baseid][bPosEnterA] - 180.0);
				SetPlayerVirtualWorld(playerid,0);SetPlayerInterior(playerid,0);
            	InPeacefulZone[playerid] = 0;
				SetCameraBehindPlayer(playerid); return 1;
			}//Корректный ID штаба
	    	return 1;
		}//выход из штаба
		case 7:
		{//выход из дома
			if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
			new houseid = GetPlayerVirtualWorld(playerid) - 1000;
			if (houseid > 0 && houseid <= MAX_PROPERTY)
			{//Корректный ID
				SetPlayerPos(playerid, Property[houseid][pPosEnterX], Property[houseid][pPosEnterY],Property[houseid][pPosEnterZ]);
				SetPlayerFacingAngle(playerid, Property[houseid][pPosEnterA] - 180.0);
				SetPlayerVirtualWorld(playerid,0);SetPlayerInterior(playerid,0);
        		InPeacefulZone[playerid] = 0;
				SetCameraBehindPlayer(playerid);
			}
			return 1;
		}//выход из дома

		default: //остальные (единичные)
		{
			/*if (pickupid == BankOut) //выход из банка
    		{
        		if(GetPlayerVirtualWorld(playerid) != 648 || GetPlayerInterior(playerid) != 61) return 1;
        		new bnk = GetPVarInt(playerid, "LastBank");
        		SetPlayerInterior(playerid, 0);
        		SetPlayerVirtualWorld(playerid,0);
        		SetPlayerPos(playerid, EXBANK[bnk][0],EXBANK[bnk][1],EXBANK[bnk][2]);
	    		SetPlayerFacingAngle(playerid,EXBANK[bnk][3]);
	    		DeletePVar(playerid, "LastBank");
	    		return 1;
			}*/
			//new year
			if(pickupid == NYGift) //нг подарок
			{
	    		if (Logged[playerid] == 0) return 1;
	    		if (Player[playerid][Time] < 10800) return SendClientMessage(playerid,COLOR_QUEST,"Вы должны отыграть как минимум 3 часа, чтобы получить подарок!");
				if(Player[playerid][Bonus] == 4) return SendClientMessage(playerid,COLOR_QUEST,"Вы уже забрали свой подарок!");
				Player[playerid][Bonus] = 4;
				//new xDay = DateToIntDate(Day, Month, Year);
				GameTextForPlayer(playerid, "~y~Happy~r~New Year!", 2000, 6);
				//PlayAudioStreamForPlayer(playerid, "https://drive.google.com/uc?export=download&id=0B5QybhvTfm7GZVQwR1IzUnhTalE");
				SendClientMessage(playerid, COLOR_RED, "-------------------------------------------------------");
				if (Player[playerid][Prestige] > 2)
				{
		    		if(Player[playerid][GPremium] < 20)
					{
						Player[playerid][GPremium] += 1;
						SendClientMessage(playerid, COLOR_RED, "Ваш подарок: +1 ViP! Поздравляем!");
					}
					else
					{
			    		Player[playerid][GameGold] += 100.0;
			    		Player[playerid][Bank] += 10000000;
			    		SendClientMessage(playerid, COLOR_RED, "Ваш подарок: +100р в /shop и 10кк в банк! Поздравляем С Новым годом!");
					}
				}
				else
				{
	 				if(Player[playerid][Prestige] > 0)
					{
						Player[playerid][GameGold] += 70.0;
						AddACashLost(playerid,7);
						SendClientMessage(playerid, COLOR_RED, "Ваш подарок: +70р в /shop и + 7 дней несливайки! Поздравляем С Новым годом!");
					}
					else
					{
						switch(Player[playerid][Level])
						{
							case 1..19:
							{
								Player[playerid][Level]+=10;
								Player[playerid][GameGold] += 10.0;
					 			AddACashLost(playerid,3);
								SendClientMessage(playerid, COLOR_RED, "Ваш подарок: +10лвл, +10р в /shop и +3 дня несливайки! Поздравляем С Новым годом!");
							}
							case 20..49:
							{
								Player[playerid][Level]+=20;
								Player[playerid][GameGold] += 30.0;
								AddACashLost(playerid,5);
								SendClientMessage(playerid, COLOR_RED, "Ваш подарок: +20лвл, +20р в /shop и +5 дня несливайки! Поздравляем С Новым годом!");
							}
							case 50..100:
							{
	  							if(Player[playerid][Level] < 71)
	  							{
									Player[playerid][Level]+=30;
								}
								else Player[playerid][Level] = 100;
								Player[playerid][GameGold] += 40.0;
								AddACashLost(playerid,7);
								SendClientMessage(playerid, COLOR_RED, "Ваш подарок: +30лвл, +30р в /shop и +7 дней несливайки! Поздравляем С Новым годом!");
							}
						}
					}
				}
				SendClientMessage(playerid, COLOR_RED, "-------------------------------------------------------");
			}
		}
	}
	return 1;
}

public OnVehicleMod(playerid, vehicleid, componentid)
{
 	TunesPerSecond[playerid]++; if (TunesPerSecond[playerid] > 5) Kick(playerid);//От флуда тюнингом
    if (Player[playerid][Banned] == 1) return 1;//чтобы читера не садило в ад по много раз
	if (InEvent[playerid] == EVENT_RACE || InEvent[playerid] == EVENT_XRACE)
	{//использовал тюнинг в гонках
		RemovePlayerFromVehicle(playerid);//Запрет тюнинга в гонках
		return SendClientMessage(playerid, COLOR_RED, "Использование автомастерских запрещено в гонках! Заново вызовите транспорт и покиньте автомастерскую!");
	}//использовал тюнинг в гонках

	if (componentid == 1087 && Player[playerid][Level] < 9) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум 9-го уровня, чтобы гидравлика сохранялась при трансформации!");
	if (componentid == 1009 && Player[playerid][Level] < 35) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум 35-го уровня, чтобы нитро х2 сохранялось при трансформации!");
	if (componentid == 1008 && Player[playerid][Level] < 42) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум 42-го уровня, чтобы нитро х5 сохранялось при трансформации!");
	if (componentid == 1010 && Player[playerid][Level] < 48) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум 48-го уровня, чтобы нитро х10 сохранялось при трансформации!");

	if (LastPlayerTuneStatus[playerid] > 0)
	{//Игрок поставил компонент в тюнинге
	    if (Player[playerid][CarActive] == 1)
	    {//Сохранение тюнинга класс 1
	        if (GetVehicleComponentType(componentid) == 0) Player[playerid][CarSlot1Component0] = componentid;
	        if (GetVehicleComponentType(componentid) == 1) Player[playerid][CarSlot1Component1] = componentid;
	        if (GetVehicleComponentType(componentid) == 2) Player[playerid][CarSlot1Component2] = componentid;
	        if (GetVehicleComponentType(componentid) == 3) Player[playerid][CarSlot1Component3] = componentid;
	        if (GetVehicleComponentType(componentid) == 4) Player[playerid][CarSlot1Component4] = componentid;
	        if (GetVehicleComponentType(componentid) == 5) Player[playerid][CarSlot1Component5] = componentid;
	        if (GetVehicleComponentType(componentid) == 6) Player[playerid][CarSlot1Component6] = componentid;
	        if (GetVehicleComponentType(componentid) == 7) Player[playerid][CarSlot1Component7] = componentid;
	        if (GetVehicleComponentType(componentid) == 8) Player[playerid][CarSlot1Component8] = componentid;
	        if (GetVehicleComponentType(componentid) == 9) Player[playerid][CarSlot1Component9] = componentid;
	        if (GetVehicleComponentType(componentid) == 10) Player[playerid][CarSlot1Component10] = componentid;
	        if (GetVehicleComponentType(componentid) == 11) Player[playerid][CarSlot1Component11] = componentid;
	        if (GetVehicleComponentType(componentid) == 12) Player[playerid][CarSlot1Component12] = componentid;
	        if (GetVehicleComponentType(componentid) == 13) Player[playerid][CarSlot1Component13] = componentid;
            SaveTune(playerid);
	    }//Сохранение тюнинга класс 1
	    if (Player[playerid][CarActive] == 2)
	    {//Сохранение тюнинга класс 2
	        if (GetVehicleComponentType(componentid) == 0) Player[playerid][CarSlot2Component0] = componentid;
	        if (GetVehicleComponentType(componentid) == 1) Player[playerid][CarSlot2Component1] = componentid;
	        if (GetVehicleComponentType(componentid) == 2) Player[playerid][CarSlot2Component2] = componentid;
	        if (GetVehicleComponentType(componentid) == 3) Player[playerid][CarSlot2Component3] = componentid;
	        if (GetVehicleComponentType(componentid) == 4) Player[playerid][CarSlot2Component4] = componentid;
	        if (GetVehicleComponentType(componentid) == 5) Player[playerid][CarSlot2Component5] = componentid;
	        if (GetVehicleComponentType(componentid) == 6) Player[playerid][CarSlot2Component6] = componentid;
	        if (GetVehicleComponentType(componentid) == 7) Player[playerid][CarSlot2Component7] = componentid;
	        if (GetVehicleComponentType(componentid) == 8) Player[playerid][CarSlot2Component8] = componentid;
	        if (GetVehicleComponentType(componentid) == 9) Player[playerid][CarSlot2Component9] = componentid;
	        if (GetVehicleComponentType(componentid) == 10) Player[playerid][CarSlot2Component10] = componentid;
	        if (GetVehicleComponentType(componentid) == 11) Player[playerid][CarSlot2Component11] = componentid;
	        if (GetVehicleComponentType(componentid) == 12) Player[playerid][CarSlot2Component12] = componentid;
	        if (GetVehicleComponentType(componentid) == 13) Player[playerid][CarSlot2Component13] = componentid;
            SaveTune(playerid);
	    }//Сохранение тюнинга класс 2
		return 1;
	}//Игрок поставил компонент в тюнинге

	new String[140];
	DestroyVehicle(vehicleid); TimeTransform[playerid] = unixtime+5; LACPanic[playerid]++;//LAC v2.0
	format(String,sizeof(String), "[АДМИНАМ]LAC:{AFAFAF} Транспорт игрока %s[%d] уничтожен. {FF0000}Причина: {AFAFAF}Возможно тюнинг транспорта",PlayerName[playerid], playerid);
    foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
    SendClientMessage(playerid, -1,"{FF0000}LAC:{AFAFAF} Ваш транспорт был уничтожен. {FF0000}Причина: {AFAFAF}Возможно чит на тюнинг транспорта");
	format(String, 140, "%d.%d.%d в %d:%d:%d |   LAC: Транспорт игрока %s[%d] уничтожен. Причина: Возможно чит на тюнинг транспорта", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
	WriteLog("GlobalLog", String);WriteLog("LAC", String);
	return 1;
}

public OnVehiclePaintjob(playerid, vehicleid, paintjobid)
{//смена PaintJob в тюнинге
    TunesPerSecond[playerid]++; if (TunesPerSecond[playerid] > 5) Kick(playerid);//От флуда тюнингом
	if (Player[playerid][Level] < 55) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум 55-го уровня, чтобы покрасочные работы сохранялись при трансформации!");
    if (Player[playerid][CarActive] == 1) Player[playerid][CarSlot1PaintJob] = paintjobid;
    if (Player[playerid][CarActive] == 2) Player[playerid][CarSlot2PaintJob] = paintjobid;
    SaveTune(playerid);
	return 1;
}//смена PaintJob в тюнинге

public OnVehicleRespray(playerid, vehicleid, color1, color2)
{//перекраска авто в тюнинге
    TunesPerSecond[playerid]++; if (TunesPerSecond[playerid] > 5) Kick(playerid);//От флуда тюнингом
	if (Player[playerid][CarActive] == 1) {Player[playerid][CarSlot1Color1] = color1; Player[playerid][CarSlot1Color2] = color2;}
	if (Player[playerid][CarActive] == 2) {Player[playerid][CarSlot2Color1] = color1; Player[playerid][CarSlot2Color2] = color2;}
	return 1;
}//перекраска авто в тюнинге

public OnPlayerSelectedMenuRow(playerid, row)
{
	return 1;
}

public OnPlayerExitedMenu(playerid)
{
	return 1;
}

public OnPlayerInteriorChange(playerid, newinteriorid, oldinteriorid)
{
    if (LSpectators[playerid] > 0) {SpecUpdate(playerid);}
	return 1;
}

public OnPlayerKeyStateChange(playerid, newkeys, oldkeys)
{
//     new str[64];
//     format(str,64,"newkey: %d | oldkey: %d ",newkeys,oldkeys);
//     SendClientMessage(playerid,0xFFFFFFAA,str);

     if( newkeys == 1 || newkeys == 9 || newkeys == 33 && oldkeys != 1 || oldkeys != 9 || oldkeys != 33)
     {//бесконечное нитро
        //new Float: xx, Float: yy, Float: zz;
        //GetPlayerPos(playerid,xx,yy,zz);
        //DRocket[playerid] = CreateObject(354, xx, yy, zz+2.0, 0.0, 0.0, 0.0);

        if (Player[playerid][CarActive] == 1 && Player[playerid][CarSlot1NitroX] > 0 && InEvent[playerid] == 0 && QuestActive[playerid] == 0) AddVehicleComponent(GetPlayerVehicleID(playerid), 1010);
        if (Player[playerid][CarActive] == 2 && Player[playerid][CarSlot2NitroX] > 0 && InEvent[playerid] == 0 && QuestActive[playerid] == 0) AddVehicleComponent(GetPlayerVehicleID(playerid), 1010);
     }//бесконечное нитро

     if(newkeys & KEY_FIRE && IsPlayerInAnyVehicle(playerid))
     {//перекраска авто
	     if(IsPlayerInPayNSpray(playerid))
		 {//игрок в гараже Pay N Spray
			    if (Player[playerid][Cash] < 100){ShowMoneyWant(playerid,1,"100");return 1;}
		        Player[playerid][Cash] -= 100;
				new col1 = random (256), col2 = random(256);
			    if (Player[playerid][CarActive] == 1){Player[playerid][CarSlot1Color1] = col1;Player[playerid][CarSlot1Color2] = col2;}
			    if (Player[playerid][CarActive] == 2){Player[playerid][CarSlot2Color1] = col1;Player[playerid][CarSlot2Color2] = col2;}
			    if (Player[playerid][CarActive] == 3){Player[playerid][CarSlot3Color1] = col1;Player[playerid][CarSlot3Color2] = col2;}
			    ChangeVehicleColor(GetPlayerVehicleID(playerid), col1, col2);RepairVehicle(GetPlayerVehicleID(playerid));
			    PlayerPlaySound(playerid,1134,0.0,0.0,0.0);
		 }//игрок в гараже Pay N Spray
	}//перекраска авто

	if(newkeys & KEY_FIRE && IsPlayerInAnyVehicle(playerid))
    {//Автомастерская TurboSpeed
        if (InEvent[playerid] != EVENT_BATTLE || InEvent[playerid] != EVENT_RACE || InEvent[playerid] != EVENT_XRACE)
        {
        	for(new i=0;i<MAX_TS;i++)
        	{
    			if(IsPlayerInRangeOfPoint(playerid, 8, TSPosInf[i][fPosX], TSPosInf[i][fPosY], TSPosInf[i][fPosZ])) return ShowPlayerTSDialog(playerid);
			}
		}
		else SendClientMessage(playerid,COLOR_RED,"Запрещено использовать мастерскую в ивенте!");
	}//Автомастерская TurboSpeed

	if (newkeys & KEY_JUMP)
	{
 		if((ZMIsPlayerIsTank[playerid] == 1 && InEvent[playerid] == EVENT_ZOMBIE) || (Player[playerid][GPremium] > 10 && Player[playerid][MJAct] > 0 && InEvent[playerid] == 0))
		{//Высокий прыжок у прыгуна
	    	if (JumpTime[playerid] > unixtime) return 1;
	    	new Float: vx, Float: vy, Float: vz;
			GetPlayerVelocity(playerid,vx,vy,vz);
        	SetPlayerVelocity(playerid, vx, vy, 0.75);
        	JumpTime[playerid] = unixtime+3;
        	if(InEvent[playerid] == 0) SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
		}//Высокий прыжок у прыгуна
	}
	if(newkeys & KEY_YES && IsPlayerInVehicle(playerid, PlayerCarID[playerid]) && GetPlayerState(playerid) == PLAYER_STATE_DRIVER)
	{//трансформация машины на +1, если игрок за рулем своего авто
	    new rtime = TimeTransform[playerid] - unixtime;
		if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6); format(String,sizeof(String),"Вы не можете трансформировать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);return SendClientMessage(playerid,COLOR_RED,String);}
		if (LastPlayerTuneStatus[playerid] != 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя трансформироваться в автомастерской и у въезда в нее");
		LastSpeed[playerid] = 999; NeedSpeedDown[playerid] = 1; LACSH[playerid] = 3;//чтобы не работал LAC на SpeedHack (ложные срабатывания)
		new Float: x, Float: y, Float: z, Float: Angle; GetPlayerPos(playerid,x,y,z);
		new Float: vx, Float: vy, Float: vz;new wrld = GetPlayerVirtualWorld(playerid);
		//!!!запись пассажиров
		new Passenger1 = -1, Passenger2 = -1, Passenger3 = -1, Seats;
		foreach(Player, cid)
		{//цикл
		    if (IsPlayerInVehicle(cid,PlayerCarID[playerid]) && GetPlayerState(cid) == PLAYER_STATE_PASSENGER)
		    {//наш пассажир
		        if (GetPlayerVehicleSeat(cid) == 1){Passenger1 = cid;}
		        if (GetPlayerVehicleSeat(cid) == 2){Passenger2 = cid;}
		        if (GetPlayerVehicleSeat(cid) == 3){Passenger3 = cid;}
		    }//наш пассажир
		}//цикл
		//!!!запись пассажиров
		GetVehicleVelocity(PlayerCarID[playerid], vx, vy, vz);
		GetVehicleZAngle(PlayerCarID[playerid], Angle);
		DestroyVehicle(PlayerCarID[playerid]); PlayerCarID[playerid] = -1;
		CarChanged[playerid] = 0;
		if (Player[playerid][CarActive] == 1 && CarChanged[playerid] == 0)
		{//Если сейчас активен слот 1
			if (Player[playerid][CarSlot2] > 0){Player[playerid][CarActive] = 2;CarChanged[playerid] = 1;}
			if (Player[playerid][CarSlot3] > 0){Player[playerid][CarActive] = 3;CarChanged[playerid] = 1;}
			if(CarChanged[playerid] == 0){Player[playerid][CarActive] = 1;CarChanged[playerid] = 1;}
		}//Если сейчас активен слот 1
		if (Player[playerid][CarActive] == 2 && CarChanged[playerid] == 0)
		{//Если сейчас активен слот 2
			if (Player[playerid][CarSlot3] > 0){Player[playerid][CarActive] = 3;CarChanged[playerid] = 1;}
			if (Player[playerid][CarSlot1] > 0){Player[playerid][CarActive] = 1;CarChanged[playerid] = 1;}
			if(CarChanged[playerid] == 0){Player[playerid][CarActive] = 2;CarChanged[playerid] = 1;}
		}//Если сейчас активен слот 2
		if (Player[playerid][CarActive] == 3 && CarChanged[playerid] == 0)
		{//Если сейчас активен слот 3
			if (Player[playerid][CarSlot1] > 0){Player[playerid][CarActive] = 1;CarChanged[playerid] = 1;}
			if (Player[playerid][CarSlot2] > 0){Player[playerid][CarActive] = 2;CarChanged[playerid] = 1;}
			if(CarChanged[playerid] == 0){Player[playerid][CarActive] = 3;CarChanged[playerid] = 1;}
		}//Если сейчас активен слот 3
		if (Player[playerid][CarActive] == 1)
		{
			PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot1], x, y, z + 1, Angle, Player[playerid][CarSlot1Color1], Player[playerid][CarSlot1Color2], 0, Player[playerid][CarSlot1Sir]);
			if (Player[playerid][CarSlot1PaintJob] > -1){ChangeVehiclePaintjob(PlayerCarID[playerid], Player[playerid][CarSlot1PaintJob]);}
			//Загрузка компонентов тюнинга
		    if (Player[playerid][CarSlot1Component0] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component0]);
		    if (Player[playerid][CarSlot1Component1] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component1]);
		    if (Player[playerid][CarSlot1Component2] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component2]);
		    if (Player[playerid][CarSlot1Component3] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component3]);
		    if (Player[playerid][CarSlot1Component4] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component4]);
		    if (Player[playerid][CarSlot1Component5] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component5]);
		    if (Player[playerid][CarSlot1Component6] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component6]);
		    if (Player[playerid][CarSlot1Component7] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component7]);
		    if (Player[playerid][CarSlot1Component8] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component8]);
		    if (Player[playerid][CarSlot1Component9] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component9]);
		    if (Player[playerid][CarSlot1Component10] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component10]);
		    if (Player[playerid][CarSlot1Component11] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component11]);
		    if (Player[playerid][CarSlot1Component12] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component12]);
		    if (Player[playerid][CarSlot1Component13] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component13]);
            if (Player[playerid][CarSlot1Neon] != 0 && Player[playerid][Prestige] >= 4)
			{//Создание неона
			    new vehicleid = PlayerCarID[playerid];
			    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			}//Создание неона
			if (Player[playerid][CarSlot1Fire] != 0 && Player[playerid][Prestige] >= 3)
			{
				//new wrld = GetPlayerVirtualWorld(playerid);
			    new vehicleid = PlayerCarID[playerid];
				//Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
			}
			if (Player[playerid][CarSlot1Mig] != 0 && Player[playerid][Level] >= 50)
			{//Создание migalki
			    new vehicleid = PlayerCarID[playerid];
			    new model = GetVehicleModel(vehicleid);
			    new access = 0;
				for (new i=0;i<MAX_MIG;i++)
				{
					if(MigPosInf[i][vhid] == model) {access = i; continue;}
				}
			    MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Mig], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
			}

		}
		else if (Player[playerid][CarActive] == 2)
		{
			PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot2], x, y, z + 1, Angle, Player[playerid][CarSlot2Color1], Player[playerid][CarSlot2Color2], 0, Player[playerid][CarSlot2Sir]);
			if (Player[playerid][CarSlot2PaintJob] > -1){ChangeVehiclePaintjob(PlayerCarID[playerid], Player[playerid][CarSlot2PaintJob]);}
            //Загрузка компонентов тюнинга
		    if (Player[playerid][CarSlot2Component0] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component0]);
		    if (Player[playerid][CarSlot2Component1] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component1]);
		    if (Player[playerid][CarSlot2Component2] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component2]);
		    if (Player[playerid][CarSlot2Component3] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component3]);
		    if (Player[playerid][CarSlot2Component4] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component4]);
		    if (Player[playerid][CarSlot2Component5] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component5]);
		    if (Player[playerid][CarSlot2Component6] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component6]);
		    if (Player[playerid][CarSlot2Component7] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component7]);
		    if (Player[playerid][CarSlot2Component8] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component8]);
		    if (Player[playerid][CarSlot2Component9] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component9]);
		    if (Player[playerid][CarSlot2Component10] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component10]);
		    if (Player[playerid][CarSlot2Component11] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component11]);
		    if (Player[playerid][CarSlot2Component12] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component12]);
		    if (Player[playerid][CarSlot2Component13] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component13]);
            if (Player[playerid][CarSlot2Neon] != 0 && Player[playerid][Prestige] >= 4)
			{//Создание неона
			    new vehicleid = PlayerCarID[playerid];
			    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			}//Создание неона
			if (Player[playerid][CarSlot2Fire] != 0 && Player[playerid][Prestige] >= 3)
			{
				//new wrld = GetPlayerVirtualWorld(playerid);
			    new vehicleid = PlayerCarID[playerid];
				//Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
			}
			if (Player[playerid][CarSlot2Mig] != 0 && Player[playerid][Level] >= 50)
			{//Создание migalki
			    new vehicleid = PlayerCarID[playerid];
			    new model = GetVehicleModel(vehicleid);
			    new access = 0;
				for (new i=0;i<MAX_MIG;i++)
				{
					if(MigPosInf[i][vhid] == model) access = i;
				}
			    MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Mig], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
			}//Создание migalki
			
			if (Player[playerid][Type] != 0)
			{//Создание vinil
			    if(strcmp(Player[playerid][Vinil], "Null"))
			    {
			    	new vehicleid = PlayerCarID[playerid];
					CreateVehVinil(playerid, vehicleid);
				}
			}//Создание vinil
		}
		else if (Player[playerid][CarActive] == 3){PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot3], x, y, z + 2, Angle, Player[playerid][CarSlot3Color1], Player[playerid][CarSlot3Color2], 0);}
		SetVehicleVirtualWorld(PlayerCarID[playerid], wrld);PutPlayerInVehicle(playerid, PlayerCarID[playerid], 0);
		SetVehicleVelocity(PlayerCarID[playerid], vx, vy, vz); LACSH[playerid] = 3;
        LinkVehicleToInterior(PlayerCarID[playerid],GetPlayerInterior(playerid));
		CarChanged[playerid] = 1;TimeTransform[playerid] = unixtime+5;
		//!!!загрузка пассажиров
		Seats = GetPassengerSeats(PlayerCarID[playerid]);
		if (Seats == 1)
		{//если место всего одно
		    if (Passenger1 > -1){PutPlayerInVehicle(Passenger1, PlayerCarID[playerid], 1);}
		    else
		    {
		        if (Passenger2 > -1){PutPlayerInVehicle(Passenger2, PlayerCarID[playerid], 1);}
		        else
		        {
		            if (Passenger3 > -1){PutPlayerInVehicle(Passenger3, PlayerCarID[playerid], 1);}
		        }
		    }
		}//если место всего одно
		if (Seats == 3)
		{//три места
		    if (Passenger1 > -1){PutPlayerInVehicle(Passenger1, PlayerCarID[playerid], 1);}
		    if (Passenger2 > -1){PutPlayerInVehicle(Passenger2, PlayerCarID[playerid], 2);}
		    if (Passenger3 > -1){PutPlayerInVehicle(Passenger3, PlayerCarID[playerid], 3);}
		}//три места
		//!!!загрузка пассажиров
		if (LSpectators[playerid] > 0) {SpecUpdate(playerid);}//обновление спектра у тех, кто за игроком следил
        QuestUpdate(playerid, 29, 1);//Обновление квеста Трансформируйте транспорт 30 раз
	}//трансформация машины на +1, если игрок за рулем своего авто
	if(newkeys & KEY_NO && IsPlayerInVehicle(playerid, PlayerCarID[playerid]) && GetPlayerState(playerid) == PLAYER_STATE_DRIVER)
	{//трансформация машины на -1, если игрок за рулем своего авто
		new rtime = TimeTransform[playerid] - unixtime;
		if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6); format(String,sizeof(String),"Вы не можете трансформировать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);SendClientMessage(playerid,COLOR_RED,String); return 1;}
        if (LastPlayerTuneStatus[playerid] != 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя трансформироваться в автомастерской и у въезда в нее");
	    LastSpeed[playerid] = 999; NeedSpeedDown[playerid] = 1; LACSH[playerid] = 3;//чтобы 2 сек не работал LAC на SpeedHack (ложные срабатывания)
		new Float: x, Float: y, Float: z, Float: Angle; GetPlayerPos(playerid,x,y,z);
		new Float: vx, Float: vy, Float: vz;new wrld = GetPlayerVirtualWorld(playerid);
        //!!!запись пассажиров
		new Passenger1 = -1, Passenger2 = -1, Passenger3 = -1, Seats;
		foreach(Player, cid)
		{//цикл
		    if (IsPlayerInVehicle(cid,PlayerCarID[playerid]) && GetPlayerState(cid) == PLAYER_STATE_PASSENGER)
		    {//наш пассажир
		        if (GetPlayerVehicleSeat(cid) == 1){Passenger1 = cid;}
		        if (GetPlayerVehicleSeat(cid) == 2){Passenger2 = cid;}
		        if (GetPlayerVehicleSeat(cid) == 3){Passenger3 = cid;}
		    }//наш пассажир
		}//цикл
		//!!!запись пассажиров
		GetVehicleVelocity(PlayerCarID[playerid], vx, vy, vz);
		GetVehicleZAngle(PlayerCarID[playerid], Angle);
		DestroyVehicle(PlayerCarID[playerid]); PlayerCarID[playerid] = -1;
		CarChanged[playerid] = 0;
		if (Player[playerid][CarActive] == 1 && CarChanged[playerid] == 0)
		{//Если сейчас активен слот 1
			if (Player[playerid][CarSlot3] > 0){Player[playerid][CarActive] = 3;CarChanged[playerid] = 1;}
			if (Player[playerid][CarSlot2] > 0){Player[playerid][CarActive] = 2;CarChanged[playerid] = 1;}
			if(CarChanged[playerid] == 0){Player[playerid][CarActive] = 1;CarChanged[playerid] = 1;}
		}//Если сейчас активен слот 1
		if (Player[playerid][CarActive] == 2 && CarChanged[playerid] == 0)
		{//Если сейчас активен слот 2
			if (Player[playerid][CarSlot1] > 0){Player[playerid][CarActive] = 1;CarChanged[playerid] = 1;}
			if (Player[playerid][CarSlot3] > 0){Player[playerid][CarActive] = 3;CarChanged[playerid] = 1;}
			if(CarChanged[playerid] == 0){Player[playerid][CarActive] = 2;CarChanged[playerid] = 1;}
		}//Если сейчас активен слот 2
		if (Player[playerid][CarActive] == 3 && CarChanged[playerid] == 0)
		{//Если сейчас активен слот 3
			if (Player[playerid][CarSlot2] > 0){Player[playerid][CarActive] = 2;CarChanged[playerid] = 1;}
			if (Player[playerid][CarSlot1] > 0){Player[playerid][CarActive] = 1;CarChanged[playerid] = 1;}
			if(CarChanged[playerid] == 0){Player[playerid][CarActive] = 3;CarChanged[playerid] = 1;}
		}//Если сейчас активен слот 3
		if (Player[playerid][CarActive] == 1)
		{
			PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot1], x, y, z + 1, Angle, Player[playerid][CarSlot1Color1], Player[playerid][CarSlot1Color2], 0, Player[playerid][CarSlot1Sir]);
            if (Player[playerid][CarSlot1PaintJob] > -1){ChangeVehiclePaintjob(PlayerCarID[playerid], Player[playerid][CarSlot1PaintJob]);}
			//Загрузка компонентов тюнинга
		    if (Player[playerid][CarSlot1Component0] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component0]);
		    if (Player[playerid][CarSlot1Component1] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component1]);
		    if (Player[playerid][CarSlot1Component2] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component2]);
		    if (Player[playerid][CarSlot1Component3] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component3]);
		    if (Player[playerid][CarSlot1Component4] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component4]);
		    if (Player[playerid][CarSlot1Component5] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component5]);
		    if (Player[playerid][CarSlot1Component6] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component6]);
		    if (Player[playerid][CarSlot1Component7] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component7]);
		    if (Player[playerid][CarSlot1Component8] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component8]);
		    if (Player[playerid][CarSlot1Component9] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component9]);
		    if (Player[playerid][CarSlot1Component10] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component10]);
		    if (Player[playerid][CarSlot1Component11] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component11]);
		    if (Player[playerid][CarSlot1Component12] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component12]);
		    if (Player[playerid][CarSlot1Component13] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component13]);
            if (Player[playerid][CarSlot1Neon] != 0 && Player[playerid][Prestige] >= 4)
			{//Создание неона
			    new vehicleid = PlayerCarID[playerid];
			    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			}//Создание неона
			if (Player[playerid][CarSlot1Fire] != 0 && Player[playerid][Prestige] >= 3)
			{
				//new wrld = GetPlayerVirtualWorld(playerid);
			    new vehicleid = PlayerCarID[playerid];
				//Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
			}
			if (Player[playerid][CarSlot1Mig] != 0 && Player[playerid][Level] >= 50)
			{//Создание migalki
			    new vehicleid = PlayerCarID[playerid];
			    new model = GetVehicleModel(vehicleid);
			    new access = 0;
				for (new i=0;i<MAX_MIG;i++)
				{
					if(MigPosInf[i][vhid] == model) access = i;
				}
				MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Mig], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
			}//Создание migalki
		}
		else if (Player[playerid][CarActive] == 2)
		{
			PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot2], x, y, z + 1, Angle, Player[playerid][CarSlot2Color1], Player[playerid][CarSlot2Color2], 0, Player[playerid][CarSlot2Sir]);
			if (Player[playerid][CarSlot2PaintJob] > -1){ChangeVehiclePaintjob(PlayerCarID[playerid], Player[playerid][CarSlot2PaintJob]);}
        	//Загрузка компонентов тюнинга
		    if (Player[playerid][CarSlot2Component0] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component0]);
		    if (Player[playerid][CarSlot2Component1] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component1]);
		    if (Player[playerid][CarSlot2Component2] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component2]);
		    if (Player[playerid][CarSlot2Component3] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component3]);
		    if (Player[playerid][CarSlot2Component4] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component4]);
		    if (Player[playerid][CarSlot2Component5] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component5]);
		    if (Player[playerid][CarSlot2Component6] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component6]);
		    if (Player[playerid][CarSlot2Component7] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component7]);
		    if (Player[playerid][CarSlot2Component8] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component8]);
		    if (Player[playerid][CarSlot2Component9] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component9]);
		    if (Player[playerid][CarSlot2Component10] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component10]);
		    if (Player[playerid][CarSlot2Component11] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component11]);
		    if (Player[playerid][CarSlot2Component12] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component12]);
		    if (Player[playerid][CarSlot2Component13] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component13]);
            if (Player[playerid][CarSlot2Neon] != 0 && Player[playerid][Prestige] >= 4)
			{//Создание неона
			    new vehicleid = PlayerCarID[playerid];
			    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			}//Создание неона
			if (Player[playerid][CarSlot2Fire] != 0 && Player[playerid][Prestige] >= 3)
			{
				//new wrld = GetPlayerVirtualWorld(playerid);
			    new vehicleid = PlayerCarID[playerid];
				//Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
			}
			if (Player[playerid][CarSlot2Mig] != 0 && Player[playerid][Level] >= 50)
			{//Создание migalki
			    new vehicleid = PlayerCarID[playerid];
			    new model = GetVehicleModel(vehicleid);
			    new access = 0;
				for (new i=0;i<MAX_MIG;i++)
				{
					if(MigPosInf[i][vhid] == model) access = i;
				}
				MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Mig], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
			}//Создание migalki
			
			if (Player[playerid][Type] != 0)
			{//Создание vinil
			    if(strcmp(Player[playerid][Vinil], "Null"))
			    {
			    	new vehicleid = PlayerCarID[playerid];
					CreateVehVinil(playerid, vehicleid);
				}
			}//Создание vinil
		}
		else if (Player[playerid][CarActive] == 3){PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot3], x, y, z + 2, Angle, Player[playerid][CarSlot3Color1], Player[playerid][CarSlot3Color2], 0);}
		SetVehicleVirtualWorld(PlayerCarID[playerid], wrld);PutPlayerInVehicle(playerid, PlayerCarID[playerid], 0);
		SetVehicleVelocity(PlayerCarID[playerid], vx, vy, vz); LACSH[playerid] = 3;
        LinkVehicleToInterior(PlayerCarID[playerid],GetPlayerInterior(playerid));
		CarChanged[playerid] = 1;TimeTransform[playerid] = unixtime+5;
        //!!!загрузка пассажиров
		Seats = GetPassengerSeats(PlayerCarID[playerid]);
		if (Seats == 1)
		{//если место всего одно
		    if (Passenger1 > -1){PutPlayerInVehicle(Passenger1, PlayerCarID[playerid], 1);}
		    else
		    {
		        if (Passenger2 > -1){PutPlayerInVehicle(Passenger2, PlayerCarID[playerid], 1);}
		        else
		        {
		            if (Passenger3 > -1){PutPlayerInVehicle(Passenger3, PlayerCarID[playerid], 1);}
		        }
		    }
		}//если место всего одно
		if (Seats == 3)
		{//три места
		    if (Passenger1 > -1){PutPlayerInVehicle(Passenger1, PlayerCarID[playerid], 1);}
		    if (Passenger2 > -1){PutPlayerInVehicle(Passenger2, PlayerCarID[playerid], 2);}
		    if (Passenger3 > -1){PutPlayerInVehicle(Passenger3, PlayerCarID[playerid], 3);}
		}//три места
		//!!!загрузка пассажиров
		if (LSpectators[playerid] > 0) {SpecUpdate(playerid);}//обновление спектра у тех, кто за игроком следил
        QuestUpdate(playerid, 29, 1);//Обновление квеста Трансформируйте транспорт 30 раз
	}//трансформация машины на -1

    if((newkeys & KEY_YES || newkeys & KEY_NO) && IsPlayerInVehicle(playerid, QuestCar[playerid]) && QuestActive[playerid] == 0)
    {//Игрок нажал Y или N сидя в угнанной машине (повторный вызов менюшки угона)
        new modelid = GetVehicleModel(QuestCar[playerid]);
		
        switch (modelid)
        {//switch
	        case 417, 447, 469, 476, 487, 488, 497, 511, 512, 513, 519, 548, 563, 593:
	        {//Воздушное авто
		        modelid -= 400; new String[120];
				format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[modelid], GetVehicleMaxSpeed(QuestCar[playerid]) * 2000);
		        ShowPlayerDialog(playerid, DIALOG_STEALAIRCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}3{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
			}//Воздушное авто
			case 472, 473, 493, 595, 484, 430, 453, 452, 446, 454, 460:
			{//Водные авто
		        modelid -= 400; new String[120];
				format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[modelid], GetVehicleMaxSpeed(QuestCar[playerid]) * 500);
		        ShowPlayerDialog(playerid, DIALOG_STEALWATERCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}3{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
			}//Водные авто
			default:
		    {//Наземные авто
		        if(modelid < 400) return 1; //странный баг, но бывает
				modelid -= 400; new String[120];
				format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[modelid], GetVehicleMaxSpeed(QuestCar[playerid]) * 500);
			    ShowPlayerDialog(playerid, DIALOG_STEALCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}1{FFFFFF}-го класса\nСделать личным транспортом {007FFF}2{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
			}//Наземные авто
        }//switch
    }//Игрок нажал Y или N сидя в угнанной машине (повторный вызов менюшки угона)

	if(newkeys & KEY_FIRE || newkeys & KEY_SECONDARY_ATTACK || newkeys & KEY_ACTION)
	{//кнопки атаки
		if (GetPlayerState(playerid) == 1 && Player[playerid][Slot9] == -1)
		{//Стиль драки MixFight
			new rand = random(6);
			if (rand == 0){SetPlayerFightingStyle (playerid, FIGHT_STYLE_NORMAL);}
			if (rand == 1){SetPlayerFightingStyle (playerid, FIGHT_STYLE_BOXING);}
			if (rand == 2){SetPlayerFightingStyle (playerid, FIGHT_STYLE_KUNGFU);}
			if (rand == 3){SetPlayerFightingStyle (playerid, FIGHT_STYLE_KNEEHEAD);}
			if (rand == 4){SetPlayerFightingStyle (playerid, FIGHT_STYLE_GRABKICK);}
			if (rand == 5){SetPlayerFightingStyle (playerid, FIGHT_STYLE_ELBOW);}
		}//Стильь драки MixFight
		if (InPeacefulZone[playerid] == 1 || AdminTPCantKill[playerid] > 0)
		{//В мирной зоне
            if (GetPlayerState(playerid) == 1) {SetPlayerArmedWeapon(playerid,0); ApplyAnimation(playerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);}//пешком
			if (GetPlayerState(playerid) == PLAYER_STATE_DRIVER && InEvent[playerid] == 0)
			{//за рулем, не в соревах (чтобы в гонках из авто не выкидывало)
			    new model = GetVehicleModel(GetPlayerVehicleID(playerid));
			    if (model == 447 || model == 520 || model == 425 || model == 476 || model == 464 || model == 432 || model == 430)
				{
				    DestroyVehicle(GetPlayerVehicleID(playerid));
				    SendClientMessage(playerid, COLOR_RED, "Нельзя драться в мирной зоне!");
				}
			}//за рулем, не в соревах (чтобы в гонках из авто не выкидывало)
		}//В мирной зоне
		if (PrestigeGM[playerid] == 1)
		{//режим Бога
		    if (GetPlayerState(playerid) == 1 && InEvent[playerid] == 0) ApplyAnimation(playerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);//нельзя ударить кого-то при низкой карме или позоре
            if (GetPlayerState(playerid) == PLAYER_STATE_DRIVER  && InEvent[playerid] == 0)
			{
			    new model = GetVehicleModel(GetPlayerVehicleID(playerid));
			    if (model == 447 || model == 520 || model == 425 || model == 476 || model == 464 || model == 432 || model == 430)
				{
				    DestroyVehicle(GetPlayerVehicleID(playerid));
				    SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Запрещено пользоваться оружием в Режиме Бога");
				}
			}
		}//режим Бога
	}//кнопки атаки

	if((newkeys & KEY_FIRE) && (GetPlayerState(playerid) == PLAYER_STATE_ONFOOT || GetPlayerState(playerid) == PLAYER_STATE_PASSENGER))
	{//Кнопка выстрела
	    //AntiPlus
	    if (GetPlayerState(playerid) == PLAYER_STATE_ONFOOT) AntiPlus[playerid] = 2; //deagle, shotgun, sniper

		//---------------------- LAC на Оружие
		new weaponid = GetPlayerWeapon(playerid);
		if(weaponid > 0 && weaponid < 46 && Weapons[playerid][weaponid] == 0 && Player[playerid][Banned] == 0)
		{
			new cheat = 1, String[140];
			if (LACWeaponOff[playerid] > 0) cheat = 0;//Если нужно, чтобы LAC не работал
			if (cheat == 1)
			{//игрок читер
				ResetPlayerWeapons(playerid); LSpawnPlayer(playerid); LACWeaponOff[playerid] = 3;
				LACPanic[playerid]++;//LAC v2.0
				format(String,sizeof(String), "[АДМИНАМ]LAC:{AFAFAF} %s[%d] возможно использует чит на Оружие",PlayerName[playerid], playerid);
				foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
				SendClientMessage(playerid, -1,"{FF0000}LAC:{AFAFAF} Вы были заново зареспавнены. {FF0000}Причина: {AFAFAF}Возможно чит на Оружие");
				format(String, 140, "%d.%d.%d a %d:%d:%d |   LAC: %s[%d] возможно использует чит на Оружие", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
				WriteLog("GlobalLog", String);WriteLog("LAC", String);
			}//игрок читер
		}
		//---------------------- LAC на Оружие

	}//Кнопка выстрела

	if(newkeys & KEY_CROUCH && GetPlayerState(playerid) == 1 && AntiPlus[playerid] > 0) ApplyAnimation(playerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);


	/*if(newkeys & KEY_SECONDARY_ATTACK || newkeys & KEY_SPRINT)
	{//смена скина - выбор
		if (SkinChangeMode[playerid] == 1)
		{
			SavePlayer(playerid);
			TogglePlayerControllable(playerid,1);
			SkinChangeMode[playerid] = 0;
			SetPlayerVirtualWorld(playerid,0);
			LSpawnPlayer(playerid);
			TextDrawHideForPlayer(playerid, SkinChangeTextDraw);
			TextDrawHideForPlayer(playerid, SkinIDTD[playerid]);
		}
	}//смена скина - выбор*/

	if(newkeys & KEY_WALK && GetPlayerState(playerid) == 1)
	{//нажал альт - дом, штаб, аэропорт, казино, работа
	    new xOnce = 0;
		//------ Банк
		if (GetPVarInt(playerid, "BCassa") != 0)
		{//Игрок в банке
		    //Высчитывание макс. денег
		    xOnce = 1;
			ShowBankDialog(playerid);
		}
/*
		if (IsPlayerInRangeOfPoint(playerid,2,2324.4902,-1149.5474,1050.7101) || IsPlayerInRangeOfPoint(playerid,2,243.7173,304.9818,999.1484) || IsPlayerInRangeOfPoint(playerid,2,2218.4033,-1076.2634,1050.4844) || IsPlayerInRangeOfPoint(playerid,2,2365.3140,-1135.5983,1050.8826) || IsPlayerInRangeOfPoint(playerid,2,2496.0002,-1692.0852,1014.7422) || IsPlayerInRangeOfPoint(playerid,2,2270.4172,-1210.4956,1047.5625))
		{//выход из дома
		    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
			new houseid = GetPlayerVirtualWorld(playerid) - 1000;
			SetPlayerPos(playerid, Property[houseid][pPosEnterX], Property[houseid][pPosEnterY],Property[houseid][pPosEnterZ]);
			SetPlayerFacingAngle(playerid, Property[houseid][pPosEnterA] - 180.0);
			SetPlayerVirtualWorld(playerid,0);SetPlayerInterior(playerid,0);
            InPeacefulZone[playerid] = 0;
			SetCameraBehindPlayer(playerid);
			return 1;
		}//выход из дома
*/
		if (IsPlayerInRangeOfPoint(playerid,2,2332.5144,-1144.4189,1054.3047) || IsPlayerInRangeOfPoint(playerid,2,2215.7893,-1074.6979,1050.4844) || IsPlayerInRangeOfPoint(playerid,2,2363.7717,-1127.3329,1050.8826) || IsPlayerInRangeOfPoint(playerid,2,2492.4016,-1708.5626,1018.3368) || IsPlayerInRangeOfPoint(playerid,2,2262.7871,-1216.8030,1049.0234))
		{//Смена скина в доме
            ShowModelSelectionMenu(playerid, MenuMyskin, "MySkin");
            xOnce = 1;
		}//Смена скина в доме

		for(new i = 0; i < 4; i++)
		{//магазины одежды
		    if (IsPlayerInRangeOfPoint(playerid,1.5,CLOTHESENTERS[i][0],CLOTHESENTERS[i][1],CLOTHESENTERS[i][2]))
		    {//игрок у магазина одежды
        		if (Player[playerid][Cash] < 10000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вам нужно 10 000$ чтобы войти в магазин одежды!");
				Player[playerid][Cash] -= 10000;
				SendClientMessage(playerid,COLOR_YELLOW,"Вы заплатили 10 000$ за вход в магазин одежды. Выберите модель персонажа..");
				SetPlayerPos(playerid,681.4626,-450.8589,-25.6172);
				SetPlayerFacingAngle(playerid,-180.0);
				SetPlayerInterior(playerid,1);
				SetPlayerVirtualWorld(playerid,playerid + 1);
				SetPlayerCameraPos(playerid,681.4331,-454.7023,-24.5537);
				SetPlayerCameraLookAt(playerid,681.4626,-450.8589,-25.1172);
				TogglePlayerControllable(playerid,0);
				SkinChangeMode[playerid] = 1;
				SetPlayerArmedWeapon(playerid, 0);
				ShowModelSelectionMenu(playerid, MenuMyskin, "MySkin");
			    xOnce = 1;
		    }//игрок у магазина одежды
		}//магазины одежды

		if (IsPlayerInRangeOfPoint(playerid,1.5,1962.3420,1009.6814,992.4688) || IsPlayerInRangeOfPoint(playerid,1.5,1958.0320,1009.6746,992.4688) || IsPlayerInRangeOfPoint(playerid,1.5,1962.3417,1025.3008,992.4688) || IsPlayerInRangeOfPoint(playerid,1.5,1958.0321,1025.2384,992.4688))
		{//казино - рулетка
		    if (Player[playerid][CasinoBalance] >= 100000000 && Player[playerid][Prestige] < 9) return SendClientMessage(playerid, COLOR_RED, "Проваливай! Тебе здесь не рады!");
   			new String[180], MaxBet; xOnce = 1;
   			if (Player[playerid][Level] < 39) MaxBet = 100000; //1 - 38 лвл: 100 000$
   			else if (Player[playerid][Level] < 53) MaxBet = 250000; //39 - 52 лвл: 250 000$
   			else if (Player[playerid][Level] < 66) MaxBet = 500000; //53 - 65 лвл: 500 000$
   			else MaxBet = 1000000; //66+ лвл: 1 000 000$
   			if (Player[playerid][Prestige] >= 9) MaxBet = 100000000; //Престиж 8: 100 000 000$
			format(String,sizeof(String),"{AFAFAF}Максимальная Ставка: {FFFFFF}%d", MaxBet);
			ShowPlayerDialog(playerid, DIALOG_CASINORULET, 2, String, "{FFFFFF}Поставить на {FF0000}Красное\n{FFFFFF}Поставить на {AFAFAF}Черное\n{FFFFFF}Поставить на {FFFF00}1-12\n{FFFFFF}Поставить на {FFFF00}13-24\n{FFFFFF}Поставить на {FFFF00}25-36\n{FFFFFF}Поставить на {FFFF00}Число", "ОК", "Отмена");
		}//казино - рулетка

		if (IsPlayerInRangeOfPoint(playerid,1.5,1954.1530,995.4341,992.8594))
		{//Казино - Веселый Будда
		    new String[140], randaction = random(3), randvalue; xOnce = 1;
		    if (Player[playerid][BuddhaTime] > 0)
		    {
		        format(String, sizeof String, "Веселый Будда будет доступен через %d минут", Player[playerid][BuddhaTime]/60 + 1);
		        return SendClientMessage(playerid, COLOR_RED, String);
		    }
			Player[playerid][BuddhaTime] = 1800;
			if (randaction == 0)
			{//Отрицательное действие
				randvalue = random(50000) + 1;//от 1 до 50 000
				Player[playerid][Cash] -= randvalue; //SavePlayer(playerid);
				format(String,sizeof(String),"Веселый Будда: Вы потеряли {FFFFFF}%d{FF0000}$", randvalue);
                SendClientMessage(playerid, COLOR_RED, String);
                format(String, sizeof String, "-%d$", randvalue); SetPlayerChatBubble(playerid, String, COLOR_RED, 50.0, 3000);
			}//Отрицательное действие
			else if (randaction == 1)
			{//Положительное действие - Деньги
				randvalue = random(200000) + 50000;//от 50 000 до 250 000
				Player[playerid][Cash] += randvalue; //SavePlayer(playerid);
				format(String,sizeof(String),"Веселый Будда: Вы получили {FFFFFF}%d{FFCC00}$", randvalue);
                SendClientMessage(playerid, COLOR_QUEST, String);
                format(String, sizeof String, "+%d$", randvalue); SetPlayerChatBubble(playerid, String, COLOR_GREEN, 50.0, 3000);
			}//Положительное действие - Деньги
			else if (randaction == 2)
			{//Положительное действие - XP
				randvalue = random(400) + 100;//от 100 до 500
				format(String,sizeof(String),"Веселый Будда: Вы получили {FFFFFF}%d{FFCC00} XP", randvalue);
				SendClientMessage(playerid, COLOR_QUEST, String);
				LGiveXP(playerid, randvalue); //SavePlayer(playerid);
				format(String, sizeof String, "+%d XP", randvalue); SetPlayerChatBubble(playerid, String, COLOR_YELLOW, 50.0, 3000);
			}//Положительное действие - XP
		}//Казино - Веселый Будда

		if (IsPlayerInRangeOfPoint(playerid,1.5,1958.3613,953.2741,10.8203))
		{//Казино - вход слева
		    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
		    SetPlayerPos(playerid, 1963.7800,972.4600,994.4688);
		    SetPlayerFacingAngle(playerid, 30); SetPlayerInterior(playerid, 10);
		    SetCameraBehindPlayer(playerid); SetPlayerVirtualWorld(playerid, 10); xOnce = 1;
            InPeacefulZone[playerid] = 1;
		}//Казино - вход слева

		if (IsPlayerInRangeOfPoint(playerid,1.5,1963.7800,972.4600,994.4688))
		{//Казино - выход слева
		    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
		    SetPlayerPos(playerid, 1958.3613,953.2741,10.82030);
		    SetPlayerFacingAngle(playerid, 176); SetPlayerInterior(playerid, 0);
		    SetCameraBehindPlayer(playerid); SetPlayerVirtualWorld(playerid, 0); xOnce = 1;
            InPeacefulZone[playerid] = 0;
		}//Казино - выход слева

		if (IsPlayerInRangeOfPoint(playerid,1.5,2019.3174,1007.8547,10.8203))
		{//Казино - вход центральный
		    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
		    SetPlayerPos(playerid, 2018.9702, 1017.8456, 996.8750);
		    SetPlayerFacingAngle(playerid, 90); SetPlayerInterior(playerid, 10);
		    SetCameraBehindPlayer(playerid); SetPlayerVirtualWorld(playerid, 10); xOnce = 1;
            InPeacefulZone[playerid] = 1;
		}//Казино - вход центральный

		if (IsPlayerInRangeOfPoint(playerid,1.5,2018.9702,1017.8456,996.8750))
		{//Казино - выход центральный
            if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
		    SetPlayerPos(playerid, 2019.3174,1007.8547,10.8203);
		    SetPlayerFacingAngle(playerid, 270); SetPlayerInterior(playerid, 0);
		    SetCameraBehindPlayer(playerid); SetPlayerVirtualWorld(playerid, 0); xOnce = 1;
            InPeacefulZone[playerid] = 0;
		}//Казино - выход центральный

		if (IsPlayerInRangeOfPoint(playerid,1.5,1944.2803,1076.0552,10.8203))
		{//Казино - вход справа
		    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
		    SetPlayerPos(playerid, 1963.6882,1063.2550,994.4688);
		    SetPlayerFacingAngle(playerid, 180); SetPlayerInterior(playerid, 10);
		    SetCameraBehindPlayer(playerid); SetPlayerVirtualWorld(playerid, 10); xOnce = 1;
            InPeacefulZone[playerid] = 1;
		}//Казино - вход справа

		if (IsPlayerInRangeOfPoint(playerid,1.5,1963.6882,1063.2550,994.4688))
		{//Казино - выход справа
		    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
		    SetPlayerPos(playerid, 1944.2803,1076.0552,10.8203);
		    SetPlayerFacingAngle(playerid, 0); SetPlayerInterior(playerid, 0);
		    SetCameraBehindPlayer(playerid); SetPlayerVirtualWorld(playerid, 0); xOnce = 1;
            InPeacefulZone[playerid] = 0;
		}//Казино - выход справа

		if (IsPlayerInRangeOfPoint(playerid,1.5,1451.6349,-2287.0703,13.5469) || IsPlayerInRangeOfPoint(playerid,2,-1404.6575,-303.7458,14.1484) || IsPlayerInRangeOfPoint(playerid,2,1672.9861,1447.9349,10.7868) || GetPVarInt(playerid, "BBilet") != 0)
		{//аэропорт
		    if (InEvent[playerid] == 0)
		    {//игрок не на соревнованиях
			    if (GetPlayerVirtualWorld(playerid) == 0 || GetPlayerVirtualWorld(playerid) == 648) ShowPlayerDialog(playerid, DIALOG_AIRPORT, 2, "Аэропорт. Стоимость перелета: 50 000$", "{FFFFFF}Лос Сантос\nСан Фиерро\nЛас Вентурас", "ОК", "Отмена");
				else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Аэропорт недоступен в данный момент.");
			}//игрок не на соревнованиях
            xOnce = 1;
		}//аэропорт

		if (IsPlayerInRangeOfPoint(playerid,2,2397.7632,-1899.1389,13.5469) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)
		{//Работа - Доставщик пиццы
            WorkPizzaID[playerid] = random(8) + 1; WorkPizzaCP[playerid] = 0; xOnce = 1;
		    QuestCar[playerid] = LCreateVehicle(448, 2386.8760, -1921.9377, 12.9784, 270.0, 3, 3, 0);
			PutPlayerInVehicle(playerid,QuestCar[playerid], 0); QuestActive[playerid] = 2; WorkTime[playerid] = 0;
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Вовремя доставь пиццу {FF0000}клиентам{FFCC00} и вернись за зарплатой!");
			switch(WorkPizzaID[playerid])
			{
			    case 1: {WorkPizzaCPs[playerid] = 18; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA1[0][0], PIZZA1[0][1], PIZZA1[0][2], PIZZA1[1][0], PIZZA1[1][1], PIZZA1[1][2], 7);}
			    case 2: {WorkPizzaCPs[playerid] = 19; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA2[0][0], PIZZA2[0][1], PIZZA2[0][2], PIZZA2[1][0], PIZZA2[1][1], PIZZA2[1][2], 7);}
			    case 3: {WorkPizzaCPs[playerid] = 20; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA3[0][0], PIZZA3[0][1], PIZZA3[0][2], PIZZA3[1][0], PIZZA3[1][1], PIZZA3[1][2], 7);}
			    case 4: {WorkPizzaCPs[playerid] = 21; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA4[0][0], PIZZA4[0][1], PIZZA4[0][2], PIZZA4[1][0], PIZZA4[1][1], PIZZA4[1][2], 7);}
			    case 5: {WorkPizzaCPs[playerid] = 20; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA5[0][0], PIZZA5[0][1], PIZZA5[0][2], PIZZA5[1][0], PIZZA5[1][1], PIZZA5[1][2], 7);}
			    case 6: {WorkPizzaCPs[playerid] = 25; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA6[0][0], PIZZA6[0][1], PIZZA6[0][2], PIZZA6[1][0], PIZZA6[1][1], PIZZA6[1][2], 7);}
			    case 7: {WorkPizzaCPs[playerid] = 22; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA7[0][0], PIZZA7[0][1], PIZZA7[0][2], PIZZA7[1][0], PIZZA7[1][1], PIZZA7[1][2], 7);}
			    case 8: {WorkPizzaCPs[playerid] = 20; return SetPlayerRaceCheckpoint(playerid, 0, PIZZA8[0][0], PIZZA8[0][1], PIZZA8[0][2], PIZZA8[1][0], PIZZA8[1][1], PIZZA8[1][2], 7);}
			}
		}//Работа - Доставщик пиццы

		//Работа - Грузчик (Конец)
        if (QuestActive[playerid] == 3){xOnce = 1; ShowPlayerDialog(playerid,DIALOG_WORKGRUZSTOP,0,"Грузчик - Завершить работу?","{FFFFFF}Завершить работу грузчиком?","Да","Отмена");}
        //Работа - Доставщика пиццы, Домушника (когда потерял транспорт и нажал Альт)
        if (QuestActive[playerid] == 2 || QuestActive[playerid] >= 4){xOnce = 1; ShowPlayerDialog(playerid,DIALOG_WORKSTOP,2,"Работа","Вызвать рабочий транспорт\n{FF0000}Завершить работу","ОК","Отмена");}

		if (IsPlayerInRangeOfPoint(playerid,2, 2729.3267, -2451.4578, 17.5937) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)// Проверяем нахождение игрока в точках начала работы
        {//Работа - Грузчик (Старт)
            SendClientMessage(playerid, COLOR_QUEST, "Работа: Бери {FF0000}груз{FFCC00} и переноси его в точку назначения!");
			QuestActive[playerid] = 3; WorkTime[playerid] = 0; WorkTimeGruz[playerid] = 0; xOnce = 1;
            SetPVarInt(playerid,"WorkStage",1);// Устанавливаем момент работы, 1 - идём брать вещи. 2 - несём вещи.
            new checkp = random(sizeof GRUZFROM);// Рандомно выдаём координаты где брать груз
            ApplyAnimation(playerid,"CARRY","Null",4.1,0,1,1,1,1);//Прогружаем библиотеку с анимациями
            SetPlayerCheckpoint(playerid,GRUZFROM[checkp][0],GRUZFROM[checkp][1],GRUZFROM[checkp][2],1.5);// Создаём один из чекпоинтов
        }//Работа - Грузчик (Старт)

        if (IsPlayerInRangeOfPoint(playerid,2,-1972.5024,-1020.2568,32.1719) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)
		{//Работа - Домушник
		    if (Player[playerid][Level] < 14) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 14-го уровня чтобы работать домушником!");
            new rand = random(MAX_PROPERTY); if (rand == 0) rand++;//Выбираем дом для ограбления
            if (rand == Player[playerid][Home]) {if (rand > 1) rand--; else rand++;}//Выбрался дом грабителя - исправляем
            SetPVarInt(playerid, "WorkDomStage", 1); QuestActive[playerid] = 4; WorkTime[playerid] = 0; xOnce = 1;
		    QuestCar[playerid] = LCreateVehicle(609, -1945.5354,-1085.3024,30.8479, 0.0, 25, 25, 0); PutPlayerInVehicle(playerid,QuestCar[playerid], 0);
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Обчисти {FF0000}дом{FFCC00} и привези награбленное сюда!");
            SetPlayerCheckpoint(playerid,Property[rand][pPosEnterX],Property[rand][pPosEnterY],Property[rand][pPosEnterZ],2);
		}//Работа - Домушник

		if (IsPlayerInRangeOfPoint(playerid,2,-1061.6104,-1195.4755,129.8281) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)
		{//Работа - Комбайнер
		    if (Player[playerid][Level] < 21) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 21-го уровня чтобы работать комбайнером!");
			new Float: wx = random(20) - 10 - 1096, Float: wy = random(20) - 10 - 992, Float: wz = 130, Float:wa = random(360);
		    QuestCar[playerid] = LCreateVehicle(532, wx, wy, wz, wa, 25, 25, 0); PutPlayerInVehicle(playerid,QuestCar[playerid], 0);
            QuestActive[playerid] = 5; WorkTime[playerid] = 0; xOnce = 1;
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Разъезжай по {FF0000}полю{FFCC00} и коси овёс!");
            GangZoneShowForPlayer(playerid, WorkZoneCombine, 0xFF000080);
		}//Работа - Комбайнер

		if (IsPlayerInRangeOfPoint(playerid,2,2484.6682,-2120.8743,13.5469) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)
		{//Работа - Дальнобойщик
		    if (Player[playerid][Level] < 28) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 28-го уровня чтобы работать дальнобойщиком!");
            new rand = random(sizeof WORKTRUCK);//Выбираем место доставки груза
            SetPlayerCheckpoint(playerid,WORKTRUCK[rand][0], WORKTRUCK[rand][1], WORKTRUCK[rand][2], 10);
	        SetPVarInt(playerid, "WorkTruckStage", 1); QuestActive[playerid] = 6; WorkTime[playerid] = 0; xOnce = 1;
		    QuestCar[playerid] = LCreateVehicle(515, 2453.7183, -2089.3940, 15.2, 90.0, 4, 4, 0); PutPlayerInVehicle(playerid,QuestCar[playerid], 0);
			CallTrailer(QuestCar[playerid], 584);
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Доставь груз до {FF0000}места назначения{FFCC00} и вернись за зарплатой!");
		}//Работа - Дальнобойщик

		if (IsPlayerInRangeOfPoint(playerid,2,-1713.1389,-61.8556,3.5547) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)
		{//Работа - Капитан Корабля
		    if (Player[playerid][Level] < 35) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 35-го уровня чтобы работать капитаном корабля!");
            new rand = random(sizeof WORKWATER);//Выбираем место доставки груза
            SetPlayerCheckpoint(playerid,WORKWATER[rand][0], WORKWATER[rand][1], WORKWATER[rand][2], 10);
	        SetPVarInt(playerid, "WorkWaterStage", 1); QuestActive[playerid] = 7; WorkTime[playerid] = 0; xOnce = 1;
		    QuestCar[playerid] = LCreateVehicle(452, -1759.8169,-192.7360,0.5, 270.0, 1, 2, 0); PutPlayerInVehicle(playerid,QuestCar[playerid], 0);
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Доставь груз до {FF0000}места назначения{FFCC00} и вернись за зарплатой!");
		}//Работа - Капитан Корабля

		if (IsPlayerInRangeOfPoint(playerid,2,2364.8955,2382.8770,10.8203) && QuestActive[playerid] == 0 && InEvent[playerid] == 0)
		{//Работа - Инкассатор
		    if (Player[playerid][Level] < 42) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 42-го уровня чтобы работать инкассатором!");
            new rand = random(MAX_BASE); if (rand == 0) rand++;//Выбираем штаб для сбора денег
            SetPVarInt(playerid, "WorkBankStage", 1); QuestActive[playerid] = 8; WorkTime[playerid] = 0; xOnce = 1;
		    QuestCar[playerid] = LCreateVehicle(428, 2361.7593,2397.3511,10.9471, 0.0, 227, 4, 0); PutPlayerInVehicle(playerid,QuestCar[playerid], 0);
			SendClientMessage(playerid, COLOR_QUEST, "Работа: Собери деньги со {FF0000}штаба{FFCC00} и привези их сюда!");
            SetPlayerCheckpoint(playerid,Base[rand][bPosEnterX],Base[rand][bPosEnterY],Base[rand][bPosEnterZ],2);
		}//Работа - Инкассатор

		if (xOnce == 0 && SkinChangeMode[playerid] == 0)
		{//Меню быстрого доступа
		    if (InEvent[playerid] == 0)
		    {//Игрок не в соревнованиях
				ShowPlayerAltMenu(playerid);
			}//Игрок не в соревнованиях
			if (JoinEvent[playerid] == EVENT_RACE && TimeTransform[playerid]-unixtime <= 0)
			{//Вызов транспорта в обычной гонке
			    new Float: x, Float: y, Float: z, Float: Angle, col1 = random(187), col2 = random(187);
			    GetPlayerPos(playerid,x,y,z);GetPlayerFacingAngle(playerid, Angle);
			    FRCarID[playerid] = LCreateVehicle(FRModelCar, x, y, z, Angle, col1, col2, 0);
				SetVehicleVirtualWorld(FRCarID[playerid], 661);PutPlayerInVehicle(playerid, FRCarID[playerid], 0);
                new rand = random(3);ChangeVehiclePaintjob(GetPlayerVehicleID(playerid), rand);//случайный paintjob
				//Ниже закрываем двери
				new engine, lights, alarm, doors, bonnet, boot, objective; TimeTransform[playerid] = unixtime+5;
			    GetVehicleParamsEx(FRCarID[playerid], engine, lights, alarm, doors, bonnet, boot, objective);
			    SetVehicleParamsEx(FRCarID[playerid], engine, lights, alarm, true, bonnet, boot, objective);
                SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Если ваша машина перевернулась в гонке, используйте клавишу гудка чтобы поставить ее на колеса");
			}//Вызов транспорта в обычной гонке
			if (JoinEvent[playerid] == EVENT_XRACE && TimeTransform[playerid]-unixtime <= 0)
			{//Вызов транспорта в легендарной гонке
			    new Float: x, Float: y, Float: z, Float: Angle, col1 = random(187), col2 = random(187);
				GetPlayerPos(playerid,x,y,z);GetPlayerFacingAngle(playerid, Angle);
				XRCarID[playerid] = LCreateVehicle(XRPlayerCar[playerid], x, y, z, Angle, col1, col2, 0);
				SetVehicleVirtualWorld(XRCarID[playerid], 700);PutPlayerInVehicle(playerid, XRCarID[playerid], 0);
                new rand = random(3);ChangeVehiclePaintjob(GetPlayerVehicleID(playerid), rand);//случайный paintjob
				//Ниже закрываем двери
				new engine, lights, alarm, doors, bonnet, boot, objective; TimeTransform[playerid] = unixtime+5;
			    GetVehicleParamsEx(XRCarID[playerid], engine, lights, alarm, doors, bonnet, boot, objective);
			    SetVehicleParamsEx(XRCarID[playerid], engine, lights, alarm, true, bonnet, boot, objective);
			}//Вызов транспорта в легендарной гонке
			if (InEvent[playerid] == EVENT_PARK)
			{//возврат на паркуре
			    new CPid = PRPlayerLastCP[playerid], rtime = PBackTime[playerid] - unixtime;
	    		if (rtime > 0) {new StringZ[20]; format(StringZ, sizeof StringZ, "~b~%d sec", rtime); GameTextForPlayer(playerid, StringZ, 1000, 6); return 1;}
	    		SendClientMessage(playerid,COLOR_PARK,"Вы вернулись на последнюю контрольную точку!");
	    		switch (PRid)
				{
					case 1:
     				{
						SetPlayerPos(playerid, ParkCoord1[CPid][0], ParkCoord1[CPid][1],ParkCoord1[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord1[CPid][3]);
					}
					case 2:
     				{
						SetPlayerPos(playerid, ParkCoord2[CPid][0], ParkCoord2[CPid][1],ParkCoord2[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord2[CPid][3]);
					}
					case 3:
     				{
						SetPlayerPos(playerid, ParkCoord3[CPid][0], ParkCoord3[CPid][1],ParkCoord3[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord3[CPid][3]);
					}
					case 4:
     				{
						SetPlayerPos(playerid, ParkCoord4[CPid][0], ParkCoord4[CPid][1],ParkCoord4[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord4[CPid][3]);
					}
					case 5:
     				{
						SetPlayerPos(playerid, ParkCoord5[CPid][0], ParkCoord5[CPid][1],ParkCoord5[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord5[CPid][3]);
					}
					case 6:
     				{
						SetPlayerPos(playerid, ParkCoord6[CPid][0], ParkCoord6[CPid][1],ParkCoord6[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord6[CPid][3]);
					}
					/*case 6:
     				{
						SetPlayerPos(playerid, ParkCoord4ny[CPid][0], ParkCoord4ny[CPid][1],ParkCoord4ny[CPid][2]);
						SetPlayerFacingAngle(playerid, ParkCoord4ny[CPid][3]);
					}*/
				}
        		PBackTime[playerid] = unixtime + 3;
			}//возврат на паркуре
			if (BTStarted[playerid] == 1)
			{
			    ShowPlayerBTInventory(playerid);
			}
		}//Меню быстрого доступа
		ShowHouseDialog(playerid);
        ShowBaseDialog(playerid);
	}//нажал альт - банк, дом, штаб, рулетка, аэропорт

    if(QuestActive[playerid] == 3 && GetPVarInt(playerid,"WorkStage") == 2)
    {//грузчик, несущий груз
    	if(newkeys == KEY_SECONDARY_ATTACK || newkeys == KEY_JUMP || newkeys == KEY_SECONDARY_ATTACK || newkeys == KEY_FIRE || newkeys == KEY_CROUCH)
        {//обранил груз
        	RemovePlayerAttachedObject(playerid,8);// Удаляем объект из рук
            ApplyAnimation(playerid,"PED","IDLE_tired",4.1,0,1,1,0,1);// Обнуляем анимацию
            SetPVarInt(playerid,"WorkStage",1);// Устанавливаем момент работы игрока на 1..
            new checkp = random(sizeof GRUZFROM);
            SetPlayerCheckpoint(playerid,GRUZFROM[checkp][0],GRUZFROM[checkp][1],GRUZFROM[checkp][2],1.5);// Создаём один из чекпоинтов
        }//обранил груз
    }//грузчик, несущий груз

	//moto nitro
 	if (PRESSED(KEY_FIRE)  || PRESSED(KEY_ACTION))
	{//кнопки нитро
		 if (((Player[playerid][CarActive] == 1 && Player[playerid][CarSlot1NitroX] >= 2) || (Player[playerid][CarActive] == 2 && Player[playerid][CarSlot2NitroX] >= 2)) && InEvent[playerid] == 0 && QuestActive[playerid] == 0)
		 {//UberNitro класс 1, 2
		    new rtime = UberNitroTime[playerid] - unixtime;
		    if (rtime > 0)
		    {//UberNitro еще недоступно
		        new StringZ[20];
				format(StringZ, sizeof StringZ, "~R~%d sec", rtime);
		        GameTextForPlayer(playerid, StringZ, 1000, 6);
		    }//UberNitro еще недоступно
		    else
		    {//UberNitro доступно
		        new vehicleid = GetPlayerVehicleID(playerid), MaxSpeed = GetVehicleMaxSpeed(vehicleid);
		        if (MaxSpeed > 250) MaxSpeed = 250;//для мотоциклов и тд, где макс. скорость 300
				SetVehicleSpeed(vehicleid, MaxSpeed);
				LastSpeed[playerid] = MaxSpeed; LACSH[playerid] = 3; UberNitroTime[playerid] = unixtime + 5;
				SetPlayerChatBubble(playerid, "Использовал UberNitro", COLOR_GREEN, 300.0, 3000);
			}//UberNitro доступно
		}//UberNitro класс 1, 2
	}//кнопки нитро

	//ubervortex
	if (Player[playerid][Level] >= 90 && Player[playerid][CarActive] == 3)
	{//ubervortex
		new vehid = GetPlayerVehicleID(playerid);
		new model = GetVehicleModel(vehid);
		if(model == 539)
		{//ubervortex
			if (PRESSED(KEY_SUBMISSION))
			{//2 - взлет
			    new Float:Velocity[3];
				GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);
				SetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2] + 0.25);
				NeedSpeedDown[playerid] = 1;LACTeleportOff[playerid] = 3;
			}//2 - взлет
			if (PRESSED(KEY_CROUCH))
			{//H - приземление
			    new Float:Velocity[3];
				GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);
				SetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2] - 0.25);
				LastSpeed[playerid] = 999;LACSH[playerid] = 10;LACTeleportOff[playerid] = 3;
			}//H - приземление
   			if (newkeys & KEY_FIRE || newkeys & KEY_ACTION)
			{//Альт - ускорение
			    new Float:Velocity[3];
				GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);
				if(Velocity[0] < 4  && Velocity[1] < 4 && Velocity[0] > -4 && Velocity[1] > -4)
				{
					SetVehicleVelocity(vehid, Velocity[0]*2, Velocity[1]*2, Velocity[2] * 0.8);
					NeedSpeedDown[playerid] = 1; LACSH[playerid] = 5;LACTeleportOff[playerid] = 3;
				}
			}//Альт - ускорение
		}
	}//ubervortex

	if(PRESSED(KEY_SUBMISSION) && Player[playerid][CarActive] == 1 && Player[playerid][ActiveSkillCar1] > 0 && LSpecID[playerid] == -1 && InEvent[playerid] == 0 && QuestActive[playerid] == 0)
	{//навыки авто класса 1
		new rtime = JumpTime[playerid] - unixtime;
	    if(rtime <= 0) //если доступно
	    {
	    	new vehid = GetPlayerVehicleID(playerid);new Float:Velocity[3];
	    	if (Player[playerid][ActiveSkillCar1] == 1)
	    	{//Разворот на 180
	         	new Float: vang;GetVehicleZAngle(vehid, vang);SetVehicleZAngle(vehid, vang - 180.0);
	         	GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);SetVehicleVelocity(vehid, Velocity[0] * -1, Velocity[1] * -1, Velocity[2] * -1);
	         	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
	         	JumpTime[playerid] = unixtime + 3;
			 	SetCameraBehindPlayer(playerid);
	    	}//Разворот на 180
	    	if (Player[playerid][ActiveSkillCar1] == 2)
    		{//прыжок
	    	    GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);SetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2] + 0.5);
	         	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
	   	      	JumpTime[playerid] = unixtime + 3;
			 	LACSH[playerid] = 5;LACTeleportOff[playerid] = 3;
	    	}//прыжок
	    	if (Player[playerid][ActiveSkillCar1] == 3)
	    	{//трамплин
				if(rampid[playerid] == -1)
				{
	         		new Float:x, Float:y, Float:z, Float:angle;GetPlayerPos(playerid, x, y, z);
		     		angle = GetXYInFrontOfPlayer(playerid, x, y, GetOptimumRampDistance(playerid));
		 	 		rampid[playerid] = CreateDynamicObject(1632, x, y, z, 0.0, 0.0, angle, GetPlayerVirtualWorld(playerid), -1, -1, 300.0);//Стандартные трамплины
	         		SetTimerEx("RemoveRamp", 2000, 0, "d", playerid);
			 		SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
			 		JumpTime[playerid] = unixtime + 4;
	 			}
	    	}//трамплин
		}//если доступно
		else {new StringZ[20]; format(StringZ, sizeof StringZ, "~R~%d sec", rtime); GameTextForPlayer(playerid, StringZ, 1000, 6);}
	}//навыки авто класса 1

	if(PRESSED(KEY_SUBMISSION) && Player[playerid][CarActive] == 2 && Player[playerid][ActiveSkillCar2] > 0 && LSpecID[playerid] == -1 && InEvent[playerid] == 0 && QuestActive[playerid] == 0)
	{//навыки авто класса 2
		new rtime = JumpTime[playerid] - unixtime;
		if(rtime <= 0) //если доступно
	    {
	    	new vehid = GetPlayerVehicleID(playerid);new Float:Velocity[3];
	    	if (Player[playerid][ActiveSkillCar2] == 1)
	    	{//Разворот на 180
	         	new Float: vang;GetVehicleZAngle(vehid, vang);SetVehicleZAngle(vehid, vang - 180.0);
	         	GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);SetVehicleVelocity(vehid, Velocity[0] * -1, Velocity[1] * -1, Velocity[2] * -1);
	         	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
	         	JumpTime[playerid] = unixtime+4;
			 	SetCameraBehindPlayer(playerid);
	    	}//Разворот на 180
	    	if (Player[playerid][ActiveSkillCar2] == 2)
	    	{//прыжок
	         	GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);SetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2] + 0.5);
	         	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
	         	JumpTime[playerid] = unixtime+4;
			 	LACSH[playerid] = 5;LACTeleportOff[playerid] = 3;
	    	}//прыжок
	    	if (Player[playerid][ActiveSkillCar2] == 3)
	    	{//трамплин
	    		if(rampid[playerid] == -1)
				{
	         		new Float:x, Float:y, Float:z, Float:angle;GetPlayerPos(playerid, x, y, z);
		     		angle = GetXYInFrontOfPlayer(playerid, x, y, GetOptimumRampDistance(playerid));
		 	 		rampid[playerid] = CreateDynamicObject(1632, x, y, z, 0.0, 0.0, angle, GetPlayerVirtualWorld(playerid), -1, -1, 300.0);//Стандартные трамплины
	         		SetTimerEx("RemoveRamp", 2000, 0, "d", playerid);
			 		SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
			 		JumpTime[playerid] = unixtime+3;
	 			}
	    	}//трамплин
		}
		else {new StringZ[20]; format(StringZ, sizeof StringZ, "~R~%d sec", rtime); GameTextForPlayer(playerid, StringZ, 1000, 6);}
	}//навыки авто класса 2

	if (Player[playerid][Level] >= 100 && PRESSED(KEY_NO) && !IsPlayerInAnyVehicle(playerid) && GetPlayerSpecialAction(playerid) == SPECIAL_ACTION_USEJETPACK)
	{//UberJetpack
     	new Float: x, Float: y, Float: z;GetPlayerVelocity(playerid,x,y,z);
	    SetPlayerVelocity(playerid,x*5,y*5,0.0);
		LACTeleportOff[playerid] = 5; LACPedSHOff[playerid] = 5;
	    SetPlayerChatBubble(playerid, "Использует Ускоритель", COLOR_GREEN, 100.0, 3000);
	}//UberJetpack

	if (Player[playerid][ActiveSkillPerson] > 0)
	{//навык персонажа
		if(PRESSED(KEY_NO) && !IsPlayerInAnyVehicle(playerid) && GetPlayerSpecialAction(playerid) != SPECIAL_ACTION_USEJETPACK && InEvent[playerid] == 0 && QuestActive[playerid] == 0)
		{//на N
			new rtime = SkillNTime[playerid] - unixtime;
			if(rtime <= 0)
			{//если можно
		    	if (Player[playerid][ActiveSkillPerson] == 1)
		    	{//тп на 50 метров
		        	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
			    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,50.0);
			    	SetPlayerPosFindZ(playerid, x, y, 3000.0);
					SkillNTime[playerid] = unixtime+5;
			    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
		    	}//тп на 50 метров
		    	if (Player[playerid][ActiveSkillPerson] == 2)
		    	{//тп на 100 метров
		        	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
			    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,100.0);
			    	SetPlayerPosFindZ(playerid, x, y, 3000.0);
					SkillNTime[playerid] = unixtime+5;
			    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
		    	}//тп на 100 метров
		    	if (Player[playerid][ActiveSkillPerson] == 3)
		    	{//тп на 300 метров
		        	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
			    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,200.0);
			    	SetPlayerPosFindZ(playerid, x, y, 3000.0);
					SkillNTime[playerid] = unixtime+5;
			    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
		    	}//тп на 300 метров
		    	if (Player[playerid][ActiveSkillPerson] == 4)
		    	{//Режим Супермена
		        	if (OnFly[playerid] == 0 && Player[playerid][Prestige] >= 8)//Проверка на 8 престиж нужна т.к. раньше он был на 2 престиже
					{
				    	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
			    		else StartFly(playerid);
					}
					else StopFly(playerid);
		    	}//Режим Супермена
			}//если можно
			else {new StringZ[20]; format(StringZ, sizeof StringZ, "~R~%d sec", rtime); GameTextForPlayer(playerid, StringZ, 1000, 6);} //нельзя
		}//на N
	}//Навык персонажа

	if(PRESSED(KEY_YES) && !IsPlayerInAnyVehicle(playerid) && Player[playerid][Prestige] >= 10 && InEvent[playerid] == 0)
	{//Режим Бога
	    new rtime = SkillYTime[playerid] - unixtime;
		if(rtime <= 0)
		{
	    	if(OnZone[playerid] != Clan[ Player[playerid][MyClan] ][NowWarZone])
	 		{
				if (PrestigeGM[playerid] == 0){PrestigeGM[playerid] = 1;SendClientMessage(playerid,0x00FF00FF,"Режим Бога активирован.");}
	    		else ShowPlayerDialog(playerid, DIALOG_PRESTIGEGM, 2, "Режим Бога", "{FF0000}Отключить режим Бога\nТелепорт к маркеру GPS\nРеспавн", "ОК", "Отмена");
			}
			else SendClientMessage(playerid,0x00FF00FF,"Режим Бога запрещен на завоевываемой территории.");
		}
	}//Режим Бога

	if (Player[playerid][ActiveSkillHCar1] > 0 || Player[playerid][ActiveSkillHCar2] > 0)
	{//Навык H авто класс 1
		if(PRESSED(KEY_CROUCH) && IsPlayerInAnyVehicle(playerid) && InEvent[playerid] == 0 && QuestActive[playerid] == 0)
		{//на H
			new rtime = SkillHTime[playerid] - unixtime;
	    	if(rtime <= 0) //если доступно
	  		{
		    	if (Player[playerid][CarActive] == 1)
		    	{//Класс 1
		        	if (Player[playerid][ActiveSkillHCar1] == 1)
		        	{//Перевернуть транспорт на колеса
		        		new Float: aangle;
				    	SkillHTime[playerid] = unixtime + 5;
						SetPlayerChatBubble(playerid, "Перевернул транспорт", COLOR_GREEN, 300.0, 3000);
				    	GetVehicleZAngle(GetPlayerVehicleID(playerid), aangle);SetVehicleZAngle(GetPlayerVehicleID(playerid), aangle);
		            	SendClientMessage(playerid,COLOR_GREEN,"Вы перевернули ваш транспорт на колеса.");
		        	}//Перевернуть транспорт на колеса
			    	if (Player[playerid][ActiveSkillHCar1] == 2)
			    	{//тп на 50 метров
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,50.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
	                	SetTimerEx("PrestigeCarTP" , 500, false, "idiii", playerid, CarClass, S1, S2, S3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 50 метров
			    	if (Player[playerid][ActiveSkillHCar1] == 3)
			    	{//тп на 100 метров
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
	                	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,100.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				   	 	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
	                	SetTimerEx("PrestigeCarTP" , 500, false, "idiii", playerid, CarClass, S1, S2, S3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 100 метров
			    	if (Player[playerid][ActiveSkillHCar1] == 4)
			    	{//тп на 200 метров
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
	                	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,200.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
	               	 	SetTimerEx("PrestigeCarTP" , 500, false, "idiii", playerid, CarClass, S1, S2, S3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 100 метров
			    	if (Player[playerid][ActiveSkillHCar1] == 5)
			    	{//тп на 50 метров со скоростью
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,50.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
						new Float: vel1, Float: vel2, Float: vel3;GetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	                	SetTimerEx("PrestigeCarTPx" , 500, false, "idiiifff", playerid, CarClass, S1, S2, S3, vel1, vel2, vel3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 50 метров
			    	if (Player[playerid][ActiveSkillHCar1] == 6)
			    	{//тп на 100 метров со скоростью
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,100.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
						new Float: vel1, Float: vel2, Float: vel3;GetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	                	SetTimerEx("PrestigeCarTPx" , 500, false, "idiiifff", playerid, CarClass, S1, S2, S3, vel1, vel2, vel3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
	                	//ended
			    	}//тп на 100 метров
			    	if (Player[playerid][ActiveSkillHCar1] == 7)
			    	{//тп на 200 метров со скоростью
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,200.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
						new Float: vel1, Float: vel2, Float: vel3;GetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	                	SetTimerEx("PrestigeCarTPx" , 500, false, "idiiifff", playerid, CarClass, S1, S2, S3, vel1, vel2, vel3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 200 метров
			    	if (Player[playerid][ActiveSkillHCar1] == 8){if(OnVehFly[playerid] == 0) StartVehFly(playerid); else StopVehFly(playerid);}//Режим Полета на авто
				}//Класс 1
		    	if (Player[playerid][CarActive] == 2)
		    	{//Класс 2
		        	if (Player[playerid][ActiveSkillHCar2] == 1)
		        	{//Перевернуть транспорт на колеса
		        		new Float: aangle;
				    	SkillHTime[playerid] = unixtime + 5;SetPlayerChatBubble(playerid, "Перевернул транспорт", COLOR_GREEN, 300.0, 3000);
				    	GetVehicleZAngle(GetPlayerVehicleID(playerid), aangle);SetVehicleZAngle(GetPlayerVehicleID(playerid), aangle);
		            	SendClientMessage(playerid,COLOR_GREEN,"Вы перевернули ваш транспорт на колеса.");
		        	}//Перевернуть транспорт на колеса
			    	if (Player[playerid][ActiveSkillHCar2] == 2)
		    		{//тп на 50 метров
      					if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,50.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
	                	SetTimerEx("PrestigeCarTP" , 500, false, "idiii", playerid, CarClass, S1, S2, S3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
    				}//тп на 50 метров
			    	if (Player[playerid][ActiveSkillHCar2] == 3)
			    	{//тп на 100 метров
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
	                	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,100.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
	                	SetTimerEx("PrestigeCarTP" , 500, false, "idiii", playerid, CarClass, S1, S2, S3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 100 метров
			   		if (Player[playerid][ActiveSkillHCar2] == 4)
			    	{//тп на 200 метров
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
	                	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,200.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
	                	SetTimerEx("PrestigeCarTP" , 500, false, "idiii", playerid, CarClass, S1, S2, S3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 100 метров
			    	if (Player[playerid][ActiveSkillHCar2] == 5)
			    	{//тп на 50 метров со скоростью
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,50.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
						new Float: vel1, Float: vel2, Float: vel3;GetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	                	SetTimerEx("PrestigeCarTPx" , 500, false, "idiiifff", playerid, CarClass, S1, S2, S3, vel1, vel2, vel3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 50 метров
			    	if (Player[playerid][ActiveSkillHCar2] == 6)
			    	{//тп на 100 метров со скоростью
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,100.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
								if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
								if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
								if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
						new Float: vel1, Float: vel2, Float: vel3;GetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	                	SetTimerEx("PrestigeCarTPx" , 500, false, "idiiifff", playerid, CarClass, S1, S2, S3, vel1, vel2, vel3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
    				}//тп на 100 метров
			    	if (Player[playerid][ActiveSkillHCar2] == 7)
			    	{//тп на 200 метров со скоростью
			        	if (GetPlayerInterior(playerid) != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть на улице, чтобы использовать этот навык");
				    	new Float: x, Float: y;GetXYInFrontOfPlayer(playerid,x,y,200.0);
				    	SetPlayerPosFindZ(playerid, x, y, 3000.0);SkillHTime[playerid] = unixtime + 5;
				    	SetPlayerChatBubble(playerid, "Использовал навык", COLOR_GREEN, 100.0, 3000);
				    	new CarClass = Player[playerid][CarActive];TimeTransform[playerid] = 0;
				    	new S1 = -1, S2 = -1, S3 = -1;
				    	foreach(Player, cid)
						{//цикл
							if(GetPlayerVehicleID(cid) == GetPlayerVehicleID(playerid) && GetPlayerVehicleSeat(cid) > 0)
							{//запись пассажиров
							if(GetPlayerVehicleSeat(cid) == 1){S1 = cid;}
							if(GetPlayerVehicleSeat(cid) == 2){S2 = cid;}
							if(GetPlayerVehicleSeat(cid) == 3){S3 = cid;}
							}//запись пассажиров
						}
						new Float: vel1, Float: vel2, Float: vel3;GetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	                	SetTimerEx("PrestigeCarTPx" , 500, false, "idiiifff", playerid, CarClass, S1, S2, S3, vel1, vel2, vel3);
	                	TogglePlayerControllable(playerid,0);DestroyVehicle(PlayerCarID[playerid]);
			    	}//тп на 200 метров
			    	if (Player[playerid][ActiveSkillHCar2] == 8){if(OnVehFly[playerid] == 0) StartVehFly(playerid); else StopVehFly(playerid);}//Режим Полета на авто
				}//Класс 2
			}//если можно
			else {new StringZ[20]; format(StringZ, sizeof StringZ, "~R~%d sec", rtime); GameTextForPlayer(playerid, StringZ, 1000, 6);}
		}//на H
	}//Навык H авто

	if(PRESSED(KEY_CROUCH) && IsPlayerInAnyVehicle(playerid))
	{//Поставить машину на колеса
	    if (InEvent[playerid] == EVENT_XRACE || InEvent[playerid] == EVENT_RACE)
	    {//В обычной или легендарной гонке
	        if (FlipCount[playerid] <= 0) return 1;
			new Float: aangle, String[120], needcount = 0;
			GetVehicleZAngle(GetPlayerVehicleID(playerid), aangle);SetVehicleZAngle(GetPlayerVehicleID(playerid), aangle);
            SetPlayerChatBubble(playerid, "Перевернул транспорт", COLOR_GREEN, 300.0, 3000);
         	if (InEvent[playerid] == EVENT_RACE || InEvent[playerid] == EVENT_XRACE) needcount = 1;
			if (needcount == 1)
			{//если нужно считать кол-во оставшихся переворотов
	            FlipCount[playerid] -= 1;
				format(String,sizeof(String),"Вы перевернули ваш транспорт на колеса. Осталось переворотов: %d", FlipCount[playerid]);
				SendClientMessage(playerid,COLOR_GREEN,String);
			}//если нужно считать кол-во оставшихся переворотов
			else
			{//если НЕ нужно
			    format(String,sizeof(String),"Вы перевернули ваш транспорт на колеса.", FlipCount[playerid]);
				SendClientMessage(playerid,COLOR_GREEN,String);
			}//если НЕ нужно
	    }//В обычной или легендарной гонке
	    
	    if (InEvent[playerid] == EVENT_DRACE)
	    {
	        if (JumpCount[playerid] <= 0) return SendClientMessage(playerid,COLOR_GREEN,"Вы исчерпали лимит прыжков в этой гонке.");
	        new rtime = JumpTime[playerid] - unixtime;
	        if(rtime <= 0)
	        {
	            new String[100];
				format(String,sizeof(String),"Вы использовали прыжок. Осталось прыжков: %d", JumpCount[playerid]-1);
				SendClientMessage(playerid,COLOR_GREEN,String);
				
	        	new Float:Velocity[3],vehid = GetPlayerVehicleID(playerid);
            	SetPlayerChatBubble(playerid, "Использовал прыжок", COLOR_GREEN, 300.0, 3000);
            	GetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2]);
				SetVehicleVelocity(vehid, Velocity[0], Velocity[1], Velocity[2] + 0.5);
	        	JumpTime[playerid] = unixtime+3;
				LACSH[playerid] = 5;
				LACTeleportOff[playerid] = 3;
	        	JumpCount[playerid]--;
			}
            else {new StringZ[20]; format(StringZ, sizeof StringZ, "~R~%d sec", rtime); GameTextForPlayer(playerid, StringZ, 1000, 6);}

	    }
	}//Поставить машину на колеса

	if (Player[playerid][Level] == 0 && IsPlayerInAnyVehicle(playerid))
	{//проходит обучение
		if(PRESSED(KEY_NO) || PRESSED(KEY_YES))
		{//трансформировался из мопеда в машину
			new String[1024];
			strcat(String, "{007FFF}Конец Обучения: Игра{FFFFFF}\n\n");
			strcat(String, "Поздравляем! Вы успешно прошли обучение! Теперь вашей основной задачей является прокачка уровня.\n");
			strcat(String, "С каждым новым уровнем у вас будут новые возможности, транспорт и оружие. Чтобы повысить уровень\n");
			strcat(String, "лучше всего участвовать в соревнованиях: в гонках, десматчах, дерби и так далее.\n\n");
			strcat(String, "{008E00}Посмотреть список доступных соревнований можно командой {FF0000}/events\n");
			strcat(String, "{008E00}Посмотреть список доступных заданий можно командой {FF0000}/quests\n");
			strcat(String, "{008E00}Найти работу, банк, казино и другие важные объекты можно при помощи {FF0000}/gps\n\n");
			strcat(String, "{FFFFFF}Если у вас остались какие-то вопросы, то мы рекомендуем вам прочитать FAQ (команда {FF0000}/help{FFFFFF}).\n");
			strcat(String, "\n\n{FFFF00}Приятной игры!");
			ShowPlayerDialog(playerid, DIALOG_TUTORIAL, 0, "Обучение", String, "ИГРАТЬ", "");
			DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;
			TutorialStep[playerid] = 4;
			SendClientMessage(playerid, -1, "{AFAFAF}SERVER: Вы успешно прошли обучение!");
		}//трансформировался из мопеда в машину
	}//проходит обучение
	
		//----- Настройки режима слежки
	if (LSpecID[playerid] != -1 && LSpecCanFastChange[playerid] == 1)
	{//Игрок в режиме слежки (смена подозреваемого стрелочками)
	    if (newkeys & KEY_HANDBRAKE)
	    {//Нажата ЛКМ
	        new bool: CurrentID = false, specplayerid = LSpecID[playerid];
	        LSpectators[specplayerid]--;
	        while (!CurrentID)
	        {//Пока ID нового подозреваемого неподходящий
	            specplayerid++;
	            if (specplayerid == MAX_PLAYERS) specplayerid = 0;
	            if ((IsPlayerConnected(specplayerid) && LSpecID[specplayerid] == -1) || LSpecID[playerid] == specplayerid)
	            {
	                TogglePlayerSpectating(playerid, 1);
					CurrentID = true;
					LSpecID[playerid] = specplayerid;
					LSpecCanFastChange[playerid] = 0;
		            SetPlayerInterior(playerid, GetPlayerInterior(specplayerid));
		            SetPlayerVirtualWorld(playerid, GetPlayerVirtualWorld(specplayerid));
		            if (IsPlayerInAnyVehicle(specplayerid)) PlayerSpectateVehicle(playerid, GetPlayerVehicleID(specplayerid), LSpecMode[playerid]);
					else PlayerSpectatePlayer(playerid, specplayerid);
					LSpectators[specplayerid]++;
				}
	        }//Пока ID нового подозреваемого неподходящий
	    }
		//Нажата ПКМ
	    if (newkeys & KEY_FIRE)
	    {
	        new bool: CurrentID = false, specplayerid = LSpecID[playerid];
            LSpectators[specplayerid]--;
			while (!CurrentID)
	        {//Пока ID нового подозреваемого неподходящий
	            specplayerid--;
	            if (specplayerid == -1) specplayerid = MAX_PLAYERS - 1;
	            if ((IsPlayerConnected(specplayerid) && LSpecID[specplayerid] == -1) || LSpecID[playerid] == specplayerid)
	            {
					CurrentID = true;
					LSpecID[playerid] = specplayerid;
					LSpecCanFastChange[playerid] = 0;
		            SetPlayerInterior(playerid, GetPlayerInterior(specplayerid));
		            SetPlayerVirtualWorld(playerid, GetPlayerVirtualWorld(specplayerid));
		            if (IsPlayerInAnyVehicle(specplayerid)) PlayerSpectateVehicle(playerid, GetPlayerVehicleID(specplayerid), LSpecMode[playerid]);
					else PlayerSpectatePlayer(playerid, specplayerid);
					LSpectators[specplayerid]++;
				}
	        }//Пока ID нового подозреваемого неподходящий
	    }
	    if (newkeys & KEY_JUMP)
	 	{
            callcmd::specoff(playerid, "");
            return 1;
	 	}
	 	if (newkeys & KEY_LOOK_BEHIND)
	 	{
            new specplayerid = LSpecID[playerid]; LSpecCanFastChange[playerid] = 0;
	        SetPlayerInterior(playerid, GetPlayerInterior(specplayerid));
		    SetPlayerVirtualWorld(playerid, GetPlayerVirtualWorld(specplayerid));
		    if (IsPlayerInAnyVehicle(specplayerid)) PlayerSpectateVehicle(playerid, GetPlayerVehicleID(specplayerid), LSpecMode[playerid]);
			else PlayerSpectatePlayer(playerid, specplayerid);
			GameTextForPlayer(playerid, "~Y~camera updated", 1500, 6);
            return 1;
	 	}
	    /*else if(ud != 0)
	    {//Нажата стрелка вниз или вверх (обновление слежки, смена камеры)
	        if(ud > 0)
	        {//Нажата клавиша вниз (смена камеры)
	            if (LSpecMode[playerid] == SPECTATE_MODE_NORMAL) LSpecMode[playerid] = SPECTATE_MODE_SIDE;
	            else  LSpecMode[playerid] = SPECTATE_MODE_NORMAL;
	        }//Нажата клавиша вниз (смена камеры)
	    }//Нажата стрелка вниз или вверх (обновление слежки, смена камеры)*/
	}//Игрок в режиме слежки (смена подозреваемого стрелочками)
	//----- Настройки режима слежки
	
	//битва до последнего
	if (BTStarted[playerid] > 0)
	{
	    if(PRESSED(KEY_CTRL_BACK) && !IsPlayerInAnyVehicle(playerid))
  		{
  		    if(GetPVarInt(playerid,"BThls") < 1) return SendClientMessage(playerid,COLOR_YELLOW," BT: У вас нет аптечек!");
        	if(GetPVarInt(playerid,"HealTime") > unixtime) {new String[140]; format(String,sizeof(String), " BT: Аптечка будет доступна через {ffffff}%d{ffff00} сек.", GetPVarInt(playerid,"HealTime")-unixtime); return SendClientMessage(playerid,COLOR_YELLOW,String);}
            SetPVarInt(playerid, "HealTime", unixtime+60);
            SetPVarInt(playerid, "BThls", GetPVarInt(playerid,"BThls")-1);
            SetPlayerHealth(playerid,100);
            ApplyAnimation(playerid, "COP_AMBIENT", "COPBROWSE_IN", 4.1, false, false, false, false, 4000, false);
            SetPlayerChatBubble(playerid, "Использовал аптечку", COLOR_GREEN, 250.0, 3000); PlayerPlaySound(playerid,1134,0.0,0.0,0.0);
            new String[120]; format(String,sizeof(String), " BT: Вы использовали аптечку. Осталось {ffffff}%d{ffff00} шт.", GetPVarInt(playerid,"BThls")); return SendClientMessage(playerid,COLOR_YELLOW,String);
		}
	    if(PRESSED(KEY_NO))
	    {
	    	if(GetPVarInt(playerid,"UseMap") == 0) ShowHideBTMap(playerid,1);
			else ShowHideBTMap(playerid, 0);
		}
	    if( PRESSED(KEY_CROUCH) && (GetPVarInt(playerid,"PLoot") > -1 /*|| GetPVarInt(playerid,"PBLoot") > -1*/) )
	    {
	        if(GetPVarInt(playerid,"PLoot") > -1)
	        {
	            new lootid = GetPVarInt(playerid,"PLoot");
	            new loottype = LootType[lootid];
	            if (loottype == -1) return 1;
				new weapon = Loot[loottype][LWeapon];
	            new String[140];
	            ApplyAnimation(playerid, "BOMBER", "BOM_Plant", 4.0, 0, 0, 0, 0, 1000);
	            
				switch(loottype)
				{
					//холодное
					case 0,1,19:
					{
					    new OldColdWeap = PlayerInv[playerid][2];
                        GiveWeapon(playerid,weapon,1);
                        PlayerInv[playerid][2] = loottype;
                        if(OldColdWeap > -1) ReplaceLoot(lootid, OldColdWeap, 1);
	  					else DestroyLoot(lootid);
	  					format(String,sizeof(String), " BT: Вы подобрали холодное оружие {ffffff}%s", Loot[loottype][LName]);
                        SendClientMessage(playerid,COLOR_YELLOW,String);
					}
					//метательное
					case 2,3:
					{
					    //есть это или нет никакого
						if(PlayerInv[playerid][3] == loottype || PlayerInv[playerid][3] == -1)
						{
						    PlayerInv[playerid][3] = loottype;
						    ThrowCount[playerid] += LootCount[lootid];
						    GiveWeapon(playerid,weapon,1);
						    SetPlayerAmmo(playerid, weapon, ThrowCount[playerid]);
						    format(String,sizeof(String), " BT: Вы подобрали метательное оружие {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	DestroyLoot(lootid);
						}
						//есть какое-то другое
						else
						{
							new oldcount = ThrowCount[playerid], oldweap = PlayerInv[playerid][3];
							PlayerInv[playerid][3] = loottype;
						    ThrowCount[playerid] = LootCount[lootid];
						    GiveWeapon(playerid,weapon,1);
						    SetPlayerAmmo(playerid, weapon, ThrowCount[playerid]);
						    format(String,sizeof(String), " BT: Вы заменили метательное оружие на {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	ReplaceLoot(lootid, oldweap, oldcount);
						}
					}
					//огнестрельное
					case 4..15,18:
					{
						// -- 1 СЛОТ --
					    //нет пушки в 1 слоте
						if (PlayerInv[playerid][0] == -1)
						{
						    PlayerInv[playerid][0] = loottype;
						    Slot1Bullets[playerid] = LootCount[lootid];
						    GiveWeapon(playerid,weapon,LootCount[lootid]);// SetPVarInt(playerid, "Slot1", weapon);
						    format(String,sizeof(String), " BT: Вы подобрали огнестрельное оружие {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	DestroyLoot(lootid);
						}
						//уже есть эта пушка в 1 слоте
						else if(PlayerInv[playerid][0] == loottype)//cлот 1
						{
						    if(Slot1Bullets[playerid] < 1) GiveWeapon(playerid,weapon,LootCount[lootid]);//пушка есть, патронов нет
						    Slot1Bullets[playerid] += LootCount[lootid];
						    SetPlayerAmmo(playerid, weapon, Slot1Bullets[playerid]);
						    format(String,sizeof(String), " BT: Вы подобрали %d патронов для {ffffff}%s", LootCount[lootid], Loot[loottype][LName]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	DestroyLoot(lootid);
						}
						//нет этой пушки, но есть какая-то этого же типа (1 слот)
						else if (Loot[loottype][LSlot] == Loot[PlayerInv[playerid][0]][LSlot])
						{
						    new oldcount = Slot1Bullets[playerid], oldweap = PlayerInv[playerid][0];
							PlayerInv[playerid][0] = loottype;
						    Slot1Bullets[playerid] = LootCount[lootid];
						    //SetPlayerAmmo(playerid, Loot[oldweap][LWeapon], 0);
						    RemovePlayerWeapon(playerid, Loot[oldweap][LWeapon]);
						    GiveWeapon(playerid,weapon,Slot1Bullets[playerid]);
						    format(String,sizeof(String), " BT: Вы заменили огнестрельное оружие (1 слот) на {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	ReplaceLoot(lootid, oldweap, oldcount);
						}
						// -- 2 СЛОТ --
						//нет пушки в 2 слоте
						else if (PlayerInv[playerid][1] == -1)
						{
						    PlayerInv[playerid][1] = loottype;
						    Slot2Bullets[playerid] = LootCount[lootid];
						    GiveWeapon(playerid,weapon,LootCount[lootid]);
						    format(String,sizeof(String), " BT: Вы подобрали огнестрельное оружие {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	DestroyLoot(lootid);
						}
						//уже есть эта пушка в 2 слоте
						else if (PlayerInv[playerid][1] == loottype) //слот 2
						{
							if(Slot2Bullets[playerid] < 1) GiveWeapon(playerid,weapon,LootCount[lootid]);//пушка есть, патронов нет
						    Slot2Bullets[playerid] += LootCount[lootid];
						    SetPlayerAmmo(playerid, weapon, Slot2Bullets[playerid]);
						    format(String,sizeof(String), " BT: Вы подобрали %d патронов для {ffffff}%s", LootCount[lootid], Loot[loottype][LName]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	DestroyLoot(lootid);
						}
						//нет этой пушки, но есть какая-то этого же типа (2 слот)
						else if (Loot[loottype][LSlot] == Loot[PlayerInv[playerid][1]][LSlot])
						{
						    new oldcount = Slot2Bullets[playerid], oldweap = PlayerInv[playerid][1];
							PlayerInv[playerid][1] = loottype;
						    Slot2Bullets[playerid] = LootCount[lootid];
						    //SetPlayerAmmo(playerid, Loot[loottype][LWeapon], 0);
						    RemovePlayerWeapon(playerid, Loot[oldweap][LWeapon]);
							GiveWeapon(playerid,weapon,Slot2Bullets[playerid]);
						    format(String,sizeof(String), " BT: Вы заменили огнестрельное оружие (2 слот) на {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	ReplaceLoot(lootid, oldweap, oldcount);
						}
						//заняты оба слота, такой же пушки нет, пушки того же типа нет - меняем пушку в 1 слоте
						else
						{
						    new oldcount = Slot1Bullets[playerid], oldweap = PlayerInv[playerid][0];
							PlayerInv[playerid][0] = loottype;
						    Slot1Bullets[playerid] = LootCount[lootid];
						    //SetPlayerAmmo(playerid, Loot[oldweap][LWeapon], 0);
						    RemovePlayerWeapon(playerid, Loot[oldweap][LWeapon]);
							GiveWeapon(playerid,weapon,Slot1Bullets[playerid]);
						    format(String,sizeof(String), " BT: Вы заменили огнестрельное оружие (1 слот) на {ffffff}%s (%d)", Loot[loottype][LName],LootCount[lootid]);
                        	SendClientMessage(playerid,COLOR_YELLOW,String);
                        	ReplaceLoot(lootid, oldweap, oldcount);
						}
					}
				    //аптечка
					case 16:{DestroyLoot(lootid); SetPVarInt(playerid, "BThls", GetPVarInt(playerid,"BThls")+1); return SendClientMessage(playerid,COLOR_YELLOW," BT: Вы подобрали аптечку. Нажмите {ffffff}H{ffff00}, чтобы использовать.");}
	 				//броня
					case 17:{DestroyLoot(lootid); SetPlayerArmour(playerid, 100.0); return SendClientMessage(playerid,COLOR_YELLOW," BT: Вы подобрали 100 брони.");}
					default: return 1;
				}
				
                SetPVarInt(playerid, "PLoot", -1);
	            return 1;
	        }
		 	/*
	        if(GetPVarInt(playerid,"PBLoot") > -1)
	        {
	            new boxid = GetPVarInt(playerid,"PBLoot");
	            ApplyAnimation(playerid, "BOMBER", "BOM_Plant", 4.0, 0, 0, 0, 0, 0);
	            SendClientMessage(playerid,COLOR_GREEN,"SERVER: В ящике нет ничего, кроме дохлой крысы");
				return 1;
	        }*/
	    }
		if(PRESSED(KEY_SECONDARY_ATTACK) && GetPVarInt(playerid, "inplane") == 1 && BTTimer <= -6) //прыжок из самолета (Enter / F)
		{
		    SetPVarInt(playerid, "inplane", 0);
            new Float:x, Float:y, Float:z, Float: a, Float: dist;
            GetObjectRot(PlaneObject[0], x, y, a);
            GetObjectPos(PlaneObject[0], x, y, z);
            
            dist = 40.0 + float(random(10));
            x -= (dist * floatsin(-a, degrees));
			y -= (dist * floatcos(-a, degrees));
			
			TogglePlayerSpectating(playerid, 0);
			SetPlayerPos(playerid, x, y, z-40.0);
			SetPlayerFacingAngle(playerid,a);
			SetCameraBehindPlayer(playerid);
			PlayerPlaySound(playerid,1039,0.0,0.0,0.0);
			SetPVarInt(playerid,"UseMap",0); TextDrawHideForPlayer(playerid, BTMap); PlayerTextDrawHide(playerid, PlayerPosTD[playerid]);
			GivePlayerWeapon(playerid,46,1);
		}
	}
	return 1;
}

public OnRconLoginAttempt(ip[], password[], success)
{
   		//printf("FAILED RCON LOGIN BY IP %s USING PASSWORD %s",ip, password);
        new pip[16];
        for(new i=0; i<MAX_PLAYERS; i++) //Loop through all players
        {
            GetPlayerIp(i, pip, sizeof(pip));
            if(!strcmp(ip, pip, true)) //If a player's IP is the IP that failed the login
            {
                SendClientMessage(i, 0xFFFFFFFF, "Неправильный пароль. Давай досвидания!"); //Send a message
                Kick(i);//They are now kicked.
            }
        }
	return 1;
}

public OnPlayerUpdate(playerid)
{
    //if(IsPlayerNPC(playerid)) return 0;
    if (Logged[playerid] == 0) return 0;
	LAFK[playerid] = 0; //Сброс afk
	/*
	new Float:x, Float:y, Float:z, String[140];
	GetPlayerCameraFrontVector(playerid, x, y, z);

	format(String,sizeof(String),"| X: %.3f | Y: %.3f | Z: %.3f |",x,y,z);
	SendClientMessage(playerid,COLOR_GREEN,String);
	*/
	//new sString[140]; format(sString,sizeof(sString),"%d",Player[playerid][DMove]);
	//SendClientMessage(playerid,COLOR_GREEN,sString);
	
	//-— Защита от воздействия на транспорт других игроков
	if (GetPlayerState(playerid) == PLAYER_STATE_DRIVER && GetPlayerVehicleSeat(playerid) == 0)
	{//Игрок за рулем авто
		new vehicleid = GetPlayerVehicleID(playerid);
		if (Vehicle[vehicleid][Owner] != -1 && Vehicle[vehicleid][Owner] != playerid)
		{
			new String[180]; DestroyVehicle(vehicleid); LACPanic[playerid]++;
			format(String,sizeof(String), "[АДМИНАМ]LAC:{AFAFAF} %s[%d] возможно воздействует на транспорт других игроков читом",PlayerName[playerid], playerid);
			foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
			format(String, 140, "%d.%d.%d a %d:%d:%d | LAC: %s[%d] возможно воздействует на транспорт других игроков читом", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
			WriteLog("GlobalLog", String);WriteLog("LAC", String);
		}
	}//Игрок за рулем авто
	//-— Защита от воздействия на транспорт других игроков


    /*new Float:Velocity[3], string[80];
	GetPlayerVelocity(playerid, Velocity[0], Velocity[1], Velocity[2]);
        format(string, sizeof(string), "X: %f, Y: %f, Z: %f", Velocity[0], Velocity[1], Velocity[2]);
        SendClientMessage(playerid, 0xFFFFFFFF, string);*/
    //new str[140], vid = GetPlayerVehicleID(playerid), Float: vHealth;
	//GetVehicleHealth(vid, vHealth);
	//format(str, sizeof str, "PlayerState: %d vehicleid: %d Seat: %d Health: %0.2f", GetPlayerState(playerid), vid, GetPlayerVehicleSeat(playerid), vHealth);
    //SendClientMessageToAll(-1, str);

	if(GetPlayerCameraMode(playerid) == 53)
	{//Anti Weapon Crasher
		new Float:pos[3];
		GetPlayerCameraPos(playerid,pos[0],pos[1],pos[2]);
		if( pos[0] < -7000.0 || pos[0] > 7000.0 || pos[1] < -7000.0 || pos[1] > 7000.0 || pos[2] < -7000.0 || pos[2] > 7000.0 )
		{
			Kick(playerid); return 0;
		}
	}//Anti Weapon Crasher

	if (GMTestStage[playerid] > 0)
	{//----- GMTest
	    new Float: hp, Float: Armour, testerid = GMTesterID[playerid];GetPlayerHealth(playerid, hp);GetPlayerArmour(playerid, Armour);
	    if (GMTestStage[playerid] == 1 && GMTestTime[playerid] < 3 && GMTestTime[playerid] > 0)
	    {//NOP
	        if (hp != 100.0 || Armour != 0.0) SendClientMessage(testerid,COLOR_YELLOW,"GMTest: {DD0000}Обнаружен чит, запрещающий изменять здоровье и/или броню игрока!");
	        GMTestTime[playerid] = 3;GMTestStage[playerid] = 2;//подбрасывание игрока
			new Float: x, Float: y, Float: z;GetPlayerPos(playerid,x,y,z);SetPlayerPos(playerid,x+1,y+1,z + 10);
	    }//NOP
	    if (GMTestStage[playerid] == 2)
	    {//подбрасывание
	        if (hp < 100.0)
	        {
	            SendClientMessage(testerid,COLOR_YELLOW,"GMTest: {008E00}Неуязвимости к падению с высоты не обнаружено.");
	            SetPlayerHealth(playerid,100);GMTestTime[playerid] = 3;GMTestTime[playerid] = 3;GMTestStage[playerid] = 666;//взрыв
	        }
	        else if (GMTestTime[playerid] <= 1)
	        {
	            SendClientMessage(testerid,COLOR_YELLOW,"GMTest: {DD0000}Обнаружен чит на неуязвимость к падению с высоты!");
	            SetPlayerHealth(playerid,100);GMTestTime[playerid] = 3;GMTestTime[playerid] = 3;GMTestStage[playerid] = 666;//взрыв
	        }
	    }//подбрасывание
	    if (GMTestStage[playerid] == 3)
	    {//взрыв
	        if (hp < 100.0)
	        {
	            SendClientMessage(testerid,COLOR_YELLOW,"GMTest: {008E00}Неуязвимости к взрывам не обнаружено.");
	            SetPlayerHealth(playerid,100);GMTestTime[playerid] = 0;GMTestStage[playerid] = 4;//финал
	        }
	        else if (GMTestTime[playerid] <= 1)
	        {
	            SendClientMessage(testerid,COLOR_YELLOW,"GMTest: {DD0000}Обнаружен чит на неуязвимость к взрывам!");
	            SetPlayerHealth(playerid,100);GMTestTime[playerid] = 3;GMTestStage[playerid] = 4;//финал
	        }
	    }//взрыв
	    if (GMTestStage[playerid] == 666)
	    {//промежуточное, но необходимое..
	        GMTestStage[playerid] = 3;GMTestTime[playerid] = 3;
	        new Float: x, Float: y, Float: z;GetPlayerPos(playerid,x,y,z);CreateExplosionForPlayer(playerid, x, y , z+7, 4, 2);
	    }//промежуточное, но необходимое..
	    if (GMTestStage[playerid] == 4)
	    {
	        GMTestStage[playerid] = 0;GMTestTime[playerid] = 0;
			SetPlayerHealth(playerid,GMTestHealthOld[playerid]);SetPlayerArmour(playerid,GMTestArmourOld[playerid]);
			new string[120];
			format(string,sizeof(string),"GMTest: Тестирование игрока %s[%d] завершено.",PlayerName[playerid],playerid);
			SendClientMessage(testerid,COLOR_YELLOW,string);
	    }

	}//----- GMTest

	/*new Keys, ud, lr;
	//GetPlayerKeys(playerid,Keys,ud,lr);
	//----- Настройки режима слежки
	if (LSpecID[playerid] != -1 && LSpecCanFastChange[playerid] == 1)
	{//Игрок в режиме слежки (смена подозреваемого стрелочками)
	    if(lr > 0)
	    {//Нажата стрелка вправо
	        new bool: CurrentID = false, specplayerid = LSpecID[playerid];
	        LSpectators[specplayerid]--;
	        while (!CurrentID)
	        {//Пока ID нового подозреваемого неподходящий
	            specplayerid++;
	            if (specplayerid == MAX_PLAYERS) specplayerid = 0;
	            if ((IsPlayerConnected(specplayerid) && LSpecID[specplayerid] == -1) || LSpecID[playerid] == specplayerid)
	            {
	                TogglePlayerSpectating(playerid, 1);
					CurrentID = true; LSpecID[playerid] = specplayerid; LSpecCanFastChange[playerid] = 0;
		            SetPlayerInterior(playerid, GetPlayerInterior(specplayerid));
		            SetPlayerVirtualWorld(playerid, GetPlayerVirtualWorld(specplayerid));
		            if (IsPlayerInAnyVehicle(specplayerid)) PlayerSpectateVehicle(playerid, GetPlayerVehicleID(specplayerid), LSpecMode[playerid]);
					else PlayerSpectatePlayer(playerid, specplayerid);
					LSpectators[specplayerid]++;
				}
	        }//Пока ID нового подозреваемого неподходящий
	    }//Нажата стрелка вправо
	    else if(lr < 0)
	    {//Нажата стрелка влево
	        new bool: CurrentID = false, specplayerid = LSpecID[playerid];
            LSpectators[specplayerid]--;
			while (!CurrentID)
	        {//Пока ID нового подозреваемого неподходящий
	            specplayerid--;
	            if (specplayerid == -1) specplayerid = MAX_PLAYERS - 1;
	            if ((IsPlayerConnected(specplayerid) && LSpecID[specplayerid] == -1) || LSpecID[playerid] == specplayerid)
	            {
					CurrentID = true; LSpecID[playerid] = specplayerid; LSpecCanFastChange[playerid] = 0;
		            SetPlayerInterior(playerid, GetPlayerInterior(specplayerid));
		            SetPlayerVirtualWorld(playerid, GetPlayerVirtualWorld(specplayerid));
		            if (IsPlayerInAnyVehicle(specplayerid)) PlayerSpectateVehicle(playerid, GetPlayerVehicleID(specplayerid), LSpecMode[playerid]);
					else PlayerSpectatePlayer(playerid, specplayerid);
					LSpectators[specplayerid]++;
				}
	        }//Пока ID нового подозреваемого неподходящий
	    }//Нажата стрелка влево
	    else if(ud != 0)
	    {//Нажата стрелка вниз или вверх (обновление слежки, смена камеры)
	        if(ud > 0)
	        {//Нажата клавиша вниз (смена камеры)
	            if (LSpecMode[playerid] == SPECTATE_MODE_NORMAL) LSpecMode[playerid] = SPECTATE_MODE_SIDE;
	            else  LSpecMode[playerid] = SPECTATE_MODE_NORMAL;
	        }//Нажата клавиша вниз (смена камеры)
	        new specplayerid = LSpecID[playerid]; LSpecCanFastChange[playerid] = 0;
	        SetPlayerInterior(playerid, GetPlayerInterior(specplayerid));
		    SetPlayerVirtualWorld(playerid, GetPlayerVirtualWorld(specplayerid));
		    if (IsPlayerInAnyVehicle(specplayerid)) PlayerSpectateVehicle(playerid, GetPlayerVehicleID(specplayerid), LSpecMode[playerid]);
			else PlayerSpectatePlayer(playerid, specplayerid);
			GameTextForPlayer(playerid, "~Y~camera updated", 1500, 6);
	    }//Нажата стрелка вниз или вверх (обновление слежки, смена камеры)
	}//Игрок в режиме слежки (смена подозреваемого стрелочками)
	//----- Настройки режима слежки
	*/
	if (InPeacefulZone[playerid] == 1 || AdminTPCantKill[playerid] > 0) SetPlayerArmedWeapon(playerid, 0);//Запрет оружия в мирных зонах

    if (PrestigeGM[playerid] == 1)
    {//Режим Бога
        if (InEvent[playerid] == 0)
        {
	        SetPlayerHealth(playerid, 90000.0);
	        if (GetPlayerInterior(playerid) != 10) SetPlayerChatBubble(playerid, "Режим Бога (Престиж)", COLOR_YELLOW, 300.0, 1000); //в казино не показывает надпись
	        if (IsPlayerInAnyVehicle(playerid)) RepairVehicle(GetPlayerVehicleID(playerid));

	        if(OnZone[playerid] == Clan[ Player[playerid][MyClan] ][NowWarZone])
			{
		    	PrestigeGM[playerid] = 0;
				SetPlayerHealth(playerid, 100.0);
				SendClientMessage(playerid,0xFF0000FF,"Режим Бога деактивирован в зоне захвата территории.");
    		}
        }
        else
		{
			PrestigeGM[playerid] = 0;SetPlayerHealth(playerid, 100.0);SendClientMessage(playerid,0xFF0000FF,"Режим Бога деактивирован.");
			//if (InEvent[playerid] == EVENT_DERBY) SetVehicleHealth(GetPlayerVehicleID(playerid), 650.0);
		}
    }//Режим Бога

    if (MapTP[playerid] == 1)
    {//Использовал телепорт по карте (нужно найти номальное значение координаты Z)
    	new Float: X, Float: Y, Float: Z; GetPlayerPos(playerid, X, Y, Z);
    	if (MapTPx[playerid] != X || MapTPy[playerid] != Y) Z = -5.0;
        if (Z < 0)
        {//Всё еще кривая координата Z
            MapTPTry[playerid]++;
            if (MapTPTry[playerid] < 10) SetPlayerPosFindZ(playerid, MapTPx[playerid], MapTPy[playerid], 10000);
            else
            {//Так и не удалось найти координату Z выше моря (попытка телепорта на дно)
                SetPlayerPos(playerid, MapTPx[playerid], MapTPy[playerid], 1);
                //SendClientMessage(playerid, -1, "Не удалось найти координату Z после 10 попыток!");
            }//Так и не удалось найти координату Z выше моря (попытка телепорта на дно)
        }//Всё еще кривая координата Z
        else
        {//Координата Z в норме
            MapTP[playerid] = 0; AdminTPCantKill[playerid] = 20;
            if (Player[playerid][Admin] < 4) {MapTPTime[playerid] = unixtime+120; SetPlayerChatBubble(playerid, "Телепортировался (ViP)", 0x00FF00FF, 300.0, 6000);}
			SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно использовали телепорт по карте!");
        }//Координата Z в норме
    }//Использовал телепорт по карте (нужно найти номальное значение координаты Z)

	if (InEvent[playerid] == EVENT_ZOMBIE && ZMTimeToFirstZombie <= 0 && ZMIsPlayerIsZombie[playerid] == 0)
	{//Игрок на зомби-выживании играет за человека, зомби уже заспавнились
	    new Float:SPD, Float:vx, Float:vy, Float:vz; GetPlayerVelocity(playerid, vx,vy,vz);
		SPD = floatsqroot(((vx*vx)+(vy*vy))/*+(vz*vz)*/);
		if (SPD > 0.125 || GetPlayerAnimationIndex(playerid) == 1195 || GetPlayerAnimationIndex(playerid) == 1061 || GetPlayerAnimationIndex(playerid) == 1065 || GetPlayerAnimationIndex(playerid) == 1066)
		{//Бег, Прыжок, Повис на стене, залазит на стену, залазит на забор
		    SecFreeze(playerid, 1); ApplyAnimation(playerid,"CRACK","crckdeth1",4.1,0,0,0,0,1,1);
	 		SendClientMessage(playerid, COLOR_RED, "Людям запрещено бегать и прыгать после появления зомби!");
		}//Бег, Прыжок, Повис на стене, залазит на стену, залазит на забор
	}//Игрок на зомби-выживании играет за человека, зомби уже заспавнились

	return 1;
}

public OnPlayerStreamIn(playerid, forplayerid)
{
/*
    //Стрим анимок
    new aindex = GetPlayerAnimationIndex(playerid);
    if(aindex > 0)
    {
        new animlib[32], animname[32];
        GetAnimationName(aindex, animlib, sizeof(animlib), animname, sizeof(animname));
        ApplyAnimation(playerid, animlib, animname, 4.0, 0, 1, 1, 0, 0, 1);
    }
    //Стрим анимок*/
    return 1;
}

public OnPlayerStreamOut(playerid, forplayerid)
{
	return 1;
}

public OnVehicleStreamIn(vehicleid, forplayerid)
{
	return 1;
}

public OnVehicleStreamOut(vehicleid, forplayerid)
{
	return 1;
}



public SecUpdate()
{//нц пб
	//Время и дата
 	//new currenttime = GetTickCount();
 	//NDD++;
 	unixtime = gettime();
    getdate(Year, Month, Day); gettime(hour,minute,second);new StringTime[80];
	format(StringTime, sizeof StringTime, "%d/%s%d/%s%d", Day, ((Month < 10) ? ("0") : ("")), Month, (Year < 10) ? ("0") : (""), Year);
	TextDrawSetString(TextDrawDate, StringTime);
	format(StringTime, sizeof StringTime, "%s%d:%s%d:%s%d", (hour < 10) ? ("0") : (""), hour, (minute < 10) ? ("0") : (""), minute, (second < 10) ? ("0") : (""), second);
	TextDrawSetString(TextDrawTime, StringTime);
	
	//MrfDate = DateToIntDate(20,1,2016)-DateToIntDate(Day, Month, Year);
	if (minute == 0 && second < 3)
	{//обнуление лимита хр раз в час, срабатывает трижды на случай, если один раз не сработает (баг таймера)
		format(ServerLimitXPDate,sizeof ServerLimitXPDate, "%d/%d/%d в %d:00", Day, Month, Year, hour);
		foreach(Player, gid)
		{
		    //--------- Сброс ежечасовой статистики
	    	format(PlayerLimitXPDate[gid], 80, "%d/%d/%d в %d:00", Day, Month, Year, hour);
            if (Player[gid][LastHourExp] > 0)
			{
				new String[180];
			    format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   STATISTICS: Игрок %s[%d] получил %d XP за один час", Day, Month, Year, hour, minute, second, PlayerName[gid], gid, Player[gid][LastHourExp]);
				WriteLog("StatisticsXP", String);
			}
			if (Player[gid][LastHourReferalExp] > 0)
			{
				new String[180];
			    format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   STATISTICS: Игрок %s[%d] получил от клана %d XP за один час", Day, Month, Year, hour, minute, second, PlayerName[gid], gid, Player[gid][LastHourReferalExp]);
				WriteLog("StatisticsClanXP", String);
			}
			Player[gid][LastHourExp] = 0; Player[gid][LastHourReferalExp] = 0;
			//--------- Сброс ежечасовой статистики

		    ShopUpdate(gid);//Обновление временных товаров Shop
		}
		if (minute == 00 && second == 0)
		{//Иногда может не сработать (баг таймера)
		    ClansUpdate();//Удаление кланов, которые не купили штаб вовремя
		    HousesUpdate();//Снятие неперекупайки у тех, у кого она кончилась
			//SendClientMessageToAll(COLOR_YELLOW,"SERVER: Начался новый игровой час! Счетчик опыта, набранного за последний час, аннулирован.");
			
			if (hour == 0 && Day == 1)
			{//В начале каждого месяца в 00:00
			    //Окончание месячного рейтинга
			    FinishTopOperationXP();
			    FinishTopOperationGG();
			    SendClientMessageToAll(-1, " ");
			    SendClientMessageToAll(COLOR_QUEST, "Месячный Рейтинг: Окончание месяца");
			    new str[140];
			    switch (Month)
				{
					case 1: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Январь %d", Year);
					case 2: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Февраль %d", Year);
					case 3: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Март %d", Year);
					case 4: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Апрель %d", Year);
					case 5: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Май %d", Year);
					case 6: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Июнь %d", Year);
					case 7: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Июль %d", Year);
					case 8: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Август %d", Year);
					case 9: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Сентябрь %d", Year);
					case 10: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Октябрь %d", Year);
					case 11: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Ноябрь %d", Year);
					case 12: format(str, sizeof str, "Начался новый месяц:{AFAFAF} Декабрь %d", Year);
				}
				SendClientMessageToAll(-1, str);
				SendClientMessageToAll(-1, "Все награды за прошлый месяц были выданы");
				SendClientMessageToAll(-1, "Для получения награды нужно {FF0000}перезайти на сервер или использовать /shop - Проверить мои платежи");
				SendClientMessageToAll(COLOR_QUEST, "Благодарим всех игроков за участие в рейтинге и желаем вам успехов в новом месяце!");
			    SendClientMessageToAll(-1, " ");
			}//В начале каждого месяца в 00:00
		}//Иногда может не сработать (баг таймера)
		
		
		
	}//обнуление лимита хр раз в час, срабатывает трижды на случай, если один раз не сработает (баг таймера)
	if (second == 0)
	{//Раз в минуту
	    PlayersOnline = 0;
	    foreach(Player, gid)
		{//цикл
			PlayersOnline++;
            QuestUpdate(gid, 25, 1);//Обновление квеста Проведите на сервере 60 минут
            if (QuestActive[gid] >= 2) QuestUpdate(gid, 27, 1);//Обновление квеста Проведите 15 минут на любой работе
		}//цикл
	}//Раз в минуту


	UGTime--; //сообщение о форуме
	if (UGTime == 0)
	{
	    SendClientMessageToAll(-1,"");
	    SendClientMessageToAll(COLOR_YELLOW,"Вступайте в нашу группу вконтакте: {FFFFFF}vk.com/esampdm");
	    new rand = random(4);
	        //if (rand == 0) SendClientMessageToAll(COLOR_GG,"На сервере есть внутриигровой магазин: {FFFFFF}/shop");
	        if (rand == 0) SendClientMessageToAll(COLOR_DERBY,"На сервере есть внутриигровой магазин: {FFFFFF}/shop");
	        if (rand == 1) SendClientMessageToAll(COLOR_RACE,"Чтобы приобрести игровые рубли, перейдите в раздел {ffffff}Донат{007FFF} на{ffffff} exclusive-dm.com");
	        if (rand == 2) SendClientMessageToAll(COLOR_GREEN,"Все новости сервера можно найти в нашей оффициальной группе.");
	        if (rand == 3) SendClientMessageToAll(COLOR_NICEORANGE,"Спасибо, что выбрали наш сервер :)");
        SendClientMessageToAll(-1,"");

		//Динамическая реклама
		if(fexist("AD.ini"))
		{
		    new file, ADString1[140], ADString2[140], ADString3[140], ADString4[140];
		    file = ini_openFile("AD.ini");
			ini_getString(file,"String1", ADString1); if(strcmp(ADString1, "ПУСТО", true)) SendClientMessageToAll(-1, ADString1);
			ini_getString(file,"String2", ADString2); if(strcmp(ADString2, "ПУСТО", true)) SendClientMessageToAll(-1, ADString2);
			ini_getString(file,"String3", ADString3); if(strcmp(ADString3, "ПУСТО", true)) SendClientMessageToAll(-1, ADString3);
			ini_getString(file,"String4", ADString4); if(strcmp(ADString4, "ПУСТО", true)) SendClientMessageToAll(-1, ADString4);
            ini_closeFile(file);
		}//Динамическая реклама
		
		//mrf
		nowday = DateToIntDate(Day, Month, Year);
        MrfDate = DateToIntDate(10,9,2018)-nowday;
        
	    UGTime = 900; SendRconCommand("reloadbans");
	    //Смена погоды
	    ServerWeather = random(20);
		if (ServerWeather == 8 || ServerWeather == 16 || ServerWeather == 19) ServerWeather -= 1;//Удаление погоды с дождем и с бурей
		if (ServerWeather == 9) ServerWeather = 10;
		SetWeather(ServerWeather);		//Смена погоды
		//foreach(Player, gid) if (Logged[gid] == 1) SavePlayer(gid);
		SaveAllClans(); //SaveAllProperty(); SaveAllBase();
		
		UpdateTopOperationXP();//обновим топ по хп
		UpdateTopOperationGG();//обновим топ по донату
		UpdateTopClans();
		format(LastTopUpdate, sizeof LastTopUpdate, "От %s%d:%s%d:%s%d", (hour < 10) ? ("0") : (""), hour, (minute < 10) ? ("0") : (""), minute, (second < 10) ? ("0") : (""), second);
	}


	/////////////
	DMPlayers = 0; DerbyPlayers = 0;	ZMPlayers = 0; ZMZombies = 0; ZMHumans = 0;	FRPlayers = 0;	XRPlayers = 0;	GGPlayers = 0; TDMPlayers = 0;
	PRPlayers = 0;
	DRPlayers = 0; BTPlayers = 0; //PDMPlayers = 0;
	foreach(Player, cid)
	{//цикл
		if (JoinEvent[cid] == EVENT_DM){DMPlayers++;}
		if (JoinEvent[cid] == EVENT_DERBY && DerbyTimer <= 300 && DerbyTimer > 0){DerbyPlayers++;}
		if (JoinEvent[cid] == EVENT_DERBY && DerbyStarted[cid] == 1 && DerbyTimer <= -1 && DerbyTimeToEnd >= 0){DerbyPlayers++;}
		if (JoinEvent[cid] == EVENT_ZOMBIE && ZMTimer <= 300 && ZMTimer > 0){ZMPlayers++;}
		if (ZMStarted[cid] == 1 && ZMTimer <= -1 && ZMTimeToEnd >= 0){ZMPlayers++; if (ZMIsPlayerIsZombie[cid] > 0) ZMZombies++; else ZMHumans++;}
		if (FRTimer != -1 && JoinEvent[cid] == EVENT_RACE){FRPlayers++;}
		else if(FRStarted[cid] == 1 && FRTimeToEnd >= 0){FRPlayers++;}
		if (XRTimer != -1 && JoinEvent[cid] == EVENT_XRACE){XRPlayers++;}
		else if(XRStarted[cid] == 1 && XRTimeToEnd >= 0){XRPlayers++;}
		if (JoinEvent[cid] == EVENT_GUNGAME){GGPlayers++;}
		if (JoinEvent[cid] == EVENT_TDM){TDMPlayers++;}
		//if (JoinEvent[cid] == EVENT_PDM){PDMPlayers++;}
		if (JoinEvent[cid] == EVENT_DRACE && DRTimer <= 300 && DRTimer > 0){DRPlayers++;}
		if (JoinEvent[cid] == EVENT_DRACE && DRStarted[cid] == 1 && DRTimer <= -1 && DRTimeToEnd >= 0){DRPlayers++;}
		if (PRTimer != -1 && JoinEvent[cid] == EVENT_PARK){PRPlayers++;}
		else if(PRStarted[cid] == 1 && PRTimeToEnd >= 0){PRPlayers++;}
		if (JoinEvent[cid] == EVENT_BATTLE && BTTimer <= 300 && BTTimer > 0){BTPlayers++;}
		if (JoinEvent[cid] == EVENT_BATTLE && BTStarted[cid] == 1 && BTTimer <= -1 ){BTPlayers++;}
	}//цикл
	/////////////

	#include "Transformer\DMSecUpdate"
	#include "Transformer\DerbySecUpdate"
	#include "Transformer\ZombieSecUpdate"
	#include "Transformer\RaceSecUpdate"
	#include "Transformer\XRaceSecUpdate"
	#include "Transformer\GGSecUpdate"
	#include "Transformer\TDMSecUpdate"
	#include "Transformer\PRSecUpdate"
	#include "Transformer\DRSecUpdate"
	#include "Transformer\BTSecUpdate"
	//#include "Transformer\PDMSecUpdate"
	#include "Transformer\ZoneSecUpdate"

	//------------------------------- Прочие цикличные важности
	for (new vid = 1; vid <= 35; vid++)
	{//обработка авто для угона
	    //StealCarTimer[vid]++;
	    if (StealCarTimer[vid] <= unixtime)
	    {//нужно заменить авто для угона на новое
	        if (vid <= 25)
	        {//Наземные авто
				DestroyVehicle(StealCar[vid]);DestroyDynamicMapIcon(StealCarMapIcon[vid]);
				//пересоздание того авто в другом месте
				new rrand1 = random(sizeof(CarStealSpawns)), rcol1 = random(256), rcol2 = random(256), rmodeld = random(133); new rmodel = StealCars[rmodeld];
				StealCar[vid] = LCreateVehicle(rmodel, CarStealSpawns[rrand1][0], CarStealSpawns[rrand1][1], CarStealSpawns[rrand1][2], CarStealSpawns[rrand1][3], rcol1, rcol2, 0);
	  		 	StealCarMapIcon[vid] = CreateDynamicMapIcon(CarStealSpawns[rrand1][0], CarStealSpawns[rrand1][1], CarStealSpawns[rrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);
			}//Наземные авто
			else if (vid <= 30)
			{//Водные авто
				DestroyVehicle(StealCar[vid]);DestroyDynamicMapIcon(StealCarMapIcon[vid]);
				//пересоздание того авто в другом месте
				new rrand1 = random(sizeof(CarStealWaterSpawns)), rcol1 = random(256), rcol2 = random(256), rmodeld = random(11); new rmodel = StealWaterCars[rmodeld];
				StealCar[vid] = LCreateVehicle(rmodel, CarStealWaterSpawns[rrand1][0], CarStealWaterSpawns[rrand1][1], CarStealWaterSpawns[rrand1][2], CarStealWaterSpawns[rrand1][3], rcol1, rcol2, 0);
	  		 	StealCarMapIcon[vid] = CreateDynamicMapIcon(CarStealWaterSpawns[rrand1][0], CarStealWaterSpawns[rrand1][1], CarStealWaterSpawns[rrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);
			}//Водные авто
			else if (vid <= 35)
			{//Воздушное авто
				DestroyVehicle(StealCar[vid]);DestroyDynamicMapIcon(StealCarMapIcon[vid]);
				//пересоздание того авто в другом месте
				new rrand1 = random(sizeof(CarStealAirSpawns)), rcol1 = random(256), rcol2 = random(256), rmodeld = random(13); new rmodel = StealAirCars[rmodeld];
				StealCar[vid] = LCreateVehicle(rmodel, CarStealAirSpawns[rrand1][0], CarStealAirSpawns[rrand1][1], CarStealAirSpawns[rrand1][2], CarStealAirSpawns[rrand1][3], rcol1, rcol2, 0);
	  		 	StealCarMapIcon[vid] = CreateDynamicMapIcon(CarStealAirSpawns[rrand1][0], CarStealAirSpawns[rrand1][1], CarStealAirSpawns[rrand1][2], 55, COLOR_QUEST, 0, 0, -1, 350.0);
			}//Воздушное авто
	    }//нужно заменить авто для угона на новое
	}//обработка авто для угона

	new Float: vehHP, NewMaxVehicleUsed = 35;
	for (new vehid = 36; vehid <= MaxVehicleUsed; vehid++)
	{//обработка всех авто, кроме авто для угона
	    GetVehicleHealth(vehid, vehHP);
	    //если здоровье авто не равно 0, значит машина существует - обрабатываем её
	    if (vehHP != 0) {SecVehicleUpdate(vehid); NewMaxVehicleUsed = vehid;}
	}//обработка всех авто, кроме авто для угона
	MaxVehicleUsed = NewMaxVehicleUsed;
	//new time = GetTickCount() -currenttime;// ????????? ????? ?????????? ?????
	//new log[MAX_MESSAGE];
	//format(log, sizeof(log), "Отзыв сек. таймера: %i. Сработало раз: %d", time, NDD);
	//print(log);
    SetActorPos(Actor[4], 1104.8467,1531.2722,4452.4751);

	return 1;
}//кц пб

public SecVehicleUpdate(vehicleid)
{//ежесекундный обработчик транспорта (не работает на авто для угона и на несуществующих авто)
	if (Vehicle[vehicleid][VType] == 1) goto NEXT;
	
	if (Vehicle[vehicleid][AntiDestroyTime] > 0) Vehicle[vehicleid][AntiDestroyTime]--;
	else
	{//транспорт уже можно уничтожать
	    if (Vehicle[vehicleid][Owner] == -1) DestroyVehicle(vehicleid); //если транспорт никому не принадлежит - уничтожить
	    else if (!IsPlayerInVehicle(Vehicle[vehicleid][Owner], vehicleid) || (GetPlayerVehicleSeat(Vehicle[vehicleid][Owner]) != 0 && GetPlayerVehicleSeat(Vehicle[vehicleid][Owner]) != 128))
		{//если владелец транспорта не за рулем этого авто
		    if( IsTrailer[vehicleid] == 0) DestroyVehicle(vehicleid); //если это не трейлер - уничтожить
		}//если владелец транспорта не за рулем этого авто
	}//транспорт уже можно уничтожать

	NEXT:
	new Float: newHealth;
	GetVehicleHealth(vehicleid, newHealth);
	if (newHealth <= Vehicle[vehicleid][Health]) {Vehicle[vehicleid][Health] = newHealth; LACRepair[vehicleid] = 0;}
	else
	{//Здоровье транспорта оказалось больше, чем оно должно быть
	    new playerid = Vehicle[vehicleid][Owner];
	    if (playerid > -1 && IsPlayerConnected(playerid) && IsPlayerInVehicle(playerid, vehicleid) && LAFK[playerid] < 4)
	    {//Владелец транспорта подключен к серверу и сидит за рулем этого авто. Также он НЕ afk, не в тюнинге и не в PayNSpray
			//Если игрок отремонтировал авто в тюнинге или в Pay N Spray - то принять новые значение здоровья авто
			if (newHealth == 1000.0 && (LastPlayerTuneStatus[playerid] != 0 || IsPlayerInPayNSpray(playerid))) {Vehicle[vehicleid][Health] = newHealth; LACRepair[vehicleid] = 0;}
			else
			{//игрок читер
			    LACRepair[vehicleid]++;
				SetVehicleHealth(vehicleid, Vehicle[vehicleid][Health]); //устанавливаем настоящее значение
			    if (LACRepair[vehicleid] > 4)
			    {
			        new String[140]; DestroyVehicle(vehicleid); TimeTransform[playerid] = unixtime+5; LACPanic[playerid]++;//LAC v2.0
					format(String,sizeof(String), "[АДМИНАМ]LAC:{AFAFAF} Транспорт игрока %s[%d] уничтожен. {FF0000}Причина: {AFAFAF}Возможно чит на Ремонт транспорта",PlayerName[playerid], playerid);
		            foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
		    		SendClientMessage(playerid, -1,"{FF0000}LAC:{AFAFAF} Ваш транспорт был уничтожен. {FF0000}Причина: {AFAFAF}Возможно чит на Ремонт транспорта");
					format(String, 140, "%d.%d.%d в %d:%d:%d |   LAC: Транспорт игрока %s[%d] уничтожен. Причина: Возможно чит на Ремонт транспорта", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("GlobalLog", String);WriteLog("LAC", String);
				}
			}//игрок читер
	    }//Владелец транспорта подключен к серверу и сидит за рулем этого авто
	}//Здоровье транспорта оказалось больше, чем оно должно быть

	return 1;
}//ежесекундный обработчик транспорта (не работает на авто для угона и на несуществующих авто)

public SecPlayerUpdate(playerid)
{//нц пб
		if (!IsPlayerConnected(playerid)) return 1;
		SetTimerEx("SecPlayerUpdate" , 1000, false, "i", playerid);

		//if (Logged[playerid] == 1 && SaveTime == 1) UpdatePlayer(playerid);

		InEvent[playerid] = 0;
		new AutoBug = 0;
		if (JoinEvent[playerid] == EVENT_DM && DMTimeToEnd > 0){InEvent[playerid] = EVENT_DM; AutoBug = 1;SetPlayerVirtualWorld(playerid,1);}
		if (JoinEvent[playerid] == EVENT_ZOMBIE && ZMTimeToEnd > 0){InEvent[playerid] = EVENT_ZOMBIE; AutoBug = 1;SetPlayerVirtualWorld(playerid,663);} else {ZMIsPlayerIsZombie[playerid] = 0;}
	    if (JoinEvent[playerid] == EVENT_RACE){InEvent[playerid] = EVENT_RACE;SetPlayerVirtualWorld(playerid,661);}
	    if (JoinEvent[playerid] == EVENT_XRACE){InEvent[playerid] = EVENT_XRACE;SetPlayerVirtualWorld(playerid,XRACE_WORLD);}
	    if (DerbyStarted[playerid] == 1){InEvent[playerid] = EVENT_DERBY;SetPlayerVirtualWorld(playerid,WORLD_DERBY);}
	    if (JoinEvent[playerid] == EVENT_GUNGAME && GGTimeToEnd > 0){InEvent[playerid] = EVENT_GUNGAME; AutoBug = 1;SetPlayerVirtualWorld(playerid,701);}
	    if (JoinEvent[playerid] == EVENT_TDM && TDMTimeToEnd > 0){InEvent[playerid] = EVENT_TDM; AutoBug = 1;SetPlayerVirtualWorld(playerid,TDM_WORLD);}
	    if (JoinEvent[playerid] == EVENT_PARK && PRTimeToEnd > 0){InEvent[playerid] = EVENT_PARK; AutoBug = 1;SetPlayerVirtualWorld(playerid,PARK_WORLD);}
        if (DRStarted[playerid] == 1){InEvent[playerid] = EVENT_DRACE;SetPlayerVirtualWorld(playerid,DRACE_WORLD);}
        if (BTStarted[playerid] == 1){InEvent[playerid] = EVENT_BATTLE;SetPlayerVirtualWorld(playerid,BATTLE_WORLD);}
        //if (JoinEvent[playerid] == EVENT_PDM && PDMTimeToEnd > 0){InEvent[playerid] = EVENT_PDM; AutoBug = 1;SetPlayerVirtualWorld(playerid,PDM_WORLD);}
		if (PlayerPVP[playerid][Status] >= 2){InEvent[playerid] = EVENT_PVP; AutoBug = 1;}


	    InPeacefulZone[playerid] = 0;//В мирной зоне: нельзя убить и быть убитым
	    if (GetPlayerInterior(playerid) != 16 && GetPlayerInterior(playerid) != 0 && InEvent[playerid] == 0) InPeacefulZone[playerid] = 1;//В интерьерах (кроме PvP)
		//if (IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) InPeacefulZone[playerid] = 1;//В банке (не считается интерьером)
        if (JoinEvent[playerid] == EVENT_RACE || JoinEvent[playerid] == EVENT_XRACE) InPeacefulZone[playerid] = 1;//В гонках
        if (IsPlayerInRangeOfPoint(playerid, 150.0, 2746.9546, -2436.0449, 13.6432) && InEvent[playerid] == 0) InPeacefulZone[playerid] = 1;//Порт (работа грузчика)
        if (IsPlayerInRangeOfPoint(playerid, 150.0, -1107.8953, -986.4189, 129.2188) && InEvent[playerid] == 0) InPeacefulZone[playerid] = 1;//Поле (работа комбайнера)
		if (OnVehFly[playerid] == 1 && InPeacefulZone[playerid] > 0) StopVehFly(playerid);//Режим полета отключается в мирной зоне

	    //Заморозка за 3 сек до конца (защита от бага слива ХР при убийстве в конце сорев)
	    if (JoinEvent[playerid] == EVENT_DM && DMTimeToEnd == 3){EndEventFreeze(playerid);}
	    if (JoinEvent[playerid] == EVENT_ZOMBIE && ZMTimeToEnd == 3){EndEventFreeze(playerid);}

		//Ниже исправляем баг, когда игрок в соревновании мог упасть с высоты и не умереть, таким образом оказавшись за картой
		if ((DMid == 7 && InEvent[playerid] == EVENT_DM) || (GGid == 14 && InEvent[playerid] == EVENT_GUNGAME))
		{//дм на скалах либо гангейм на скалах
		    if (LastPlayerZ[playerid] < 98.0) {OnPlayerDeath(playerid, -1, -1); LSpawnPlayer(playerid);}
		}//дм на скалах либо гангейм на скалах

	    //Ремонт авто в гонках
	    if (JoinEvent[playerid] == EVENT_RACE || JoinEvent[playerid] == EVENT_XRACE) if (IsPlayerInAnyVehicle(playerid)) RepairVehicle(GetPlayerVehicleID(playerid));

	    if (AutoBug == 1 && IsPlayerInAnyVehicle(playerid)){DestroyVehicle(PlayerCarID[playerid]);Player[playerid][CarActive] = 0;PlayerCarID[playerid] = -1;}
	    //Исправляет баг, когда игрок на оказался на машине в пеших соревнованиях (например DM)

 		if (PrestigeGM[playerid] > 0 && InEvent[playerid] == 0) ResetPlayerWeapons(playerid);//Запрет оружия в Режиме Бога

		//Работа
		if (QuestActive[playerid] > 0)
		{//На задании или работе
			if (QuestActive[playerid] == 2)
			{//Доставщик пиццы
			    WorkTime[playerid]++;
				new wTime[16], wTimeLeft = 300 - WorkTime[playerid], wmin = wTimeLeft / 60, wsec = wTimeLeft - wmin * 60;
				if (wTimeLeft > 30)
				{//Больше 30 секунд в запасе
					format(wTime, sizeof wTime, "~Y~%s%d~W~:~Y~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft <= 30 && wTimeLeft >= 0)
				{//Осталось меньше 30 секунд
					format(wTime, sizeof wTime, "~R~%s%d~W~:~R~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft < 0)
				{//Время вышло
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], "~R~00~W~:~R~00"); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Время вышло
				if (wTimeLeft == -1) SendClientMessage(playerid, COLOR_QUEST, "Работа: {FF0000}Вы не успели вовремя и не получите денег за работу!");
			}//Доставщик пиццы

			if (QuestActive[playerid] == 3)
	        {//Грузчик
	            WorkTimeGruz[playerid]++; if (WorkTimeGruz[playerid] <= 35) WorkTime[playerid]++;
				new str[16]; format(str, sizeof str, "~Y~%d~W~/~Y~10", GetPVarInt(playerid,"WorkCount"));
                PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], str); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
                if(GetPVarInt(playerid,"WorkStage") == 2) ApplyAnimation(playerid,"CARRY","crry_prtial",4.1,0,1,1,1,1);//Чтобы не спадала анимация когда несет ящик

	            if (!IsPlayerInRangeOfPoint(playerid, 150.0, 2746.9546, -2436.0449, 13.6432) || GetPlayerState(playerid) != 1)
	            {//Игрок вне зоны работы или он в машине
	                ApplyAnimation(playerid,"PED","IDLE_tired",4.1,0,1,1,0,1);// Обнуляем анимацию
	            	RemovePlayerAttachedObject(playerid,8);// Удаляем объект из рук
	            	DeletePVar(playerid,"WorkStage"); DeletePVar(playerid,"WorkCount");// Удаляем PVar работы
	            	DisablePlayerCheckpoint(playerid); QuestActive[playerid] = 0;
	            	SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Грузчик{FFCC00}>> прервана.");
	            }//Игрок вне зоны работы или он в машине
	        }//Грузчик

	        if (QuestActive[playerid] == 4)
			{//Домушник
			    WorkTime[playerid]++;
				new wTime[16], wTimeLeft = 720 - WorkTime[playerid], wmin = wTimeLeft / 60, wsec = wTimeLeft - wmin * 60;
				if (wTimeLeft > 30)
				{//Больше 30 секунд в запасе
					format(wTime, sizeof wTime, "~Y~%s%d~W~:~Y~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft <= 30 && wTimeLeft >= 0)
				{//Осталось меньше 30 секунд
					format(wTime, sizeof wTime, "~R~%s%d~W~:~R~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft < 0)
				{//Время вышло
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], "~R~00~W~:~R~00"); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Время вышло
				if (wTimeLeft == -1) SendClientMessage(playerid, COLOR_QUEST, "Работа: {FF0000}Вы не успели вовремя и получите только половину денег за работу!");
			}//Домушник

			if (QuestActive[playerid] == 5)
	        {//Комбайнер
	            new Float:Speed, Float:vx, Float:vy, Float:vz, str[24];
			    GetVehicleVelocity(GetPlayerVehicleID(playerid), vx,vy,vz); Speed = floatsqroot(((vx*vx)+(vy*vy)))*200;
	            if (Speed >= 45 && LAFK[playerid] < 4 && -1198.7462 < LastPlayerX[playerid] < -1001.5065 && -1066.4282 < LastPlayerY[playerid] < -908.7125 && GetVehicleModel(GetPlayerVehicleID(playerid)) == 532) WorkTime[playerid]++;//Единица овса засчитывается если комбайн едет(!) по полю
				format(str, sizeof str, "~Y~%d~W~/~Y~300", WorkTime[playerid]);
                PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], str); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
       			if (WorkTime[playerid] == 300)
				{//Набрал 300 единиц овса (за 300сек)
				    SendClientMessage(playerid, COLOR_QUEST,"Работа: Вы получили 270 XP и 22500$ за 300 единиц овса.");
				    LGiveXP(playerid, 300); Player[playerid][Cash] += 22500; WorkTime[playerid] = 0; PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
				}//Набрал 300 единиц овса (за 300сек)
	        }//Комбайнер

	        if (QuestActive[playerid] == 6)
			{//Дальнобойщик
			    WorkTime[playerid]++;
				new wTime[16], wTimeLeft = 720 - WorkTime[playerid], wmin = wTimeLeft / 60, wsec = wTimeLeft - wmin * 60;
				if (wTimeLeft > 30)
				{//Больше 30 секунд в запасе
					format(wTime, sizeof wTime, "~Y~%s%d~W~:~Y~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft <= 30 && wTimeLeft >= 0)
				{//Осталось меньше 30 секунд
					format(wTime, sizeof wTime, "~R~%s%d~W~:~R~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft < 0)
				{//Время вышло
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], "~R~00~W~:~R~00"); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Время вышло
				if (wTimeLeft == -1) SendClientMessage(playerid, COLOR_QUEST, "Работа: {FF0000}Вы не успели вовремя и получите только половину денег за работу!");
			}//Дальнобойщик

			if (QuestActive[playerid] == 7)
			{//Капитан Корабля
			    WorkTime[playerid]++;
				new wTime[16], wTimeLeft = 480 - WorkTime[playerid], wmin = wTimeLeft / 60, wsec = wTimeLeft - wmin * 60;
				if (wTimeLeft > 30)
				{//Больше 30 секунд в запасе
					format(wTime, sizeof wTime, "~Y~%s%d~W~:~Y~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft <= 30 && wTimeLeft >= 0)
				{//Осталось меньше 30 секунд
					format(wTime, sizeof wTime, "~R~%s%d~W~:~R~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft < 0)
				{//Время вышло
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], "~R~00~W~:~R~00"); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Время вышло
				if (wTimeLeft == -1) SendClientMessage(playerid, COLOR_QUEST, "Работа: {FF0000}Вы не успели вовремя и получите только половину денег за работу!");
			}//Капитан Корабля

			if (QuestActive[playerid] == 8)
			{//Инкассатор
			    WorkTime[playerid]++;
				new wTime[16], wTimeLeft = 600 - WorkTime[playerid], wmin = wTimeLeft / 60, wsec = wTimeLeft - wmin * 60;
				if (wTimeLeft > 30)
				{//Больше 30 секунд в запасе
					format(wTime, sizeof wTime, "~Y~%s%d~W~:~Y~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft <= 30 && wTimeLeft >= 0)
				{//Осталось меньше 30 секунд
					format(wTime, sizeof wTime, "~R~%s%d~W~:~R~%s%d", (wmin < 10) ? ("0") : (""), wmin, (wsec < 10) ? ("0") : (""), wsec);
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], wTime); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Больше 30 секунд в запасе
				if (wTimeLeft < 0)
				{//Время вышло
					PlayerTextDrawSetString(playerid, TextDrawWorkTimer[playerid], "~R~00~W~:~R~00"); PlayerTextDrawShow(playerid, TextDrawWorkTimer[playerid]);
				}//Время вышло
				if (wTimeLeft == -1) SendClientMessage(playerid, COLOR_QUEST, "Работа: {FF0000}Вы не успели вовремя и получите только половину денег за работу!");
			}//Инкассатор

	        if (InEvent[playerid] > 0)
	        {//игрок в соревнованиях, но при этом работа или задание активно
	            if (JoinEvent[playerid] != EVENT_RACE && JoinEvent[playerid] != EVENT_XRACE && JoinEvent[playerid] != EVENT_PARK) {DisablePlayerCheckpoint(playerid); DisablePlayerRaceCheckpoint(playerid);}
	            if (QuestActive[playerid] == 3)
	            {//отключаем работу грузчика
	                ApplyAnimation(playerid,"PED","IDLE_tired",4.1,0,1,1,0,1);// Обнуляем анимацию
	            	RemovePlayerAttachedObject(playerid,8);// Удаляем объект работы из рук
	            	DeletePVar(playerid,"WorkStage"); DeletePVar(playerid,"WorkCount");// Удаляем PVar работы
	            }//отключаем работу грузчика
	            if (QuestActive[playerid] == 4)
	            {//отключаем работу домушника
	            	RemovePlayerAttachedObject(playerid,8);// Удаляем объект работы из рук
	            	DeletePVar(playerid,"WorkDomStage");// Удаляем PVar работы
	            }//отключаем работу домушника
	            if (QuestActive[playerid] == 5) GangZoneHideForPlayer(playerid, WorkZoneCombine);//поле комбайнера
                if (QuestActive[playerid] == 6) DeletePVar(playerid,"WorkTruckStage");// Удаляем PVar работы
                if (QuestActive[playerid] == 7) DeletePVar(playerid,"WorkWaterStage");// Удаляем PVar работы
                if (QuestActive[playerid] == 8) DeletePVar(playerid,"WorkBankStage");// Удаляем PVar работы
				QuestActive[playerid] = 0;
	        }//игрок в соревнованиях, но при этом работа или задание активно
	        if (GetPlayerSpecialAction(playerid) == SPECIAL_ACTION_USEJETPACK) SetPlayerSpecialAction(playerid,0);
		}//На задании или работе
		else {WorkTime[playerid] = 0; PlayerTextDrawHide(playerid, TextDrawWorkTimer[playerid]);}

        if (Logged[playerid] == 1)
		{//обновление Score и денег
			SetPlayerScore(playerid,Player[playerid][Level]); //обновление score
            if (LastPlayerTuneStatus[playerid] > 0)
			{//игрок в тюнинге
			    if (GetPlayerMoney(playerid) < Player[playerid][Cash]) Player[playerid][Cash] = GetPlayerMoney(playerid); //чтобы игрок мог тратить деньги на тюнинг
			}//игрок в тюнинге
			else {ResetPlayerMoney(playerid); GivePlayerMoney(playerid, Player[playerid][Cash]);} //обновление денег
		} else SetPlayerScore(playerid,0);
		//Чтобы у игрока тратились деньги за тюнинг

		//Мешок денег за спиной при 500к и более
		if (Player[playerid][Cash] >= 500000 && GetPVarInt(playerid,"CashBag") == 0 && InEvent[playerid] == 0) {SetPVarInt(playerid, "CashBag", 1); SetPlayerAttachedObject(playerid,9,1550,1,0.0,-0.245,0.0,270.0,103.0,70.0);}
		else if ( (InEvent[playerid] > 0 || Player[playerid][Cash] < 500000) && GetPVarInt(playerid,"CashBag") == 1 ){SetPVarInt(playerid, "CashBag", 0); RemovePlayerAttachedObject(playerid,9);}
		//new year
		if (GetPlayerWeapon(playerid) != 34 && GetPVarInt(playerid,"CrHat") == 0) {SetPVarInt(playerid, "CrHat", 1); SetPlayerAttachedObject(playerid,6, 19064, 2, 0.13, 0.0, 0.0, 0.0, 90.0, 90.0);}
		else if (GetPlayerWeapon(playerid) == 34 && GetPVarInt(playerid,"CrHat") == 1){SetPVarInt(playerid, "CrHat", 0); RemovePlayerAttachedObject(playerid,6);}

		if (Player[playerid][Banned] != 0) {SetPlayerVirtualWorld(playerid,666);SetPlayerChatBubble(playerid, "Забанен", COLOR_RED, 300.0, 1001);}//Ад

		//if (SkydiveTime[playerid] > 0){SkydiveTime[playerid]--;}
        if (InviteTime[playerid] > -1){InviteTime[playerid] --;}
        if (InviteTime[playerid] == 0){ShowPlayerDialog(playerid, 777, 0, "Приглашение в клан", "{008E00}Внимание! Вас пригласили в клан, но вы не успели принять приглашение..", "ОК", "");}
    	if (FloodTime[playerid] > 0)
		{
			FloodTime[playerid]--;
			if (FloodTime[playerid] == 0) FloodMessages[playerid] = 0;
		}
		if (ArmourTime[playerid] > 0){ArmourTime[playerid]--;}
		
    	//if (HealthTime[playerid] > 0){HealthTime[playerid]--;}
		//if (UberNitroTime[playerid] > 0) UberNitroTime[playerid]--;
		if (AdminTPCantKill[playerid] > 0){AdminTPCantKill[playerid]--;}
		if (RepairTime[playerid] > 0) RepairTime[playerid]--;
		if (RepairTime[playerid] == 0 && Player[playerid][SkillRepair] > 0 && GetPlayerVehicleSeat(playerid) == 0 && InEvent[playerid] == 0)
		{//авто-починка авто
	        new Float: vehhealth; GetVehicleHealth(GetPlayerVehicleID(playerid), vehhealth);
	        if (vehhealth < 1000.0)
			{//авто не целое
			    RepairVehicle(GetPlayerVehicleID(playerid));
			    SetPlayerChatBubble(playerid, "Транспорт автоматически отремонтирован.", COLOR_GREEN, 100.0, 3000);
			    PlayerPlaySound(playerid,1133,0.0,0.0,0.0);
			    RepairTime[playerid] = 40 - Player[playerid][SkillRepair];
			}//авто не целое
		}//авто-починка авто
		if (HPRegenTime[playerid] == 0 && Player[playerid][SkillHP] > 0 && GMTestStage[playerid] == 0 && InEvent[playerid] == 0 && PlayerPVP[playerid][Status] < 2 && TimeAfterSpawn[playerid] > 3)
		{//регенерация HP (навык)
		    new Float: hp;GetPlayerHealth(playerid, hp);
		    if (Player[playerid][PHealth] < 100.0 && InEvent[playerid] == 0)
		    {
		        HPRegenTime[playerid] = 5;
		        if (hp + Player[playerid][SkillHP] <= 100.0) SetPlayerHealth(playerid, hp + Player[playerid][SkillHP]);
		        else SetPlayerHealth(playerid, 100.0);
		    }
		}//регенерация HP (навык)
		if (HPRegenTime[playerid] > 0){HPRegenTime[playerid]--;}//RegenHP Timer
		
		//if (JumpTime[playerid] > 0){JumpTime[playerid]--;new String[5];format(String,sizeof(String),"%d",JumpTime[playerid]);GameTextForPlayer(playerid, String,1000,6);}//Jump Timer
		//if (SkillNTime[playerid] > 0){SkillNTime[playerid]--;new String[5];format(String,sizeof(String),"%d",SkillNTime[playerid]);GameTextForPlayer(playerid, String,1000,6);}//Skill N Timer
		//if (SkillYTime[playerid] > 0){SkillYTime[playerid]--;new String[5];format(String,sizeof(String),"%d",SkillYTime[playerid]);GameTextForPlayer(playerid, String,1000,6);}//Skill Y Timer
		//if (SkillHTime[playerid] > 0){SkillHTime[playerid]--;new String[5];format(String,sizeof(String),"%d",SkillHTime[playerid]);GameTextForPlayer(playerid, String,1000,6);}//Skill H Timer
		//if (PBackTime[playerid] > 0){PBackTime[playerid]--;new String[5];format(String,sizeof(String),"%d",PBackTime[playerid]);GameTextForPlayer(playerid, String,1000,6);}//parkour back Timer
		//if (MapTPTime[playerid] > 0){MapTPTime[playerid]--;}//Skill N Timer
        //if (CaseBugTime[playerid] > 0){CaseBugTime[playerid]--;}
        //if (PremiumTime[playerid] > 0){PremiumTime[playerid]--;}
        //if (Player[playerid][EventChangeTime] > 0) Player[playerid][EventChangeTime]--;
        //if (GetCpTime[playerid] > 0){GetCpTime[playerid]--;}
        //if (PrestigeTPTime[playerid] > 0) PrestigeTPTime[playerid]--;
        //LastDeathTime[playerid]++;
        //if (Player[playerid][ClanWarTime] > 0) Player[playerid][ClanWarTime]--;
        
        if (OnStartEvent[playerid] > 0){OnStartEvent[playerid]--;}
        if (LACSH[playerid] > 0){LACSH[playerid]--;}
        if (Player[playerid][LeaveZM] > 0) Player[playerid][LeaveZM]--;
        TimeAfterSpawn[playerid]++;
        if(TimeAfterSpawn[playerid] < 4 && Logged[playerid] == 1)
        {
            new String[16]; format(String, sizeof String, "GM ~g~%d sec.", 4-TimeAfterSpawn[playerid]);
			GameTextForPlayer(playerid, String, 1500, 6); SetPlayerHealth(playerid, 0x7F800000);
        }
        if(TimeAfterSpawn[playerid] == 4) SetPlayerHealth(playerid, 100.0);
        
        WeaponShotsLastSecond[playerid] = 0;//Кол-во выстрелов за последнюю секунду
		
		if (PGunActiv[playerid] == 1)
 		{
			if(GetPlayerWeapon(playerid) != 23 || InEvent[playerid] != 0)
			{
		    	PGunActiv[playerid] = 0;
		    	GiveWeapon(playerid,Player[playerid][Slot2],200);
		    	SetPlayerArmedWeapon(playerid, 0);
		    	RemovePlayerAttachedObject(playerid,7);
		    	SendClientMessage(playerid,0xFF0000FF,"Портальная пушка автоматически деактивирована.");
			}
    	}
		
        if (GMTestTime[playerid] > 0)
		{
			GMTestTime[playerid]--;new tester= GMTesterID[playerid];
			if (GMTestTime[playerid] == 0){GMTestStage[playerid] = 0;SendClientMessage(tester,COLOR_YELLOW,"GMTest: Тестирование отменено, так как игрок AFK");}

		}

		if (ArmourTime[playerid] == 59){SetPlayerArmour(playerid, 100.0);}
		if (AntiPlus[playerid] > -1) AntiPlus[playerid] --;
		if (PlayerPVP[playerid][TimeOut] == 1)
		{
			PlayerPVP[playerid][TimeOut] = 0;PlayerPVP[playerid][Status] = 0;PlayerPVP[playerid][Invite] = -1;CanStartPVP[playerid] = 0;
			SendClientMessage(playerid,COLOR_RED,"Время действия приглашения на дуэль истекло.");
			if (JoinEvent[playerid] == EVENT_PVP) JoinEvent[playerid] = 0;
		}
		if (PlayerPVP[playerid][TimeOut] > 1){PlayerPVP[playerid][TimeOut]--;}

		if (LoginKickTime[playerid] > 0)
		{//Кик если вовремя не ввел пароль
			LoginKickTime[playerid]--;
			if (LoginKickTime[playerid] == 0) Kick(playerid);
			else if (LoginKickTime[playerid] <= 30)
			{
				new StringZ[20];
				format(StringZ, sizeof StringZ, "~R~%d", LoginKickTime[playerid]);
			    GameTextForPlayer(playerid, StringZ, 1000, 6);
		    }
		}//Кик если вовремя не ввел пароль


		//уведомления
		if (Player[playerid][BuddhaTime] == 1){SendClientMessage(playerid,COLOR_QUEST,"Веселый Будда в казино теперь доступен!");PlayerPlaySound(playerid,1083,0.0,0.0,0.0);}//звук выигрыша
        if (QuestTime[playerid][0] == 1 || QuestTime[playerid][1] == 1 || QuestTime[playerid][2] == 1){SendClientMessage(playerid,COLOR_QUEST,"QUEST: Новое задание теперь доступно! Смотри {FF0000}/quests");PlayerPlaySound(playerid,1083,0.0,0.0,0.0);}//звук выигрыша

		if (Player[playerid][HelpTime] > 0) Player[playerid][HelpTime]--;
		if (Player[playerid][HelpTime] == 0)
		{//Система подсказок
		    if (Player[playerid][Level] < 5 && Player[playerid][Prestige] == 0)
		    {//Уровень меншьше 5
		        new hms = random(5) + 1; Player[playerid][HelpTime] = 180;//Каждые 3 минуты для новичков
		        if (hms == 1) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Вы можете менять транспорт во время езды клавишами {FFFFFF}Y {00CCCC}и {FFFFFF}N.");
		        if (hms == 2) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Используйте команду {FFFFFF}/bg{00CCCC} чтобы купить оружие.");
		        if (hms == 3) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Смотрите {FFFFFF}/help{00CCCC} если у вас есть вопросы по игре.");
		        if (hms == 4) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Участвуйте в соревнованиях (гонки, дерби, зомби т.д.) чтобы повысить свой уровень.");
		        if (hms == 5) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Используйте {FFFFFF}/gps{00CCCC} чтобы найти работу.");
		    }//Уровень меншьше 5
		    if (Player[playerid][Level] >= 5 && Player[playerid][Level] < 20 && Player[playerid][Prestige] == 0)
		    {//уровень больше 5
		        new hms = random(10) + 1; Player[playerid][HelpTime] = 240;//Каждые 4 минуты для "почти" новичков
		        if (hms == 1) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Используйте {FFFFFF}/gps{00CCCC} чтобы найти работу.");
		        if (hms == 2) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Чтобы изменить свой транспорт используйте {FFFFFF}Alt - Изменить мои автомобили{00CCCC}.");
		        if (hms == 3) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Используйте {FFFFFF}/mygun{00CCCC} чтобы изменить личное оружие. Оно появится после смерти.");
		        if (hms == 4) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: С {FFFFFF}/radio {00CCCC}играть интереснее!");
		        if (hms == 5) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: При помощи {FFFFFF}/myspawn{00CCCC} вы можете изменить стиль и место спавна.");
		        if (hms == 6) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Смотрите {FFFFFF}/help{00CCCC} если у вас есть вопросы по игре.");
		        if (hms == 7) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Введите {FFFFFF}/stats{00CCCC} для отображения вашей статистики.");
                if (hms == 8) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Заметили читера? Сообщите модераторам через {FFFFFF}@{00CCCC}текст.");
                if (hms == 9) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Не забывайте выполнять задания! Введите {FFFFFF}/quests{00CCCC} чтобы отобразить список заданий.");
                if (hms == 10) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Где взять рубли для {FFFFFF}/shop{00CCCC}? Купить можно на {FFFFFF}exclusive-dm.com/donate.php");
 		    }//уровень больше 5
		    if (Player[playerid][Level] >= 20 || Player[playerid][Prestige] > 0)
		    {
		        new hms = random(6) + 1; Player[playerid][HelpTime] = 300;//Каждые 5 минут для всех остальных
                if (hms == 1) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Смотрите {FFFFFF}/help{00CCCC} если у вас есть вопросы по игре.");
                if (hms == 2) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: С {FFFFFF}/radio {00CCCC}играть интереснее!");
                if (hms == 3) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Используйте {FFFFFF}/config {00CCCC}чтобы открыть меню настроек аккаунта.");
                if (hms == 4) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Заметили читера? Сообщите модераторам через {FFFFFF}@{00CCCC}текст.");
                if (hms == 5) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Не забывайте выполнять задания! Введите {FFFFFF}/quests{00CCCC} чтобы отобразить список заданий.");
                if (hms == 6) SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Где взять рубли для {FFFFFF}/shop{00CCCC}? Купить можно на {FFFFFF}exclusive-dm.com/donate.php");
			}
		}//Система подсказок

		//MaxMoney
		if (Player[playerid][Cash] > 999999999)
		{
		    Player[playerid][Cash] = 999999999;
		    SendClientMessage(playerid,COLOR_RED,"Внимание! У вас максимальное количество денег! Все лишние деньги были уничтожены...");
		}

		if(Player[playerid][Muted] > 0 && LAFK[playerid] < 60){Player[playerid][Muted] -= 1;}
		//несливайка
        //new xDay = DateToIntDate(Day, Month, Year);
  		if (Logged[playerid] == 1)
  		{
    		if(Player[playerid][SlivBlock] > 0 && Player[playerid][SlivBlock] < nowday)
        	{
        		SendClientMessage(playerid,COLOR_RED,"Внимание! Действие функции 'Отключение слива денег' остановлено: закончилось время.");
        		Player[playerid][SlivBlock] = -1;
			}
		}
		//Исправление ошибки, когда игрок в неактивном соревновании и не может из него выйти
		if (DMTimer > 600 && JoinEvent[playerid] == EVENT_DM && DMTimeToEnd < 1) JoinEvent[playerid] = 0;
		if (DerbyTimer > 600 && JoinEvent[playerid] == EVENT_DERBY) JoinEvent[playerid] = 0;
		if (ZMTimer > 600 && JoinEvent[playerid] == EVENT_ZOMBIE && ZMTimeToEnd < 1) JoinEvent[playerid] = 0;
		if (FRTimer > 600 && JoinEvent[playerid] == EVENT_RACE) JoinEvent[playerid] = 0;
		if (XRTimer > 600 && JoinEvent[playerid] == EVENT_XRACE && XRStarted[playerid] == 0) JoinEvent[playerid] = 0;
		if (GGTimer > 600 && JoinEvent[playerid] == EVENT_GUNGAME && GGTimeToEnd < 1) JoinEvent[playerid] = 0;
	    if (TDMTimer > 600 && JoinEvent[playerid] == EVENT_TDM && TDMTimeToEnd < 1) JoinEvent[playerid] = 0;
	    if (PRTimer > 600 && JoinEvent[playerid] == EVENT_PARK) JoinEvent[playerid] = 0;
	    if (DRTimer > 600 && JoinEvent[playerid] == EVENT_DRACE) JoinEvent[playerid] = 0;
	    if (BTTimer > 600 && JoinEvent[playerid] == EVENT_BATTLE) JoinEvent[playerid] = 0;
	    //if (PDMTimer > 600 && JoinEvent[playerid] == EVENT_PDM && PDMTimeToEnd < 1) JoinEvent[playerid] = 0;
		//--- Синхронизация погоды и времени
		if (LSpecID[playerid] == -1)
		{//игрок не в спектре
		    //Погода
			if (PlayerWeather[playerid] != -1 && InEvent[playerid] == 0)
				SetPlayerWeather(playerid, PlayerWeather[playerid]);
			else SetPlayerWeather(playerid, ServerWeather);
			//Время
			if (PlayerTime[playerid] != -1 && InEvent[playerid] == 0)
				SetPlayerTime(playerid, PlayerTime[playerid], minute);
			else SetPlayerTime(playerid, hour, minute);
		}//игрок не в спектре
		else
		{//игрок в спектре
		    new specid = LSpecID[playerid];
		    if (PlayerWeather[specid] != -1 && InEvent[specid] == 0)
				SetPlayerWeather(playerid, PlayerWeather[specid]);
			else SetPlayerWeather(playerid, ServerWeather);
			//Время
			if (PlayerTime[specid] != -1 && InEvent[specid] == 0)
				SetPlayerTime(playerid, PlayerTime[specid], minute);
			else SetPlayerTime(playerid, hour, minute);
		}//игрок в спектре
		//--- Синхронизация погоды и времени

		if (AirportTime[playerid] >= 0){AirportTime[playerid] --;}
		if (AirportTime[playerid] == 0 && InEvent[playerid] == 0)
		{//перелет между аэро
		    if (AirportID[playerid] > 0 && AirportID[playerid] <= 5)
		    {
			    SetPlayerInterior(playerid,0);SetPlayerVirtualWorld(playerid, 0);
			    if (AirportID[playerid] == 1)
			    {
			        SetPlayerPos(playerid,1451.6349, -2287.0703, 13.5469);SetPlayerFacingAngle(playerid,90.0);SetCameraBehindPlayer(playerid);
			        SendClientMessage(playerid,COLOR_YELLOW,"Добро пожаловать в {FFFFFF}Лос Сантос");
				}
				if (AirportID[playerid] == 2)
			    {
			        SetPlayerPos(playerid,-1404.6575, -303.7458, 14.1484);SetPlayerFacingAngle(playerid,140.0);SetCameraBehindPlayer(playerid);
			        SendClientMessage(playerid,COLOR_YELLOW,"Добро пожаловать в {FFFFFF}Сан Фиерро");
				}
				if (AirportID[playerid] == 3)
			    {
			        SetPlayerPos(playerid,1672.9861, 1447.9349, 10.7868);SetPlayerFacingAngle(playerid,270.0);SetCameraBehindPlayer(playerid);
			        SendClientMessage(playerid,COLOR_YELLOW,"Добро пожаловать в {FFFFFF}Лас Вентурас");
				}
				if (AirportID[playerid] == 4)
			    {
			        SetPlayerPos(playerid,-2281.9551, 2288.5420, 4.9740);SetPlayerFacingAngle(playerid,270.0);SetCameraBehindPlayer(playerid);
			        SendClientMessage(playerid,COLOR_YELLOW,"Добро пожаловать в {FFFFFF}Бэйсайд");
				}
			}
		}//перелет между аэро

		//Убирание брони в соревнованиях
		if(InEvent[playerid] > 0 && InEvent[playerid] != EVENT_PVP && BTStarted[playerid] == 0){SetPlayerArmour(playerid, 0);}

		//Уничтожение авто если загорелось и отображение времени до трансформации
		//if (TimeTransform[playerid] > 0){TimeTransform[playerid]--;new String[5];format(String,sizeof(String),"%d",TimeTransform[playerid]);GameTextForPlayer(playerid, String,1000,6);}

		if (IsPlayerInVehicle(playerid,PlayerCarID[playerid]))
		{//игрок в своей машине
			GetVehicleHealth(PlayerCarID[playerid], carhealth);
			if (PrestigeGM[playerid] == 1 && InEvent[playerid] == 0) RepairVehicle(PlayerCarID[playerid]);
			if (carhealth <= 250 && PrestigeGM[playerid] == 0){DestroyVehicle(PlayerCarID[playerid]);PlayerCarID[playerid] = 0;Player[playerid][CarActive] = 0;TimeTransform[playerid] = unixtime+10;}
		}//игрок в своей машине

        if (second == 0)
        {//обновление счетчика кол-ва следящим за игроком раз в минуту
            LSpectators[playerid] = 0;
            foreach(Player, i)
			{//цикл
			    if(LSpecID[i] == playerid && IsPlayerConnected(i)){LSpectators[playerid] += 1;}
			}//цикл
        }//обновление счетчика кол-ва следящим за игроком раз в минуту

		if (Player[playerid][BuddhaTime] > 0){Player[playerid][BuddhaTime]--;}
        if (QuestTime[playerid][0] > 0) QuestTime[playerid][0]--;
        if (QuestTime[playerid][1] > 0) QuestTime[playerid][1]--;
        if (QuestTime[playerid][2] > 0) QuestTime[playerid][2]--;

		if (LAFK[playerid] < 600 || Player[playerid][DMove] < 800)
		{//игрок не в афк, либо афк менее 10 минут
			Player[playerid][Time]++;//общее время на серве
			//MarafonUpdate(playerid,4,1);
		    if (Player[playerid][GPremium] >= 3 && Player[playerid][Time] == Player[playerid][Time] / 3600 * 3600)
		    {//ViP 3: +500k в час
		        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
		        if (Player[playerid][Bank] <= 999699999)
		        {
			        Player[playerid][Bank] += 300000;
					SendClientMessage(playerid, 0x00FF00FF, "ViP: Вы получили ежечасовой бонус в размере 300 000$ на ваш банковский счет");
				}
				else
				{
				    Player[playerid][Cash] += 300000;
					SendClientMessage(playerid, 0x00FF00FF, "ViP: Вы получили ежечасовой бонус в размере 300 000$");
				}
		    }//ViP 3: +100k в час
	    }//игрок не в афк, либо афк менее 10 минут

		//---------- карма
		if (LAFK[playerid] < 60){Player[playerid][KarmaTime]++;}
		new xkarm = Player[playerid][KarmaTime] / 600;new xkarm2 = xkarm*600;//делит на 600 без остатка и умножает на 600
		if (xkarm2 == Player[playerid][KarmaTime] && Logged[playerid] == 1)
		{//если прошло еще 10 минут без убийств и пора начислять карму
		    new Float: x, Float: y, Float: z;
			GetPlayerPos(playerid,x,y,z);
			new Float: xdist = x - KarmaX[playerid], Float: ydist = y - KarmaY[playerid];
			if (xdist < 0) xdist = xdist * -1;//Расстояние смещения по X от точки предыдущего начисления кармы
			if (ydist < 0) ydist = ydist * -1;//Расстояние смещения по Y от точки предыдущего начисления кармы
		    if (xdist < 10 && ydist < 10) SendClientMessage(playerid,COLOR_RED,"Вы не получили очков кармы так как всё время стояли на месте.");
		    else
		    {//игрок не стоял на месте и ему надо начислить карму
		        new String[120], kpoint;
	      	    if(xkarm == 1) kpoint = 2; if(xkarm == 2) kpoint = 4;
			    if(xkarm == 3) kpoint = 6; if(xkarm == 4) kpoint = 8;
			    if(xkarm >= 5) kpoint = 10;
				Player[playerid][Karma] += kpoint;
				if (Player[playerid][Karma] > 1000) Player[playerid][Karma] = 1000;
				else
				{
					format(String,sizeof(String),"Вы получили %d очков кармы! Продержитесь без убийств еще 10 минут и вы получите больше.",kpoint);SendClientMessage(playerid,COLOR_YELLOW,String);
					if(Player[playerid][GPremium] >= 7){format(String,sizeof(String),"ViP: Вы получили бонус %d очков кармы",kpoint/2);SendClientMessage(playerid,0x00FF00FF,String);Player[playerid][Karma] += kpoint/2;}
					PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//Звук выигрыша
				}
			    KarmaX[playerid] = x; KarmaY[playerid] = y; KarmaZ[playerid] = z;
		    }//игрок не стоял на месте и ему надо начислить карму
		}//если прошло еще 10 минут без убийств и пора начислять карму

		//---------- Синхронизация цвета игрока
		UpdateColor(playerid);
		//---------- Синхронизация цвета игрока

		if  (SkinChangeMode[playerid] == 1) JoinEvent[playerid] = 0;//Исправление бага при изменении скина

		//--------- PVP
		if (PlayerPVP[playerid][Status] >= 2)
		{//Игрок в PVP
		    if (PlayerPVP[playerid][Status] == 2)
		    {
		        ResetPlayerWeapons(playerid);
				GiveWeapon(playerid,PlayerPVP[playerid][PlayWeapon],20000);
				if (PlayerPVP[playerid][PlayHealth] < 101){SetPlayerHealth(playerid,PlayerPVP[playerid][PlayHealth]);SetPlayerArmour(playerid,0);}
				else{SetPlayerHealth(playerid,100);SetPlayerArmour(playerid,PlayerPVP[playerid][PlayHealth] - 100);}
				PlayerPlaySound(playerid,1056,0.0,0.0,0.0);GameTextForPlayer(playerid, "2",1000,6);
				SetCameraBehindPlayer(playerid);
		    }
		    if (PlayerPVP[playerid][Status] == 3){PlayerPlaySound(playerid,1056,0.0,0.0,0.0);GameTextForPlayer(playerid, "1",1000,6);}
		    if (PlayerPVP[playerid][Status] == 4){PlayerPlaySound(playerid,1057,0.0,0.0,0.0);GameTextForPlayer(playerid, "GO",1000,6);TogglePlayerControllable(playerid,1);}
		    if (PlayerPVP[playerid][Status] < 5) PlayerPVP[playerid][Status]++;
		    if (PlayerPVP[playerid][Status] == 5)
		    {//После старта PVP
		        new Float: x, Float: y, Float: z;GetPlayerPos(playerid,x,y,z);
		        if (PlayerPVP[playerid][PlayMap] == 1 && z < 1038) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 2 && z < 2.5) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 3 && z < 132) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 4 && z < 78) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 5 && z < 66) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 6 && z < 72) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 7 && z < 20) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 8 && z < 75) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 9 && z < 1.3) FailPVP(playerid);
		        if (PlayerPVP[playerid][PlayMap] == 10 && z < 144) FailPVP(playerid);
		        if (LAFK[playerid] > 3) FailPVP(playerid);
		    }//После старта PVP
		}//Игрок в PVP
        //--------- PVP
        
        //if(OnZone[playerid] == Clan[Player[playerid][MyClan]][NowWarZone] && ZoneWarTime[OnZone[playerid]] > 1 && LAFK[playerid] > 6)
        //{
        //	SendClientMessage(playerid,COLOR_RED,"Запрещено стоять в АФК на территории во время войны!");
	    //	GKick(playerid);
        //}

        if (OnFly[playerid] == 1)//Отключение режима супермена в соревах и тд
        {if (IsPlayerInAnyVehicle(playerid) || InEvent[playerid] > 0) StopFly(playerid); else SetPlayerChatBubble(playerid,"Superman (Престиж)",COLOR_YELLOW,200,1001);}

		if (GetPlayerPing(playerid) < MAX_PING) BadPingTime[playerid] = 0;
		else
		{
		    BadPingTime[playerid]++;
		    if (BadPingTime[playerid] == 10)
		    {
		        new String[140]; GKick(playerid);
				format(String,sizeof(String), "SERVER: %s[%d] был автоматически кикнут (Ping: %d).", PlayerName[playerid], playerid, GetPlayerPing(playerid));
				return SendClientMessageToAll(COLOR_GREY, String);
		    }
		}
    	#include "Transformer\LAC" //Lomt1k`s AntiCheat

		if (GetPlayerSpecialAction(playerid) == SPECIAL_ACTION_USEJETPACK && InEvent[playerid] != 0) SetPlayerSpecialAction(playerid, 0); //Исправляем баг с джетпаком на соревнованиях
		//Убираем текстдравы о старте соревнований, если игрок вне сорев
		if (JoinEvent[playerid] == 0) for (new i = 1; i <= MAX_EVENT_TYPES; i++) TextDrawHideForPlayer(playerid, TextDrawEvent[i]);

	    LAFK[playerid] += 1;
		if (LAFK[playerid] >= 3)
		{
		    new afstring[120];
		    if (LAFK[playerid] > 60){new mi = LAFK[playerid]/60; format(afstring,sizeof(afstring),"AFK (%d минут %d секунд)",mi,LAFK[playerid] - 60 * mi);}
			else {format(afstring,sizeof(afstring),"AFK (%d секунд)",LAFK[playerid]);}
			SetPlayerChatBubble(playerid,afstring,COLOR_GREY, 80.0,1000);NeedSpeedDown[playerid] = 1; LACSH[playerid] = 3;
			
		}
		if(LSpecID[playerid] != -1) {if(LAFK[playerid] > 3) {callcmd::specoff(playerid, "");} }
		if(Logged[playerid] == 1 && Player[playerid][SaveTime] <= gettime()) {SavePlayer(playerid); Player[playerid][SaveTime]=gettime()+600;}//сохраняем игрока каждые 10 мин

		return 1;
}//кц пб


public OnPlayerModelSelection(playerid, response, listid, modelid)
{//меню
	if(listid == MenuMyskin)
    {//myskin
        if(response)
        {
            if (InEvent[playerid] == EVENT_TDM) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Запрещено менять скин в ТДМ.");
            SendClientMessage(playerid, COLOR_YELLOW, "Модель персонажа успешно изменена");
            SetPlayerSkin(playerid,modelid);
			Player[playerid][Model] = modelid;
	    }
	    if (SkinChangeMode[playerid] == 1)
   		{
   		    TogglePlayerControllable(playerid,1);
   		    SkinChangeMode[playerid] = 0;
			SetPlayerVirtualWorld(playerid,0);
			LSpawnPlayer(playerid);
   		}
	}//myskin

	if(listid == MenuFirstCar)
    {//выбор первого автомобиля (обучение)
		if(response)
		{//респонс
		    Player[playerid][CarSlot2] = modelid;TutorialStep[playerid] = 3;
		    new String[1024];
			strcat(String, "{007FFF}Обучение: Трансформация{FFFFFF}\n\n");
			strcat(String, "Вы можете прямо во время езды трансформироваться из мопеда в автомобиль!\n");
			strcat(String, "Для этого используйте клавиши {00FF00}Y{FFFFFF} и {00FF00}N\n");
			strcat(String, "\n\n{FFFF00}Нажмите ОК и трансформируйтесь в автомобиль клавишей {00FF00}Y{FFFF00} или {00FF00}N");
			ShowPlayerDialog(playerid, DIALOG_TUTORIAL, 0, "Обучение", String, "ОК", "");
		}//респонс
		else{ShowModelSelectionMenu(playerid, MenuFirstCar, "First Car");}
	}//выбор первого автомобиля (обучение)

	if(listid == MenuClass1)
    {//выбор авто класс 1
			if(response)
			{
			    if(modelid == 1343)
				{//Корзина - удалить транспорт
				    Player[playerid][CarSlot1] = 0;
					return SendClientMessage(playerid,COLOR_YELLOW,"Автомобиль 1-го класса удален");
				}//Корзина - удалить транспорт

				new CarLevel, CarPrice = 0, String[120];
			    if(modelid == 509) CarLevel = 0;//bike
				if(modelid == 462) CarLevel = 0;//faggio
				if(modelid == 586) CarLevel = 5;
				if(modelid == 471) CarLevel = 5;
    			if(modelid == 478) CarLevel = 12;
				if(modelid == 424) CarLevel = 16;
				if(modelid == 539) CarLevel = 20;
				if(modelid == 408) CarLevel = 24;
				if(modelid == 434) CarLevel = 28;
				if(modelid == 522) CarLevel = 45;
				if(modelid == 406) CarLevel = 49;
				if(modelid == 441) CarLevel = 57;
				if(modelid == 564) CarLevel = 57;
				if(modelid == 465) CarLevel = 58;
				if(modelid == 501) CarLevel = 58;
				if(modelid == 464) CarLevel = 58;
				if(modelid == 432) CarLevel = 75;
				if (CarLevel >= 10) CarPrice = CarLevel * 1500;
				if (Player[playerid][Karma] >= 800) CarPrice /= 2;//При карме 800+ транспорт стоит в два раза дешевле

				if (Player[playerid][Level] < CarLevel){ShowModelSelectionMenu(playerid, MenuClass1, "Car Class 1");format(String,sizeof(String),"ОШИБКА: Вы должны быть как минимум %d-го уровня",CarLevel);return SendClientMessage(playerid,COLOR_RED,String);}
				if (Player[playerid][Cash] < CarPrice && CarPrice > 0){ShowModelSelectionMenu(playerid, MenuClass1, "Car Class 1");format(String,sizeof(String),"ОШИБКА: Вам нужно как минимум %d$. Деньги можно приобрести в /shop!",CarPrice);return SendClientMessage(playerid,COLOR_RED,String);}
				Player[playerid][CarSlot1] = modelid;Player[playerid][Cash] -= CarPrice; ResetTuneClass1(playerid);
				Player[playerid][CarActive] = 0;
				modelid -= 400;format(String,sizeof(String),"Ваш новый автомобиль 1-го класса - %s",PlayerVehicleName[modelid]);SendClientMessage(playerid,COLOR_YELLOW,String);
				if (CarPrice > 0){format(String,sizeof(String),"Вы потратили на него %d$",CarPrice);SendClientMessage(playerid,COLOR_YELLOW,String);}
			}
			else{ShowPlayerDialog(playerid, 3, 2, "Замена личного транспорта", "Класс 1\nКласс 2\nКласс 3\n{FFFF00}Prestige{FFFFFF}\nОтмена", "ОК", "");}
    }//выбор авто класс 1

    if(listid == MenuClass2)
    {//выбор авто класс 2
    if(response)
			{
			    if(modelid == 1343)
				{//Корзина - удалить транспорт
				    Player[playerid][CarSlot2] = 0;
					return SendClientMessage(playerid,COLOR_YELLOW,"Автомобиль 2-го класса удален");
				}//Корзина - удалить транспорт

				if(modelid == 365)
				{//paintjob
					if (Player[playerid][Level] < 55){ShowModelSelectionMenu(playerid, MenuClass2, "Car Class 2");SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум 55-го уровня");return 1;}
					return ShowModelSelectionMenu(playerid, MenuPaintJob, "PaintJob Cars");
				}//paintjob

				new CarLevel, CarPrice = 0, String[120];
				if(modelid == 561) CarLevel = 1;
				if(modelid == 558) CarLevel = 1;
				if(modelid == 555) CarLevel = 1;
				if(modelid == 496) CarLevel = 1;
				if(modelid == 542) CarLevel = 1;
				if(modelid == 589) CarLevel = 3;
				if(modelid == 565) CarLevel = 3;
				if(modelid == 602) CarLevel = 3;
				if(modelid == 444) CarLevel = 8;
				if(modelid == 475) CarLevel = 8;
				if(modelid == 603) CarLevel = 8;
				if(modelid == 560) CarLevel = 14;
				if(modelid == 559) CarLevel = 14;
				if(modelid == 506) CarLevel = 14;
				if(modelid == 562) CarLevel = 14;
				if(modelid == 477) CarLevel = 22;
				if(modelid == 402) CarLevel = 22;
				if(modelid == 480) CarLevel = 22;
				if(modelid == 415) CarLevel = 22;
				if(modelid == 451) CarLevel = 26;
				if(modelid == 541) CarLevel = 26;
				if(modelid == 429) CarLevel = 26;
				if(modelid == 494) CarLevel = 30;
				if(modelid == 411) CarLevel = 50;
				if (CarLevel >= 10) CarPrice = CarLevel * 1500;
				if (Player[playerid][Karma] >= 800) CarPrice /= 2;//При карме 800+ транспорт стоит в два раза дешевле

                if (Player[playerid][Level] < CarLevel){ShowModelSelectionMenu(playerid, MenuClass2, "Car Class 2");format(String,sizeof(String),"ОШИБКА: Вы должны быть как минимум %d-го уровня",CarLevel);return SendClientMessage(playerid,COLOR_RED,String);}
				if (Player[playerid][Cash] < CarPrice && CarPrice > 0){ShowModelSelectionMenu(playerid, MenuClass2, "Car Class 2");format(String,sizeof(String),"ОШИБКА: Вам нужно как минимум %d$. Деньги можно приобрести в /shop!",CarPrice);return SendClientMessage(playerid,COLOR_RED,String);}
				Player[playerid][CarSlot2] = modelid;Player[playerid][Cash] -= CarPrice; ResetTuneClass2(playerid);
                Player[playerid][CarActive] = 0;
				modelid -= 400;format(String,sizeof(String),"Ваш новый автомобиль 2-го класса - %s",PlayerVehicleName[modelid]);SendClientMessage(playerid,COLOR_YELLOW,String);
				if (CarPrice > 0){format(String,sizeof(String),"Вы потратили на него %d$",CarPrice);SendClientMessage(playerid,COLOR_YELLOW,String);}
    		}
    		else{ShowPlayerDialog(playerid, 3, 2, "Замена личного транспорта", "Класс 1\nКласс 2\nКласс 3\n{FFFF00}Prestige{FFFFFF}\nОтмена", "ОК", "");}
    }//выбор авто класс 2

    if(listid == MenuClass3)
    {//выбор авто класс 3
    		if(response)
			{
			    if(modelid == 1343)
				{//Корзина - удалить транспорт
				    Player[playerid][CarSlot3] = 0;
					return SendClientMessage(playerid,COLOR_YELLOW,"Автомобиль 3-го класса удален");
				}//Корзина - удалить транспорт

				if(modelid == 539)
				{//UberVortex
					if (Player[playerid][Level] < 90){ShowModelSelectionMenu(playerid, MenuClass3, "Car Class 3");SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум 90-го уровня");return 1;}
					if (Player[playerid][Cash] < 200000 && Player[playerid][Karma] < 900){ShowModelSelectionMenu(playerid, MenuClass3, "Car Class 3");return ShowMoneyWant(playerid,1,"200.000");}
					Player[playerid][CarSlot3] = 539;

					SendClientMessage(playerid,COLOR_YELLOW,"Ваш новый автомобиль 3-го класса - {9966CC}Uber{007FFF}Vortex");
					if (Player[playerid][Karma] < 900){Player[playerid][Cash] -= 200000; SendClientMessage(playerid,COLOR_YELLOW,"Вы потратили на него 150000$");}
					return SendClientMessage(playerid,COLOR_YELLOW,"Особые функции: [ЛКМ] - ускорение, [2] - взлет, [Гудок] - приземление");
				}//UberVortex

				new CarLevel, CarPrice = 0, String[120];
				if(modelid == 473) CarLevel = 6;
				if(modelid == 452) CarLevel = 7;
				if(modelid == 493) CarLevel = 9;
				if(modelid == 512) CarLevel = 11;
				if(modelid == 446) CarLevel = 15;
				if(modelid == 469) CarLevel = 17;
				if(modelid == 447) CarLevel = 19;
				if(modelid == 593) CarLevel = 21;
				if(modelid == 487) CarLevel = 23;
				if(modelid == 460) CarLevel = 25;
				if(modelid == 513) CarLevel = 29;
				if(modelid == 476) CarLevel = 32;
				if(modelid == 519) CarLevel = 68;
				if(modelid == 425) CarLevel = 78;
				if(modelid == 520) CarLevel = 85;
                if (CarLevel >= 10) CarPrice = CarLevel * 2000;
                if (Player[playerid][Karma] >= 800) CarPrice /= 2;//При карме 800+ транспорт стоит в два раза дешевле

                if (Player[playerid][Level] < CarLevel){ShowModelSelectionMenu(playerid, MenuClass3, "Car Class 3");format(String,sizeof(String),"ОШИБКА: Вы должны быть как минимум %d-го уровня",CarLevel);return SendClientMessage(playerid,COLOR_RED,String);}
				if (Player[playerid][Cash] < CarPrice && CarPrice > 0){ShowModelSelectionMenu(playerid, MenuClass3, "Car Class 3");format(String,sizeof(String),"ОШИБКА: Вам нужно как минимум %d$. Деньги можно приобрести в /shop!",CarPrice);return SendClientMessage(playerid,COLOR_RED,String);}
				Player[playerid][CarSlot3] = modelid;Player[playerid][Cash] -= CarPrice;
                Player[playerid][CarActive] = 0;
				modelid -= 400;format(String,sizeof(String),"Ваш новый автомобиль 3-го класса - %s",PlayerVehicleName[modelid]);SendClientMessage(playerid,COLOR_YELLOW,String);
				if (CarPrice > 0){format(String,sizeof(String),"Вы потратили на него %d$",CarPrice);SendClientMessage(playerid,COLOR_YELLOW,String);}

			}
			else{ShowPlayerDialog(playerid, 3, 2, "Замена личного транспорта", "Класс 1\nКласс 2\nКласс 3\n{FFFF00}Prestige{FFFFFF}\nОтмена", "ОК", "");}
    }//выбор авто класс 3

    if(listid == MenuPaintJob)
    {//PaintJob Cars
    		if(response)
			{
			    new CarLevel, CarPrice = 0, String[120];
			    if(modelid == 483) CarLevel = 22;
				if(modelid == 534) CarLevel = 22;
				if(modelid == 535) CarLevel = 22;
				if(modelid == 536) CarLevel = 22;
				if(modelid == 558) CarLevel = 1;
				if(modelid == 559) CarLevel = 14;
				if(modelid == 560) CarLevel = 14;
				if(modelid == 561) CarLevel = 14;
				if(modelid == 562) CarLevel = 14;
				if(modelid == 565) CarLevel = 2;
				if(modelid == 567) CarLevel = 22;
				if(modelid == 575) CarLevel = 22;
				if(modelid == 576) CarLevel = 22;
				if (CarLevel >= 10) CarPrice = CarLevel * 1500;
				if (Player[playerid][Karma] >= 800) CarPrice /= 2;

				if (Player[playerid][Cash] < CarPrice && CarPrice > 0){ShowModelSelectionMenu(playerid, MenuPaintJob, "PaintJob Cars");format(String,sizeof(String),"ОШИБКА: Вам нужно как минимум %d$. Деньги можно приобрести в /shop!",CarPrice);return SendClientMessage(playerid,COLOR_RED,String);}
				Player[playerid][CarSlot2] = modelid;Player[playerid][Cash] -= CarPrice;ResetTuneClass2(playerid);
                Player[playerid][CarActive] = 0;
				modelid -= 400;format(String,sizeof(String),"Ваш новый автомобиль 2-го класса - %s",PlayerVehicleName[modelid]);SendClientMessage(playerid,COLOR_YELLOW,String);
				if (CarPrice > 0){format(String,sizeof(String),"Вы потратили на него %d$",CarPrice);SendClientMessage(playerid,COLOR_YELLOW,String);}

				if(modelid == 83)
				{//Фургончик
				    Player[playerid][CarSlot2PaintJob] = 0;
				}//Фургончик
				else if (modelid == 134 || modelid == 136 || modelid == 167 || modelid == 175 || modelid == 176)
				{//lowrider
				    SendClientMessage(playerid, COLOR_YELLOW, "На этот автомобиль можно установить покрасочные работы в автомастерской {FFFFFF}Lowrider");
				}//lowrider
				else
				{//Arch Angels
				    SendClientMessage(playerid, COLOR_YELLOW, "На этот автомобиль можно установить покрасочные работы в автомастерской {FFFFFF}Arch Angels");
				}//Arch Angels
			}
			else{ShowPlayerDialog(playerid, 3, 2, "Замена личного транспорта", "Класс 1\nКласс 2\nКласс 3\n{FFFF00}Prestige{FFFFFF}\nОтмена", "ОК", "");}
	}//PaintJob Cars

    if(listid == MenuBuyGun)
    {//оружейный магазин
		{//оружейный магазин
			if(response)
			{
			    if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя покупать оружие в соревнованиях");
                    if(modelid == 1240)
					{//аптечка
						new rtime = HealthTime[playerid]-unixtime;
						if (rtime > 0)
						{
							new str[120];format(str, sizeof(str), "{FF0000}Покупка аптечки станет доступна через {FFFFFF}%d{FF0000} секунд.", rtime);
							SendClientMessage(playerid,COLOR_RED,str);ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");return 1;
						}
						if (Player[playerid][Cash] < 100 && Player[playerid][Karma] < 600){ShowMoneyWant(playerid,1,"100");return 1;}
	     				SetPlayerChatBubble(playerid, "Приобрел аптечку", COLOR_GREEN, 100.0, 3000);
						ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
						HealthTime[playerid] = unixtime + 30; SetPlayerHealth(playerid, 100);
						if (Player[playerid][Karma] < 600) {Player[playerid][Cash] -= 100; SendClientMessage(playerid,COLOR_YELLOW,"Вы купили аптечку за 100$");}
						else SendClientMessage(playerid,COLOR_YELLOW,"Вы получили аптечку.");
						QuestUpdate(playerid, 30, 100);//Обновление квеста Потратьте 25к в /bg
					}//аптечка
					if(modelid == 1242)
					{//покупка брони за 250$
					    if (Player[playerid][Karma] <= -600) return SendClientMessage(playerid, COLOR_RED, "Вы не можете покупать аптечки броню из-за слишком низкой кармы.");
						if (ArmourTime[playerid] > 0)
						{
							new str[120];format(str, sizeof(str), "{FF0000}Покупка брони станет доступна через {FFFFFF}%d{FF0000} секунд.", ArmourTime[playerid]);
							SendClientMessage(playerid,COLOR_RED,str);ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");return 1;
						}
						if (Player[playerid][Cash] < 250 && Player[playerid][Karma] < 600){ShowMoneyWant(playerid,1,"250");return 1;}
	     				SetPlayerChatBubble(playerid, "Приобрел броню", COLOR_GREEN, 100.0, 3000);
						ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun"); ArmourTime[playerid] = 60;
                        if (Player[playerid][Karma] < 600) {Player[playerid][Cash] -= 250; SendClientMessage(playerid,COLOR_YELLOW,"Вы купили броню за 250$");}
						else SendClientMessage(playerid,COLOR_YELLOW,"Вы получили броню.");
						QuestUpdate(playerid, 30, 250);//Обновление квеста Потратьте 25к в /bg
					}//покупка брони за 250$
					if(modelid == 347)
					{//9мм силенсед 100$
						if (Player[playerid][Cash] < 100){ShowMoneyWant(playerid,1,"100");return 1;}
						Player[playerid][Cash] -= 100;GivePlayerWeapon(playerid,23,70);SetPlayerChatBubble(playerid, "Приобрел пистолет с глушителем", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили 9мм пистолет с глушителем за 100$");
	 					QuestUpdate(playerid, 30, 100);//Обновление квеста Потратьте 25к в /bg
					}//9мм силенсед 100$
					if(modelid == 346)
					{//9мм  200$
						if (Player[playerid][Cash] < 200){ShowMoneyWant(playerid,1,"200");return 1;}
						Player[playerid][Cash] -= 200;GivePlayerWeapon(playerid,22,70);SetPlayerChatBubble(playerid, "Приобрел 9мм пистолет", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили 9мм пистолет за 200$");
	 					QuestUpdate(playerid, 30, 200);//Обновление квеста Потратьте 25к в /bg
					}//9мм 200$
					if(modelid == 348)
					{//дигл  500$
						if (Player[playerid][Cash] < 500){ShowMoneyWant(playerid,1,"500");return 1;}
						Player[playerid][Cash] -= 500;GivePlayerWeapon(playerid,24,70);SetPlayerChatBubble(playerid, "Приобрел Desert Eagle", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили Desert Eagle за 500$");
	 					QuestUpdate(playerid, 30, 500);//Обновление квеста Потратьте 25к в /bg
					}//дигл 500$
					if(modelid == 349)
					{//дробовик  250$
						if (Player[playerid][Cash] < 250){ShowMoneyWant(playerid,1,"250");return 1;}
						Player[playerid][Cash] -= 250;GivePlayerWeapon(playerid,25,28);SetPlayerChatBubble(playerid, "Приобрел дробовик", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили Дробовик за 250$");
	 					QuestUpdate(playerid, 30, 250);//Обновление квеста Потратьте 25к в /bg
					}//дробовик 250$
					if(modelid == 350)
					{//обрез
						if (Player[playerid][Cash] < 800){ShowMoneyWant(playerid,1,"800");return 1;}
						Player[playerid][Cash] -= 800;GivePlayerWeapon(playerid,26,48);SetPlayerChatBubble(playerid, "Приобрел обрез", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили Обрез за 800$");
	 					QuestUpdate(playerid, 30, 800);//Обновление квеста Потратьте 25к в /bg
					}//обрез
					if(modelid == 351)
					{//спас
						if (Player[playerid][Cash] < 1200){ShowMoneyWant(playerid,1,"1200");return 1;}
						Player[playerid][Cash] -= 1200;GivePlayerWeapon(playerid,27,48);SetPlayerChatBubble(playerid, "Приобрел SPAS12", COLOR_GREEN, 100.0, 3000);
	  					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	  					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили SPAS12 за 1200$");
	  					QuestUpdate(playerid, 30, 1200);//Обновление квеста Потратьте 25к в /bg
					}//спас
					if(modelid == 353)
					{//MP5
					   	if (Player[playerid][Cash] < 500){ShowMoneyWant(playerid,1,"500");return 1;}
						Player[playerid][Cash] -= 500;GivePlayerWeapon(playerid,29,500);SetPlayerChatBubble(playerid, "Приобрел MP5", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили MP5 за 500$");
	 					QuestUpdate(playerid, 30, 500);//Обновление квеста Потратьте 25к в /bg
					}//MP5
					if(modelid == 372)
					{//Tec9
					   	if (Player[playerid][Cash] < 650){ShowMoneyWant(playerid,1,"650");return 1;}
						Player[playerid][Cash] -= 650;GivePlayerWeapon(playerid,32,500);SetPlayerChatBubble(playerid, "Приобрел Tec9", COLOR_GREEN, 100.0, 3000);
	 					ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
	 					SendClientMessage(playerid,COLOR_YELLOW,"Вы купили Tec9 за 650$");
	 					QuestUpdate(playerid, 30, 650);//Обновление квеста Потратьте 25к в /bg
					}//Tec9
					if(modelid == 352)
					{//UZI
					    if (Player[playerid][Cash] < 650){ShowMoneyWant(playerid,1,"650");return 1;}
						Player[playerid][Cash] -= 650;GivePlayerWeapon(playerid,28,500);SetPlayerChatBubble(playerid, "Приобрел MiniUZI", COLOR_GREEN, 100.0, 3000);
						ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
						SendClientMessage(playerid,COLOR_YELLOW,"Вы купили MicroUZI за 650$");
						QuestUpdate(playerid, 30, 650);//Обновление квеста Потратьте 25к в /bg
					}//UZI
					if(modelid == 355)
					{//AK
						if (Player[playerid][Cash] < 800){ShowMoneyWant(playerid,1,"800");return 1;}
						Player[playerid][Cash] -= 800;GivePlayerWeapon(playerid,30,90);SetPlayerChatBubble(playerid, "Приобрел AK-47", COLOR_GREEN, 100.0, 3000);
						ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
						SendClientMessage(playerid,COLOR_YELLOW,"Вы купили AK-47 за 800$");
						QuestUpdate(playerid, 30, 800);//Обновление квеста Потратьте 25к в /bg
					}//AK
					if(modelid == 356)
					{//m4
					    if (Player[playerid][Cash] < 800){ShowMoneyWant(playerid,1,"800");return 1;}
						Player[playerid][Cash] -= 800;GivePlayerWeapon(playerid,31,90);SetPlayerChatBubble(playerid, "Приобрел M4", COLOR_GREEN, 100.0, 3000);
						ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
						SendClientMessage(playerid,COLOR_YELLOW,"Вы купили M4 за 800$");
						QuestUpdate(playerid, 30, 800);//Обновление квеста Потратьте 25к в /bg
					}//m4
					if(modelid == 1310)
					{//Парашют
					    if (Player[playerid][Cash] < 200){ShowMoneyWant(playerid,1,"200");return 1;}
						Player[playerid][Cash] -= 200;GivePlayerWeapon(playerid,46,1);SetPlayerChatBubble(playerid, "Приобрел парашют", COLOR_GREEN, 100.0, 3000);
						ShowModelSelectionMenu(playerid, MenuBuyGun, "Buy Gun");
						SendClientMessage(playerid,COLOR_YELLOW,"Вы купили Парашют за 200$");
						QuestUpdate(playerid, 30, 200);//Обновление квеста Потратьте 25к в /bg
					}//Парашют

				if(GetPlayerState(playerid) == PLAYER_STATE_DRIVER || GetPlayerState(playerid) == PLAYER_STATE_PASSENGER)
				{//делает возможным пользоваться только смг, находясь в транспорте
				    new Weap[2];
				    GetPlayerWeaponData(playerid, 4, Weap[0], Weap[1]); // Get the players SMG weapon in slot 4
				    SetPlayerArmedWeapon(playerid, Weap[0]); // Set the player to driveby with SMG
				}//делает возможным пользоваться только смг, находясь в транспорте
			}
		}//респонс
    }//оружейный магазин

    if(listid == MenuPrestigeCars)
    {//Престижные авто
        if(response)
		{
		    SelectedModel[playerid] = modelid;
		    ShowPlayerDialog(playerid, DIALOG_PRESTIGECAR, 2, "Выбор класса для данного авто", "Класс 1\nКласс 2\n{FFFF00}Сесть только сейчас", "ОК", "Отмена");
		}
		else ShowPlayerDialog(playerid, 3, 2, "Замена личного транспорта", "Класс 1\nКласс 2\nКласс 3\n{FFFF00}Prestige{FFFFFF}\nОтмена", "ОК", "");
    }//Престижные авто

    if(listid == MenuCarWheels)
    {//wheels
        if(response)
		{
		    if (!IsPlayerInAnyVehicle(playerid)) return SendClientMessage(playerid,0xFF8800FF,"Вы должны находиться в автомобиле!");
		    if (Player[playerid][Cash] < 20000) return ShowMoneyWant(playerid,1,"20.000");
            AddVehicleComponent(GetPlayerVehicleID(playerid), modelid);
            ShowPlayerTSDialog(playerid);
            Player[playerid][Cash] -= 20000;
			SetPlayerChatBubble(playerid, "Приобрел диски", COLOR_GREEN, 100.0, 3000);
			SendClientMessage(playerid,COLOR_YELLOW,"Вы установили новые диски на ваш автомобиль за 20.000$!");
			if(Player[playerid][Level] < 10) SendClientMessage(playerid,COLOR_GREEN,"Вы должны быть как минимум 10 уровня, чтобы колеса TurboSpeed сохранялись!");
			else switch(Player[playerid][CarActive])
			{
				case 1: Player[playerid][CarSlot1Component7] = modelid;
   				case 2: Player[playerid][CarSlot2Component7] = modelid;
   				default: SendClientMessage(playerid,COLOR_RED,"Произошла ошибка!");
			}
		}
		else ShowPlayerTSDialog(playerid);
 	}
 	
    if(listid == MenuHousePick)
    {//house pick
        if(response)
		{
		    if(Player[playerid][SPN5] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вам нужен навык Дизайнер! Приобрести его можно в {ffffff}/gold{ff0000}.");
		    if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
            new id = LastHouseVisited[playerid];
			if (id < 1 || id >= MAX_PROPERTY) return 1;
			if (PlayerToPoint(3.0,playerid, Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ]))
			{//игрок рядом с домом
				if (Player[playerid][Home] == id)
				{
				    Player[playerid][Cash] -= 1000000;
				    SendClientMessage(playerid, COLOR_GOLDSHOP, "Вы установили новый пикап для своего дома за 1.000.000$.");
				    
				    Property[id][pPickup] = modelid;
				    DestroyDynamicPickup(PropertyPickup[id]);
				    PropertyPickup[id] = CreateDynamicPickup(Property[id][pPickup], 1, Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ], -1, -1, -1, 100.0);
				    
				    new query[256];
					mysql_format(connects,query, sizeof(query), "UPDATE `houses` SET `Pick` = '%d' WHERE `HID` = '%d';" ,modelid, id);
					if (ServConf[1] == 0) mysql_tquery(connects, query);
					//PropertyMapIcon[id] = CreateDynamicMapIcon(Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ], Property[id][pIcon], 0, -1, -1, -1, 100.0);
				}
			}
 		}
		else ShowHouseDialog(playerid);
    }//housepick
    
    if(listid == MenuHouseIcon)
    {//house pick
        if(response)
		{
		    if(Player[playerid][SPN5] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вам нужен навык Дизайнер! Приобрести его можно в {ffffff}/gold{ff0000}.");
		    if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");

            new id = LastHouseVisited[playerid];
			if (id < 1 || id == MAX_PROPERTY) return 1;
			if (PlayerToPoint(3.0,playerid, Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ]))
			{//игрок рядом с домом
				if (Player[playerid][Home] == id)
				{
				    Player[playerid][Cash] -= 1000000;
				    SendClientMessage(playerid, COLOR_GOLDSHOP, "Вы установили новую иконку для своего дома за 1.000.000$.");

				    Property[id][pIcon] = modelid-19200;
				    DestroyDynamicMapIcon(PropertyMapIcon[id]);
				    PropertyMapIcon[id] = CreateDynamicMapIcon(Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ], Property[id][pIcon], 0, -1, -1, -1, 100.0);

				    new query[256];
					mysql_format(connects,query, sizeof(query), "UPDATE `houses` SET `Icon` = '%d' WHERE `HID` = '%d';" ,Property[id][pIcon], id);
					mysql_tquery(connects, query);
					//PropertyMapIcon[id] = CreateDynamicMapIcon(Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ], Property[id][pIcon], 0, -1, -1, -1, 100.0);
				}
			}
		}
		else ShowHouseDialog(playerid);
    }//housepick

    return 1;
}//меню



public OnDialogResponse(playerid, dialogid, response, listitem, inputtext[])
{
if (PDialogID[playerid] == dialogid)
 	{
 	PDialogID[playerid] = -1;
	if (Logged[playerid] == 0 && dialogid != DIALOG_LOGIN && dialogid != DIALOG_REGISTER) return Kick(playerid);//До авторизации никакие диалоги не работают
    for(new i; inputtext[i];i++) if(inputtext[i]=='%') inputtext[i] = '#';
	//new string[MAX_DIALOG_INFO];
	switch(dialogid)
	{
	case DIALOG_LOGIN:
		{
		    if(!response)
		    {
		    	ShowPlayerDialog(playerid,999,0,"Соединение разорвано","{FF0000}Вы были кикнуты с сервера, за попытку обойти систему авторизации\nВведите /q для выхода.", "ОК", "");
				Kick(playerid);
		    }
		    
		    if(strlen(inputtext) < 3)
			{
   				SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Слишком короткий пароль!");
				DialogToLogin(playerid);
				return 1;
			}
		    
		    for (new i; i < strlen(inputtext); i++)
			{
		   		if (inputtext[i] == '`')
	   			{//В пароле есть символ `
	   				SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Недопустимые символы!");
		   		    DialogToLogin(playerid);
		   		    return 1;
				}//В пароле есть символ `
		   	}
		   	
			if(strcmp(PlayerPass[playerid], inputtext, true))
			{
				Errors[playerid]--;
				if(Errors[playerid] < 1)
				{
					SendClientMessage(playerid,0xFF8800FF,"-------------------------------------------------");
					SendClientMessage(playerid,0xFF8800FF,"Введён неверный пароль!");
					SendClientMessage(playerid,0xFF8800FF,"Соединение разорвано...");
					SendClientMessage(playerid,0xFF8800FF,"-------------------------------------------------");
					GKick(playerid);
					return 1;
				}
				new str[140];
				format(str, sizeof str, "ОШИБКА: Неверный пароль! Осталось попыток: %d",Errors[playerid]);
				SendClientMessage(playerid,COLOR_RED,str);
				DialogToLogin(playerid);
				return 1;
			}
			new query_string[49+MAX_PLAYER_NAME];
            format(query_string, sizeof(query_string), "SELECT * FROM `accounts` WHERE `PName` = '%s'", PlayerName[playerid]);
            mysql_function_query(connects, query_string, true, "LoadPlayerAccount", "i", playerid);
			return 1;
		}
	case DIALOG_REGISTER:
		{
			if(!response){ShowPlayerDialog(playerid,999,0,"Соединение разорвано","{FF0000}Вы были кикнуты с сервера, за попытку обойти систему авторизации", "ОК", "");Kick(playerid);}
			if(!strlen(inputtext) || strlen(inputtext) < 6 || strlen(inputtext) > 24)
			{
			    SendClientMessage(playerid,0xFF8800FF,"ОШИБКА: Длина пароля от 6 до 24 символов!");
				DialogToRegister(playerid);
				return 1;
			}
			
			for(new i = strlen(inputtext)-1; i != -1; i--)
        	{
            	switch(inputtext[i])
            	{
                	case '0'..'9', 'а'..'я', 'a'..'z', 'А'..'Я', 'A'..'Z': continue;
                	default:
				 	{
				 	    SendClientMessage(playerid,0xFF8800FF,"ОШИБКА: В пароле разрешены только цифры, русские и английские буквы!");
				 	    DialogToRegister(playerid);
				 	    return 1;
		 			}
				}
        	}
        	
        	strmid(PlayerPass[playerid], inputtext, 0, strlen(inputtext), MAX_PASSWORD);
        	
        	new NoobSkins[] = {134,135,137, 212, 230, 239};
			new rand = random(sizeof NoobSkins);
			Player[playerid][Model] = NoobSkins[rand];
			Player[playerid][CarSlot1] = 462;//Faggio по-умолчанию
			Player[playerid][CarSlot1Color1] = 1;
			Player[playerid][Cash] = 500;
			LoginKickTime[playerid] = 0;
			TutorialStep[playerid] = 1;
        	
        	new query_string[400], StringDT[16], ChatMes[140];
        	format(StringDT, sizeof StringDT, "%d.%d.%d", Day, Month, Year);
        	//format(StringIP, sizeof StringIP, "%s", PlayerIP[playerid]);
        	
    		format(query_string, sizeof(query_string), "INSERT INTO `accounts` (`PName`,`Password`,`RegisterDate`,`RegisterIP`,`Model`,`LastIP`,`ChatName`)\
			VALUES ('%s','%s','%s','%s','%d','%s','%s')", PlayerName[playerid], PlayerPass[playerid], StringDT, PlayerIP[playerid], Player[playerid][Model], PlayerIP[playerid], PlayerName[playerid]);
    		mysql_function_query(connects, query_string, false, "UploadPlayerAccountNumber", "d", playerid);
    		
    		TextDrawShowForPlayer(playerid, TextDrawTime), TextDrawShowForPlayer(playerid, TextDrawDate);//дата и время

			foreach(Player, gid)
			{//цикл
				if (Logged[gid] == 1 && Player[gid][Admin] > 0)
				{//если модер и выше
   					format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] зарегистрировался [IP-Адрес:{FFFFFF} %s{AFAFAF}].", PlayerName[playerid], playerid, PlayerIP[playerid]);
				}//если модер и выше
				else
				{
					format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] зарегистрировался.", PlayerName[playerid],playerid);
				}
				SendClientMessage(gid, COLOR_GREY, ChatMes);
			}//цикл
			
			//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
			format(ChatMes, sizeof ChatMes, "%d.%d.%d в %d:%d:%d |   %s[%d] зарегистрировался [IP-Адрес: %s].", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, PlayerIP[playerid]);
			WriteLog("GlobalLog", ChatMes);
			
			strmid(RegisterIP[playerid], PlayerIP[playerid], 0, strlen(PlayerIP[playerid]), 16);
			
			Registered[playerid] = 1;
			Logged[playerid] = 1;
			TutorialStep[playerid] = 1;
			XReg[playerid] = 1;
			PlayerWeather[playerid] = -1;
			PlayerTime[playerid] = -1;//Серверные погода и время после регистрации
 			
			//Начало обучения
            new String[1024];
			LSpawnPlayer(playerid);
			StopAudioStreamForPlayer(playerid);
			strcat(String, "{007FFF}Обучение: Вызов транспорта{FFFFFF}\n\n");
			strcat(String, "Каждому игроку на сервере с самого начала выдается свой личный автомобиль. Изначально это мопед.\n");
			strcat(String, "Для того, чтобы сесть на него, нажмите клавишу {00FF00}Alt{FFFFFF} и выберите <<{FFFF00}Сесть в машину [Класс 1]{FFFFFF}>>");
			return ShowPlayerDialog(playerid, DIALOG_TUTORIAL, 0, "Обучение", String, "ОК, сейчас", "");
		}

		///////////////

	case 2:
		{//Быстрый доступ
			if(response)
			{
				if(listitem == 0 && GetPlayerState(playerid) == 1)
				{//Slot 1
				    CallCar1(playerid);//вызов авто класса 1
				    if (Player[playerid][Level] == 0)
				    {//Проходит обучение
				        if (TutorialStep[playerid] == 1)
				        {//Обучение: Вызов мопеда
					        new String[1024];
					        TutorialStep[playerid] = 2;
							strcat(String, "{007FFF}Обучение: Выбор первого автомобиля{FFFFFF}\n\n");
							strcat(String, "Ваш мопед - транспорт первого класса, но у каждого игрока может быть сразу три автомобиля: \n");
							strcat(String, "по одному на каждый класс. Пришла пора выбрать ваш первый автомобиль второго класса!");
	 						strcat(String, "\n\n{FFFF00}Нажмите ОК и выберите автомобиль..");
							ShowPlayerDialog(playerid, DIALOG_TUTORIAL, 0, "Обучение", String, "ОК", "");
							DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;
						}//Обучение: Вызов мопеда
						if (TutorialStep[playerid] == 3)
						{//Обучение: Трансформация
						    if (TutorialObject[playerid] != -1){DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;}
						    TutorialObject[playerid] = CreateObject(19482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
							SetObjectMaterialText(TutorialObject[playerid], "{FFFF00}Обучение\n{FFFFFF}Нажмите {00FF00}Y{FFFFFF}/{00FF00}N", 0, OBJECT_MATERIAL_SIZE_512x512, "Tahoma", 50, 1, 0xFFFFFFFF, 0x00, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
			                AttachObjectToPlayer(TutorialObject[playerid], playerid, 0, 0, 1.2, 0, 0, 270);
						}//Обучение: Трансформация
				    }//Проходит обучение
				}//Slot 1
				if(listitem == 1 && GetPlayerState(playerid) == 1)
				{//Slot 2
				    CallCar2(playerid);//вызов авто класса 2
				}//Slot 2
				if(listitem == 2 && GetPlayerState(playerid) == 1)
				{//Slot 3
				    CallCar3(playerid);//вызов авто класса 3
				}//Slot 3
				if(listitem == 3) callcmd::jetpack(playerid, ""); 	//Jetpack
				if(listitem == 4) callcmd::events(playerid, ""); 	//events
				if(listitem == 5) callcmd::buygun(playerid, ""); 	//buygun
				if(listitem == 6) callcmd::gps(playerid, ""); 		//GPS
				if(listitem == 7) callcmd::config(playerid, ""); 	//config
				if(listitem == 8) callcmd::status(playerid, ""); 	//stats
				if(listitem == 9) callcmd::quests(playerid, ""); 	//quests
				if(listitem == 10) ShowPlayerKPK(playerid); //kpk
			}
		}//Быстрый доступ


	case 3:
		{//Замена транспорта
			if(response)
			{
				if(listitem == 0) ShowModelSelectionMenu(playerid, MenuClass1, "Car Class 1");
				if(listitem == 1) ShowModelSelectionMenu(playerid, MenuClass2, "Car Class 2");
				if(listitem == 2) ShowModelSelectionMenu(playerid, MenuClass3, "Car Class 3");
				if(listitem == 3)
				{//Prestige-list
				    if (Player[playerid][Prestige] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас должен быть как минимум 1-ый уровень Престижа");return 1;}
				    if (Player[playerid][Level] < 85){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум 85-го уровня");return 1;}
				    if (Player[playerid][CarActive] > 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны выйти из авто");return 1;}
				    ShowModelSelectionMenu(playerid, MenuPrestigeCars, "Prestige Cars");
				}//Prestige-list
			}
			else ShowPlayerKPK(playerid);
		}//замена транспорта


	case 8:
		{//КПК
			if(response)
			{
				if(listitem == 0) callcmd::mygun(playerid, "");		//личное оружие
				if(listitem == 1) callcmd::clan(playerid, "");		//clan
				if(listitem == 2) callcmd::shop(playerid, "");		//shop
				if(listitem == 3) 									//навыки
				{//Изменить навыки
				    new StringF[600];
				    switch (Player[playerid][ActiveSkillPerson])
				    {//Навык персонажа
				        case 1: strcat(StringF,"Клавиша {008D00}N{FFFFFF} (Пешком): {007FFF}Телепорт на 50 метров\n");
				        case 2: strcat(StringF,"Клавиша {008D00}N{FFFFFF} (Пешком): {007FFF}Телепорт на 100 метров\n");
				        case 3: strcat(StringF,"Клавиша {008D00}N{FFFFFF} (Пешком): {007FFF}Телепорт на 200 метров\n");
				        case 4: strcat(StringF,"Клавиша {008D00}N{FFFFFF} (Пешком): {007FFF}Режим Супермена\n");
				        default: strcat(StringF,"Клавиша {008D00}N{FFFFFF} (Пешком): {AFAFAF}Нет\n");
				    }//Навык персонажа

				    switch (Player[playerid][ActiveSkillCar1])
				    {//Класс 1: Клавиша 2
				        case 1: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 1): {007FFF}Разворот на 180 градусов\n");
				        case 2: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 1): {007FFF}Прыжок\n");
				        case 3: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 1): {007FFF}Трамплин\n");
				        default: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 1): {AFAFAF}Нет\n");
				    }//Класс 1: Клавиша 2

				    switch (Player[playerid][ActiveSkillCar2])
				    {//Класс 2: Клавиша 2
				        case 1: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 2): {007FFF}Разворот на 180 градусов\n");
				        case 2: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 2): {007FFF}Прыжок\n");
				        case 3: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 2): {007FFF}Трамплин\n");
				        default: strcat(StringF,"Клавиша {008D00}2{FFFFFF} (Класс 2): {AFAFAF}Нет\n");
				    }//Класс 2: Клавиша 2

				    switch (Player[playerid][ActiveSkillHCar1])
				    {//Класс 1: Клавиша гудка
				        case 1: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Переворот транспорта на колеса\n");
				        case 2: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Телепорт на 50 метров\n");
				        case 3: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Телепорт на 100 метров\n");
				        case 4: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Телепорт на 200 метров\n");
				        case 5: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Телепорт на 50 метров со скоростью\n");
				        case 6: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Телепорт на 100 метров со скоростью\n");
				        case 7: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Телепорт на 200 метров со скоростью\n");
				        case 8: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {007FFF}Режим Полета\n");
				        default: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 1): {AFAFAF}Нет\n");
				    }//Класс 1: Клавиша гудка

				    switch (Player[playerid][ActiveSkillHCar2])
				    {//Класс 2: Клавиша гудка
				        case 1: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Переворот транспорта на колеса\n");
				        case 2: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Телепорт на 50 метров\n");
				        case 3: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Телепорт на 100 метров\n");
				        case 4: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Телепорт на 200 метров\n");
				        case 5: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Телепорт на 50 метров со скоростью\n");
				        case 6: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Телепорт на 100 метров со скоростью\n");
				        case 7: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Телепорт на 200 метров со скоростью\n");
				        case 8: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {007FFF}Режим Полета\n");
				        default: strcat(StringF,"Клавиша {008D00}H{FFFFFF} (Класс 2): {AFAFAF}Нет\n");
				    }//Класс 1: Клавиша гудка
				    strcat(StringF, "{FF0000}Пассивные навыки\n");
				    strcat(StringF, "{F1C619}Особые навыки (/gold)\n");
				    if(Player[playerid][GPremium] > 10) //если випка 11 и более
				    {
				    	if(Player[playerid][MJAct] == 0)strcat(StringF, "{ffffff}Мега-прыжок (VIP 11) | {ff0000}Выкл.");
				    	else strcat(StringF, "{ffffff}Мега-прыжок (VIP 11) | {00ff00}Вкл.");
			    	}
				    ShowPlayerDialog(playerid, DIALOG_SKILLCHANGE, 2, "Изменить мои навыки", StringF, "ОК", "Отмена");
				}//Изменить навыки
				
				if(listitem == 4)//транспорт
				{//Изменить слоты
					ShowPlayerDialog(playerid, 3, 2, "Замена личного транспорта", "Класс 1\nКласс 2\nКласс 3\n{FFFF00}Prestige{FFFFFF}\nОтмена", "ОК", "");
				}//Изменить слоты
				if(listitem == 5) callcmd::style(playerid, "");		//стиль драки
				if(listitem == 6) callcmd::radio(playerid, "");		//радио
				if(listitem == 7) callcmd::help(playerid, "");		//помощь
  				if(listitem == 8) callcmd::myspawn(playerid, "");	//спавн
				if(listitem == 9) callcmd::invisible(playerid, "");	//невидимка
				if(listitem == 10) callcmd::zones(playerid, "");    //терры
				if(listitem == 11) callcmd::skydive(playerid, "");	//прыжок с парашютом
				if(listitem == 12) //пвп
				{//Настройки PvP
				    if (PlayerPVP[playerid][Status] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки во время дуэли.");
					if (PlayerPVP[playerid][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки когда Вы/Вас вызвали на дуэль.");
					ShowConfigPVP(playerid);
				}//Настройки PvP
				
			}
			else ShowPlayerAltMenu(playerid);//{ShowPlayerDialog(playerid, 2, 2, "Меню быстрого доступа", "Сесть в машину [Класс 1]\nСесть в машину [Класс 2]\nСесть в машину [Класс 3]\nНадеть JetPack (/jetpack)\nПрыгнуть с парашютом (/skydive)\n{FF0000}GPS (/gps){FFFFFF}\nИзменить мои автомобили\nИзменить мои навыки\nНастройки PvP\n{FFFF00}Открыть КПК", "ОК", "Назад");}
			return 1;
		}//КПК



	case 9:
		{//Радио
			if(response)
			{
				if(listitem == 0){StopAudioStreamForPlayer(playerid);}
				if(listitem == 1){PlayAudioStreamForPlayer(playerid, "http://ep256.hostingradio.ru:8052/europaplus256.mp3");}//Europa+
				if(listitem == 2){PlayAudioStreamForPlayer(playerid, "http://mxsel.maksmedia.ru:8000/maksfm128.m3u");}//MaksFM
				if(listitem == 3){PlayAudioStreamForPlayer(playerid, "https://zaycevfm.cdnvideo.ru/ZaycevFM_pop_128.mp3");}//zaysev fm
				if(listitem == 4){PlayAudioStreamForPlayer(playerid, "http://radio02-cn03.akadostream.ru:8108/shanson128.mp3");}//Shanson
				if(listitem == 5){PlayAudioStreamForPlayer(playerid, "http://online.radiorecord.ru:8102/rock_128.m3u");}//record rock
				if(listitem == 6){PlayAudioStreamForPlayer(playerid, "http://online.radiorecord.ru:8102/club_128.m3u");}//Record club
				if(listitem == 7){PlayAudioStreamForPlayer(playerid, "http://online.radiorecord.ru:8102/dub_128.m3u");}//Record Dubstep
				if(listitem == 8){PlayAudioStreamForPlayer(playerid, "http://cmd.3dn.ru/sound/RadioRecord.m3u");}//Radio Record
				if(listitem == 9){PlayAudioStreamForPlayer(playerid, "http://radio.zaycev.fm:9002/ZaycevFM(128).m3u");}//Зайцев.fm Pop
				if(listitem == 10){PlayAudioStreamForPlayer(playerid, "http://radio.zaycev.fm:9002/alternative/ZaycevFM(128).m3u");}//Зайцев.fm NewRock
				if(listitem == 11){PlayAudioStreamForPlayer(playerid, "http://radio.zaycev.fm:9002/electronic/ZaycevFM(128).m3u");}//Зайцев.fm Club
				if(listitem == 12){PlayAudioStreamForPlayer(playerid, "http://radio.zaycev.fm:9002/disco/ZaycevFM(128).m3u");}//Зайцев.fm Disco
				if(listitem == 13){PlayAudioStreamForPlayer(playerid, "http://radio.zaycev.fm:9002/rnb/ZaycevFM(128).m3u");}//Зайцев.fm RnB
				if(listitem == 14){PlayAudioStreamForPlayer(playerid, "http://nashe1.hostingradio.ru:80/nashe20-128.mp3");}//Наше радио
			}
			return 1;
		}//Радио



	case DIALOG_MYSPAWN:
		{//Место спавна
			if (response)
			{//респонс
				if (listitem == 0)
				{//Стандартное место спавна
					Player[playerid][Spawn] = 0;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Стандартное место спавна");
				}//Стандартное место спавна
				if (listitem == 1)
				{//Личный дом (Снаружи)
					if (Player[playerid][Home] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет дома.");return 0;}
					Player[playerid][Spawn] = 4;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Личный дом (Снаружи)");
				}//Личный дом (Снаружи)
				if (listitem == 2)
				{//Личный дом (Внутри)
				    if (Player[playerid][Home] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет дома.");return 0;}
					Player[playerid][Spawn] = 6; Player[playerid][SpawnStyle] = 0;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Личный дом (Внутри)");
                    return 1;//Чтобы не было выбора стиля спавна
				}//Личный дом (Внутри)
				if (listitem == 3)
				{//Штаб клана (Снаружи)
				    if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане");
					new clanid = Player[playerid][MyClan];
					if(Clan[clanid][cBase] < 1 || Clan[clanid][cBase] > MAX_BASE) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вашего клана нет штаба");
    				Player[playerid][Spawn] = 5;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Штаб клана (Снаружи)");
				}//Штаб клана (Снаружи)
				if (listitem == 4)
				{//Штаб клана (Внутри)
				    if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане");
					new clanid = Player[playerid][MyClan];
					if(Clan[clanid][cBase] < 1 || Clan[clanid][cBase] > MAX_BASE) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вашего клана нет штаба");
    				Player[playerid][Spawn] = 8; Player[playerid][SpawnStyle] = 0;
					return SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Штаб клана (Внутри)");
				}//Штаб клана (Внутри)
				if (listitem == 5)
				{//текущее местоположение (ViP 4 lvl)
				    if (Player[playerid][GPremium] < 4) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум 4-го уровня ViP");
				    if (Player[playerid][Home] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас должен быть личный дом");
					if (LSpecID[playerid] != -1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны выйти из режима слежки");
					if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя установить VIP-спавн в помещениях");
				    GetPlayerPos(playerid,Player[playerid][PosX],Player[playerid][PosY],Player[playerid][PosZ]);GetPlayerFacingAngle(playerid,Player[playerid][PosA]);
				    Player[playerid][Spawn] = 7;//SavePlayer(playerid);
				    SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Личная позиция (ViP)");
				}//текущее местоположение (ViP 4 lvl)

				new StringX[1024];
				strcat(StringX, "{FFFFFF}({FFFF00}Уровень 0{FFFFFF})Нет\n{FFFFFF}({FFFF00}Уровень 10{FFFFFF})Спавн на авто класса 1\n{FFFFFF}({FFFF00}Уровень 13{FFFFFF})Спавн на авто класса 2\n{FFFFFF}({FFFF00}Уровень 38{FFFFFF})Спавн на JetPack\n{FFFFFF}({FFFF00}Уровень 54{FFFFFF})Спавн на авто класса 3");
				ShowPlayerDialog(playerid, DIALOG_MYSPAWN2, 2, "Настройки респавна - Стиль", StringX, "ОК", "Назад");
			}//респонс
		}//Место спавна

	case DIALOG_MYSPAWN2:
		{//Стили спавна
			if(response)
			{//респонс
				if(listitem == 0)
				{//без стиля
					Player[playerid][SpawnStyle] = 0;
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль вашего респавна: {FFFFFF}Обычный(без стиля)");
				}//без стиля
				if(listitem == 1)
				{//авто 1
					if (Player[playerid][Level] < 10){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум {FFFFFF}10{FF0000}-го уровня, чтобы выбрать этот стиль респавна");return 0;}
					Player[playerid][SpawnStyle] = 1;
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль вашего респавна: {FFFFFF}На авто класса 1");
				}//авто 1
				if(listitem == 2)
				{//авто 2
					if (Player[playerid][Level] < 13){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум {FFFFFF}13{FF0000}-го уровня, чтобы выбрать этот стиль респавна");return 0;}
					Player[playerid][SpawnStyle] = 2;
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль вашего респавна: {FFFFFF}На авто класса 2");
				}//авто 2
				if(listitem == 3)
				{//jetpack
				    if (Player[playerid][Level] < 38){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум {FFFFFF}38{FF0000}-го уровня, чтобы выбрать этот стиль респавна");return 0;}
					Player[playerid][SpawnStyle] = 5;
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль вашего респавна: {FFFFFF}На JetPack");
				}//jetpack
				if(listitem == 4)
				{//авто 3
					if (Player[playerid][Level] < 54){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум {FFFFFF}54{FF0000}-го уровня, чтобы выбрать этот стиль респавна");return 0;}
					Player[playerid][SpawnStyle] = 4;
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль вашего респавна: {FFFFFF}На авто класса 3");
				}//авто 3
			}//респонс
			else {callcmd::myspawn(playerid, "");}//если нажал Еск
		}//Стили спавна

	case DIALOG_MYGUN:
		{//Личное оружие
			if(response)
			{//респонс
				if(listitem == 0)
				{//холодное оружие сл1
					if (Player[playerid][Level] < 8) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}8{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					if (Player[playerid][SPN6] == 0) ShowPlayerDialog(playerid, DIALOG_MYGUN1, 2, "Личное Оружие - Холодное Оружие", "Нет\n[{FFFF00}8{FFFFFF}]Бензопила\n[{FFFF00}27{FFFFFF}]Катана", "ОК", "Назад");
					else ShowPlayerDialog(playerid, DIALOG_MYGUN1, 2, "Личное Оружие - Холодное Оружие", "Нет\n[{FFFF00}8{FFFFFF}]Бензопила\n[{FFFF00}27{FFFFFF}]Катана\n{FFFF00}Кастет\n{ffff00}Клюшка\n{ffff00}Дубинка\n{ffff00}Бита\n{ffff00}Лопата\n{ffff00}Кий\n{ffff00}Вибратор\n{ffff00}Букет\n{ffff00}Трость", "ОК", "Назад");
				}//холодное оружие сл1
				if(listitem == 1)
				{//пистолеты сл2
					if (Player[playerid][Level] < 16) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}16{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					ShowPlayerDialog(playerid, DIALOG_MYGUN2, 2, "Личное Оружие - Пистолеты", "Нет\n9мм пистолет\n9мм пистолет с глушителем\nDesert Eagle", "ОК", "Назад");
				}//пистолеты сл2
				if(listitem == 2)
				{//дробовики сл3
					if (Player[playerid][Level] < 17) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}17{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					ShowPlayerDialog(playerid, DIALOG_MYGUN3, 2, "Личное Оружие - Дробовики", "Нет\nДробовик\nОбрез\nSPAZ-12", "ОК", "Назад");
				}//дробовики сл3
				if(listitem == 3)
				{//пп сл4
					if (Player[playerid][Level] < 18) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}18{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					ShowPlayerDialog(playerid, DIALOG_MYGUN4, 2, "Личное Оружие - Пистолет-Пулеметы", "Нет\nMP5\nUZI\nTec-9", "ОК", "Назад");
				}//пп сл4
				if(listitem == 4)
				{//автоматы сл5
					if (Player[playerid][Level] < 19) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}19{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					ShowPlayerDialog(playerid, DIALOG_MYGUN5, 2, "Личное Оружие - Автоматы", "Нет\nАК-47\nМ4", "ОК", "Назад");
				}//автоматы сл5
				if(listitem == 5)
				{//метательное сл8
					if (Player[playerid][Level] < 23) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}23{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					if (Player[playerid][SPN6] == 0) ShowPlayerDialog(playerid, DIALOG_MYGUN8, 2, "Личное Оружие - Метательное", "Нет\nГранаты", "ОК", "Назад");
					else ShowPlayerDialog(playerid, DIALOG_MYGUN8, 2, "Личное Оружие - Метательное", "Нет\nГранаты\n[{ffff00}45{ffffff}] {ffff00}C4 взрывчатка\n{ffff00}Молотов", "ОК", "Назад");
				}//метательное сл8
				if(listitem == 6)
				{//винтовки сл6
					if (Player[playerid][Level] < 34) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}34{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					ShowPlayerDialog(playerid, DIALOG_MYGUN6, 2, "Личное Оружие - Винтовки", "Нет\nДеревенское Ружье\nСнайперская Винтовка", "ОК", "Назад");
				}//винтовки сл6
				if(listitem == 7)
				{//тяжелое оружие сл7
					if (Player[playerid][Level] < 40) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}40{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					if (Player[playerid][SPN6] == 0) ShowPlayerDialog(playerid, DIALOG_MYGUN7, 2, "Личное Оружие - Тяжелое Оружие", "Нет\nRPG\n[{FFFF00}60{FFFFFF}]Миниган", "ОК", "Назад");
					else ShowPlayerDialog(playerid, DIALOG_MYGUN7, 2, "Личное Оружие - Тяжелое Оружие", "Нет\nRPG\n[{FFFF00}60{FFFFFF}]Миниган\n{ffff00}Самонаводящийся гранатомет\n{ffff00}Огнемет", "ОК", "Назад");
				}//тяжелое оружие сл7
				if(listitem == 8)
				{//прочее сл10
					if (Player[playerid][Level] < 4) return SendClientMessage(playerid,COLOR_RED,"Вы должны быть как минимум {FFFFFF}4{FF0000}-го уровня, чтобы покупать оружие из этой категории");
					if (Player[playerid][SPN6] == 0) ShowPlayerDialog(playerid, DIALOG_MYGUN10, 2, "Личное Оружие - Прочее", "Нет\nПарашют\nОгнетушитель", "ОК", "Назад");
					else ShowPlayerDialog(playerid, DIALOG_MYGUN10, 2, "Личное Оружие - Прочее", "Нет\nПарашют\nОгнетушитель\n{FFFF00}Баллончик\n{FFFF00}Фотоаппарат", "ОК", "Назад");
				}//прочее сл10
			}//респонс
		}//Личное оружие

	case DIALOG_MYGUN1:
		{//ло - холодное
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) {Player[playerid][Slot1] = 0; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 1) {Player[playerid][Slot1] = 9; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 2)
			{
				if (Player[playerid][Level] < 27) return SendClientMessage(playerid,COLOR_RED,"Ошибка: Вы должны быть как минимум {FFFFFF}27{FF0000}-го уровня, чтобы выбрать это оружие");
				Player[playerid][Slot1] = 8; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			}
			if(listitem == 3) {Player[playerid][Slot1] = 1; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 4) {Player[playerid][Slot1] = 2; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 5) {Player[playerid][Slot1] = 3; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 6) {Player[playerid][Slot1] = 5; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 7) {Player[playerid][Slot1] = 6; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 8) {Player[playerid][Slot1] = 7; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 9) {Player[playerid][Slot1] = 12; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 10) {Player[playerid][Slot1] = 14; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 11) {Player[playerid][Slot1] = 15; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			callcmd::mygun(playerid, "");
		}//ло - холодное

	case DIALOG_MYGUN2:
		{//ло - пистолеты
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) Player[playerid][Slot2] = 0;
			if(listitem == 1) Player[playerid][Slot2] = 22;
			if(listitem == 2) Player[playerid][Slot2] = 23;
			if(listitem == 3) Player[playerid][Slot2] = 24;
			SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			callcmd::mygun(playerid, "");
		}//ло - пистолеты

	case DIALOG_MYGUN3:
		{//ло - дробовики
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) Player[playerid][Slot3] = 0;
			if(listitem == 1) Player[playerid][Slot3] = 25;
			if(listitem == 2) Player[playerid][Slot3] = 26;
			if(listitem == 3) Player[playerid][Slot3] = 27;
			SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			callcmd::mygun(playerid, "");
		}//ло - дробовики

	case DIALOG_MYGUN4:
		{//ло - пп
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) Player[playerid][Slot4] = 0;
			if(listitem == 1) Player[playerid][Slot4] = 29;
			if(listitem == 2) Player[playerid][Slot4] = 28;
			if(listitem == 3) Player[playerid][Slot4] = 32;
			SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			callcmd::mygun(playerid, "");
		}//ло - пп

	case DIALOG_MYGUN5:
		{//ло - автоматы
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) Player[playerid][Slot5] = 0;
			if(listitem == 1) Player[playerid][Slot5] = 30;
			if(listitem == 2) Player[playerid][Slot5] = 31;
			SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			callcmd::mygun(playerid, "");
		}//ло - автоматы

	case DIALOG_MYGUN8:
		{//ло - Метательное
            if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) {Player[playerid][Slot8] = 0;SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 1) {Player[playerid][Slot8] = 16; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 2)
			{
				if (Player[playerid][Level] < 45) return SendClientMessage(playerid,COLOR_RED,"Ошибка: Вы должны быть как минимум {FFFFFF}45{FF0000}-го уровня, чтобы выбрать это оружие");
				Player[playerid][Slot8] = 39; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			}
			if(listitem == 3) {Player[playerid][Slot8] = 18; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			callcmd::mygun(playerid, "");
		}//ло - Метательное

	case DIALOG_MYGUN6:
		{//ло - Винтовки
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) Player[playerid][Slot6] = 0;
			if(listitem == 1) Player[playerid][Slot6] = 33;
			if(listitem == 2) Player[playerid][Slot6] = 34;
			SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			callcmd::mygun(playerid, "");
		}//ло - Винтовки

	case DIALOG_MYGUN7:
		{//ло - Тяжелое оружие
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) {Player[playerid][Slot7] = 0; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 1) {Player[playerid][Slot7] = 35; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 2)
			{
				if (Player[playerid][Level] < 60) return SendClientMessage(playerid,COLOR_RED,"Ошибка: Вы должны быть как минимум {FFFFFF}60{FF0000}-го уровня, чтобы выбрать это оружие");
				Player[playerid][Slot7] = 38; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			}
			if(listitem == 3) {Player[playerid][Slot7] = 36; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			if(listitem == 4) {Player[playerid][Slot7] = 37; SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");}
			callcmd::mygun(playerid, "");
		}//ло - Прочее

	case DIALOG_MYGUN10:
		{//ло - Прочее
		    if(!response) {callcmd::mygun(playerid, ""); return 1;}
			if(listitem == 0) Player[playerid][Slot10] = 0;
			if(listitem == 1) Player[playerid][Slot10] = 46;
			if(listitem == 2) Player[playerid][Slot10] = 42;
			if(listitem == 3) Player[playerid][Slot10] = 41;
			if(listitem == 4) Player[playerid][Slot10] = 43;
			SendClientMessage(playerid, COLOR_YELLOW, "Изменения вступят в силу после респавна.");
			callcmd::mygun(playerid, "");
		}//ло - Прочее

	case DIALOG_STYLE:
		{//стиль драки
			if(response)
			{//респонс
				if(listitem == 0)
				{//обычный
					Player[playerid][Slot9] = 0;SetPlayerFightingStyle (playerid, FIGHT_STYLE_NORMAL);
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}Обычный");
				}//обычный
				if(listitem == 1)
				{//бокс
					Player[playerid][Slot9] = 1;SetPlayerFightingStyle (playerid, FIGHT_STYLE_BOXING);
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}Boxing");
				}//бокс
				if(listitem == 2)
				{//кунгфу
					Player[playerid][Slot9] = 2;SetPlayerFightingStyle (playerid, FIGHT_STYLE_KUNGFU);
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}KungFu");
				}//кунгфу
				if(listitem == 3)
				{//книхед
					Player[playerid][Slot9] = 3;SetPlayerFightingStyle (playerid, FIGHT_STYLE_KNEEHEAD);
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}KneeHead");
				}//книхед
				if(listitem == 4)
				{//грабкик
					Player[playerid][Slot9] = 4;SetPlayerFightingStyle (playerid, FIGHT_STYLE_GRABKICK);
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}GrabKick");
				}//грабкик
				if(listitem == 5)
				{//елбоу
					Player[playerid][Slot9] = 5;SetPlayerFightingStyle (playerid, FIGHT_STYLE_ELBOW);
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}Elbow");
				}//елбоу
				if(listitem == 6)
				{//микс
					Player[playerid][Slot9] = -1;
					SendClientMessage(playerid,COLOR_YELLOW,"Стиль драки изменен на {FFFFFF}MixFight");
				}//микс
			}//респонс
		}//стиль драки

	case DIALOG_BANK:
		{//Банк
			if(response)
			{//респонс
				if(listitem == 0)
				{//На счет
				    if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
					ShowPlayerDialog(playerid, DIALOG_BANKTO, 1, "Банк - Положить на счет", "{FFFFFF}Сколько денег вы хотите положить?", "ОК", "Назад");
				}//На счет
				if(listitem == 1)
				{//Со счета
				    if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
					new String[120];format(String,sizeof(String),"{FFFFFF}У вас на счету {00FF00}%d{FFFFFF}$\nСколько вы хотите снять?",Player[playerid][Bank]);
					ShowPlayerDialog(playerid, DIALOG_BANKFROM, 1, "Банк - Снять со счета", String, "ОК", "Назад");
				}//Со счета
				if(listitem == 2)
				{
					if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
					if (Player[playerid][Member] == 0) return ShowBankDialog(playerid);
					new clanid = Player[playerid][MyClan];
					new String[120];
					format(String,sizeof(String),"{00ff00}На счету клана: {ffffff}%d{00ff00}$",Clan[clanid][ClanBank]);
					ShowPlayerDialog(playerid, DIALOG_GANGBANK, 2, String, "Положить деньги в общак (1 ранг)\nВзять деньги из общака (3 ранг)\n{afafaf}(?) Макс. сумма общака", "Выбрать", "Назад");
				}
				if(listitem == 3)
				{//Как увеличить максимум денег в банке
				    new String[512];
				    strcat(String, "{FFFF00}Максимум денег в банке зависит от стоимости вашего личного дома:{FFFFFF}\n");
				    strcat(String, "   Нет дома - Максимум денег в банке: 50 000 000$\n");
				    strcat(String, "10 000 000$ - Максимум денег в банке: 100 000 000$\n");
				    strcat(String, "20 000 000$ - Максимум денег в банке: 150 000 000$\n");
				    strcat(String, "40 000 000$ - Максимум денег в банке: 250 000 000$\n");
				    strcat(String, "60 000 000$ - Максимум денег в банке: 400 000 000$\n");
				    strcat(String, "80 000 000$ - Максимум денег в банке: 999 999 999$\n");
					ShowPlayerDialog(playerid, 999, 0, "Как увеличить максимум денег в банке", String, "ОК", "");
				}//Как увеличить максимум денег в банке
			}//респонс
		}//Банк

	case DIALOG_BANKTO:
		{//Банк положить тут
			if(response)
			{//респонс
				new entered = strval(inputtext);
				if (entered < 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Введенная сумма некорректна");return 1;}
				if (Player[playerid][Bank] >= MaxBank[playerid]) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Достигнут максимум денег в банке!");
				if (entered > Player[playerid][Cash]){entered = Player[playerid][Cash];}
				new BankFree = MaxBank[playerid] - Player[playerid][Bank];if (BankFree < entered){entered = BankFree;}
				Player[playerid][Bank] += entered;Player[playerid][Cash] -= entered;//SavePlayer(playerid);
				new String[120];format(String,sizeof(String),"Вы успешно положили {FFFFFF}%d{00FF00}$",entered);
				SendClientMessage(playerid,COLOR_GREEN,String);
			}//респонс
			else ShowBankDialog(playerid);
		}//банк положить

	case DIALOG_BANKFROM:
		{//Банк cнять
			if(response)
			{//респонс
				new entered = strval(inputtext);
				if (entered < 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Введенная сумма некорректна");return 1;}
				if (entered > Player[playerid][Bank]){entered = Player[playerid][Bank];}
				Player[playerid][Bank] -= entered;Player[playerid][Cash] += entered;//SavePlayer(playerid);
				new String[120];format(String,sizeof(String),"Вы успешно сняли {FFFFFF}%d{00FF00}$",entered);
				SendClientMessage(playerid,COLOR_GREEN,String);
			}//респонс
			else  ShowBankDialog(playerid);
		}//банк снять
	case DIALOG_GANGBANK:
		{
			if(response)
			{
				if(listitem == 0)
				{//На счет
				    if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
					ShowPlayerDialog(playerid, DIALOG_GANGTO, 1, "Общак банды - Положить на счет", "{FFFFFF}Сколько денег вы хотите положить?", "ОК", "Назад");
				}//На счет
				if(listitem == 1)
				{//Со счета
					if(Player[playerid][Leader] < 3)
					{
					    ShowBankDialog(playerid);
                        SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны иметь 3 ранг в клане, чтобы брать из общака!");
                        return 1;
					}
				    if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
					new String[120];
					new clanid = Player[playerid][MyClan];
					format(String,sizeof(String),"{FFFFFF}На счету клана {00FF00}%d{FFFFFF}$\nСколько вы хотите снять?",Clan[clanid][ClanBank]);
					ShowPlayerDialog(playerid, DIALOG_GANGFROM, 1, "Общак банды - Снять со счета", String, "ОК", "Назад");
				}//Со счета
                if(listitem == 2)
                {
                	new String[512];
				    strcat(String, "{FFFF00}Максимум денег в общаке зависит от от уровня вашего клана:{FFFFFF}\n");
				    strcat(String, "Уровень клана умножается на 500.000 и получается максимальная сумма\n");
				    strcat(String, "То есть минимальный размер общака - 500.000$\n");
				    strcat(String, "Введите /clan чтобы узнать уровень клана\n");
					ShowPlayerDialog(playerid, 999, 0, "Как увеличить максимум денег в банке", String, "ОК", "");
				}
			}
			else ShowBankDialog(playerid);
		}
	case DIALOG_GANGTO:
		{
		if(response)
			{//респонс
			    if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
				new entered = strval(inputtext);
				new clanid = Player[playerid][MyClan];
				if (entered < 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Введенная сумма некорректна");return 1;}
				if (Clan[clanid][ClanBank] >= Clan[clanid][cLevel]*500000) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Достигнут максимум денег в общаке!");
				if (entered > Player[playerid][Cash]){entered = Player[playerid][Cash];}
				new BankFree = Clan[clanid][cLevel]*500000 - Clan[clanid][ClanBank];if (BankFree < entered){entered = BankFree;}
				Clan[clanid][ClanBank] += entered;Player[playerid][Cash] -= entered;SavePlayer(playerid);
				SaveClan(clanid);
				new String[120];format(String,sizeof(String),"Вы успешно положили {FFFFFF}%d{00FF00}$ в общак банды!",entered);
				SendClientMessage(playerid,COLOR_GREEN,String);
				if(entered !=0)
				{
					format(String,sizeof(String),"ОБЩАК: Член банды %s[%d] положил в общак %d$!",PlayerName[playerid], playerid, entered);
					foreach(Player, cid) if (Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1){SendClientMessage(cid, COLOUR_GANG_CHAT, String);}
				}
			}//респонс
			else ShowBankDialog(playerid);
		}
    case DIALOG_GANGFROM:
		{
		if(response)
		    {//респонс
		        if (!IsPlayerInRangeOfPoint(playerid, 5, 1104.7926,1528.5916,4452.4810)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в банке");
				new entered = strval(inputtext);
				new clanid = Player[playerid][MyClan];
				if (entered < 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Введенная сумма некорректна");return 1;}
				if (entered > Clan[clanid][ClanBank]){entered = Clan[clanid][ClanBank];}
				Clan[clanid][ClanBank] -= entered;Player[playerid][Cash] += entered;SavePlayer(playerid);
				SaveClan(clanid);
				new String[120];format(String,sizeof(String),"Вы успешно сняли {FFFFFF}%d{00FF00}$ с общака банды!",entered);
				SendClientMessage(playerid,COLOR_GREEN,String);
				if(entered !=0)
				{
					format(String,sizeof(String),"ОБЩАК: Член банды %s[%d] взял из общака %d$!",PlayerName[playerid], playerid, entered);
					foreach(Player, cid) if (Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1){SendClientMessage(cid, COLOUR_GANG_CHAT, String);}
				}
			}//респонс
      	else ShowBankDialog(playerid);
		}
	case DIALOG_HOUSEMENU:
		{//Дом диалог
			if(response)
			{//респонс
			    if(listitem == 0)
				{
				    if (GetPlayerVirtualWorld(playerid) != 0) return SendClientMessage(playerid, COLOR_RED, "Заходить в дома можно только в общем игровом мире!");
					new i = LastHouseVisited[playerid];
					if (i < 1 || i >= MAX_PROPERTY) return 1;
					if (PlayerToPoint(3.0,playerid, Property[i][pPosEnterX], Property[i][pPosEnterY], Property[i][pPosEnterZ]))
					{
						if(Player[playerid][Home] != i && Property[i][pOpened] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот дом закрыт.");
						new j = Property[i][pInter];
  						SetPlayerPos(playerid, HIntInfo[j][inX],HIntInfo[j][inY],HIntInfo[j][inZ]);
						SetPlayerFacingAngle(playerid, HIntInfo[j][inA]);
						SetPlayerInterior(playerid,HIntInfo[j][binter]);
						SetCameraBehindPlayer(playerid);SetPlayerVirtualWorld(playerid, 1000 + i);
						InPeacefulZone[playerid] = 1;
					}
					return 1;
				}
				if(listitem == 1) callcmd::houseinfo(playerid, "");
				if(listitem == 2) callcmd::buyhouse(playerid, "");
				if(listitem == 3)
				{//продать дом
				    if (Player[playerid][Home] > 0 && Player[playerid][Home] == LastHouseVisited[playerid])
				    {
				        new String[180], myhome = Player[playerid][Home], Nalog = Property[myhome][pPrice] / 100 * 15;
				        format(String, sizeof String, "{FFFFFF}Вы уверены, что хотите продать дом?\n\nЦена дома для покупки: {008D00}%d$\n{FFFFFF}Цена дома для продажи: {E60020}%d$", Property[myhome][pPrice], Property[myhome][pPrice] - Nalog);
						return ShowPlayerDialog(playerid, DIALOG_SELLHOUSE, 0, "Продать дом", String, "{FF0000}ПРОДАТЬ", "Отмена");
				    }
				}//продать дом
				if(listitem == 4)
				{//увеличить цену
					if (Player[playerid][Home] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет дома.");return 1;}
					new myhome = Player[playerid][Home];
					if(strcmp(Property[myhome][pOwner], PlayerName[playerid], true)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш дом");
					ShowPlayerDialog(playerid, DIALOG_HOUSEMENUPRICE, 1, "Повысить цену", "{FFFF00}Интерьер дома меняется в зависимости от его стоимости:{FFFFFF}\n• Менее 20 000 000$\n• 20 000 000$\n• 40 000 000$\n• 60 000 000$\n• 80 000 000$\n• Неперекупаемый дом (/shop)\n\n{FFFF00}На сколько вы хотите повысить цену дома?", "ОК", "Назад");
				}//увеличить цену
				if(listitem == 5)
				{
				    new i = LastHouseVisited[playerid];
					if (i < 1 || i == MAX_PROPERTY) return 1;
					if (PlayerToPoint(3.0,playerid, Property[i][pPosEnterX], Property[i][pPosEnterY], Property[i][pPosEnterZ]))
					{
   						if(strcmp(Property[i][pOwner], PlayerName[playerid], true)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш дом");
						if (Property[i][pOpened] == 0)
						{//Открываем дом
		    				Property[i][pOpened] = 1; SaveProperty(i);
		    				SendClientMessage(playerid, COLOR_CLAN, "Теперь любой желающий может войти в ваш дом!");
						}//Открываем дом
						else
						{//закрываем дом
		    				Property[i][pOpened] = 0; SaveProperty(i);
		    				SendClientMessage(playerid, COLOR_RED, "Теперь только вы можете зайти в ваш дом!");
						}//закрываем дом
					}
					return 1;
				}
				if(listitem == 6)
				{//сделать тут спавн (снаружи)
					if (Player[playerid][Home] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет дома.");return 1;}
					new myhome = Player[playerid][Home];
					if(strcmp(Property[myhome][pOwner], PlayerName[playerid], true)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш дом");
					Player[playerid][Spawn] = 4;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Личный дом (Снаружи)");
				}//сделать тут спавн (снаружи)
				if(listitem == 7)
				{//сделать тут спавн (внутри)
					if (Player[playerid][Home] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет дома.");return 1;}
					new myhome = Player[playerid][Home];
					if(strcmp(Property[myhome][pOwner], PlayerName[playerid], true)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш дом");
					Player[playerid][Spawn] = 6;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Личный дом (Внутри)");
				}//сделать тут спавн (внутри)
				if(listitem == 8)
				{
				    new StringX[512];
				    strcat(StringX, "Опция\tСтоимость\tДоступ\n");
				    strcat(StringX, "Сменить вход (пикап)\t{31B404}1.000.000$\t{afafaf}Навык Дизайнер\n");
				    strcat(StringX, "Сменить иконку на карте\t{31B404}1.000.000$\t{afafaf}Навык Дизайнер\n");
				    ShowPlayerDialog(playerid, DIALOG_HOUSEUPD, 5, "Улучшения для дома:", StringX, "Выбор", "Назад");
					return 1;
				}
			}//респонс
		}//Дом диалог


	case DIALOG_HOUSEMENUPRICE:
		{//цена дома
			if(response)
			{//респонс
				new entered = strval(inputtext);
				if (entered <= 0){SendClientMessage(playerid,COLOR_RED,"Введенная сумма некорректна");return 1;}
				if (entered > Player[playerid][Cash]){entered = Player[playerid][Cash];}
				new myhome = Player[playerid][Home];
				new BankFree = 80000000 - Property[myhome][pPrice];if (BankFree < entered){entered = BankFree;}
				if (entered == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Стоимость дома уже достигла максимума");
				Property[myhome][pPrice] += entered;
				Player[playerid][Cash] -= entered;
				UpdatePropertyInterior(myhome);
				SavePlayer(playerid);
				SaveProperty(myhome);
				new String[120];format(String,sizeof(String),"Новая цена дома: {FFFFFF}%d{00FF00}$",Property[myhome][pPrice]);
				SendClientMessage(playerid,COLOR_GREEN,String);
				if (Property[myhome][pBuyBlock] <= 0)
				{//Дом перекупаемый
					new text3d[MAX_3DTEXT];
					format(text3d, sizeof(text3d), "{00FF00}Дом ({FFFFFF}%d${00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[myhome][pPrice], Property[myhome][pOwner]);
					UpdateDynamic3DTextLabelText(PropertyText3D[myhome], 0xFFFFFFFF, text3d);
				}//Дом перекупаемый
			}//респонс
			else{ShowPlayerDialog(playerid, DIALOG_HOUSEMENU, 2, "{00FF00}Дом", "{007FFF}Войти в дом{FFFFFF}\nИнформация о доме\nКупить дом\nПродать дом\nУвеличить цену дома\nОткрыть / Закрыть дом\nСделать местом респавна (Снаружи дома)\nСделать местом респавна (Внутри дома)\n{ff0000}Улучшения", "ОК", "Отмена");}
		}//цена дома

	case DIALOG_CLANCREATE:
		{//вы хотите создать клан за 500к?
			if(response)
			{//Да
				if (Player[playerid][Cash] < 500000){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет {FFFFFF}500 000{FF0000}$");return 1;}
				new StringX[1024];
				strcat(StringX, "{AFAFAF}Цвет №0\n{FFFF99}Цвет №1\n{FFFF00}Цвет №2\n{FF99FF}Цвет №3\n{FF9999}Цвет №4\n{FFCC00}Цвет №5\n{FF66CC}Цвет №6\n{FF6600}Цвет №7\n{FF00FF}Цвет №8\n{CCFFFF}Цвет №9\n{00A0C1}Цвет №10\n");
				strcat(StringX, "{E5004F}Цвет №11\n{CCFF00}Цвет №12\n{CC66FF}Цвет №13\n{CC3366}Цвет №14\n{CC6600}Цвет №15\n{9999FF}Цвет №16\n{9925FF}Цвет №17\n{99CCCC}Цвет №18\n{99FF66}Цвет №19\n{99FF00}Цвет №20\n");
				strcat(StringX, "{993300}Цвет №21\n{990066}Цвет №22\n{66FFFF}Цвет №23\n{6666FF}Цвет №24\n{EB6100}Цвет №25\n{666633}Цвет №26\n{33FFFF}Цвет №27\n{3399FF}Цвет №28\n{33CC99}Цвет №29\n{33FF66}Цвет №30\n");
				strcat(StringX, "{339900}Цвет №31\n{457EFF}Цвет №32\n{FFCC00}Цвет №33\n{976D3D}Цвет №34\n{FF8800}Цвет №35\n{FF6666}Цвет №36\n{0015FF}Цвет №37\n{DDAA00}Цвет №38\n{FFFFFF}Цвет №39\n{FF8000}Цвет №40");
				ShowPlayerDialog(playerid, DIALOG_CLANCREATECOLOR, 2, "Выберите цвет клана", StringX, "Выбрать", "Отмена");
			}//Да
		}//вы хотите создать клан за 500к?

	case DIALOG_CLANCREATECOLOR:
		{//выбор цвета
			if(response)
			{//Да
				CreateClanColor[playerid] = listitem;
				ShowPlayerDialog(playerid, DIALOG_CLANCREATENAME, 1, "Введите название клана", "{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "Создать", "Отмена");
			}//Да
		}//выбор цвета

	case DIALOG_CLANCREATENAME:
		{//ввод названия клана
			if(response)
			{//респонс
				if(!strlen(inputtext) || strlen(inputtext) < 2 || strlen(inputtext) > 20) return ShowPlayerDialog(playerid, DIALOG_CLANCREATENAME, 1, "Введите название клана", "{FF0000}ОШИБКА: Неверная длина названия..\n\n{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "Создать", "Отмена"); //если длина некорректна

				new AllowName = 1;
			    for (new i; i < strlen(inputtext); i++)
				{//Проверка каждого символа в нике на допустимость
				    if (inputtext[i] >= '0' && inputtext[i] <= '9') continue;
				    if (inputtext[i] >= 'A' && inputtext[i] <= 'Z') continue;
				    if (inputtext[i] >= 'a' && inputtext[i] <= 'z') continue;
                    if (inputtext[i] == '_') continue;
				    AllowName = 0;
				}//Проверка каждого символа в нике на допустимость
				if (!AllowName)  return ShowPlayerDialog(playerid, DIALOG_CLANCREATENAME, 1, "Введите название клана", "{FF0000}ОШИБКА: В названии допускаются только латинские буквы, цифры и символ '_'.\n\n{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "Создать", "Отмена");

				for(new i = 1; i < MAX_CLAN; i++)
				{//все возможные id`ы кланов
					if (Clan[i][cLevel] == 0) continue; //Пропускаем несуществующие кланы
                    if(!strcmp(Clan[i][cName], inputtext, true)) return ShowPlayerDialog(playerid, DIALOG_CLANCREATENAME, 1, "Введите название клана", "{FF0000}ОШИБКА: Клан с таким именем уже существует.\n\n{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "Создать", "Отмена");
				}//все возможные id`ы кланов
				if (Player[playerid][Cash] < 500000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет {FFFFFF}500 000{FF0000}$");
				Player[playerid][Cash] -= 500000;

				new clanid = 0;
				for(new i = 1; i < MAX_CLAN; i++)
				{//--- Находим минимальный незанятый ID для клана
				    if (Clan[i][cLevel] > 0) continue;
				    clanid = i;
					if (clanid > MaxClanID) MaxClanID = clanid;
					break;
				}//--- Находим минимальный незанятый ID для клана
				if (clanid == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: На сервере достигнут лимит кланов. Попробуйте создать клан позднее.");
				
				
				Clan[clanid][cLastDay] = nowday + 7;//Удаление клана через неделю
				
				new stringer[300];
	   	 		mysql_format(connects, stringer, sizeof stringer, "INSERT INTO `clans` (`CID`,`Name`,`Lider`,`Color`,`LastDay`) VALUES ('%d','%s','%s','%d','%d');", clanid, inputtext, PlayerName[playerid],CreateClanColor[playerid],Clan[clanid][cLastDay]);
				mysql_empty(connects, stringer);
				
				//ResetClan
				Clan[clanid][cLevel] = 1;
				strmid(Clan[clanid][cLider], PlayerName[playerid], 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);
				strmid(Clan[clanid][cName], inputtext, 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);
				Clan[clanid][cColor] = CreateClanColor[playerid];
				Clan[clanid][cBase] = 0;
				Clan[clanid][cXP] = 0;
				Clan[clanid][cCWwin] = 0;
				Clan[clanid][cEnemyClan] = 0;
				Clan[clanid][cSlots] = 20;
				Clan[clanid][Imm] = 0;
				Clan[clanid][ChangeLead] = 0;
				Clan[clanid][InfPoints] = 0;
				
				strmid(Clan[clanid][cMessage], "ПУСТО", 0, strlen("ПУСТО"), 25);
                strmid(Clan[clanid][cTag], "Пусто", 0, strlen("Пусто"), 25);
                
				for(new memb=1; memb<MAX_CMEMBERS; memb++)
				{
					strmid(CMember[clanid][memb], "No", 0, strlen("No"), MAX_PLAYER_NAME);
					CRangs[clanid][memb] = 0;
					COnline[clanid][memb] = 0;
				}
				COnline[clanid][0] = 1;

				PlayerColor[playerid] = CreateClanColor[playerid];
				Player[playerid][MyClan] = clanid;
				Player[playerid][Leader] = 100;
				Player[playerid][Member] = -1;
				//SaveClan(clanid);
				SavePlayer(playerid);
				new ChatMes[120];
				format(ChatMes, sizeof(ChatMes), "{008E00}Вы успешно создали клан '{FFFFFF}%s{008E00}'. Чтобы отображался цвет, нужно купить штаб.", inputtext);
				SendClientMessage(playerid,COLOR_GREEN, ChatMes);
				
				new str[140]; format(str, sizeof str, "%d.%d.%d в %d:%d:%d | Создан клан %s [%d] игроком %s [sid:%d]", Day, Month, Year, hour, minute, second,Clan[clanid][cName],clanid,PlayerName[playerid],Player[playerid][SID]);
				WriteLog("ClanLog", str);
			}//респонс
		}//ввод названия клана


	case DIALOG_CLANMENU:
		{//меню клана
			if(response)
			{//респорс
				if(listitem == 0)
				{//информация о клане
				    new clanid = Player[playerid][MyClan];
				    if (clanid == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в клане!");
					else return ShowClanStats(playerid, clanid);
				}//информация о клане
				if(listitem == 1)
				{
				    ShowClanMembers(playerid, Player[playerid][MyClan]);
				}
				if(listitem == 2)
				{//Управление кланом
					ShowClanControlMenu(playerid);
					//if (Player[playerid][Leader] < 2){SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас недостаточно прав.");return 1;}
					//if (Player[playerid][Leader] == 2){ShowPlayerDialog(playerid, DIALOG_CLANMANAGER, 2, "Управление кланом", "Удалить игрока из клана", "Ок", "Отмена");}
					//if (Player[playerid][Leader] >= 100) ShowPlayerDialog(playerid, DIALOG_CLANMANAGER, 2, "Управление кланом", "{FFFFFF}Удалить игрока из клана\nИзменить цвет клана\nИзменить сообщение клана при входе в игру\nПереименовать клан\n{AFAFAF}Объявить об окончании войны\n{FF0000}[Распустить клан]\n/---{008E00} Назначение прав {FFFFFF}---/\nОбычный член клана\nМожет принимать игроков\nМожет принимать и исключать игроков", "Ок", "Отмена");
				}//Управление кланом
				if(listitem == 3)
				{//Отношения с другими кланами
				    new String[1024], String2[140], clanid = Player[playerid][MyClan], enemies = 0; if (clanid == 0) return 1;
				    if (Clan[clanid][cEnemyClan] > 0)
				    {//клан объявил кому-то войну
				        new enemyclan = Clan[clanid][cEnemyClan];
				        format(String, sizeof String, "{FFFFFF}Ваш клан объявил войну клану {FF0000}%s[ID:%d]\n\n", Clan[enemyclan][cName], enemyclan);
				    }//клан объявил кому-то войну
				    else format(String, sizeof String, "{008E00}Ваш клан никому не объявлял войну.\n\n");

				    strcat(String, "{FFFFFF}Следующие кланы объявили войну вашему:\n{FF0000}");
				    for(new i = 1; i <= MaxClanID; i++)
				    {//цикл
				        if (Clan[i][cEnemyClan] == clanid)
				        {//клан i объявлял войну клану игрока
				            format(String2, sizeof String2, "%s[ID:%d]\n", Clan[i][cName], i);
							strcat(String, String2); enemies++;
				        }//клан i объявлял войну клану игрока
				    }//цикл
				    if (enemies == 0) strcat(String, "{008E00}Вашему клану никто не объявлял войну.\n");
				    strcat(String, "\n{FFFF00}Используйте {FFFFFF}/claninfo [ID клана] {FFFF00}чтобы посмотреть информацию о нужном клане.");
				    ShowPlayerDialog(playerid, 999, 0, "Отношения с кланами", String, "ОК", "");
				}//Отношения с другими кланами
				if(listitem == 4)
				{//Покинуть клан
					if (Player[playerid][Leader] == 100){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Лидер не может покинуть клан! Используйте 'Управление кланом' чтобы распустите клан."); return 1;}
					new StringX[120], clanid = Player[playerid][MyClan];
					format(StringX,sizeof(StringX),"{008E00}Вы уверены, что хотите выйти из клана '{FFFFFF}%s{008E00}'",Clan[clanid][cName]);
					ShowPlayerDialog(playerid, DIALOG_CLANEXIT, 0, "Выйти из клана", StringX, "Да", "Отмена");
				}//Покинуть клан
			}//респонс
		}//меню клана

	case DIALOG_CLANEXIT:
		{//выйти из клана
			if(response)
			{//респорс
				new StringX[120], clanid = Player[playerid][MyClan],Free=1;
				format(StringX,sizeof(StringX),"Игрок %s[%d] покинул клан.",PlayerName[playerid],playerid);
				foreach(Player, cid)
				{//цикл
     				if (Player[cid][Member] != 0 && Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1) SendClientMessage(cid,COLOR_GREEN,StringX);
				}//цикл

				for(new memb=1; memb<MAX_CMEMBERS; memb++)
				{
				    if(!strcmp(CMember[clanid][memb], PlayerName[playerid], true))
					{
						strmid(CMember[clanid][memb], "No", 0, strlen("No"), MAX_PLAYER_NAME);
						Free=memb;
						break;
					}
				}

				Player[playerid][Member] = 0;
				Player[playerid][Leader] = 0;
				Player[playerid][MyClan] = 0;
				PlayerColor[playerid] = 0;
				SavePlayer(playerid);
                MysqlSaveMember(clanid,Free,1,"No");
				//SaveClan(clanid);
			}//респонс
		}//выйти из клана

	case DIALOG_TABMENU:
		{//меню игрока таб
			if(response)
			{//респорс
				if (listitem == 0)
				{//статистика игрока
					ShowStats(playerid,ClickedPid[playerid]);
				}//статистика игрока
				if (listitem == 1)
				{//статистика клана игрока
				    new clicked = ClickedPid[playerid], clanid = Player[clicked][MyClan];
					if (clanid == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот игрок не в клане.");
					else return ShowClanStats(playerid, clanid);
				}//статистика клана игрока
				if (listitem == 2) return SendClientMessage(playerid, COLOR_RED, "Для отправки личного сообщения используй /pm [id игрока] [Сообщение]");//отправить PM
				if (listitem == 3)
				{//дать денег
					ShowPlayerDialog(playerid, DIALOG_TABGIVECASH, 1, "Передать деньги", "Введите сумму денег, которую хотите передать.", "Ок", "Отмена");
				}//дать денег
				if (listitem == 4)
				{//вызвать на дуэль (PVP)
				    new clicked = ClickedPid[playerid];
				    if (JoinEvent[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны выйти из соревнований прежде, чем вызывать кого-то на дуэль.");
					if (PrestigeGM[playerid] == 1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны выйти из режима Бога прежде, чем вызывать кого-то на дуэль");
					if (PrestigeGM[clicked] == 1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя вызвать этого игрока на дуэль, так как он находится в режиме Бога.");
					if (Player[playerid][Banned] > 0 || Player[clicked][Banned] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Забаненные игроки не могут участвовать в PvP.");
					if (Logged[clicked] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот игрок не авторизировался.");
				    if (Player[clicked][ConInvitePVP] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок запретил вызывать его на PvP.");
				    if (InEvent[clicked] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот игрок участвует в соревнованиях.");
				    if (LAFK[clicked] > 3) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот игрок сейчас AFK.");
				    if (LSpecID[clicked] > -1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот игрок находится в режиме слежки.");
				    if (Player[clicked][Level] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этот игрок сейчас проходит обучение...");
				    if (PlayerPVP[clicked][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Этого игрока кто-то только что вызывал на дуэль. Пожалуйста, попробуйте позднее..");
				    PlayerPVP[playerid][Invite] = clicked;PlayerPVP[clicked][Invite] = playerid;PlayerPVP[playerid][TimeOut] = 20; PlayerPVP[clicked][TimeOut] = 20;
                    CanStartPVP[playerid] = 0;CanStartPVP[clicked] = 1;
					PlayerPVP[playerid][PlayMap] = PlayerPVP[playerid][Map];PlayerPVP[playerid][PlayWeapon] = PlayerPVP[playerid][Weapon];PlayerPVP[playerid][PlayHealth] = PlayerPVP[playerid][Health];
                    PlayerPVP[clicked][PlayMap] = PlayerPVP[playerid][Map];PlayerPVP[clicked][PlayWeapon] = PlayerPVP[playerid][Weapon];PlayerPVP[clicked][PlayHealth] = PlayerPVP[playerid][Health];
					PlayerPVP[playerid][Status] = 1; JoinEvent[playerid] = EVENT_PVP; PlayerPVP[clicked][Status] = 0;
					
					new String[300], zWeapon[48], zMap[30];	GetWeaponName(PlayerPVP[playerid][Weapon],zWeapon,sizeof(zWeapon));
				    if (PlayerPVP[playerid][PlayWeapon] == 0) zWeapon = "Без оружия";
				    if (PlayerPVP[playerid][PlayMap] == 1) zMap = "Арена";
					if (PlayerPVP[playerid][PlayMap] == 2) zMap = "Под мостом";
					if (PlayerPVP[playerid][PlayMap] == 3) zMap = "Над мостом";
					if (PlayerPVP[playerid][PlayMap] == 4) zMap = "Молния";
					if (PlayerPVP[playerid][PlayMap] == 5) zMap = "Окопы";
					if (PlayerPVP[playerid][PlayMap] == 6) zMap = "Вертолетная площадка";
					if (PlayerPVP[playerid][PlayMap] == 7) zMap = "Две крыши";
					if (PlayerPVP[playerid][PlayMap] == 8) zMap = "Дамба";
					if (PlayerPVP[playerid][PlayMap] == 9) zMap = "Грузовой корабль";
					if (PlayerPVP[playerid][PlayMap] == 10) zMap = "Пирамида";
				    format(String,sizeof(String),"{FF9E27}PVP: {AFAFAF}Вы вызвали игрока %s на дуэль. У него есть 20 секунд на принятие решения.", PlayerName[clicked]);SendClientMessage(playerid,COLOR_RED,String);
				    format(String,sizeof(String),"{FF9E27}PVP: {AFAFAF}Игрок %s вызывает вас на дуэль. Используйте {FF9E27}/pvp{AFAFAF} чтобы принять вызов.", PlayerName[playerid]);SendClientMessage(clicked,COLOR_RED,String);
				    format(String,sizeof(String),"{AFAFAF}Оружие: %s   Карта: %s   Здоровье: %d   Ставка: {ffffff}%d$", zWeapon, zMap, PlayerPVP[playerid][PlayHealth],PlayerPVP[playerid][Stavka]);
				    SendClientMessage(playerid,COLOR_RED,String);
					SendClientMessage(clicked,COLOR_RED,String);
				}//вызвать на дуэль (PVP)
				if (listitem == 5)
				{//пригласить в клан
				    new clickedplayerid = ClickedPid[playerid];
				    if (Player[playerid][Member] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас нет клана! Используйте команду {FFFFFF}/clan {FF0000}чтобы создать его.");
				    if (Player[playerid][Leader] < 4) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Для принятия игроков нужен {ffff00}[4 ранг] {FF0000}в клане! О рангах: /ranginfo");
					if (Player[clickedplayerid][MyClan] != 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок уже состоит в чьем-то клане.");
	 				if (Player[clickedplayerid][Level] < 5 && Player[clickedplayerid][Prestige] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя приглашать в клан игроков ниже 5 уровня.");
					new clicked = ClickedPid[playerid];
					if (Player[clicked][MyClan] == 0)
					{//игрок, на которого кликнули - не в клане
					    new Free = 0, clanid = Player[playerid][MyClan], StringF[140];

					    for(new memb=1; memb<MAX_CMEMBERS; memb++)
						{
				    		if(!strcmp(CMember[clanid][memb], "No", true)) Free++;
						}

						if (Free == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: В клане нет места.");
						if (Logged[clicked] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя пригласить этого игрока в клан, так как он не авторизовался.");
						if (Player[clicked][ConInviteClan] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок запретил приглашать его в клан.");
						if (LAFK[clicked] > 4) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя пригласить этого игрока в клан, так как он AFK.");
						if (InEvent[clicked] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя пригласить этого игрока в клан, так как он сейчас участвует в соревновании.");
 						InviteClan[clicked] = Player[playerid][MyClan];
						SendClientMessage(playerid,COLOR_CLAN,"Приглашение отправлено. Внимание! У игрока 10 секунд на принятие приглашения!");
						format(StringF,sizeof(StringF),"{008E00}Внимание! Игрок {FFFFFF}%s{008E00} приглашает вас в клан '{FFFFFF}%s{008E00}'\nХотите вступить?",PlayerName[playerid],Clan[clanid][cName]);
						ShowPlayerDialog(clicked,DIALOG_CLANENTER,0,"Приглашение в клан",StringF,"Да","Нет");InviteTime[clicked] = 10;
					}//игрок, на которого кликнули - не в клане
				}//пригласить в клан
				if (listitem == 6)
				{//Объявить войну клану игрока
				    new targetid = ClickedPid[playerid], clanid = Player[playerid][MyClan], targetclanid = Player[targetid][MyClan];
				    if (clanid <= 0 || Player[playerid][Leader] < 3) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 3 ранга, чтобы объявлять войну!");
					if (Clan[clanid][cLevel] < 2) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Чтобы объявлять войну ваш клан должен быть как минимум 2-го уровня!");
				    if (targetclanid <= 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок не в клане!");
					if (targetclanid == clanid) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя объявить войну своему клану!");
				    if (Clan[clanid][cEnemyClan] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Объявлять войну можно только одному клану! Заключите перемирие с предыдущим, прежде чем воевать со следующим!");
                    new String[140], String2[140];
					if (Player[playerid][ClanWarTime] > unixtime)
				    {
				        format(String,sizeof(String),"ОШИБКА: Вы сможете объявить войну не раньше, чем через %d минут",(Player[playerid][ClanWarTime]-unixtime)/60 + 1);
				        return SendClientMessage(playerid,COLOR_RED,String);
				    }
					//объявляем войну
					Clan[clanid][cEnemyClan] = targetclanid; SaveClan(clanid);
					format(String, sizeof String, "{008E00}SERVER: Клан {FFFFFF}%s{008E00}[ID:%d] объявил войну клану {FFFFFF}%s{008E00}[ID:%d].", Clan[clanid][cName], clanid, Clan[targetclanid][cName], targetclanid);
					SendClientMessageToAll(-1, String); Player[playerid][ClanWarTime] = unixtime+3600;
					format(String, sizeof String, "Клан %s[ID:%d] объявил войну вашему клану! Вы можете убивать друг друга без потери очков кармы!", Clan[clanid][cName], clanid);
                    format(String2, sizeof String2, "Ваш клан объявил войну клану %s[ID:%d]! Вы можете убивать друг друга без потери очков кармы!", Clan[targetclanid][cName], targetclanid);
					foreach(Player, cid)
					{//цикл
					    if (Player[cid][MyClan] == targetclanid) SendClientMessage(cid, COLOR_RED, String);
					    else if (Player[cid][MyClan] == clanid) SendClientMessage(cid, COLOR_RED, String2);
					}//цикл
				}//Объявить войну клану игрока
				if (listitem == 7)
				{//телепортироваться к игроку (Престиж 5)
				    new String[140], clickedplayerid = ClickedPid[playerid],rtime = PrestigeTPTime[playerid]-unixtime;
					if (rtime > 0) {format(String, sizeof String, "ОШИБКА: Вы не можете телепортироваться к игрокам еще %d секунд!", rtime); return SendClientMessage(playerid, COLOR_RED, String);}
				    if (Player[playerid][Prestige] < 5) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 5-го уровня Престижа!");
				    if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя телепортироваться когда вы участвуете в соревнованиях!");
				    if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя телепортироваться во время выполнения задания или работы!");
				    if (InEvent[clickedplayerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок сейчас участвует в соревнованиях!");
					if (GetPlayerVirtualWorld(clickedplayerid) != 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок не находится в общем игровом мире!");
					if (LSpecID[clickedplayerid] != -1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок находится в режиме слежки!");
					if (GetPlayerInterior(clickedplayerid) != 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этот игрок находится в помещении!");
					if (Player[clickedplayerid][Banned] > 0) return SendClientMessage(playerid, COLOR_RED, "Нельзя телепортироваться к этому игроку так как он забанен!");
					SetPlayerInterior(playerid, 0);  SetPlayerVirtualWorld(playerid, 0); PrestigeTPTime[playerid] = unixtime+180; AdminTPCantKill[playerid] = 20;
					new Float: x, Float: y, Float: z; GetPlayerPos(clickedplayerid, x, y, z);
				    if (GetPlayerState(playerid) == PLAYER_STATE_DRIVER) SetVehiclePos(GetPlayerVehicleID(playerid), x + 1, y, z);
				    else SetPlayerPos(playerid, x + 1, y, z);
				    format(String, sizeof String, "Вы телепортировались к игроку %s[%d] и не можете брать оружие в течение 20 секунд!", PlayerName[clickedplayerid], clickedplayerid); SendClientMessage(playerid, COLOR_YELLOW, String);
				    format(String, sizeof String, "Игрок %s[%d] телепортировался к вам (Престиж 5) и не может атаковать вас в течение 20 секунд!", PlayerName[playerid], playerid); SendClientMessage(clickedplayerid, COLOR_YELLOW, String);
				}//телепортироваться к игроку (Режим Бога, Престиж 5)
			}//респонс
		}//меню игрока таб

	case DIALOG_TABGIVECASH:
		{//передать денег
			if(response)
			{//респонс
				if (Logged[playerid] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны авторизироваться, чтобы использовать эту команду");return 1;}
                if (Player[playerid][Banned] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Забаненные игроки не могут передавать деньги");
				new plid = ClickedPid[playerid]; new money = strval(inputtext);
				new stringD[180];
				if (!IsPlayerConnected(plid)){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Игрока с указанным ID нет в сети"); return 1;}
				if (Logged[plid] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Игрока с указанным ID не авторизировался"); return 1;}
				//if (Player[plid][GiveCashBalance] >= 100000000) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Этому игроку нельзя передавать деньги!");
                if (LastPlayerTuneStatus[plid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя передавать деньги игроку, который находится в автомастерской. Попробуйте позднее.");
				if (money < 1000){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Минимальная сумма перевода: 1000$"); return 1;}
				if (money > Player[playerid][Cash]){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет такой суммы денег"); return 1;}
				//if (money > 100000000 - Player[plid][GiveCashBalance]) money = 100000000 - Player[plid][GiveCashBalance];//Если игрок может получить лишь 20к по балансу - то эта строка правит сумму перевода на 20к
				Player[plid][Cash] += money;
				Player[playerid][Cash] -= money;
				//Player[playerid][GiveCashBalance] -= money; Player[plid][GiveCashBalance] += money;
				format(stringD, sizeof(stringD), "{FFFF00}Игрок %s[%d] передал вам {FFFFFF}%d$ {FFFF00}денег", PlayerName[playerid], playerid, money);
				SendClientMessage(plid,COLOR_YELLOW,stringD);
				format(stringD, sizeof(stringD), "{FFFF00}Вы успешно передали {FFFFFF}%d$ {FFFF00}денег игроку %s[%d]", money, PlayerName[plid], plid);
				SendClientMessage(playerid,COLOR_YELLOW,stringD);
				QuestUpdate(playerid, 15, money);//Обновление квеста Подарите другим игрокам 50 000$

				format(stringD, sizeof stringD, "%d.%d.%d в %d:%d:%d |   CASH: %s[%d] передал %d$ игроку %s[%d]", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, money, PlayerName[plid], plid);
				WriteLog("GlobalLog", stringD);WriteLog("CashOperations", stringD);
			}//респонс
		}//передать денег

	case DIALOG_CLANMANAGER:
		{//управление кланом
			if(response)
			{//респорс
				if (listitem == 0)
				{//Объявить об окончании войны
				    new clanid = Player[playerid][MyClan], targetclan = Clan[clanid][cEnemyClan], String[140];
				    if (targetclan == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не объявляли никому войну.");
				    format(String, sizeof String, "{008E00}Клан {FFFFFF}%s{008E00}[ID:%d] объявил о нежелании продолжать войну с кланом {FFFFFF}%s{008E00}[ID:%d].", Clan[clanid][cName], clanid, Clan[targetclan][cName], targetclan);
				    Clan[clanid][cEnemyClan] = 0; SaveClan(clanid); return SendClientMessageToAll(-1, String);
				}//Объявить об окончании войны
				if (listitem == 1)
				{//сообщение клана
				    ShowPlayerDialog(playerid, DIALOG_CLANMESSAGE, 1, "Сообщение клана", "{008E00}Введите сообщение, которое будет отображаться игрокам при входе на сервер.\nВведите '{FF0000}ПУСТО{008E00}'(большими буквами), чтобы убрать сообщение.", "ОК", "Отмена");
				}//сообщение клана
				if (listitem == 2)
				{//удалить из клана
					ClanFunks[playerid] = -1;
//					ShowPlayerDialog(playerid, DIALOG_CLANENTERNAME, 1, "Исключение из клана", "{FFFFFF}Введите никнейм игрока, которого вы хотите исключить из клана", "Ок", "Отмена");
                    new StringX[800], clanid = Player[playerid][MyClan], member[36];
                    for(new memb=1; memb<MAX_CMEMBERS; memb++)
					{
					    if(!strcmp(CMember[clanid][memb], "No", false))	format(member, sizeof member, "{afafaf}%d) НЕТ\n", memb);
						else format(member, sizeof member, "%d) %s\n", memb, CMember[clanid][memb]);
					    strcat(StringX, member);
					}
					ShowPlayerDialog(playerid, DIALOG_CLANENTERNAME, 2, "{ffff00}Исключить из клана:", StringX, "Выбрать", "Отмена");
				}//удалить из клана
				
				if (listitem == 3)
				{
					if(Clan[Player[playerid][MyClan]][cLevel] < 20)
					{
					    SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Установка тега доступна с 20 уровня клана.");
					    ShowClanControlMenu(playerid);
						return 1;
					}
                    else ShowPlayerDialog(playerid, DIALOG_CLANTAG, 2, "Установка тега:", "Установить тег для клана\n{ff0000}Удалить тег клана", "Ок", "Отмена");
				}
				if (listitem == 4)
				{//смена цвета
					new StringX[1024];
					strcat(StringX, "{AFAFAF}Цвет №0\n{FFFF99}Цвет №1\n{FFFF00}Цвет №2\n{FF99FF}Цвет №3\n{FF9999}Цвет №4\n{FFCC00}Цвет №5\n{FF66CC}Цвет №6\n{FF6600}Цвет №7\n{FF00FF}Цвет №8\n{CCFFFF}Цвет №9\n{00A0C1}Цвет №10\n");
					strcat(StringX, "{E5004F}Цвет №11\n{CCFF00}Цвет №12\n{CC66FF}Цвет №13\n{CC3366}Цвет №14\n{CC6600}Цвет №15\n{9999FF}Цвет №16\n{9925FF}Цвет №17\n{99CCCC}Цвет №18\n{99FF66}Цвет №19\n{99FF00}Цвет №20\n");
					strcat(StringX, "{993300}Цвет №21\n{990066}Цвет №22\n{66FFFF}Цвет №23\n{6666FF}Цвет №24\n{EB6100}Цвет №25\n{666633}Цвет №26\n{33FFFF}Цвет №27\n{3399FF}Цвет №28\n{33CC99}Цвет №29\n{33FF66}Цвет №30\n");
					strcat(StringX, "{339900}Цвет №31\n{457EFF}Цвет №32\n{FFCC00}Цвет №33\n{976D3D}Цвет №34\n{FF8800}Цвет №35\n{FF6666}Цвет №36\n{0015FF}Цвет №37\n{DDAA00}Цвет №38\n{FFFFFF}Цвет №39\n{FF8000}Цвет №40");
					ShowPlayerDialog(playerid, DIALOG_CLANCOLOR, 2, "Выберите цвет клана", StringX, "Выбрать", "Отмена");
				}//смена цвета
				
				if (listitem == 5)
				{//Переименовать клан
				    ShowPlayerDialog(playerid, DIALOG_CLANRENAME, 1, "Введите название клана", "{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "ОК", "Отмена");
				}//Переименовать клан
				
				if (listitem == 6)
				{
				    ClanFunks[playerid] = 0;
					new StringX[650], clanid = Player[playerid][MyClan], member[36];
                    for(new memb=1; memb<MAX_CMEMBERS; memb++)
					{
					    if(!strcmp(CMember[clanid][memb], "No", false))	format(member, sizeof member, "{afafaf}%d) НЕТ\n", memb);
						else format(member, sizeof member, "%d) %s\n", memb, CMember[clanid][memb]);
					    strcat(StringX, member);
					}
					ShowPlayerDialog(playerid, DIALOG_CLANENTERNAME, 2, "{ffff00}Выберите игрока клана:", StringX, "Выбрать", "Отмена");
				}
				
				if (listitem == 7)
				{//распустить клан
					ShowPlayerDialog(playerid, DIALOG_CLANDESTROY, 0, "{FF0000}Распустить клан", "Вы уверены, что хотите {FF0000}распустить клан?\n{ff0000}Перед удалением нужно забрать все деньги с общака!", "Да", "Отмена");
				}//распустить клан
				if (listitem == 8)
				{//изменить лидера
				    if (Player[playerid][Banned] == 1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Забаненному нельзя менять лидера!");
				    new StringX[650], clanid = Player[playerid][MyClan], member[36];
				    if (Clan[clanid][ChangeLead] > nowday)
				    {
				        new Strr[140], rtime = Clan[clanid][ChangeLead] - nowday;
				        format(Strr, sizeof Strr, "Смена лидера будет доступна через: %d дней.", rtime);
				        SendClientMessage(playerid,COLOR_RED,Strr);
				        return 1;
					}
				    ClanFunks[playerid] = 1;
					
                    for(new memb=1; memb<MAX_CMEMBERS; memb++)
					{
					    if(!strcmp(CMember[clanid][memb], "No", false))	format(member, sizeof member, "{afafaf}%d) НЕТ\n", memb);
						else format(member, sizeof member, "%d) %s\n", memb, CMember[clanid][memb]);
					    strcat(StringX, member);
					}
					ShowPlayerDialog(playerid, DIALOG_CLANENTERNAME, 2, "{ffff00}Выберите нового лидера клана:", StringX, "Выбрать", "Отмена");
				}
			}//респонс
		}//управление кланом

	case DIALOG_CLANENTERNAME:
		{//введите имя
			if(response)
			{//респонс
			    //if (strlen(inputtext) < 3 || strlen(inputtext) > 24) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Неверная длина никнейма");
				new clanid = Player[playerid][MyClan],PlayerOnline = 0;
				new member = listitem+1;

				if(!strcmp(CMember[clanid][member], "No", true))
				{
				    SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Выбран пустой слот!");
					return 1;
				}

			 	if (ClanFunks[playerid] == -1)
				{//исключение из клана
					new str[140];
					format(str, sizeof(str), "Игрок {ffffff}%s{ffff00} был удален из клана.", CMember[clanid][member]);
					SendClientMessage(playerid,COLOR_YELLOW, str);
					ShowClanControlMenu(playerid);
					
					foreach(Player, cid)
					{//цикл
						if (Player[cid][MyClan] == Player[playerid][MyClan] && !strcmp(CMember[clanid][member], PlayerName[cid], true))
						{//исключаемый игрок онлайн
							Player[cid][Member] = 0;
							Player[cid][Leader] = 0;
							Player[cid][MyClan] = 0;
							PlayerColor[cid] = 0;
							SendClientMessage(cid,COLOR_RED,"Вас исключили из клана");
							SavePlayer(cid);
							PlayerOnline = 1;
							break;
						}//исключаемый игрок онлайн
	  				}//цикл
	  				if(PlayerOnline == 0)
	  				{
	  				    new query[120];
						mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `MyClan` = '0',`Leader` = '0',`Member` = '0' WHERE `PName` = '%s'",CMember[clanid][member]);
						if (ServConf[1] == 0) mysql_empty(connects, query);
					}
					strmid(CMember[clanid][member], "No", 0, strlen("No"), MAX_PLAYER_NAME);
					CRangs[clanid][member] = 1;
					//SaveClan(clanid);
					MysqlSaveMember(clanid,member,1,"No");
				}//исключение из клана

				if (ClanFunks[playerid] == 0)
				{
				    SetPVarInt(playerid, "CLRang", member);
				    new str[128];
				    format(str, sizeof(str), "Ранг для игрока {ffff00}%s:", CMember[clanid][member]);
				    ShowPlayerDialog(playerid, DIALOG_CLANRANG, 2, str, "{ffff00}[1 ранг] {afafaf}(обычный член клана)\n{ffff00}[2 ранг]\n{ffff00}[3 ранг]\n{ffff00}[4 ранг]\n{ffff00}[5 ранг]\n{ff0000}Информация о рангах (/ranginfo)", "Выбрать", "Отмена");
				}
				
				if (ClanFunks[playerid] == 1)
				{
				    new str[140];
					format(str, sizeof(str), "Игрок {ffffff}%s{ffff00} был назначен лидером клана.", CMember[clanid][member]);
					foreach(Player, i){if(Player[i][MyClan] == Player[playerid][MyClan]){SendClientMessage(i,COLOR_YELLOW, str);}}
					
                    Player[playerid][Leader] = 5;
                    Player[playerid][Member] = member;
                    SavePlayer(playerid);

                    if(Clan[clanid][Imm] < 1) Clan[clanid][ChangeLead] = nowday+14;
                    else if(Clan[clanid][Imm] == 1) Clan[clanid][ChangeLead] = nowday+7;
                    
					foreach(Player, cid)
					{//цикл
						if (Player[cid][MyClan] == Player[playerid][MyClan] && !strcmp(CMember[clanid][member], PlayerName[cid], true) && Logged[cid] == 1)
						{//исключаемый игрок онлайн
							Player[cid][Leader] = 100;
							Player[cid][Member] = -1;
							SendClientMessage(cid,COLOR_RED,"Вас назначили лидером клана");
							SavePlayer(cid);
							COnline[clanid][0] = 1;
							PlayerOnline = 1;
							break;
						}//исключаемый игрок онлайн
	  				}//цикл
	  				
	  				if(PlayerOnline == 0)
	  				{
	  				    COnline[clanid][0] = 0;
	  				    new query[156];
						mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Leader`='100',`Member`='-1' WHERE `PName` = '%s';",CMember[clanid][member]);
						if (ServConf[1] == 0) mysql_empty(connects, query);
					}
					
					COnline[clanid][member] = 1;
					strmid(Clan[clanid][cLider], CMember[clanid][member], 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);
					strmid(CMember[clanid][member], PlayerName[playerid], 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);
					
					CRangs[clanid][member] = 5;
					MysqlSaveMember(clanid,member,5,PlayerName[playerid]);
					SaveClan(clanid);
				}

			}//респонс
		}//введите имя

	case DIALOG_CLANCOLOR:
		{//выбор цвета
			if(response)
			{//Да
			    PlayerColor[playerid] = listitem;
				foreach(Player, cid)
				{//цикл
					if (Player[cid][Member] != 0 && Player[cid][MyClan] == Player[playerid][MyClan])
					{
						SendClientMessage(cid, ClanColor[listitem], "Цвет клана был изменен.");
						PlayerColor[cid] = PlayerColor[playerid];
					}
				}//цикл
				new clanid = Player[playerid][MyClan];
				Clan[clanid][cColor] = listitem;
				SaveClan(clanid);
				//меняем цвет терры
				if(Clan[Player[playerid][MyClan]][ClanZones] >0)
				{
					for (new Zone=1; Zone<MAX_GZONE;Zone++)
					{
	  					if(GangZones[Zone][GZOwner] == Player[playerid][MyClan]) {GangZones[Zone][GZColor] = listitem; GangZoneHideForAll(ClanZoneID[Zone]); ClanZoneShowForFree(ClanZoneID[Zone],ClanZoneColor[listitem],0,0); SaveZone(Zone);}
					}
				}
			}//Да
			return 1;
		}//выбор цвета

	case DIALOG_CLANDESTROY:
		{//распустить клан
			if(response)
			{//Да
				new StringX[120], clanid = Player[playerid][MyClan], bbase = Clan[clanid][cBase];
				format(StringX,sizeof(StringX),"Клан '{FFFFFF}%s{008E00}' был распущен лидером {ffffff}%s{008E00}.",Clan[clanid][cName],PlayerName[playerid]);
				SendClientMessageToAll(COLOR_CLAN,StringX);
				if (bbase > 0 && bbase < MAX_BASE)
				{//у клана есть штаб
				    Base[bbase][bPrice] -= Base[bbase][bPrice] / 100 * 15;//При продаже штаба взывмается налог 15% от его стоимости
					Player[playerid][Cash] += Base[bbase][bPrice];
					new String[80], text3d[MAX_3DTEXT];
					format(String,sizeof(String),"{008E00}Вы успешно продали свой штаб за {FFFFFF}%d{008E00}$",Base[bbase][bPrice]);
					SendClientMessage(playerid,COLOR_GREEN,String);
				    Base[bbase][bClan] = 0; Base[bbase][bPrice] = 10000000; SaveBase(bbase);
					format(text3d, sizeof(text3d), "{007FFF}Штаб ({FFFFFF}%d${007FFF})\n{008E00}Клан:{FFFFFF} Никто\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Base[bbase][bPrice]);
					UpdateDynamic3DTextLabelText(BaseText3D[bbase], 0xFFFFFFFF, text3d);
				}//у клана есть штаб
				format(StringX, sizeof(StringX), "DELETE FROM `clans` WHERE `CID`='%d';", clanid);
				if (ServConf[1] == 0) mysql_tquery(connects, StringX);
				
				Clan[clanid][cLevel] = 0;//Чтобы клан был недействителеьным
				foreach(Player, cid)
				{//цикл
					if (Player[cid][Member] != 0 && Player[cid][MyClan] == clanid && Logged[cid] == 1)
					{//соклан
						Player[cid][MyClan] = 0;
						Player[cid][Member] = 0;
						Player[cid][Leader] = 0;
						PlayerColor[cid] = 0;
						SavePlayer(cid);
					}//соклан
				}//цикл

				for(new i = 0; i < MaxClanID; i++) if (Clan[i][cEnemyClan] == clanid) {Clan[i][cEnemyClan] = 0; SaveClan(i);}
				
                new str[140]; format(str, sizeof str, "%d.%d.%d в %d:%d:%d | Клан %s [%d] распущен лидером %s [sid:%d]", Day, Month, Year, hour, minute, second,Clan[clanid][cName],clanid,PlayerName[playerid],Player[playerid][SID]);
				WriteLog("ClanLog", str);
			}//да
		}//распустить клан
    case DIALOG_CLANRANG:
    {
        if(response)
		{
        	if(listitem == 5)
        	{
        	    callcmd::ranginfo(playerid, "");
				return 1;
        	}
        	new clanid = Player[playerid][MyClan],PlayerOnline = 0,rang=listitem+1,RangPlayer = GetPVarInt(playerid,"CLRang");
    		foreach(Player, cid)
			{//цикл
				if (Player[cid][MyClan] == Player[playerid][MyClan] && !strcmp(CMember[clanid][RangPlayer], PlayerName[cid], true) && Logged[cid] == 1)
				{//игрок онлайн
					Player[cid][Leader] = rang;

					new str[140];
					format(str, sizeof(str), "Вам был присвоен {ffff00}[%d ранг]{ffffff} в клане! О рангах: {ffff00}/ranginfo.", rang);
					SendClientMessage(cid,COLOR_WHITE,str);
					SavePlayer(cid);
					PlayerOnline = 1;
					break;
				}//игрок онлайн
   			}//цикл
        	if(PlayerOnline == 0)
	  		{
                new query[100];
				mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Leader`='%d' WHERE `PName`='%s';",rang,CMember[clanid][RangPlayer]);
				if (ServConf[1] == 0) mysql_empty(connects, query);
			}
			CRangs[clanid][RangPlayer] = rang;
			
			new query[100];
    		mysql_format(connects,query, sizeof(query), "UPDATE `clans` SET `r%d`='%d' WHERE `CID`='%d';",RangPlayer,rang,clanid);
			if (ServConf[1] == 0) mysql_tquery(connects, query);
			
			SendClientMessage(playerid,COLOR_YELLOW,"Вы успешно изменили статус игроку.");
    	}
    	else ShowClanControlMenu(playerid);
    	DeletePVar(playerid, "CLRang");
	}
	case DIALOG_BASEMENU:
		{//Штаб диалог
			if(response)
			{//респонс
			    if (listitem == 0)
			    {//Войти в штаб
		        	if (GetPlayerVirtualWorld(playerid) != 0) return SendClientMessage(playerid, COLOR_RED, "Заходить в штабы можно только в общем игровом мире!");
                    new i = LastBaseVisited[playerid];
				    if (i < 1 || i >= MAX_BASE) return 1;
					if (PlayerToPoint(3.0,playerid, Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ]))
					{
						new cint = Base[i][bInterior];
						SetPlayerInterior(playerid,BIntInfo[cint][binter]);
						SetPlayerPos(playerid,BIntInfo[cint][inX], BIntInfo[cint][inY], BIntInfo[cint][inZ]); SetPlayerFacingAngle(playerid,BIntInfo[cint][inA]);
						SetPlayerVirtualWorld(playerid, 2000 + i); SetCameraBehindPlayer(playerid);//мир штаба
                        InPeacefulZone[playerid] = 1;
					}
			    }//Войти в штаб
				if (listitem == 1) callcmd::baseinfo(playerid, "");
				if (listitem == 2) callcmd::buybase(playerid, "");
				if (listitem == 3)
				{//продать штаб
				    new baseid = LastBaseVisited[playerid];
				    if (baseid < 1 || baseid == MAX_BASE) return 1;
				    new String[180], Nalog = Base[baseid][bPrice] / 100 * 15;
				    format(String, sizeof String, "{FFFFFF}Вы уверены, что хотите продать штаб?\n\nЦена штаба для покупки: {008D00}%d$\n{FFFFFF}Цена штаба для продажи: {E60020}%d$", Base[baseid][bPrice], Base[baseid][bPrice] - Nalog);
				    return ShowPlayerDialog(playerid, DIALOG_SELLBASE, 0, "Продать штаб", String, "{FF0000}ПРОДАТЬ", "Отмена");
				}//продать штаб
				if (listitem == 4)
				{//увеличить цену штаба
				    if (Player[playerid][MyClan] == 0)return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в клане");
	   				new clanid = Player[playerid][MyClan];
                    for(new i = 1; i < MAX_BASE; i++) if(PlayerToPoint(3.0,playerid, Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ]))
					{
					    if (Base[i][bClan] != clanid) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш штаб");
                        return ShowPlayerDialog(playerid, DIALOG_BASEMENUPRICE, 1, "Повысить цену", "{FFFF00}На сколько вы хотите повысить цену штаба?", "ОК", "Назад");
                    }
				}//увеличить цену штаба
				if (listitem == 5)
				{//Спавн снаружи штаба
				    if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане");
					new clanid = Player[playerid][MyClan];
					if(Clan[clanid][cBase] < 1 || Clan[clanid][cBase] > MAX_BASE) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вашего клана нет штаба");
    				Player[playerid][Spawn] = 5;
					SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Штаб клана (Снаружи)");
				}//Спавн снаружи штаба
				if (listitem == 6)
				{//Спавн внутри штаба
				    if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане");
					new clanid = Player[playerid][MyClan];
					if(Clan[clanid][cBase] < 1 || Clan[clanid][cBase] > MAX_BASE) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вашего клана нет штаба");
    				Player[playerid][Spawn] = 8; Player[playerid][SpawnStyle] = 0;
					return SendClientMessage(playerid,COLOR_YELLOW,"Место вашего респавна изменено на {FFFFFF}Штаб клана (Внутри)");
				}//Спавн внутри штаба
				if(listitem == 7)
				{
				    if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане");
					if (Player[playerid][Leader] < 5) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны иметь как минимум 5 ранг в клане.");
					//if (GetPlayerVirtualWorld(playerid) != 0) return 1;
				    new StringX[200], strtitle[50];
				    strcat(StringX, "Опция\tСтоимость\n");
				    strcat(StringX, "Сменить интерьер\t\n");
				    format(strtitle,sizeof(strtitle),"Улучшения базы. Очков влияния: {ffff00}%d", Clan[Player[playerid][MyClan]][InfPoints]);
				    //strcat(StringX, "Сменить вход (пикап)\t{31B404}1.000.000$\t{afafaf}Навык Дизайнер\n");
				    //strcat(StringX, "Сменить иконку на карте\t{31B404}1.000.000$\t{afafaf}Навык Дизайнер\n");
				    ShowPlayerDialog(playerid, DIALOG_BASEUPD, 5, strtitle, StringX, "Выбор", "Назад");
					return 1;
				}
			}//респонс
		}//Штаб диалог

 	case DIALOG_INVISIBLE:
		{//диалог инвиз
			if(response)
			{//респонс
			    if(listitem == 0)
			    {//нет
			        Player[playerid][Invisible] = 0;
			        SendClientMessage(playerid,COLOR_YELLOW,"Невидимость отключена.");
			    }//нет
			    if(listitem == 1)
			    {//на радаре
			        if (Player[playerid][Level] < 70) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны быть как минимум 70-го уровня.");
                   	if (Player[playerid][Karma] <= -400) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Невидимость недоступна из-за низкой кармы.");
					Player[playerid][Invisible] = 1;
					SendClientMessage(playerid,COLOR_YELLOW,"Включена невидимость на радаре.");
			    }//на радаре
			}//респонс
		}//диалог инвиз

	case DIALOG_AIRPORT:
		{//аэропорт
		    if(response)
			{//респонс
			    if (Player[playerid][Banned] != 0) return 1;//Забаненных не пускает
			    if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя использовать аэропорт в соревнованиях");//игрок мог вызвать менюшку до старта соревнований, и затем во время соревнований использовать аэропорт
			    if(listitem == 0)
			    {//LS
			        if (IsPlayerInRangeOfPoint(playerid,3,1451.6349,-2287.0703,13.5469)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы итак в Лос Сантосе");
			        if (Player[playerid][Cash] < 50000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вам нужно 50 000$ для покупки билета. Деньги можно приобрести в /shop!");
			        AirportTime[playerid] = 15; AirportID[playerid] = 1;Player[playerid][Cash] -= 50000;
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы будете в Лос Сантосе через 15 секунд.");SetPlayerVirtualWorld(playerid,playerid + 1);
			        SetPlayerInterior(playerid,1);SetPlayerPos(playerid,1.5491, 23.3183, 1199.5938);SetPlayerFacingAngle(playerid,0.0);SetCameraBehindPlayer(playerid);
			    }//LS
			    if(listitem == 1)
			    {//SF
			        if (IsPlayerInRangeOfPoint(playerid,3,-1404.6575,-303.7458,14.1484)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы итак в Сан Фиерро");
                    if (Player[playerid][Cash] < 50000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вам нужно 50 000$ для покупки билета. Деньги можно приобрести в /shop!");
			        AirportTime[playerid] = 15; AirportID[playerid] = 2;Player[playerid][Cash] -= 50000;
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы будете в Сан Фиерро через 15 секунд.");SetPlayerVirtualWorld(playerid,playerid + 1);
			        SetPlayerInterior(playerid,1);SetPlayerPos(playerid,1.5491, 23.3183, 1199.5938);SetPlayerFacingAngle(playerid,0.0);SetCameraBehindPlayer(playerid);
			    }//SF
			    if(listitem == 2)
			    {//LV
			        if (IsPlayerInRangeOfPoint(playerid,3,1672.9861,1447.9349,10.7868)) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы итак в Лас Вентурасе");
                    if (Player[playerid][Cash] < 50000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вам нужно 50 000$ для покупки билета. Деньги можно приобрести в /shop!");
			        AirportTime[playerid] = 15; AirportID[playerid] = 3;Player[playerid][Cash] -= 50000;
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы будете в Лас Вентурасе через 15 секунд.");SetPlayerVirtualWorld(playerid,playerid + 1);
			        SetPlayerInterior(playerid,1);SetPlayerPos(playerid,1.5491, 23.3183, 1199.5938);SetPlayerFacingAngle(playerid,0.0);SetCameraBehindPlayer(playerid);
			    }//LV
			}//респонс
		}//аэропорт

		case DIALOG_STEALCAR:
		{//StealCar
		    if (!IsPlayerInAnyVehicle(playerid) && response) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в транспорте!");
			else QuestCar[playerid] = GetPlayerVehicleID(playerid);

		    if (listitem == 0 || !response)
			{
				SendClientMessage(playerid, COLOR_QUEST, "Вы угнали транспорт! Он исчезнет как только вы покинете его!");
                return SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Нажмите клавишу {FFFFFF}Y{00CCCC} или {FFFFFF}N{00CCCC} если вы передумали и хотите купить этот транспорт.");
			}
		    if (listitem == 1 || listitem == 2)
		    {//Покупка авто
		        if (StealCarModel[playerid] != GetVehicleModel(QuestCar[playerid])) return QuestCar[playerid] = -1;//Игрок попытлася купить авто, сидя уже в другом транспорте
		        new Price = GetVehicleMaxSpeed(QuestCar[playerid]) * 500, modelid = GetVehicleModel(QuestCar[playerid]), xmodel = modelid - 400, String[120];
		        if (Player[playerid][Cash] < Price)
		        {
					format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[xmodel], Price);
			        ShowPlayerDialog(playerid, DIALOG_STEALCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}1{FFFFFF}-го класса\nСделать личным транспортом {007FFF}2{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
					return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас недостаточно денег для покупки этого транспорта!\nНо вы можете обменять рубли в {ffff00}/shop!");
				}
				Player[playerid][Cash] -= Price;
				new col1, col2; GetVehicleColor(QuestCar[playerid], col1, col2);
				if (listitem == 1) {Player[playerid][CarSlot1] = modelid; Player[playerid][CarSlot1Color1] = col1; Player[playerid][CarSlot1Color2] = col2; ResetTuneClass1(playerid);}
				if (listitem == 2) {Player[playerid][CarSlot2] = modelid; Player[playerid][CarSlot2Color1] = col1; Player[playerid][CarSlot2Color2] = col2; ResetTuneClass2(playerid);}
				format(String,sizeof(String),"Ваш новый автомобиль %d-го класса - %s", listitem, PlayerVehicleName[xmodel]); SendClientMessage(playerid,COLOR_YELLOW,String);
				format(String,sizeof(String),"Вы потратили на него %d$", Price); SendClientMessage(playerid,COLOR_YELLOW,String);
                Player[playerid][CarActive] = listitem; PlayerCarID[playerid] = QuestCar[playerid]; QuestCar[playerid] = -1;
		    }//Покупка авто
		    if (listitem == 3) return RemovePlayerFromVehicle(playerid);//Покинуть транспорт
		}//StealCar

		case DIALOG_STEALWATERCAR:
		{//StealWaterCar
		    if (!IsPlayerInAnyVehicle(playerid)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не в транспорте!");
			else QuestCar[playerid] = GetPlayerVehicleID(playerid);

            if (listitem == 0 || !response)
			{
				SendClientMessage(playerid, COLOR_QUEST, "Вы угнали транспорт! Он исчезнет как только вы покинете его!");
                return SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Нажмите клавишу {FFFFFF}Y{00CCCC} или {FFFFFF}N{00CCCC} если вы передумали и хотите купить этот транспорт.");
			}
			if (listitem == 1)
		    {//Покупка авто
		        new Price = GetVehicleMaxSpeed(QuestCar[playerid]) * 500, modelid = GetVehicleModel(QuestCar[playerid]), xmodel = modelid - 400, String[120];
		        if (Player[playerid][Cash] < Price)
		        {
					format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[xmodel], Price);
			        ShowPlayerDialog(playerid, DIALOG_STEALWATERCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}3{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
					return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас недостаточно денег для покупки этого транспорта!\nНо вы можете обменять рубли в {ffff00}/shop!");
				}
				Player[playerid][Cash] -= Price;
				new col1, col2; GetVehicleColor(QuestCar[playerid], col1, col2);
				Player[playerid][CarSlot3] = modelid; Player[playerid][CarSlot3Color1] = col1; Player[playerid][CarSlot3Color2] = col2;
				format(String,sizeof(String),"Ваш новый автомобиль 3-го класса - %s", PlayerVehicleName[xmodel]); SendClientMessage(playerid,COLOR_YELLOW,String);
				format(String,sizeof(String),"Вы потратили на него %d$", Price); SendClientMessage(playerid,COLOR_YELLOW,String);
                Player[playerid][CarActive] = 3; PlayerCarID[playerid] = QuestCar[playerid]; QuestCar[playerid] = -1;
		    }//Покупка авто
		    if (listitem == 2) return RemovePlayerFromVehicle(playerid);//Покинуть транспорт
		}//StealWaterCar

		case DIALOG_STEALAIRCAR:
		{//StealAirCar
		    if (listitem == 0 || !response)
			{
				SendClientMessage(playerid, COLOR_QUEST, "Вы угнали транспорт! Он исчезнет как только вы покинете его!");
                return SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Нажмите клавишу {FFFFFF}Y{00CCCC} или {FFFFFF}N{00CCCC} если вы передумали и хотите купить этот транспорт.");
			}
			else QuestCar[playerid] = GetPlayerVehicleID(playerid);

		    if (listitem == 0 || !response) return SendClientMessage(playerid, COLOR_QUEST, "Вы угнали транспорт! Он исчезнет как только вы покинете его!");
		    if (listitem == 1)
		    {//Покупка авто
		        new Price = GetVehicleMaxSpeed(QuestCar[playerid]) * 2000, modelid = GetVehicleModel(QuestCar[playerid]), xmodel = modelid - 400, String[120];
		        if (Player[playerid][Cash] < Price)
		        {
					format(String,sizeof(String),"{AFAFAF}Транспорт: {FFCC00}%s{AFAFAF} Стоимость: %d$",PlayerVehicleName[xmodel], Price);
			        ShowPlayerDialog(playerid, DIALOG_STEALAIRCAR, 2, String, "{FFCC00}Угнать транспорт{FFFFFF}\nСделать личным транспортом {007FFF}3{FFFFFF}-го класса\n{FF0000}Покинуть транспорт", "Начать", "Отмена");
					return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас недостаточно денег для покупки этого транспорта!\nНо вы можете обменять рубли в {ffff00}/shop!");
				}
				Player[playerid][Cash] -= Price;
				new col1, col2; GetVehicleColor(QuestCar[playerid], col1, col2);
				Player[playerid][CarSlot3] = modelid; Player[playerid][CarSlot3Color1] = col1; Player[playerid][CarSlot3Color2] = col2;
				format(String,sizeof(String),"Ваш новый автомобиль 3-го класса - %s", PlayerVehicleName[xmodel]); SendClientMessage(playerid,COLOR_YELLOW,String);
				format(String,sizeof(String),"Вы потратили на него %d$", Price); SendClientMessage(playerid,COLOR_YELLOW,String);
                Player[playerid][CarActive] = 3; PlayerCarID[playerid] = QuestCar[playerid]; QuestCar[playerid] = -1;
		    }//Покупка авто
		    if (listitem == 2) return RemovePlayerFromVehicle(playerid);//Покинуть транспорт
		}//StealAirCar

		case DIALOG_GGSHOP:
		{//GGSHOP
		    if(response)
			{//response
				if(listitem == 0)//check shop
			    {
			        new tm = gettime();
			        if(Player[playerid][UpdTime]-tm > 0 && Player[playerid][UpdTime] != 0)
			        {
			            new String[120];
			            format(String, sizeof String, "SHOP: Проверка платежа будет доступна через %d сек.", Player[playerid][UpdTime]-tm);
			        	SendClientMessage(playerid,COLOR_YELLOW,String);
			        	return 1;
			        }
			        else
			        {
						UpdatePlayer(playerid);
						Player[playerid][UpdTime] = tm+10;
					}
				}
				
				if(listitem == 1)//где взять GG
			    {
			        new StringX[1024];
			        format(StringX,sizeof(StringX),"{FFFFFF}Виртуальные (игровые) рубли приобретаются за реальные.\n");
			        strcat(StringX, "{FFCC00}Курс на сегодня: {FFFFFF} 1 виртуальный рубль = 1 реальный рубль\n\n");
                    strcat(StringX, "{007FFF}За покупкой нужно перейти по адресу:.");
                    strcat(StringX, "\n{FFFF00}exclusive-dm.com/donate.php{007FFF} или");
                    strcat(StringX, "\n{FFFF00}exclusive-dm.com - {007FFF}Раздел {FFFF00}'Донат'");
                    strcat(StringX, "\n\n{01DF74}Постоянные бонусы при покупке:\n");
                    strcat(StringX, " {FFffff}от 300 руб - бонус {ff0000}10 процентов {ffffff}");
                    strcat(StringX, "\n от 700 руб - бонус {ff0000}20 процентов {ffffff}");
                    strcat(StringX, "\n от 1500 руб - бонус {ff0000}30 процентов {ffffff}");
                    strcat(StringX, "\n от 2000 руб - бонус {ff0000}50 процентов");
			        ShowPlayerDialog(playerid, 666, 0, "Получить рубли", StringX, "ОК", "");
			        return 1;
				}
				
			    if(listitem == 2)//Повысить уровень ViP
			    {
			        if (Player[playerid][GameGold] < 150) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 150 рублей");
			        if (Player[playerid][GPremium] == 20) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас максимальный уровень ViP");
			        Player[playerid][GameGold] -= 150.0; Player[playerid][GPremium] += 1;
					if (Player[playerid][GPremium] == 19) Player[playerid][Prestige] += 1;//Разовое повышение престижа на ViP 19
					SendClientMessage(playerid,COLOR_YELLOW,"Вы повысили ваш уровень ViP за 150 рублей. Введите /vip, чтобы узнать ваши привелегии.");
                    new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] повысил свой уровень ViP за 150 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("GlobalLog", String);WriteLog("Shop", String);SavePlayer(playerid);
				}
			    if(listitem == 3)//LevelUp
			    {
			        if (Player[playerid][Level] >= 100 && Player[playerid][Prestige] < 10) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы уже достигли максимального уровня! Перейдите на Престиж (/prestige).");
                    if (Player[playerid][Level] < 30)
					{
						if (Player[playerid][GameGold] < 10) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 10 рублей");
	       	  	    	Player[playerid][GameGold] -= 10.0; Player[playerid][Exp] += NeedXP[playerid]; PlayerLevelUp(playerid);
			        	SendClientMessage(playerid,COLOR_YELLOW,"Вы повысили свой уровень за 10 рублей");
			        	new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] повысил свой уровень за 10 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
						WriteLog("GlobalLog", String);WriteLog("Shop", String);
					}
					else if (Player[playerid][Level] < 60)
					{
						if (Player[playerid][GameGold] < 15) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 15 рублей");
	       	  	    	Player[playerid][GameGold] -= 15.0; Player[playerid][Exp] += NeedXP[playerid]; PlayerLevelUp(playerid);
			        	SendClientMessage(playerid,COLOR_YELLOW,"Вы повысили свой уровень за 15 рублей");
			        	new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] повысил свой уровень за 15 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
						WriteLog("GlobalLog", String);WriteLog("Shop", String);
					}
					else
					{
                        if (Player[playerid][GameGold] < 20) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 20 рублей");
	       	  	    	Player[playerid][GameGold] -= 20.0; Player[playerid][Exp] += NeedXP[playerid]; PlayerLevelUp(playerid);
			        	SendClientMessage(playerid,COLOR_YELLOW,"Вы повысили свой уровень за 20 рублей");
			        	new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] повысил свой уровень за 20 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
						WriteLog("GlobalLog", String);WriteLog("Shop", String);
					}
				}
			    if(listitem == 4)//1 000 000$ (15GG)
			    {
			        if (Player[playerid][GameGold] < 15) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 15 рублей");
			        Player[playerid][GameGold] -= 15.0;Player[playerid][Cash] += 1000000; SavePlayer(playerid);
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы купили 1 000 000$ за 15 рублей");
			        new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] приобрел 1 000 000$ за 15 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("GlobalLog", String);WriteLog("Shop", String);
				}
			    if(listitem == 5)//+50 к карме (10GG)
			    {
			        if (Player[playerid][Karma] >= 1000) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас максимум кармы!");
			        if (Player[playerid][GameGold] < 10) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 10 рублей");
			        Player[playerid][GameGold] -= 10.0;Player[playerid][Karma] += 50;
			        if (Player[playerid][Karma] > 1000) Player[playerid][Karma] = 1000;
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы купили 50 очков кармы за 10 рублей");
			        new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] купил 50 очков кармы за 10 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("GlobalLog", String);WriteLog("Shop", String);SavePlayer(playerid);
				}
				if(listitem == 6)//Изменить игровой ник
			    {
			        if (Player[playerid][GameGold] < 100) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 100 рублей");
			        return ShowPlayerDialog(playerid, DIALOG_CHANGENICK, 1, "Смена ника", "{FF0000}Вы уверены, что хотите сменить ник?\n{FFFFFF}Для продолжения введите ваш текущий пароль:","ОК","Назад");
			    }
			    if(listitem == 7)//Разбан (50GG, 100GG или 250GG)
			    {
			        if (Player[playerid][Banned] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не забанены.");
			        if (Player[playerid][Banned] == 2) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вам запрещено покупать разбан!");
                    if (Player[playerid][Level] < 30 && Player[playerid][Prestige] == 0)
					{
						if (Player[playerid][GameGold] < 50) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 50 рублей");
				        Player[playerid][GameGold] -= 50.0;Player[playerid][Banned] = 0; strmid(BannedBy[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5); strmid(BanReason[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5);
						SavePlayer(playerid);LSpawnPlayer(playerid);
				        new String[120];
						format(String,sizeof(String),"{AFAFAF}SERVER: %s[%d] купил разбан за 50 рублей",PlayerName[playerid],playerid);
				        PlayerWeather[playerid] = -1;SendClientMessageToAll(COLOR_YELLOW,String);
				        format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] приобрел разбан за 50 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
						WriteLog("GlobalLog", String);WriteLog("Shop", String);
			        }
					else if (Player[playerid][Level] < 60 && Player[playerid][Prestige] == 0)
					{
						if (Player[playerid][GameGold] < 100) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 100 рублей");
				        Player[playerid][GameGold] -= 100.0;Player[playerid][Banned] = 0; strmid(BannedBy[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5); strmid(BanReason[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5);
						SavePlayer(playerid);LSpawnPlayer(playerid);
				        new String[120];
						format(String,sizeof(String),"{AFAFAF}SERVER: %s[%d] купил разбан за 100 рублей",PlayerName[playerid],playerid);
				        PlayerWeather[playerid] = -1;SendClientMessageToAll(COLOR_YELLOW,String);
				        format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] приобрел разбан за 100 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
						WriteLog("GlobalLog", String);WriteLog("Shop", String);
			        }
			        else
			        {
			            if (Player[playerid][GameGold] < 250) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 250 рублей");
				        Player[playerid][GameGold] -= 250.0;Player[playerid][Banned] = 0; strmid(BannedBy[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5); strmid(BanReason[playerid], "ПУСТО", 0, strlen("ПУСТО"), 5);
						SavePlayer(playerid);LSpawnPlayer(playerid);
				        new String[120];
						format(String,sizeof(String),"{AFAFAF}SERVER: %s[%d] купил разбан за 250 рублей",PlayerName[playerid],playerid);
				        PlayerWeather[playerid] = -1;SendClientMessageToAll(COLOR_YELLOW,String);
				        format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] приобрел разбан за 250 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
						WriteLog("GlobalLog", String);WriteLog("Shop", String);
			        }
				}
				if(listitem == 8)//несливайка
			    {
			        if (Player[playerid][GameGold] < 35) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 35 рублей");
			        if (Player[playerid][SlivBlock] != -1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Еще не закончилось действие прошлой опции!");
					//new xDay = DateToIntDate(Day, Month, Year);
					AddACashLost(playerid,7);
			        new String[120];
			        Player[playerid][GameGold] -= 35.0;
			        format(String, sizeof String, "Вы купили 'Несливайку' за 35 рублей до {ffffff}%s", IntDateToStringDate(Player[playerid][SlivBlock]) );
			        SendClientMessage(playerid,COLOR_YELLOW,String);
			        format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] приобрел несливайку за 35 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("GlobalLog", String);WriteLog("Shop", String);
			    }
			    if(listitem == 9)//1 lottery
			    {
					if (ServConf[5] < 1) return 1;
			        if (Player[playerid][GameGold] < 25) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 25 рублей");
			        Player[playerid][GameGold] -= 25.0;Player[playerid][Lottery] += 1; SavePlayer(playerid);
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы купили лотерейный билет за 25 рублей");
			        ServConf[5]--;
			        new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s[%d] приобрел лотерею за 25 рублей", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("GlobalLog", String);WriteLog("Shop", String);
				}
			    if(listitem == 10)
			    {
			        new String[512] = "";
			        strcat(String, "Вы можете выиграть следующие призы:\n\nШанс 2 процента: 1000 золота, 1 престиж, 100 лвл\nШанс 3 процента: 1 ViP, 500 золота\nШанс 5 процентов: 100 золота, 100 рублей\n");
			        strcat(String, "Шанс 10 процентов: 45 рублей, 2 лотерейных билета, 70 золота, 7 дней несливайки\nШанс 20 процентов: 1 лотерейный билет\nШанс 40 процентов: 10-30 руб, 500к-1.5кк денег\n\nИспользовать билет - {ffff00}/lottery");
			        ShowPlayerDialog(playerid, 999, 0, "{ffffff}Что можно выиграть:", String, "ОК", "");
			        return 1;
				}
			    else return ShowShopDialog(playerid);

				
			}//response
		}//GGSHOP

		case DIALOG_SKILLS:
		{//SKILLS
		    if(response)
			{//response
			    if(listitem == 0)//RegenHP
			    {
			        if (Player[playerid][SkillHP] >= 50) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы уже прокачали этот навык до максимума.");
			        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
			        Player[playerid][Cash] -= 1000000;Player[playerid][SkillHP] += 1;
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы успешно повысили уровень навыка <<{FFFFFF}Регенерация HP{FFFF00}>>.");
			        SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Чем выше уровень этого навыка, тем быстрее восстанавливается здоровье.");
			    }
			    if(listitem == 1)//Repair
			    {
			        if (Player[playerid][SkillRepair] >= 30) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы уже прокачали этот навык до максимума.");
			        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
			        Player[playerid][Cash] -= 1000000;Player[playerid][SkillRepair] += 1;
			        SendClientMessage(playerid,COLOR_YELLOW,"Вы успешно повысили уровень навыка <<{FFFFFF}Ремонт транспорта{FFFF00}>>.");
			        SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Чем выше уровень этого навыка, тем чаще ремонтируется транспорт.");
			    }
			    new String[300], StringF[500];
				format(String,sizeof(String),"{FFFFFF}[{FFFF00}%d{FFFFFF}/50] Регенерация HP (1 000 000$)\n[{FFFF00}%d{FFFFFF}/30] Ремонт транспорта (1 000 000$)",Player[playerid][SkillHP], Player[playerid][SkillRepair]);
				strcat(StringF,String);
				ShowPlayerDialog(playerid, DIALOG_SKILLS, 2, "Пассивные навыки", StringF, "ОК", "");
			}//респонс
		}//Skills

		case DIALOG_CLANENTER:
		{//вступить в клан
			if(response)
			{//респоHс
			    new Free = 0, clanid = InviteClan[playerid];
				new mxslots = Clan[clanid][cSlots]+1;

			    for(new memb=1; memb<mxslots; memb++)
				{
				    if(!strcmp(CMember[clanid][memb], "No", true))
					{
						Free = memb;
						strmid(CMember[clanid][memb], PlayerName[playerid], 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);
						break;
					}
				}
			    
				if (Free == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: В клане нет места."); return 1;}
				Player[playerid][MyClan] = InviteClan[playerid];
				Player[playerid][Member] = Free;
				Player[playerid][Leader] = 0;
				SavePlayer(playerid);
				//SaveClan(clanid);
				InviteTime[playerid] = -1;
				new StringC[140], ccolor = Clan[clanid][cColor];
				PlayerColor[playerid] = ccolor;
				format(StringC,sizeof(StringC),"Игрок %s[%d] вступил в клан.",PlayerName[playerid],playerid);
				foreach(Player, cid)
				{//цикл
					if (Player[cid][MyClan] != 0 && Player[cid][MyClan] == Player[playerid][MyClan]) SendClientMessage(cid, ClanColor[ccolor], StringC);
				}
				MysqlSaveMember(clanid,Free,1,PlayerName[playerid]);
				COnline[clanid][Free] = 1;
				return 1;
			}//респонс
			else{InviteTime[playerid] = -1;}//Если игрок отказался это нужно, чтобы ему не вылазало окошна "Вас пригласили в клан, но вы не успели принять приглашение"
		}//вступить в клан

		case DIALOG_CLANMESSAGE:
		{//сообщение клана
			if(response)
			{//респонс
			    if (Player[playerid][Muted] != 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вам запрещено использовать чат.");
			    if (strlen(inputtext) < 3 || strlen(inputtext) > 120) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Длина сообщения должна быть от 3 до 120 символов");
				if (strfind(inputtext, "'", true)!=-1 || strfind(inputtext, "`", true)!=-1 || strfind(inputtext, "=", true)!=-1 || strfind(inputtext, "%", true)!=-1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Сообщение не должно содержать любые кавычки, знак = и т.п.");
				
				new clanid = Player[playerid][MyClan], ccolor = Clan[clanid][cColor];
                new cmss[140];
                
				//strmid(cmss, inputtext, 0, strlen(inputtext), 120);
				mysql_real_escape_string(inputtext,cmss);
                strmid(Clan[clanid][cMessage], cmss, 0, strlen(cmss), 120);
                
                new query[256];
                mysql_format(connects,query, sizeof(query), "UPDATE `clans` SET `Message`='%s' WHERE `CID`='%d';", cmss,clanid);
				if (ServConf[1] == 0) mysql_tquery(connects, query);
				
				if(!strcmp(inputtext, "ПУСТО", true)) return SendClientMessage(playerid,COLOR_YELLOW,"Сообщение клана удалено.");
				else
				{//новое сообщение клана
	 				format(inputtext, 140, "СООБЩЕНИЕ КЛАНА: %s (от %s)", inputtext,PlayerName[playerid]);
					foreach(Player, cid)
					{//цикл
						if (Player[cid][MyClan] != 0 && Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1 ) SendClientMessage(cid, ClanColor[ccolor], inputtext);
					}
				}//новое сообщение клана
			}//респонс
		}//сообщение клана

		case DIALOG_SKILLCHANGE:
		{//Выбор активных навыков
		    if (!response) return ShowPlayerKPK(playerid);
		    if (listitem == 0)
		    {//Изменить скилл персонажа
		        new StringF[600];
		        strcat(StringF, "Нет\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 50 метров (Престиж 1, уровень 10)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 100 метров (Престиж 1, уровень 20)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 200 метров (Престиж 1, уровень 53)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Режим Супермена (Престиж 8, уровень 25)");
	            ShowPlayerDialog(playerid, DIALOG_ACTIVESKILLPERSON, 2, "Навык Персонажа", StringF, "ОК", "Отмена");
		    }//Изменить скилл персонажа
		    else if (listitem == 1)
		    {//Изменить скилл класса 1
		        new StringF[300];
		        strcat(StringF, "Нет\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Разворот на 180 градусов (Уровень 56)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Прыжок (Уровень 61)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Трамплин (Уровень 63)");
				ShowPlayerDialog(playerid, DIALOG_ACTIVESKILLCAR1, 2, "Навык Класса 1 (Клавиша '2')", StringF, "ОК", "Отмена");
		    }//Изменить скилл класса 1
		    else if (listitem == 2)
		    {//Изменить скилл класса 2
		        new StringF[300];
		        strcat(StringF, "Нет\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Разворот на 180 градусов (Уровень 59)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Прыжок (Уровень 62)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Трамплин (Уровень 64)");
				ShowPlayerDialog(playerid, DIALOG_ACTIVESKILLCAR2, 2, "Навык Класса 2 (Клавиша '2')", StringF, "ОК", "Отмена");
		    }//Изменить скилл класса 2
		    else if (listitem == 3)
		    {//Изменить H скилл класса 1
		        new StringF[1024];
		        strcat(StringF, "Нет\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Переворот транспорта на колеса (Уровень 51)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 50 метров (Престиж 1, уровень 35)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 100 метров (Престиж 1, уровень 40)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 200 метров (Престиж 1, уровень 45)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Телепорт на 50 метров cо скоростью (Престиж 1, уровень 55)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Телепорт на 100 метров cо скоростью (Престиж 1, уровень 60)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Телепорт на 200 метров cо скоростью (Престиж 1, уровень 65)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Режим Полета (Престиж 2, уровень 25)\n");
				ShowPlayerDialog(playerid, DIALOG_ACTIVESKILLHCAR1, 2, "Навык Класса 1 (Клавиша 'H')", StringF, "ОК", "Отмена");
		    }//Изменить скилл класса 1
		    else if (listitem == 4)
		    {//Изменить H скилл класса 2
		        new StringF[1024];
		        strcat(StringF, "Нет\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Переворот транспорта на колеса (Уровень 51)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 50 метров (Престиж 1, уровень 35)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 100 метров (Престиж 1, уровень 40)\n");
		        strcat(StringF, "[{FFFF00}500 000${FFFFFF}] Телепорт на 200 метров (Престиж 1, уровень 45)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Телепорт на 50 метров cо скоростью (Престиж 1, уровень 55)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Телепорт на 100 метров cо скоростью (Престиж 1, уровень 60)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Телепорт на 200 метров cо скоростью (Престиж 1, уровень 65)\n");
		        strcat(StringF, "[{FFFF00}1 000 000${FFFFFF}] Режим Полета (Престиж 2, уровень 25)\n");
				ShowPlayerDialog(playerid, DIALOG_ACTIVESKILLHCAR2, 2, "Навык Класса 2 (Клавиша 'H')", StringF, "ОК", "Отмена");
		    }//Изменить скилл класса 2
		    else if (listitem == 5)
		    {//Пассивные навыки
		      	new String[300], StringF[500];
				format(String,sizeof(String),"{FFFFFF}[{FFFF00}%d{FFFFFF}/50] Регенерация HP (1 000 000$)\n[{FFFF00}%d{FFFFFF}/30] Ремонт транспорта (1 000 000$)",Player[playerid][SkillHP], Player[playerid][SkillRepair]);
				strcat(StringF,String);
				ShowPlayerDialog(playerid, DIALOG_SKILLS, 2, "Пассивные навыки", StringF, "ОК", "Отмена");
		    }//Пассивные навыки
		    else if (listitem == 6)
		    {
		        GoldDialog(playerid);
		        return 1;
			}
			else if (listitem == 7)
			{
			    if(Player[playerid][MJAct] == 0){Player[playerid][MJAct] = 1; SendClientMessage(playerid, COLOR_GREY, "Навык мега-прыжок активирован. Нажмите SHIFT, чтобы прыгнуть.");}
				else {Player[playerid][MJAct] = 0; SendClientMessage(playerid, COLOR_GREY, "Навык мега-прыжок деактивирован.");}
			}
		    return 1;
		}//Выбор активных навыков

		case DIALOG_ACTIVESKILLPERSON:
		{//Выбор скилла персонажа
		    if (!response) return 1;
		    if (listitem == Player[playerid][ActiveSkillPerson]) return 1; //Игрок выбрал навык, который итак уже выбран
			if (listitem == 0) {Player[playerid][ActiveSkillPerson] = 0; return 1;}//Убрать навык
			if (listitem == 1)
		    {//тп на 50 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 10) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 10-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillPerson] = listitem;
		        if (OnFly[playerid] == 1) StopFly(playerid);
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык персонажа: {FFFFFF}Телепорт на 50 метров");
		    }//тп на 50 метров
		    if (listitem == 2)
		    {//тп на 100 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 20) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 20-го уровня!");
		        if (Player[playerid][Cash] < 500000) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вам нужно 500 000$ чтобы выбрать этот навык!");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillPerson] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык персонажа: {FFFFFF}Телепорт на 100 метров");
		    }//тп на 100 метров
		    if (listitem == 3)
		    {//тп на 200 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 53) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 53-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillPerson] = listitem;
                if (OnFly[playerid] == 1) StopFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык персонажа: {FFFFFF}Телепорт на 200 метров");
		    }//тп на 200 метров
		    if (listitem == 4)
		    {//Режим Супермена
		        if (Player[playerid][Prestige] < 8) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 8-го уровня Престижа!");
		        if (Player[playerid][Level] < 25) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 25-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillPerson] = listitem;
                if (OnFly[playerid] == 1) StopFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык персонажа: {FFFFFF}Режим Супермена");
		    }//Режим Супермена
		    return 1;
		}//Выбор скилла персонажа

		case DIALOG_ACTIVESKILLCAR1:
		{//Выбор скилла класс 1 (клавиша 2)
		    if (!response) return 1;
		    if (listitem == Player[playerid][ActiveSkillCar1]) return 1; //Игрок выбрал навык, который итак уже выбран
			if (listitem == 0) {Player[playerid][ActiveSkillCar1] = 0; return 1;}//Убрать навык
			if (listitem == 1)
		    {//Разворот на 180 градусов
		        if (Player[playerid][Level] < 56) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 56-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillCar1] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша '2'): {FFFFFF}Разворот на 180 градусов");
		    }//Разворот на 180 градусов
		    if (listitem == 2)
		    {//Прыжок
		        if (Player[playerid][Level] < 61) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 61-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillCar1] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша '2'): {FFFFFF}Прыжок");
		    }//Прыжок
		    if (listitem == 3)
		    {//Трамплин
		        if (Player[playerid][Level] < 63) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 63-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillCar1] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша '2'): {FFFFFF}Трамплин");
		    }//Трамплин
		    return 1;
		}//Выбор скилла класс 1 (клавиша 2)

		case DIALOG_ACTIVESKILLCAR2:
		{//Выбор скилла класс 2 (клавиша 2)
		    if (!response) return 1;
		    if (listitem == Player[playerid][ActiveSkillCar2]) return 1; //Игрок выбрал навык, который итак уже выбран
			if (listitem == 0) {Player[playerid][ActiveSkillCar2] = 0; return 1;}//Убрать навык
			if (listitem == 1)
		    {//Разворот на 180 градусов
		        if (Player[playerid][Level] < 59) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 59-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillCar2] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша '2'): {FFFFFF}Разворот на 180 градусов");
		    }//Разворот на 180 градусов
		    if (listitem == 2)
		    {//Прыжок
		        if (Player[playerid][Level] < 62) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 62-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillCar2] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша '2'): {FFFFFF}Прыжок");
		    }//Прыжок
		    if (listitem == 3)
		    {//Трамплин
		        if (Player[playerid][Level] < 64) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 64-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillCar2] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша '2'): {FFFFFF}Трамплин");
		    }//Трамплин
		    return 1;
		}//Выбор скилла класс 2 (клавиша 2)

		case DIALOG_ACTIVESKILLHCAR1:
		{//Выбор скилла класс 1 (клавиша H)
		    if (!response) return 1;
		    if (listitem == Player[playerid][ActiveSkillHCar1]) return 1; //Игрок выбрал навык, который итак уже выбран
			if (listitem == 0) {Player[playerid][ActiveSkillHCar1] = 0; return 1;}//Убрать навык
			if (listitem == 1)
		    {//Переворот транспорта на колеса
		        if (Player[playerid][Level] < 51) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 51-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar1] = listitem;
				if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Переворот транспорта на колеса");
		    }//Переворот транспорта на колеса
		    if (listitem == 2)
		    {//Телепорт на 50 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 35) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 35-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar1] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Телепорт на 50 метров");
		    }//Телепорт на 50 метров
		    if (listitem == 3)
		    {//Телепорт на 100 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 40) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 40-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar1] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Телепорт на 100 метров");
		    }//Телепорт на 100 метров
		    if (listitem == 4)
		    {//Телепорт на 200 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 45) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 45-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar1] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Телепорт на 200 метров");
		    }//Телепорт на 200 метров
		    if (listitem == 5)
		    {//Телепорт на 50 метров со скоростью
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 55) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 55-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar1] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Телепорт на 50 метров (со скоростью)");
		    }//Телепорт на 50 метров со скоростью
		    if (listitem == 6)
		    {//Телепорт на 100 метров со скоростью
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 60) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 60-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar1] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Телепорт на 100 метров (со скоростью)");
		    }//Телепорт на 100 метров со скоростью
		    if (listitem == 7)
		    {//Телепорт на 200 метров со скоростью
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 65) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 65-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar1] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Телепорт на 200 метров (со скоростью)");
		    }//Телепорт на 200 метров со скоростью
		    if (listitem == 8)
		    {//Режим Полета
		        if (Player[playerid][Prestige] < 2) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 2-го уровня Престижа!");
		        if (Player[playerid][Level] < 25) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 25-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar1] = listitem;
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 1 (Клавиша 'H'): {FFFFFF}Режим Полета");
		    }//Режим Полета
		    return 1;
		}//Выбор скилла класс 1 (клавиша H)

		case DIALOG_ACTIVESKILLHCAR2:
		{//Выбор скилла класс 2 (клавиша H)
		    if (!response) return 1;
		    if (listitem == Player[playerid][ActiveSkillHCar2]) return 1; //Игрок выбрал навык, который итак уже выбран
			if (listitem == 0) {Player[playerid][ActiveSkillHCar2] = 0; return 1;}//Убрать навык
			if (listitem == 1)
		    {//Переворот транспорта на колеса
		        if (Player[playerid][Level] < 51) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 51-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Переворот транспорта на колеса");
		    }//Переворот транспорта на колеса
		    if (listitem == 2)
		    {//Телепорт на 50 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 35) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 35-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Телепорт на 50 метров");
		    }//Телепорт на 50 метров
		    if (listitem == 3)
		    {//Телепорт на 100 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 40) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 40-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Телепорт на 100 метров");
		    }//Телепорт на 100 метров
		    if (listitem == 4)
		    {//Телепорт на 200 метров
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 45) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 45-го уровня!");
		        if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
		        Player[playerid][Cash] -= 500000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Телепорт на 200 метров");
		    }//Телепорт на 200 метров
		    if (listitem == 5)
		    {//Телепорт на 50 метров со скоростью
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 55) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 55-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Телепорт на 50 метров (со скоростью)");
		    }//Телепорт на 50 метров со скоростью
		    if (listitem == 6)
		    {//Телепорт на 100 метров со скоростью
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 60) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 60-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Телепорт на 100 метров (со скоростью)");
		    }//Телепорт на 100 метров со скоростью
		    if (listitem == 7)
		    {//Телепорт на 200 метров со скоростью
		        if (Player[playerid][Prestige] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 1-го уровня Престижа!");
		        if (Player[playerid][Level] < 65) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 65-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar2] = listitem;
                if (OnVehFly[playerid] == 1) StopVehFly(playerid);
				return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Телепорт на 200 метров (со скоростью)");
		    }//Телепорт на 200 метров со скоростью
		    if (listitem == 8)
		    {//Режим Полета
		        if (Player[playerid][Prestige] < 2) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 2-го уровня Престижа!");
		        if (Player[playerid][Level] < 25) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 25-го уровня!");
		        if (Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
		        Player[playerid][Cash] -= 1000000; Player[playerid][ActiveSkillHCar2] = listitem;
		        return SendClientMessage(playerid, COLOR_YELLOW, "Ваш новый навык класса 2 (Клавиша 'H'): {FFFFFF}Режим Полета");
		    }//Режим Полета
		    return 1;
		}//Выбор скилла класс 2 (клавиша H)

		case DIALOG_PAINTJOB:
		{//Выбор PaintJob
			if(response)
			{//респонс
			    Player[playerid][CarSlot2PaintJob] = listitem;
			}//респонс
			else{Player[playerid][CarSlot2PaintJob] = 0;}
  			new mid = Player[playerid][CarSlot2] - 400, String[120];format(String,sizeof(String),"Ваш новый автомобиль 2-го класса - %s (PaintJob №%d)", PlayerVehicleName[mid],Player[playerid][CarSlot2PaintJob] + 1);
			SendClientMessage(playerid,COLOR_YELLOW,String);
			SendClientMessage(playerid,COLOR_YELLOW,"Вы потратили на него 100000$");
		}//Выбор PaintJob

		case DIALOG_PRESTIGE:
		{//Престиж
			if(response)
			{//респорс
			    	Player[playerid][Level] = 1;
					Player[playerid][Exp] = 0;
					Player[playerid][Spawn] = 0;
					Player[playerid][SpawnStyle] = 0;
					Player[playerid][Invisible] = 0;
					Player[playerid][BuddhaTime] = 0;
					Player[playerid][Slot1] = 0;
					Player[playerid][Slot2] = 0;
					Player[playerid][Slot3] = 0;
					Player[playerid][Slot4] = 0;
					Player[playerid][Slot5] = 0;
					Player[playerid][Slot6] = 0;
					Player[playerid][Slot7] = 0;
					Player[playerid][Slot8] = 0;
					Player[playerid][Slot9] = 0;
					Player[playerid][Slot10] = 0;
					Player[playerid][CarSlot1] = 462;//Faggio
					Player[playerid][CarSlot2] = 0;
					Player[playerid][CarSlot3] = 0;
					//Player[playerid][SkillHP] = 0;
					//Player[playerid][SkillRepair] = 0;
					Player[playerid][ActiveSkillPerson] = 0;
					Player[playerid][ActiveSkillCar1] = 0;
					Player[playerid][ActiveSkillCar2] = 0;
					Player[playerid][ActiveSkillHCar1] = 0;
					Player[playerid][ActiveSkillHCar2] = 0;
					NeedXP[playerid] = Levels[1];

					Player[playerid][Prestige] += 1; Player[playerid][Medals] -= 10;
					new String[140];format(String,sizeof(String), "SERVER: %s[%d] достиг {FFFFFF}%d{FFFF00}-го уровня Престижа! Поздравьте его!",PlayerName[playerid], playerid, Player[playerid][Prestige]);
					SendClientMessageToAll(COLOR_YELLOW, String);

					if (Player[playerid][Prestige] == 3) SendClientMessage(playerid,COLOR_YELLOW,"PRESTIGE 3: {FFFFFF}Разноцветный ник в чате (команда '/chatname') теперь доступен.");
					if (Player[playerid][Prestige] == 4) SendClientMessage(playerid,COLOR_YELLOW,"PRESTIGE 4: {FFFFFF}Неон теперь доступен в автомастерской TurboSpeed.");
					if (Player[playerid][Prestige] == 5) SendClientMessage(playerid,COLOR_YELLOW, "{FFFF00}PRESTIGE 5: {FFFFFF}Телепортация к игрокам теперь доступна.\n");
					if (Player[playerid][Prestige] == 6) SendClientMessage(playerid,COLOR_YELLOW,"PRESTIGE 6: Режим слежки теперь доступен (команды '/specp' и '/specoff').");
					if (Player[playerid][Prestige] == 7) SendClientMessage(playerid,COLOR_YELLOW,"PRESTIGE 7: Смена цвета ника (команда '/mycolor') теперь доступна.");
					if (Player[playerid][Prestige] == 9) SendClientMessage(playerid,COLOR_YELLOW,"PRESTIGE 9: Теперь вам всегда рады в казино! Максимальная ставка увеличена до 100 000 000$");
					if (Player[playerid][Prestige] == 10) SendClientMessage(playerid,COLOR_YELLOW,"PRESTIGE 10: 'Режим Бога' (бессмертие) теперь доступен. Используйте клавишу 'Y' (Пешком).");

				ResetTuneClass1(playerid); ResetTuneClass2(playerid);
				SavePlayer(playerid);LSpawnPlayer(playerid);
			}//респонс
		}//Престиж
		
		case DIALOG_SPREST:
		{//Престиж
			if(response)
			{//респорс
			        if(Player[playerid][Prestige] < 10 || Player[playerid][Medals] < 70 || Player[playerid][Level] < 500) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Для поднятия суперпрестижа нужно 500 уровней и 70 медалей.");
					if(Player[playerid][Level] < 502) Player[playerid][Level] = 1;
					else Player[playerid][Level] = Player[playerid][Level] - 500;
					Player[playerid][Exp] = 0;
					Player[playerid][Spawn] = 0;
					Player[playerid][SpawnStyle] = 0;
					Player[playerid][Invisible] = 0;
					Player[playerid][BuddhaTime] = 0;
					Player[playerid][Slot1] = 0;
					Player[playerid][Slot2] = 0;
					Player[playerid][Slot3] = 0;
					Player[playerid][Slot4] = 0;
					Player[playerid][Slot5] = 0;
					Player[playerid][Slot6] = 0;
					Player[playerid][Slot7] = 0;
					Player[playerid][Slot8] = 0;
					Player[playerid][Slot9] = 0;
					Player[playerid][Slot10] = 0;
					Player[playerid][CarSlot1] = 462;//Faggio
					Player[playerid][CarSlot2] = 0;
					Player[playerid][CarSlot3] = 0;
					//Player[playerid][SkillHP] = 0;
					//Player[playerid][SkillRepair] = 0;
					Player[playerid][ActiveSkillPerson] = 0;
					Player[playerid][ActiveSkillCar1] = 0;
					Player[playerid][ActiveSkillCar2] = 0;
					Player[playerid][ActiveSkillHCar1] = 0;
					Player[playerid][ActiveSkillHCar2] = 0;

					if (Player[playerid][Level] < 100) NeedXP[playerid] = Levels[Player[playerid][Level]];
					else NeedXP[playerid] = (Player[playerid][Level] - 99) * 100 + 35000;

					Player[playerid][SPrest] += 1; Player[playerid][Medals] -= 70;
					new String[140];format(String,sizeof(String), "SERVER: %s[%d] достиг {FFFFFF}%d{9A2EFE}-го уровня СуперПрестижа! Поздравьте его!",PlayerName[playerid], playerid, Player[playerid][SPrest]);
					SendClientMessageToAll(0x9A2EFEFF, String);

					if (Player[playerid][SPrest] == 1) SendClientMessage(playerid,0x9A2EFEFF,"SUPERPRESTIGE 1: {FFFFFF}Вы получили элитный статус и можете обменивать до 2 медалей на рубли в день.");
					if (Player[playerid][SPrest] == 2) SendClientMessage(playerid,0x9A2EFEFF,"SUPERPRESTIGE 2: {FFFFFF}Вы можете обменивать до 3 медалей на рубли в день.");
					if (Player[playerid][SPrest] == 3) SendClientMessage(playerid,0x9A2EFEFF,"SUPERPRESTIGE 3: {FFFFFF}Вы можете обменивать до 4 медалей на рубли в день.");

				ResetTuneClass1(playerid); ResetTuneClass2(playerid);
				SavePlayer(playerid);LSpawnPlayer(playerid);
			}//респонс
		}//Престиж

		case DIALOG_TUTORIAL:
		{//обучение
			if (TutorialStep[playerid] == 1)
			{//Обучение: Вызов мопеда
			    SendClientMessage(playerid,COLOR_YELLOW,"ОБУЧЕНИЕ: {FFFFFF}Нажмите {00FF00}Alt{FFFFFF} и выберите <<{FFFF00}Сесть в машину [Класс 1]{FFFFFF}>>");
				TutorialObject[playerid] = CreateObject(19482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
    			SetObjectMaterialText(TutorialObject[playerid], "{FFFF00}Обучение\n{FFFFFF}Нажмите {00FF00}Alt", 0, OBJECT_MATERIAL_SIZE_512x512, "Tahoma", 50, 1, 0xFFFFFFFF, 0x00, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
                AttachObjectToPlayer(TutorialObject[playerid], playerid, 0, 0, 1.2, 0, 0, 270);
			}//Обучение: Вызов мопеда
			if (TutorialStep[playerid] == 2)
			{//Обучение: Выбор авто класса 2
			    ShowModelSelectionMenu(playerid, MenuFirstCar, "First Car");//менюшка выбора авто
			}//Обучение: Выбор авто класса 2
            if (TutorialStep[playerid] == 3)
			{//Обучение: Трансформация
			    SendClientMessage(playerid,COLOR_YELLOW,"ОБУЧЕНИЕ: {FFFFFF}Нажмите {00FF00}Y{FFFFFF} или {00FF00}N{FFFFFF} сидя на мопеде для трансформации транспорта.");
                TutorialObject[playerid] = CreateObject(19482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
				SetObjectMaterialText(TutorialObject[playerid], "{FFFF00}Обучение\n{FFFFFF}Нажмите {00FF00}Y{FFFFFF}/{00FF00}N", 0, OBJECT_MATERIAL_SIZE_512x512, "Tahoma", 50, 1, 0xFFFFFFFF, 0x00, OBJECT_MATERIAL_TEXT_ALIGN_CENTER);
                AttachObjectToPlayer(TutorialObject[playerid], playerid, 0, 0, 1.2, 0, 0, 270);
			}//Обучение: Трансформация
			if (TutorialStep[playerid] == 4)
			{//Обучение: Конец обучения
    			new String[120];
				TutorialStep[playerid] = 999;Player[playerid][HelpTime] = 45;Player[playerid][Level] = 1;
				new Lvl = Player[playerid][Level]; NeedXP[playerid] = Levels[Lvl]; //первое обновление NeedXP
				SetVehicleVirtualWorld(GetPlayerVehicleID(playerid), 0);SetPlayerVirtualWorld(playerid, 0);
				format(String, sizeof String, "%d.%d.%d a %d:%d:%d |   %s[%d] прошел обучение.", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);WriteLog("GlobalLog", String);
                if(TutorialObject[playerid] != -1){DestroyObject(TutorialObject[playerid]);TutorialObject[playerid] = -1;}
                LSpawnPlayer(playerid); PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
                SendClientMessage(playerid,COLOR_YELLOW,"ОБУЧЕНИЕ: {FFFFFF}Не забывайте, что нажав {00FF00}Alt{FFFFFF} вы можете вызвать транспорт.");
                SendClientMessage(playerid,COLOR_YELLOW,"ОБУЧЕНИЕ: {FFFFFF}А нажав {00FF00}Y{FFFFFF} или {00FF00}N{FFFFFF} вы можете трансформировать его.");
			}//Обучение: Конец обучения
		}//обучение

		case DIALOG_PRESTIGECAR:
		{
		    if (response)
		    {//response
			    if(listitem == 0)
			    {//Класс 1
			        SendClientMessage(playerid,COLOR_YELLOW,"Транспорт 1-го класса успешно изменен.");
			        Player[playerid][CarSlot1] = SelectedModel[playerid];ResetTuneClass1(playerid);
			    }//Класс 1
			    if(listitem == 1)
			    {//Класс 2
			        SendClientMessage(playerid,COLOR_YELLOW,"Транспорт 2-го класса успешно изменен.");
			        Player[playerid][CarSlot2] = SelectedModel[playerid];ResetTuneClass2(playerid);
			    }//Класс 2
			    if(listitem == 2)
			    {//Сесть сейчас
					if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 12.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid, COLOR_RED, "Нельзя вызывать транспорт в помещениях!");//Игрок в интерьерах или в банке
					if (GetPlayerWeapon(playerid) == 46) return SendClientMessage(playerid,COLOR_RED,"Смените оружие! Нельзя вызывать автомобиль с парашютом на спине.");
					if (InEvent[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать машину в соревнованиях!");
					if (QuestActive[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать личный транспорт на работе!");
					new rtime = TimeTransform[playerid]-unixtime;
					if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6);format(String,sizeof(String),"Вы не можете вызвать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);SendClientMessage(playerid,COLOR_RED,String);return 1;}
					new Float: x, Float: y, Float: z, Float: Angle;
					GetPlayerPos(playerid,x,y,z);new wrld = GetPlayerVirtualWorld(playerid);GetPlayerFacingAngle(playerid, Angle);
					new col1 = random(240), col2 = random(240);
					PlayerCarID[playerid] = LCreateVehicle(SelectedModel[playerid], x, y, z, Angle, col1, col2, 0);
					SetVehicleVirtualWorld(PlayerCarID[playerid], wrld);PutPlayerInVehicle(playerid, PlayerCarID[playerid], 0);
					LinkVehicleToInterior(PlayerCarID[playerid],GetPlayerInterior(playerid));
			    }//Сесть сейчас
		    } else ShowModelSelectionMenu(playerid, MenuPrestigeCars, "Prestige Cars");
		}

		case DIALOG_HELP:
		{//help
		    if(response)
			{//респорс
			    if(listitem == 0)
				{//FAQ
				    new StringX[1024];
					strcat(StringX, "Где взять машину?\nЧто тут делать? Как качать уровень?\nКак менять машину прямо во время езды?\nУ меня забрали деньги! Что делать?\n");
					strcat(StringX, "\nКак изменить модель персонажа?\nКак изменить место респавна?\nКак создать или вступить в клан?\nЧто такое 'Карма' и зачем она нужна?\nКак прокачать 'Престиж'?");
					ShowPlayerDialog(playerid, DIALOG_HELPFAQ, 2, "Часто Задаваемые Вопросы (FAQ)", StringX, "ОК", "Назад");
				}//FAQ
				if(listitem == 1){ShowPlayerDialog(playerid, DIALOG_HELPCMD, 2, "Игровые команды, Чат", "{FFFFFF}Самые важные и часто используемые команды\nВиды сообщений (общие, ЛС, шепот и т.д.)\nПолный список команд (Без подробного описания)\nViP - Сообщения", "ОК", "Назад");}//CMD
                if(listitem == 2)
                {
                    new StringX[1024];
					strcat(StringX, "{FFFF00}1 {FFFFFF}- {FFFF00}20 {FFFFFF}уровни\n{FFFF00}21 {FFFFFF}- {FFFF00}40 {FFFFFF}уровни\n{FFFF00}41 {FFFFFF}- {FFFF00}60 {FFFFFF}уровни\n{FFFF00}61 {FFFFFF}- {FFFF00}80 {FFFFFF}уровни\n{FFFF00}81 {FFFFFF}- {FFFF00}100 {FFFFFF}уровни\n");
					strcat(StringX, "{FFFF00}Престиж {FFFFFF}1\n{FFFF00}Престиж {FFFFFF}2 - 10\n{FFFF00}Супер-Престиж {FFFFFF}1 - 3");
					ShowPlayerDialog(playerid, DIALOG_HELPLVL, 2, "Информация об уровнях", StringX, "ОК", "Назад");
                }
				if(listitem == 3) callcmd::vip(playerid, "");
			}//респонс
		}//help

		case DIALOG_HELPFAQ:
		{//helpfaq
		    if(response)
			{//респорс
			    new StringX[1024];
			    if(listitem == 0)
			    {//Где взять машину
			        strcat(StringX, "{FFFFFF}Каждому игроку на сервере с смого начала выдается свой личный автомобиль. Изначально это мопед {FFFF00}Faggio{FFFFFF}.\n");
			        strcat(StringX, "Для того, чтобы сесть на него, используйте кнопку ходьбы (Левый Alt) и выберите <<Сесть в машину [Класс 1]>>\n\n");
			        strcat(StringX, "У каждого игрока может быть сразу три автомобиля: по одному на каждый класс. Более того, можно прямо во время езды трансформироваться\n");
			        strcat(StringX, "из одного автомобиля в другой при помощи клавиш <{FFFF00}Y{FFFFFF}> и <{FFFF00}N{FFFFFF}>.");
			    }//Где взять машину
			    if(listitem == 1)
			    {//Что тут делать? Как качать уровень?
			        strcat(StringX, "{FFFFFF}Вашей основной задачей является прокачка уровня. С каждым уровнем у вас будут новые возможности, транспорт и оружие.\n");
			        strcat(StringX, "Для повышения уровня нужно участвовать в {FFFF00}соревнованиях{FFFFFF}, выполнять {FFFF00}задания{FFFFFF} или ходить на {FFFF00}работу{FFFFFF}.\n");
			        strcat(StringX, "За это вы будете получать опыт, необходимый для повышения уровня.\n\n");
			        strcat(StringX, "    • Посмотреть список доступных соревнований можно командой {FF0000}/events{FFFFFF}\n");
  			        strcat(StringX, "    • Посмотреть список доступных заданий можно командой {FF0000}/quests{FFFFFF}\n");
			        strcat(StringX, "    • Найти работу, банк, казино и другие важные объекты можно при помощи {FF0000}/gps{FFFFFF}\n");
			    }//Что тут делать? Как качать уровень?
			    if(listitem == 2)
			    {//как менять авто во время езды
			        strcat(StringX, "{FFFFFF}При помощи клавиш <{FFFF00}Y{FFFFFF}> и <{FFFF00}N{FFFFFF}>.");
			    }//как менять авто во время езды
			    if(listitem == 3)
			    {//У меня забрали деньги. Что делать?
			        strcat(StringX, "{FFFFFF}Всегда храните ваши деньги в банке. Найти ближайший банк можно при помощи {FF0000}/gps{FFFFFF}.\n");
			    }//У меня забрали деньги. Что делать?
			    if(listitem == 4)
			    {//Как сменить скин
			         strcat(StringX, "{FFFFFF}Изменить модель персонажа можно в магазине одежды.\nИспользуйте {FFFF00}/gps{FFFFFF} чтобы найти его.\n");
			    }//Как сменить скин
			    if(listitem == 5)
			    {//Как изменить место респавна
			        strcat(StringX, "{FFFFFF}Стандартное место респавна изменяется автоматически, в зависимости от вашего уровня. Новички респавнятся вместе с новичками, а дядьки с шестиствольными\n");
			        strcat(StringX, "пулеметами рядом с такими же дядьками. Однако если вы купите себе дом или если у вашего клана есть штаб, то вы можете возрождаться там.\n");
			        strcat(StringX, "Используйте {FFFF00}/myspawn{FFFFFF} чтобы открыть меню настроек вашего респавна.");
			    }//Как изменить место респавна
			    if(listitem == 6)
			    {//Как создать или вступить в клан
			        strcat(StringX, "{FFFFFF}Для вступления в клан вас должен пригласить кто-то из клана, у кого есть на это право. Разумеется, что вы не должны быть ни в одном из кланов, иначе вас не\n");
			        strcat(StringX, "сможет пригласить никто другой. Если же вы сами решили создать клан, то вам нужно убедиться, что у вас есть 500 000$ и как минимум 10-ый уровень. Если да, то просто\n");
			        strcat(StringX, "введите команду {FFFF00}/clan {FFFF00} и вы обязательно разберетесь. Это не трудно.");
			    }//Как создать или вступить в клан
			    if(listitem == 7) return ShowKarma(playerid);
			    if(listitem == 8)
			    {//Как прокачать престиж?
			        strcat(StringX, "{FFFFFF}Чтобы получить Престиж вам сначала нужно дойти до самого верха - до 100-го уровня, а затем вы сможете добровольно начать всё\n");
			        strcat(StringX, "{FFFFFF}с начала. Если вы решитесь на это, то при повторной прокачке вас будут ждать новые возможности, которых нет у обычных игроков.");
			    }//Как прокачать престиж?

  			    ShowPlayerDialog(playerid, DIALOG_HELPMES, 0, "Ответ",StringX, "Назад", "");
			}//респонс
			else {callcmd::help(playerid, "");}
		}//helpfaq

		//ShowPlayerDialog(playerid, DIALOG_HELPMES, 0, "Список правил сервера","", "Назад", "");

		case DIALOG_HELPCMD:
		{//helpcmd
		    if(response)
			{//респорс
			    if(listitem == 0)
				{//частые команды
					new StringX[1024];
					strcat(StringX, "{008D00}/events{FFFFFF} - отобразить список всех соревнований    {008D00}/quests{FFFFFF} - отобразить список всех заданий,\n{008D00}/dm, /derby, /zombie, /race, /xrace, /gungame{FFFFFF} - отдельные команды для каждого соревнования,\n");
					strcat(StringX, "{008D00}/stats{FFFFFF} - посмотреть свою статистику    {008D00}/givecash{FFFFFF} - передать деньги другому игроку,\n{008D00}/buygun{FFFFFF} - оружейный магазин    {008D00}/mygun{FFFFFF} - выбор личного оружия,\n{008D00}/gps{FFFFFF} - Включить GPS    {008D00}/radio{FFFFFF} - включить радио");
				    ShowPlayerDialog(playerid, DIALOG_HELPMES, 0, "Самые важные и часто используемые команды",StringX, "Назад", "");
				}//частые команды
				if(listitem == 1)
				{//виды сообщений
				    new StringX[1024];
					strcat(StringX, "{FFFF00}В игре есть и другие способы общения кроме общего чата. Используйте\n   {008D00}!{FFFFFF}текст  - для отправки сообщений в чат клана,\n   {457EFF}@{FFFFFF}текст  - для отправки сообщений администрации сервера,\n   {CCFF00}#{FFFFFF}текст  - для отправки сообщения ближайшим игрокам (Шепот),\n   и {FFFF00}/pm{FFFFFF}  - для отправки личных сообщений.");
					ShowPlayerDialog(playerid, DIALOG_HELPMES, 0, "Виды сообщений",StringX, "Назад", "");
				}//виды сообщений
				if(listitem == 2) callcmd::commands(playerid, "");//полный список команд
				if(listitem == 3)
				{//ViP - сообщения
				    new StringX[1024];
				    strcat(StringX, "{FFFF00}Внимание! Для отправки этих сообщений у вас должен быть ViP 2-го уровня или выше!\n\nВы можете разукрашивать ваши слова в сообщениях, используя коды цветов, указанные ниже:\n");
                    strcat(StringX, "{FF0000}*1{FFFFFF} - Красный    {3399FF}*2{FFFFFF} - Синий    {00FF00}*3{FFFFFF} - Зеленый    {FFFF00}*4{FFFFFF} - Желтый    {CCFF00}*5{FFFFFF} - Qiwi\n");
                    strcat(StringX, "{24F7FE}*6{FFFFFF} - Aqua    {F74AB8}*7{FFFFFF} - Розовый    {FFCC00}*8{FFFFFF} - цвет заданий    {976D3D}*9{FFFFFF} - Коричневый    {FFFFFF}* - Белый (Стандарт)\n");
                    strcat(StringX, "{FF8C00}*!1{FFFFFF} - dm    {9966CC}*!2{FFFFFF} - derby    {E60020}*!3{FFFFFF} - zombie    {007FFF}*!4{FFFFFF} - race\n");
                    strcat(StringX, "{FFD700}*!5{FFFFFF} - xrace    {FF6666}*!6{FFFFFF} - gungame    {04B486}*!7{FFFFFF} - командный дм\n");
					ShowPlayerDialog(playerid, DIALOG_HELPMES, 0, "Premium - Сообщения",StringX, "Назад", "");
				}//Premium - сообщения
			}//респонс
			else callcmd::help(playerid, "");
		}//helpcmd

		case DIALOG_HELPLVL:
		{//helplvl
		    if(response)
			{//респорс
			    new StringX[2048];
			    if(listitem == 0)
				{//1 - 20 уровни
 					strcat(StringX, "{FFFF00}Level 2: {FFFFFF}Команда /skydive теперь доступна.\n");
					strcat(StringX, "{FFFF00}Level 3: {FFFFFF}Вам доступен новый транспорт 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 4: {FFFFFF}Вам доступен новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 5: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 6: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 7: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 8: {FFFFFF}Вам доступен новый транспорт 2-го класса и новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 9: {FFFFFF}Вам доступен новый транспорт 3-го класса и гидравлика в автомастерских.\n");
					strcat(StringX, "{FFFF00}Level 10: {FFFFFF}Вам доступен новый стиль спавна - На авто 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 11: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 12: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 13: {FFFFFF}Вам доступен новый стиль спавна - На авто 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 14: {FFFFFF}Вам доступен новый транспорт 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 15: {FFFFFF}Вам доступен новый транспорт 3-го класса и изменено место стандартного спавна - Сан Фиерро.\n");
					strcat(StringX, "{FFFF00}Level 16: {FFFFFF}Вам доступен новый транспорт 1-го класса и новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 17: {FFFFFF}Вам доступен новый транспорт 3-го класса и новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 18: {FFFFFF}Вам доступно новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 19: {FFFFFF}Вам доступен новый транспорт 3-го класса и новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 20: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
 				}//1 - 20 уровни
				if(listitem == 1)
				{//21 - 40 уровни
					strcat(StringX, "{FFFF00}Level 21: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 22: {FFFFFF}Вам доступен новый транспорт 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 23: {FFFFFF}Вам доступен новый транспорт 3-го класса и новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 24: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 25: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 25: {FFFFFF}Команда /mytime теперь доступна  и изменено место стандартного спавна - Лас Вентурас.\n");
					strcat(StringX, "{FFFF00}Level 26: {FFFFFF}Вам доступен новый транспорт 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 27: {FFFFFF}Вам доступно новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 28: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 29: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 30: {FFFFFF}Вам доступен новый транспорт 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 31: {FFFFFF}Количество боеприпасов для пистолетов (Личное Оружие) увеличено до 140.\n");
					strcat(StringX, "{FFFF00}Level 32: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 33: {FFFFFF}Количество боеприпасов для дробовиков (Личное Оружие) увеличено до 56.\n");
					strcat(StringX, "{FFFF00}Level 34: {FFFFFF}Вам доступно новое личное оружие.\n");
					strcat(StringX, "{FFFF00}Level 35: {FFFFFF}Нитро х2 в автомастерских теперь доступно.\n");
					strcat(StringX, "{FFFF00}Level 36: {FFFFFF}Вам доступны новые стили драки (/style).\n");
					strcat(StringX, "{FFFF00}Level 37: {FFFFFF}Количество боеприпасов для пистолет-пулеметов (Личное Оружие) увеличено до 1 000.\n");
					strcat(StringX, "{FFFF00}Level 38: {FFFFFF}Вам доступен JetPack и стиль спавна 'На JetPack'.\n");
					strcat(StringX, "{FFFF00}Level 39: {FFFFFF}Максимальная ставка в казино увеличена до 100 000$.\n");
					strcat(StringX, "{FFFF00}Level 40: {FFFFFF}Вам доступно новое личное оружие.\n");
				}//21 - 40 уровни
				if(listitem == 2)
				{//41 - 60 уровни
					strcat(StringX, "{FFFF00}Level 41: {FFFFFF}Количество боеприпасов для автоматов (Личное Оружие) увеличено до 180.\n");
					strcat(StringX, "{FFFF00}Level 42: {FFFFFF}Нитро х5 в автомастерских теперь доступно.\n");
					strcat(StringX, "{FFFF00}Level 43: {FFFFFF}Количество гранат (Личное Оружие) увеличено до 20.\n");
					strcat(StringX, "{FFFF00}Level 44: {FFFFFF}Количество боеприпасов для винтовок (Личное Оружие) увеличено до 30.\n");
					strcat(StringX, "{FFFF00}Level 45: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 46: {FFFFFF}Количество боеприпасов для RPG (Личное Оружие) увеличено до 20.\n");
					strcat(StringX, "{FFFF00}Level 47: {FFFFFF}Команды для перекраски транспорта /paint и /paintid теперь доступны.\n");
					strcat(StringX, "{FFFF00}Level 48: {FFFFFF}Нитро х10 в автомастерских теперь доступно.\n");
					strcat(StringX, "{FFFF00}Level 49: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 50: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 51: {FFFFFF}Навык 'Перевернуть транспорт на колеса' теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 52: {FFFFFF}Команды для смены скина (/myskin, /myskinid) теперь доступны.\n");
					strcat(StringX, "{FFFF00}Level 53: {FFFFFF}Максимальная ставка в казино увеличена до 500 000$.\n");
					strcat(StringX, "{FFFF00}Level 54: {FFFFFF}Доступен новый стиль спавна - На авто 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 55: {FFFFFF}Покрасочные работы в автомастерских теперь доступны.\n");
					strcat(StringX, "{FFFF00}Level 56: {FFFFFF}Доступен навык 'Разворот на 180' для транспорта 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 57: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 58: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 59: {FFFFFF}Доступен навык  'Разворот на 180' для транспорта 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 60: {FFFFFF}Вам доступно новое личное оружие.\n");
				}//41 - 60 уровни
				if(listitem == 3)
				{//61 - 80 уровни
					strcat(StringX, "{FFFF00}Level 61: {FFFFFF}Доступен навык 'Прыжок' для транспорта 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 62: {FFFFFF}Доступен навык 'Прыжок' для транспорта 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 63: {FFFFFF}Доступен навык 'Трамплин' для транспорта 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 64: {FFFFFF}Доступен навык 'Трамплин' для транспорта 2-го класса.\n");
					strcat(StringX, "{FFFF00}Level 65: {FFFFFF}Бесконечное нитро теперь доступно в автомастерской TurboSpeed.\n");
					strcat(StringX, "{FFFF00}Level 66: {FFFFFF}Максимальная ставка в казино увеличена до 1 000 000$.\n");
					strcat(StringX, "{FFFF00}Level 67: {FFFFFF}Команда /myweather теперь доступна.\n");
					strcat(StringX, "{FFFF00}Level 68: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 69: {FFFFFF}Изменено место стандартного спавна - Гора Chilliad.\n");
					strcat(StringX, "{FFFF00}Level 70: {FFFFFF}Вам доступна невидимость на радаре (/invisible).\n");
					strcat(StringX, "{FFFF00}Level 71: {FFFFFF}Количество боеприпасов для пистолетов (Личное Оружие) увеличено до 210.\n");
					strcat(StringX, "{FFFF00}Level 72: {FFFFFF}Количество боеприпасов для дробовиков (Личное Оружие) увеличено до 84.\n");
					strcat(StringX, "{FFFF00}Level 73: {FFFFFF}Количество боеприпасов для пистолет-пулеметов (Личное Оружие) увеличено до 1 500.\n");
					strcat(StringX, "{FFFF00}Level 74: {FFFFFF}Количество боеприпасов для автоматов (Личное Оружие) увеличено до 270.\n");
					strcat(StringX, "{FFFF00}Level 75: {FFFFFF}Вам доступен новый транспорт 1-го класса.\n");
					strcat(StringX, "{FFFF00}Level 76: {FFFFFF}Количество гранат (Личное Оружие) увеличено до 30.\n");
					strcat(StringX, "{FFFF00}Level 77: {FFFFFF}Количество боеприпасов для винтовок (Личное Оружие) увеличено до 45.\n");
					strcat(StringX, "{FFFF00}Level 78: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 79: {FFFFFF}Количество боеприпасов для RPG (Личное Оружие) увеличено до 30.\n");
					strcat(StringX, "{FFFF00}Level 80: {FFFFFF}UberNitro теперь доступно в автомастерской TurboSpeed.\n");
				}//61 - 80 уровни
				if(listitem == 4)
				{//81 - 100 уровни
					strcat(StringX, "{FFFF00}Level 81: {FFFFFF}Количество боеприпасов для Минигана (Личное Оружие) увеличено до 2 000.\n");
					strcat(StringX, "{FFFF00}Level 82: {FFFFFF}Количество боеприпасов для пистолетов (Личное Оружие) увеличено до 280.\n");
					strcat(StringX, "{FFFF00}Level 83: {FFFFFF}Количество боеприпасов для дробовиков (Личное Оружие) увеличено до 112.\n");
					strcat(StringX, "{FFFF00}Level 84: {FFFFFF}Количество боеприпасов для пистолет-пулеметов (Личное Оружие) увеличено до 2 000.\n");
					strcat(StringX, "{FFFF00}Level 85: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 86: {FFFFFF}Количество боеприпасов для автоматов (Личное Оружие) увеличено до 360.\n");
					strcat(StringX, "{FFFF00}Level 87: {FFFFFF}Количество гранат (Личное Оружие) увеличено до 40.\n");
					strcat(StringX, "{FFFF00}Level 88: {FFFFFF}Количество боеприпасов для винтовок (Личное Оружие) увеличено до 60.\n");
					strcat(StringX, "{FFFF00}Level 89: {FFFFFF}Количество боеприпасов для RPG (Личное Оружие) увеличено до 40.\n");
					strcat(StringX, "{FFFF00}Level 90: {FFFFFF}Вам доступен новый транспорт 3-го класса.\n");
					strcat(StringX, "{FFFF00}Level 91: {FFFFFF}Количество боеприпасов для Минигана (Личное Оружие) увеличено до 3 000.\n");
					strcat(StringX, "{FFFF00}Level 92: {FFFFFF}Количество боеприпасов для пистолетов (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 93: {FFFFFF}Количество боеприпасов для дробовиков (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 94: {FFFFFF}Количество боеприпасов для пистолет-пулеметов (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 95: {FFFFFF}Количество боеприпасов для автоматов (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 96: {FFFFFF}Количество гранат (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 97: {FFFFFF}Количество боеприпасов для винтовок (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 98: {FFFFFF}Количество боеприпасов для RPG (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 99: {FFFFFF}Количество боеприпасов для Минигана (Личное Оружие) увеличено до 20 000.\n");
					strcat(StringX, "{FFFF00}Level 100: {FFFFFF}Ускоритель для JetPack теперь доступен (Клавиша 'N').\n");
                }//81 - 100 уровни
				if(listitem == 5)
				{//Престиж 1
					strcat(StringX, "{FFFF00}Level 10 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 50 метров' теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 20 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 100 метров' теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 35 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 50 метров' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 40 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 100 метров' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 45 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 200 метров' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 53 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 200 метров' теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 55 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 50 метров (cо скоростью)' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 60 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 100 метров (cо скоростью)' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 65 PRESTIGE 1: {FFFFFF}Навык 'Телепорт на 200 метров (cо скоростью)' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 85 PRESTIGE 1: {FFFFFF}Теперь вы можете ставить любой транспорт в класс 1 и 2.\n");
				}//Престиж 1
				if(listitem == 6)
				{//Престиж 2+
					strcat(StringX, "{FFFF00}Level 25 PRESTIGE 2: {FFFFFF}Навык 'Режим Полета' (для транспорта) теперь доступен.\n");
					strcat(StringX, "{FFFF00}PRESTIGE 3: {FFFFFF}Разноцветный ник в чате (команда '/chatname') теперь доступен.\n");
					strcat(StringX, "{FFFF00}PRESTIGE 4: {FFFFFF}Неон теперь доступен в автомастерской TurboSpeed.\n");
					strcat(StringX, "{FFFF00}PRESTIGE 5: {FFFFFF}Телепортация к игрокам теперь доступна.\n");
					strcat(StringX, "{FFFF00}PRESTIGE 6: {FFFFFF}Режим слежки теперь доступен (команды '/specp' и '/specoff').\n");
					strcat(StringX, "{FFFF00}PRESTIGE 7: {FFFFFF}Смена цвета ника (команда '/mycolor') теперь доступна.\n");
					strcat(StringX, "{FFFF00}Level 25 PRESTIGE 8: {FFFFFF}Навык 'Режим Cупермена' теперь доступен.\n");
					strcat(StringX, "{FFFF00}PRESTIGE 9: {FFFFFF}Теперь вам всегда рады в казино! Максимальная ставка увеличена до 100 000 000$.\n");
					strcat(StringX, "{FFFF00}PRESTIGE 10: {FFFFFF}'Режим Бога' (бессмертие) теперь доступен.\n");
					strcat(StringX, "{FFFF00}Level 100 PRESTIGE 10: {FFFFFF}Внимание! Теперь вы можете 'прокачиваться' выше 100-го уровня!\n");
					strcat(StringX, "{FFFF00}Level 150 PRESTIGE 10: {FFFFFF}Внимание! Теперь вы можете летать быстрее в 'Режиме Полета'.\n");
					strcat(StringX, "{FFFF00}Level 200 PRESTIGE 10: {FFFFFF}Внимание! Теперь вы можете летать быстрее в 'Режиме Супермена'.\n");

				}//Престиж 2+
				if(listitem == 7)
				{//суперПрестиж
					strcat(StringX, "{FFFF00}SUPER PRESTIGE 1: {FFFFFF}Вы можете обменивать до 2 медалей на рубли в день.\n");
 					strcat(StringX, "{FFFF00}SUPER PRESTIGE 2: {FFFFFF}Вы можете обменивать до 3 медалей на рубли в день.\n");
					strcat(StringX, "{FFFF00}SUPER PRESTIGE 3: {FFFFFF}Вы можете обменивать до 4 медалей на рубли в день.\n");
				}//Престиж 2+
                ShowPlayerDialog(playerid, DIALOG_HELPMES, 0, "Информация об уровнях",StringX, "Назад", "");
			}//респонс
			else callcmd::help(playerid, "");
		}//helplvl

		case DIALOG_HELPMES: callcmd::help(playerid, "");

        case DIALOG_PVP:
		{//Настройки PvP
		    if(response)
			{//респонс
			    if (listitem == 0)
			    {//случайные настройки
			        if (PlayerPVP[playerid][Status] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки во время дуэли.");
      			    if (PlayerPVP[playerid][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки когда Вы/Вас вызвали на дуэль.");
					PlayerPVP[playerid][Map] = random(10) + 1;//случайная карта
					new rweap = random(20);
			        if (rweap == 0) PlayerPVP[playerid][Weapon] = 0;if (rweap == 1) PlayerPVP[playerid][Weapon] = 8;if (rweap == 2) PlayerPVP[playerid][Weapon] = 9;if (rweap == 3) PlayerPVP[playerid][Weapon] = 22;if (rweap == 4) PlayerPVP[playerid][Weapon] = 23;
					if (rweap == 5) PlayerPVP[playerid][Weapon] = 24;if (rweap == 6) PlayerPVP[playerid][Weapon] = 25;if (rweap == 7) PlayerPVP[playerid][Weapon] = 26;if (rweap == 8) PlayerPVP[playerid][Weapon] = 27;if (rweap == 9) PlayerPVP[playerid][Weapon] = 28;
					if (rweap == 10) PlayerPVP[playerid][Weapon] = 32;if (rweap == 11) PlayerPVP[playerid][Weapon] = 29;if (rweap == 12) PlayerPVP[playerid][Weapon] = 31;if (rweap == 13) PlayerPVP[playerid][Weapon] = 30;if (rweap == 14) PlayerPVP[playerid][Weapon] = 33;
					if (rweap == 15) PlayerPVP[playerid][Weapon] = 34;if (rweap == 16) PlayerPVP[playerid][Weapon] = 16;if (rweap == 17) PlayerPVP[playerid][Weapon] = 35;if (rweap == 18) PlayerPVP[playerid][Weapon] = 38;if (rweap == 19) PlayerPVP[playerid][Weapon] = 42;
					rweap = random(5);
					if (rweap == 0) PlayerPVP[playerid][Health] = 1;
					if (rweap == 1) PlayerPVP[playerid][Health] = 50;
					if (rweap == 2) PlayerPVP[playerid][Health] = 100;
					if (rweap == 3) PlayerPVP[playerid][Health] = 150;
					if (rweap == 4) PlayerPVP[playerid][Health] = 200;
					//Показать обновленные настройки
					ShowConfigPVP(playerid);
			    }//случайные настройки
			    if (listitem == 1)
			    {//Смена карты
			        ShowPlayerDialog(playerid, DIALOG_PVPMAP, 2, "PVP - Выбор карты", "Арена\nПод мостом\nНад мостом\nМолния\nОкопы\nВертолетная площадка\nДве крыши\nДамба\nГрузовой корабль\nПирамида", "Ок", "Назад");
			    }//Смена карты
			    if (listitem == 2)
			    {//Смена оружия
			        ShowPlayerDialog(playerid, DIALOG_PVPWEAPON, 2, "PVP - Выбор оружия","Без оружия\nКатана\nБензопила\n9мм пистолет\n9мм пистолет с глушителем\nDesert Eagle\nДробовик\nОбрезы\nSPAS12\nMicroUZI\nTec9\nMP5\nM4\nAK-47\nВинтовка\nСнайперская винтовка\nГранаты\nRPG\nМиниган\nОгнетушитель", "Ок", "Назад");
			    }//Смена оружия
			    if (listitem == 3)
			    {//Смена здоровья
			        ShowPlayerDialog(playerid, DIALOG_PVPHEALTH, 1, "PVP - Количество здоровья","Введите необходимое количество здоровья (от 1 до 200).\nPS: 100 здоровья + 100 брони = 200 (по умолчанию).","Ок","Назад");
			    }//Смена здоровья
			    if (listitem == 4)
			    {//ставка
			        ShowPlayerDialog(playerid, DIALOG_PVPCASH, 1, "PVP - Ставка","Введите размер ставки (от 1500 до 600 000).\nPS: Победитель получает ставку в двойном размере.","Ок","Назад");
			    }//ставка
			}//респонс
   			else ShowPlayerAltMenu(playerid);//{ShowPlayerDialog(playerid, 2, 2, "Меню быстрого доступа", "Сесть в машину [Класс 1]\nСесть в машину [Класс 2]\nСесть в машину [Класс 3]\nНадеть JetPack (/jetpack)\nПрыгнуть с парашютом (/skydive)\n{FF0000}GPS (/gps){FFFFFF}\nИзменить мои автомобили\nИзменить мои навыки\nНастройки PvP\n{FFFF00}Открыть КПК", "ОК", "Назад");}
		}///Настройки PvP

        case DIALOG_PVPMAP:
		{//Место пвп
			if (PlayerPVP[playerid][Status] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки во время дуэли.");
            if (PlayerPVP[playerid][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки когда Вы/Вас вызвали на дуэль.");
		    if(response){PlayerPVP[playerid][Map] = listitem + 1;}
		    
			ShowConfigPVP(playerid);
		}//Место пвп

		case DIALOG_PVPWEAPON:
		{//оружие пвп
			if (PlayerPVP[playerid][Status] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки во время дуэли.");
            if (PlayerPVP[playerid][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки когда Вы/Вас вызвали на дуэль.");
	        if(response)
			{
			    //Без оружия, Катана, 9мм, 9мм силенсед, дигл, шотбан, обрезы, спас, микро узи, тек9, м4, ак47
				//винтовка, снайперка, грены, рпг, миниган
				if (listitem == 0) PlayerPVP[playerid][Weapon] = 0;
				if (listitem == 1) PlayerPVP[playerid][Weapon] = 8;
				if (listitem == 2) PlayerPVP[playerid][Weapon] = 9;
				if (listitem == 3) PlayerPVP[playerid][Weapon] = 22;
				if (listitem == 4) PlayerPVP[playerid][Weapon] = 23;
				if (listitem == 5) PlayerPVP[playerid][Weapon] = 24;
				if (listitem == 6) PlayerPVP[playerid][Weapon] = 25;
				if (listitem == 7) PlayerPVP[playerid][Weapon] = 26;
				if (listitem == 8) PlayerPVP[playerid][Weapon] = 27;
				if (listitem == 9) PlayerPVP[playerid][Weapon] = 28;
				if (listitem == 10) PlayerPVP[playerid][Weapon] = 32;
				if (listitem == 11) PlayerPVP[playerid][Weapon] = 29;
				if (listitem == 12) PlayerPVP[playerid][Weapon] = 31;
				if (listitem == 13) PlayerPVP[playerid][Weapon] = 30;
				if (listitem == 14) PlayerPVP[playerid][Weapon] = 33;
				if (listitem == 15) PlayerPVP[playerid][Weapon] = 34;
				if (listitem == 16) PlayerPVP[playerid][Weapon] = 16;
				if (listitem == 17) PlayerPVP[playerid][Weapon] = 35;
				if (listitem == 18) PlayerPVP[playerid][Weapon] = 38;
				if (listitem == 19) PlayerPVP[playerid][Weapon] = 42;
			}
			ShowConfigPVP(playerid);
		}//оружие пвп

		case DIALOG_PVPHEALTH:
		{//здоровье пвп
			if (PlayerPVP[playerid][Status] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки во время дуэли.");
            if (PlayerPVP[playerid][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки когда Вы/Вас вызвали на дуэль.");
		    if(response)
			{
			    if (strval(inputtext) < 1 || strval(inputtext) > 200) SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Значение указано не верно (Должно быть от 1 до 200).");
			    else PlayerPVP[playerid][Health] = strval(inputtext);
			}
			ShowConfigPVP(playerid);
		}//здоровье пвп
		
		case DIALOG_PVPCASH:
		{
            if (PlayerPVP[playerid][Status] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки во время дуэли.");
            if (PlayerPVP[playerid][TimeOut] > 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменять настройки когда Вы/Вас вызвали на дуэль.");
		    if(response)
			{
			    if (strval(inputtext) < 500 || strval(inputtext) > 600000 || strlen(inputtext) > 7) SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Размер ставки от 500 до 600.000$.");
			    else PlayerPVP[playerid][Stavka] = strval(inputtext);
			}
			ShowConfigPVP(playerid);
		    return 1;
		}

		case DIALOG_CONFIG:
		{//Настройки аккаунта
		    if (!response) return 1;
		    if (listitem == 0)
		    {//Личные сообщения
		        if (Player[playerid][ConPM] == 1) {Player[playerid][ConPM] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Система личных сообщений отключена.");}
				else {Player[playerid][ConPM] = 1; SendClientMessage(playerid,COLOR_CLAN,"SERVER: Система личных сообщений включена.");}
		    }//Личные сообщения
		    if (listitem == 1)
		    {//Разрешить приглашать в клан
		        if (Player[playerid][ConInviteClan] == 1) {Player[playerid][ConInviteClan] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Вы запретили приглашать себя в клан.");}
				else {Player[playerid][ConInviteClan] = 1;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы разрешили приглашать себя в клан.");}
		    }//Разрешить приглашать в клан
		    if (listitem == 2)
		    {//Разрешить приглашать на PvP
		        if (Player[playerid][ConInvitePVP] == 1) {Player[playerid][ConInvitePVP] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Вы запретили вызывать себя на PvP.");}
				else {Player[playerid][ConInvitePVP] = 1;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы разрешили вызывать себя на PvP.");}
		    }//Разрешить приглашать на PvP
		    if (listitem == 3)
		    {//Отображать результаты PvP
		        if (Player[playerid][ConMesPVP] == 1) {Player[playerid][ConMesPVP] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Вы отключили отображение сообщений о результатах PvP других игроков.");}
				else {Player[playerid][ConMesPVP] = 1;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы включили отображение сообщений о результатах PvP других игроков.");}
		    }//Отображать результаты PvP
		    if (listitem == 4)
		    {//Сообщения о входе/выходе игроков
		        if (Player[playerid][ConMesEnterExit] == 1) {Player[playerid][ConMesEnterExit] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Вы отключили отображение сообщений о входе/выходе игроков на сервер.");}
				else {Player[playerid][ConMesEnterExit] = 1;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы включили отображение сообщений о входе/выходе игроков на сервер.");}
		    }//Сообщения о входе/выходе игроков
		    if (listitem == 5)
		    {//Сообщения о входе/выходе игроков
		        if (Player[playerid][ConSpeedo] == 1) {Player[playerid][ConSpeedo] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Вы отключили отображение спидометра.");}
				else {Player[playerid][ConSpeedo] = 1;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы включили отображение спидометра."); SpeedoUpdate(playerid);}
		    }//Сообщения о входе/выходе игроков
		    if (listitem == 6)
		    {//время (по умолчанию включено = 1)
		        if(Player[playerid][RadarSwitch] < 1) {Player[playerid][RadarSwitch] = 1; TextDrawShowForPlayer(playerid, TextDrawTime), TextDrawShowForPlayer(playerid, TextDrawDate);SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы включили отображение даты и времени.");}//дата и время
		        else {Player[playerid][RadarSwitch] = 0; TextDrawHideForPlayer(playerid, TextDrawTime), TextDrawHideForPlayer(playerid, TextDrawDate);SendClientMessage(playerid,COLOR_RED,"SERVER: Вы отключили отображение даты и времени.");}
		    }//время
		    if (listitem == 7)
		    {//тег
		        if (Player[playerid][MyClan] == 0 || Clan[Player[playerid][MyClan]][cLevel] < 5) return SendClientMessage(playerid,COLOR_RED,"SERVER: Вам недоступна эта функция.");
		        if (Player[playerid][Tag] == 1) {Player[playerid][Tag] = 0;SendClientMessage(playerid,COLOR_RED,"SERVER: Вы отключили отображение тега.");}
				else {Player[playerid][Tag] = 1;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы включили отображение тега.");}
			}//тег
			if (listitem == 8)
		    {//музыка
		        if (Player[playerid][FindPack] != 0) {Player[playerid][FindPack] = 0;SendClientMessage(playerid,COLOR_CLAN,"SERVER: Вы включили воспроизведение музыки от администраторов.");}
				else {Player[playerid][FindPack] = 1;StopAudioStreamForPlayer(playerid);SendClientMessage(playerid,COLOR_RED,"SERVER: Вы отключили воспроизведение музыки от администраторов.");}
		    }//музыка
		    if (listitem == 9)
		    {//pass
				new canchange = 0;
				if(strlen(PlayerIP[playerid]) < 4 || strlen(RegisterIP[playerid]) < 4) canchange = 1;
				for(new fh = 0; fh < strlen(PlayerIP[playerid]); fh++)
				{
				    if(PlayerIP[playerid][fh] == '.') continue;
				    //if(pk == 2) continue;
				    if(PlayerIP[playerid][fh] != RegisterIP[playerid][fh]) {canchange = 1; continue;}
				}
				if(canchange == 1) {callcmd::config(playerid, ""); SendClientMessage(playerid,COLOR_RED,"Вам запрещено менять пароль! Попробуйте сменить его позже или с компьютера, с которого вы регистрировались."); return 1;}
				else ShowPlayerDialog(playerid, DIALOG_CHANGEPASS1, 1, "Смена пароля", "{FF0000}Вы уверены, что хотите сменить пароль?\n{FFFFFF}Для продолжения введите ваш {ff0000}текущий{ffffff} пароль:","ОК","Назад");
		    }//pass
			if (listitem == 10) {SavePlayerConfig(playerid); return 1;}
		    if (listitem < 9) {callcmd::config(playerid, ""); return 1;}//Если не нажал "Сохранить и закрыть" - показываем менюшку еще раз
		}//Настройки аккаунта

		case DIALOG_CHANGENICK:
		{//Смена ника - ввод старого пароля прежде чем вводить новый ник
		    if (!response) return ShowShopDialog(playerid);
		    if(strcmp(PlayerPass[playerid], inputtext, true)) return ShowPlayerDialog(playerid, DIALOG_CHANGENICK, 1, "Смена ника", "{FF0000}Вы уверены, что хотите сменить ник?\n{FFFFFF}Для продолжения введите ваш текущий пароль:\n\n{FF0000}Пароль введен неверно! Повторите попытку...","ОК","Назад");
		    ShowPlayerDialog(playerid, DIALOG_CHANGENICK2, 1, "Смена ника", "{008E00}Отлично! Теперь введите ваш новый игровой ник:","ОК","Отмена");
		}//Смена ника - ввод старого пароля прежде чем вводить новый ник

		case DIALOG_CHANGENICK2:
		{//Смена ника - ввод нового ника
		    if (!response) return SendClientMessage(playerid,COLOR_RED,"Вы отменили смену ника.");
		    if (Player[playerid][GameGold] < 100) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 100GG");
		    if(!strcmp(PlayerName[playerid], inputtext, true)) return ShowPlayerDialog(playerid, DIALOG_CHANGENICK2, 1, "Смена ника", "{008E00}Отлично! Теперь введите ваш новый игровой ник:\n\n{FF0000}Ваш новый ник не отличается от старого!","ОК","Отмена");
		    if(!strlen(inputtext) || strlen(inputtext) < 3 || strlen(inputtext) > 20) return ShowPlayerDialog(playerid, DIALOG_CHANGENICK2, 1, "Смена ника", "{008E00}Отлично! Теперь введите ваш новый игровой ник:\n\n{FF0000}Длина ника должна быть от 3 до 20 символов!","ОК","Отмена");
		    new AllowNick = 1;
		    for (new i; i < strlen(inputtext); i++)
			{//Проверка каждого символа в нике на допустимость
			    if (inputtext[i] >= '0' && inputtext[i] <= '9') continue;
			    if (inputtext[i] >= 'A' && inputtext[i] <= 'Z') continue;
			    if (inputtext[i] >= 'a' && inputtext[i] <= 'z') continue;
			    if (inputtext[i] == '[' || inputtext[i] == ']') continue;
			    if (inputtext[i] == '(' || inputtext[i] == ')') continue;
			    if (inputtext[i] == '.' || inputtext[i] == '_') continue;
			    AllowNick = 0;
			}//Проверка каждого символа в нике на допустимость
			if (!AllowNick)  return ShowPlayerDialog(playerid, DIALOG_CHANGENICK2, 1, "Смена ника", "{008E00}Отлично! Теперь введите ваш новый игровой ник:\n\n{FF0000}Введенный вами ник содержит недопустимые символы!\n{008E00}Допустимые сиволы: {FFFFFF}A-Z, a-z, 0-9\n{008E00}А также символы:{FFFFFF} ( ) [ ] . _","ОК","Отмена");
            foreach(Player, cid) if(!strcmp(PlayerName[cid], inputtext, true)) return ShowPlayerDialog(playerid, DIALOG_CHANGENICK2, 1, "Смена ника", "{008E00}Отлично! Теперь введите ваш новый игровой ник:\n\n{FF0000}Аккаунт с таким именем уже существует!","ОК","Отмена");
			//----------------------------------------------------------------------------------------------------------
			new query[256],NewName[24];
			strmid(NewName, inputtext, 0, strlen(inputtext), 24);
			
            mysql_format(connects, query, sizeof(query), "SELECT `SID` FROM `accounts` WHERE `PName` = '%s' LIMIT 1", NewName);
			mysql_tquery(connects, query, "MysqlCheckNameBuyName", "ds", playerid, NewName);
   		}
   		
		case DIALOG_MYWEATHER:
		{//Настройки погоды
		    if (!response) return 1;
		    if (listitem == 0) return 1;//Оставить текущую погоду
		    if (listitem == 1){SendClientMessage(playerid,COLOR_YELLOW,"SERVER: Вы установили серверную (общую) погоду.");PlayerWeather[playerid] = -1;}
			if (listitem == 2) return ShowPlayerDialog(playerid, DIALOG_MYWEATHER2, 1, "Установить свою погоду", "{FFFFFF}Введите ID погоды (от {008D00}0 {FFFFFF}до {008D00}1000000)\n{AFAFAF}- По умолчанию на сервере используется погода с ID от 0 до 20\n- Погода с ID больше 20 может работать некорректно в некоторое время суток", "ОК", "Назад");
		}//Настройки погоды

		case DIALOG_MYWEATHER2:
		{//Установить свою погоду
		    if (!response) return ShowPlayerDialog(playerid, DIALOG_MYWEATHER, 2, "Настройки погоды", "Оставить текущую погоду\nУстановить серверную (общую) погоду\nУстановить свою погоду", "ОК", "");
			new entered = strval(inputtext);
			if (entered < 0 || entered > 1000000) return ShowPlayerDialog(playerid, DIALOG_MYWEATHER2, 1, "Установить свою погоду", "{FFFFFF}Введите ID погоды ({FF0000}от 0 {FFFFFF}до 1000000)\n{AFAFAF}- По умолчанию на сервере используется погода с ID от 0 до 20\n- Погода с ID больше 20 может работать некорректно в некоторое время суток", "ОК", "Назад");
		    PlayerWeather[playerid] = entered;
		    new String[140];format(String,sizeof(String),"SERVER: Вы установили погоду с ID %d",entered);
			return SendClientMessage(playerid,COLOR_YELLOW,String);
		}//Установить свою погоду

        case DIALOG_PRESTIGEGM:
		{//Режим Бога
		    if (!response) return 1;
		    if (InEvent[playerid] > 0) return 1; //защита от бага на спавн на ивентах
		    if (listitem == 0)
			{//Отключить режим Бога
                PrestigeGM[playerid] = 0; SetPlayerHealth(playerid, 100.0);
				SendClientMessage(playerid,0xFF0000FF,"Режим Бога деактивирован. Вы были автоматически зареспавнены.");
				LSpawnPlayer(playerid);
			}//Отключить режим Бога
			if (listitem == 1)
			{//Телепортироваться к маркеру GPS
			    if (GPSUsed[playerid] == 0) return SendClientMessage(playerid,COLOR_RED, "ОШИБКА: Сначала вам нужно установить маркер, используя {FFFFFF}/gps");
			    /*new Float: x, Float: y, Float: z; GetPlayerCheckpointPos(playerid, x, y, z);*/ SetPlayerPos(playerid, CoordsCP[playerid][0], CoordsCP[playerid][1], CoordsCP[playerid][2]); SetPlayerInterior(playerid, 0);
			}//Телепортироваться к маркеру GPS
			if (listitem == 2) return LSpawnPlayer(playerid); //Респавн
		}//Режим Бога

		case DIALOG_ACHANGE:
		{//Изменение соревнований
		    if (!response) return 1;
		    if (listitem == 0)
			{//Изменить десматч
			    if (DMTimer > 1 && DMTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= 20; id++)
			        {//цикл
			            if (DMid == id) format (StringX, sizeof StringX, "{FF8C00}%s (СЕЙЧАС ВЫБРАНО)\n", DMName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", DMName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEDM, 2, "{FF8C00}Изменить Десматч", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить десматч пока он не объявлен");
			}//Изменить десматч
			if (listitem == 1)
			{//Изменить дерби
			    if (DerbyTimer > 1 && DerbyTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_DERBYS; id++)
			        {//цикл
			            if (Derbyid == id) format (StringX, sizeof StringX, "{9966CC}%s (СЕЙЧАС ВЫБРАНО)\n", DerbyName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", DerbyName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEDERBY, 2, "{9966CC}Изменить Дерби", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить дерби пока оно не объявлено");
			}//Изменить дерби
			if (listitem == 2)
			{//Изменить зомби
			    if (ZMTimer > 1 && ZMTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_ZOMBIE; id++)
			        {//цикл
			            if (ZMid == id) format (StringX, sizeof StringX, "{FF6666}%s (СЕЙЧАС ВЫБРАНО)\n", ZMName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", ZMName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEZM, 2, "{FF6666}Изменить Зомби-Выживание", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить зомби-выживание пока оно не объявлено");
			}//Изменить зомби
			if (listitem == 3)
			{//Изменить гонку
			    if (FRTimer > 1 && FRTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[2048], StringX[100];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= 40; id++)
			        {//цикл
			            if (FRStart == id) format (StringX, sizeof StringX, "{007FFF}%s (СЕЙЧАС ВЫБРАНО)\n", FRName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", FRName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEFR, 2, "{007FFF}Изменить Гонку:{FFFFFF} Старт", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку пока она не объявлена");
			}//Изменить гонку
			if (listitem == 4)
			{//Изменить гангейм
			    if (GGTimer > 1 && GGTimer < 600)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= 20; id++)
			        {//цикл
			            if (GGid == id) format (StringX, sizeof StringX, "{FF6666}%s (СЕЙЧАС ВЫБРАНО)\n", GGName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", GGName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEGG, 2, "{FF6666}Изменить Гонку Вооружений", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку вооружений пока она не объявлена");
			}//Изменить гангейм
			if (listitem == 5)
			{//Изменить легенду
			    if (XRTimer > 1 && XRTimer < 600)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_XRACE; id++)
			        {//цикл
			            if (XRid == id) format (StringX, sizeof StringX, "{007FFF}%s (СЕЙЧАС ВЫБРАНО)\n", XRName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", XRName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEXR, 2, "{007FFF}Изменить Легендарную Гонку", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить легендарную гонку пока она не объявлена");
			}//Изменить легенду
			if (listitem == 6)
			{//Изменить ctf
			    if (TDMTimer > 1 && TDMTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_TDM; id++)
			        {//цикл
			            if (TDMid == id) format (StringX, sizeof StringX, "{04B486}%s (СЕЙЧАС ВЫБРАНО)\n", TDMName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", TDMName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEFLAG, 2, "{04B486}Изменить командный дм", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить битву пока она не объявлена");
			}//Изменить ctf
			if (listitem == 7)
			{//Изменить паркур
			    if (PRTimer > 1 && PRTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[2048], StringX[100];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_PARK; id++)
			        {//цикл
			            if (PRid == id) format (StringX, sizeof StringX, "{58FAF4}%s (СЕЙЧАС ВЫБРАНО)\n", PRName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", PRName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEPR, 2, "{58FAF4}Изменить паркур", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить паркур пока он не объявлен");
			}//Изменить паркур
			if (listitem == 8)
			{//Изменить ГВ
			    if (DRTimer > 1 && DRTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_DRACE; id++)
			        {//цикл
			            if (DRid == id) format (StringX, sizeof StringX, "{4C73E6}%s (СЕЙЧАС ВЫБРАНО)\n", DRName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", DRName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEDRACE, 2, "{4C73E6}Изменить гонку на выживание", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку пока она не объявлена");
			}//Изменить ГВ
			/*if (listitem == 9)
			{//Изменить ctf
			    if (PDMTimer > 1 && PDMTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[1024], StringX[80];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= MAX_PDM; id++)
			        {//цикл
			            if (PDMid == id) format (StringX, sizeof StringX, "{04B486}%s (СЕЙЧАС ВЫБРАНО)\n", PDMName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", PDMName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEFLAG, 2, "{04B486}Изменить командный дм", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить битву пока она не объявлена");
			}//Изменить ctf*/
		}//Изменение соревнований

		case DIALOG_ACHANGEDM:
		{//Изменение десматча
		    if (!response) return ChangeDialog(playerid);
		    if (DMTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить десматч пока он не объявлен");
		    if (listitem == 0) listitem = random(MAX_DM) + 1;
		    if (listitem == DMid) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Эта карта уже выбрана.");
		    if (listitem < 1 || listitem > MAX_DM) return 1;
			if (DMTimer > 2 && DMTimer < 300)
			{
				new String[140];
				DMid = listitem;PrevDM = listitem;
				format(String,sizeof(String),"Десматч был изменен на <<{FFFFFF}%s{FF8C00}>>",DMName[DMid]);
				SendClientMessageToAll(COLOR_DM,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение десматча

		case DIALOG_ACHANGEDERBY:
		{//Изменение дерби
		    if (!response) return ChangeDialog(playerid);
		    if (DerbyTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить дерби пока оно не объявлено");
		    if (listitem == 0) listitem = random(MAX_DERBYS) + 1;
		    if (listitem == Derbyid) return 1;
            if (listitem < 1 || listitem > MAX_DERBYS) return 1;
            if (DerbyTimer > 2 && DerbyTimer < 300)
			{
				new String[140];Derbyid = listitem;PrevDerby = listitem;
				format(String,sizeof(String),"Дерби было изменено на <<{FFFFFF}%s{9966CC}>>",DerbyName[Derbyid]);
				SendClientMessageToAll(COLOR_DERBY,String);
			
				//Выбор модели авто для дерби, где оно у всех одинаковое
				if (Derbyid == 1) {new modelid = random(123);DerbyModelAll = DerbyCars[modelid];}
				if (Derbyid == 3) {new modelid = random(76);DerbyModelAll = DerbyCars2[modelid];}
				if (Derbyid == 7) {new modelid = random(76);DerbyModelAll = DerbyCars2[modelid];}
				if (Derbyid == 9) DerbyModelAll = 432; //World Of Tanks
				if (Derbyid == 10) DerbyModelAll = 557;
				if (Derbyid == 11) {new modelid = random(76);DerbyModelAll = DerbyCars2[modelid];}
				if (Derbyid == 12) DerbyModelAll = 411;
				if (Derbyid == 13) DerbyModelAll = 489;
				if (Derbyid == 15) DerbyModelAll = 530;
				if (Derbyid == 18) DerbyModelAll = 430;
				//if (Derbyid == 19) DerbyModelAll = 565;
				for(new cid = 0; cid < MAX_PLAYERS; cid++) DerbyModelCar[cid] = DerbyModelAll; //обязательно обычный for
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение дерби

		case DIALOG_ACHANGEZM:
		{//Изменение зомби
		    if (!response) return ChangeDialog(playerid);
		    if (ZMTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить зомби-выживание пока оно не объявлено");
		    if (listitem == 0) listitem = random(MAX_ZOMBIE) + 1;
		    if (listitem == ZMid) return 1;
		    if (listitem < 1 || listitem > MAX_ZOMBIE) return 1;
            if (ZMTimer > 2 && ZMTimer < 300)
			{
				new String[140];ZMid = listitem;PrevZM = listitem;
				format(String,sizeof(String),"Зомби-Выживание было изменено на <<{FFFFFF}%s{E60020}>>",ZMName[ZMid]);
				SendClientMessageToAll(COLOR_ZOMBIE,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение зомби

		case DIALOG_ACHANGEFR:
		{//Изменение гонки: Старт
		    if (!response) return ChangeDialog(playerid);
		    if (FRTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку пока она не проявлена");
		    if (FRTimer > 2 && FRTimer <= 30) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку так как до старта осталось меньше 30 секунд");
 		    if (listitem == 0) listitem = random(40) + 1;
		    ACHANGEFR[playerid] = listitem;
            new String[2048], StringX[100];String = "{FFFF00}Случайный выбор\n";
			for (new id = 1; id <= 40; id++)
			{//цикл
				if (FRFinish == id) format (StringX, sizeof StringX, "{007FFF}%s (СЕЙЧАС ВЫБРАНО)\n", FRName[id]);
				else format (StringX, sizeof StringX, "{FFFFFF}%s\n", FRName[id]);
				strcat(String, StringX);
			}//цикл
			return ShowPlayerDialog(playerid, DIALOG_ACHANGEFR2, 2, "{007FFF}Изменить Гонку:{FFFFFF} Финиш", String, "ОК", "Назад");
		}//Изменение гонки: Старт

		case DIALOG_ACHANGEFR2:
		{//Изменение гонки: Финиш
		    if (!response)
		    {//Нажали кнопку назад (возврат к выбору старта гонки)
                if (FRTimer > 1 && FRTimer < 300)
			    {//Соревнование доступно для изменения (объявлено и еще не стартовало)
			        new String[2048], StringX[100];String = "{FFFF00}Случайный выбор\n";
			        for (new id = 1; id <= 40; id++)
			        {//цикл
			            if (FRStart == id) format (StringX, sizeof StringX, "{007FFF}%s (СЕЙЧАС ВЫБРАНО)\n", FRName[id]);
			            else format (StringX, sizeof StringX, "{FFFFFF}%s\n", FRName[id]);
						strcat(String, StringX);
			        }//цикл
			        return ShowPlayerDialog(playerid, DIALOG_ACHANGEFR, 2, "{007FFF}Изменить Гонку:{FFFFFF} Старт", String, "ОК", "Отмена");
			    }//Соревнование доступно для изменения (объявлено и еще не стартовало)
			    else return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку пока она не объявлена");
		    }//Нажали кнопку назад (возврат к выбору старта гонки)
		    
		    if (FRTimer > 2 && FRTimer <= 30) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку так как до старта осталось меньше 30 секунд");
		    
		    if (listitem == 0) listitem = random(40) + 1;

			if (FRStart == ACHANGEFR[playerid] && FRFinish == listitem) return 1;
			
			if (FRTimer > 2 && FRTimer < 300)
			{
				if (ACHANGEFR[playerid] < 1 || listitem < 1 || ACHANGEFR[playerid] > 40 || listitem > 40) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Один из [id] указан неверно (используйте значения 1 до 40)");
				if (ACHANGEFR[playerid] == listitem) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Старт и финиш гонки не может быть в одном и том же месте");
				
				foreach(Player, cid) if (JoinEvent[cid] == EVENT_RACE) LeaveEvent(cid,EVENT_RACE);//
				new String[140];
				FRStart = ACHANGEFR[playerid];
				PrevFRStart = ACHANGEFR[playerid];
				FRFinish = listitem;
				PrevFRFinish = listitem;
				format(String,sizeof(String),"Гонка была изменена. Старт: {FFFFFF}%s{007FFF}. Финиш: {FFFFFF}%s{007FFF}.",FRName[FRStart], FRName[FRFinish]);
				SendClientMessageToAll(COLOR_RACE,String);
				if (Player[playerid][Admin] < 3) Player[playerid][EventChangeTime] = unixtime+3600;
                new string[140];
				format(string, sizeof string, "%d.%d.%d в %d:%d:%d |   ADMIN: %s[%d] сменил гонку: %s - %s", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, FRName[FRStart], FRName[FRFinish]);
				WriteLog("GlobalLog", string);
				WriteLog("Admin", string);
				return 1;
			}
		    
		    Player[playerid][EventChangeTime] = unixtime+3600;
		}//Изменение гонки: Финиш

		case DIALOG_ACHANGEGG:
		{//Изменение гангейма
		    if (!response) return ChangeDialog(playerid);
		    if (GGTimer > 599){GGTimer = 601; return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку вооружений пока она не объявлена");}
		    if (listitem == 0) listitem = random(MAX_GG) + 1;
		    if (listitem < 1 || listitem > MAX_GG) return 1;
		    if (listitem == GGid) return 1;
            if (GGTimer > 2 && GGTimer < 600)
			{
				new String[140];GGid = listitem;PrevGGid = listitem;
				format(String,sizeof(String),"Гонка Вооружений была изменена на <<{FFFFFF}%s{FF6347}>>",GGName[GGid]);
				SendClientMessageToAll(COLOR_GG,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение гангейма

		case DIALOG_ACHANGEXR:
		{//Изменение легенды
		    if (!response) return ChangeDialog(playerid);
		    if (XRTimer > 599) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить  легендарную гонку пока она не объявлена");
     		if (XRTimer > 2 && XRTimer <= 30) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить легендарную гонку так как до старта осталось меньше 30 секунд");
			if (listitem == 0) listitem = random(MAX_XRACE) + 1;
			if (listitem < 1 || listitem > MAX_XRACE) return 1;
		    if (listitem == XRid) return 1;
            if (XRTimer > 2 && XRTimer < 600)
			{
			    new String[140];XRid = listitem; PrevXRid = listitem;
				format(String,sizeof(String),"Легендарная Гонка была изменена на <<{FFFFFF}%s{FFD700}>>",XRName[XRid]);
                SendClientMessageToAll(COLOR_XR,String);
                Player[playerid][EventChangeTime] = unixtime+3600;
                
                foreach(Player, cid)
				{//цикл
					if (JoinEvent[cid] == EVENT_XRACE){LeaveEvent(cid,EVENT_XRACE);}
				}//цикл
				
				switch(listitem)
				{//switch
				case 1:
				{
					XRCPs = 32;//кол-во чекпоинтов вместе со стартом и финишем
					new xrmodel;
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					for(new i = 1; i < XRCPs; i+=3)
					{//определение транспорта для чеков
						xrmodel = random(20);XRCarCP[i] = XRCars9[xrmodel];
					}//определение транспорта для чеков
					XRCarCP[0] = 448;
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 2:
				{
					XRCPs = 30;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
					XRCarCP[0] = 473;//старт обязательно на надувной лодке
					XRCarCP[1] = 446;//squallo на первом чеке
				}
				case 3:
				{
					XRCPs = 23;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRTypeCP[XRCPs-1] = 4;//воздушный финиш
					XRCarCP[0] = 461;//старт на PCJ
					XRCarCP[3] = 513;XRCarCP[4] = 451;XRCarCP[10] = 568;XRCarCP[21] = 513;//stuntplane, turismo, bandito, stuntplane
					XRTypeCP[3] = 3;XRTypeCP[4] = 3;XRTypeCP[21] = 3;//Воздушные чекпоинты
				}
				case 4:
				{
					XRCPs = 23;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
					XRCarCP[0] = 541;//старт на Bullet
					XRCarCP[9] = 541;//bullet
					XRCarCP[5] = 473;XRCarCP[16] = 473;//надувные лодки
					XRCarCP[6] = 446;XRCarCP[17] = 446;//squallo
					XRTypeCP[5] = 3;XRTypeCP[16] = 3;//воздушные чекпоинты
				}
				case 5:
				{
					XRCPs = 62;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					new xrmodel;
					for(new i = 1; i < XRCPs; i+=4)
					{//чеки смены транспорта
						xrmodel = random(126);XRCarCP[i] = XRCars1[xrmodel];
					}//чеки смены транспорта
					XRCarCP[0] = 471;//старт на квадрацикле
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 6:
				{
					XRCPs = 35;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
					XRCarCP[0] = 441;//старт на RC Bandit
					XRCarCP[22] = 441;XRCarCP[23] = 464;//RC на крыше гаража
					XRCarCP[2] = 559;XRCarCP[8] = 522;XRCarCP[12] = 560;XRCarCP[28] = 562;//Jester, NRG, Sultan, Elegy
					XRTypeCP[23] = 3;XRTypeCP[24] = 3;XRTypeCP[25] = 3;XRTypeCP[26] = 3;XRTypeCP[27] = 3;//воздушные чекпоинты
				}
				case 7:
				{
					XRCPs = 23;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 3;//воздушные чеки
					}//определение транспорта для чеков
					XRTypeCP[XRCPs-1] = 4;//воздушный финиш
					XRCarCP[0] = 461;//старт на PCJ
					XRCarCP[1] = 464;XRCarCP[4] = 464;XRCarCP[8] = 464;XRCarCP[10] = 464;//RC
					XRCarCP[2] = 513;XRCarCP[5] = 513;XRCarCP[9] = 513;XRCarCP[12] = 513;//StuntPlane
				}
				case 8:
				{
					XRCPs = 43;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//обычные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 471;//старт на квадрацикле
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
					XRTypeCP[1] = 3;//воздушный чек вортекса
					XRCarCP[1] = 539;XRCarCP[2] = 560;XRCarCP[29] = 495;//Vortex, Sultan, SandKing
				}
				case 9:
				{
					XRCPs = 29;new xrmodel;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						if(i == 1 || i == 7 || i == 15 || i == 24){xrmodel = random(20);XRCarCP[i] = XRCars9[xrmodel];}//чеки смены авто
						XRTypeCP[i] = 0;//обычные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 521;//стартовый транспорт
					XRTypeCP[XRCPs-1] = 1;XRTypeCP[22] = 3;//наземный финиш и круглый чек при прыжке в воду
					XRCarCP[22] = 473;//Надувная лодка
				}
				case 10:
				{
					XRCPs = 25;new xrmodel;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						if(i == 1 || i == 5 || i == 15 || i == 17){xrmodel = random(20);XRCarCP[i] = XRCars9[xrmodel];}//чеки смены авто
						XRTypeCP[i] = 0;//обычные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 509;//стартовый транспорт
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 11:
				{
					XRCPs = 35;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//обычные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 468;//стартовый транспорт - Sanchez
					XRCarCP[10] = 471;//cp 10 - Quad
					XRCarCP[21] = 444;//cp 21 - Monster
					XRCarCP[31] = 468;//cp 31 - Sanchez

					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 12:
				{
					XRCPs = 10; new xrmodel;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 522;
					xrmodel = random(20);XRCarCP[1] = XRCars9[xrmodel];
					xrmodel = random(20);XRCarCP[6] = XRCars9[xrmodel];
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 13:
				{
					XRCPs = 30;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 461; //стартовое авто
					XRCarCP[1] = 411; //infernus на первом чеке
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 14:
				{
					XRCPs = 66;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					new xrmodel;
					for(new i = 4; i < XRCPs; i+=4)
					{//чеки смены транспорта
						xrmodel = random(126);XRCarCP[i] = XRCars1[xrmodel];
					}//чеки смены транспорта
					XRCarCP[0] = 471;//старт на квадрацикле
					XRTypeCP[XRCPs-1] = 4;//воздушный финиш
				}
				case 15:
				{
					XRCPs = 54;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 510; //стартовое авто
					XRCarCP[5] = 562; //elegy на пятом чеке
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 16:
				{
					XRCPs = 36;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 468;//старт на sanchez
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 17:
				{
					XRCPs = 34;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						if (5 <= i <= 32) XRTypeCP[i] = 3; //воздушные чеки
						else XRTypeCP[i] = 0; //наземные чеки
						XRCarCP[i] = -1;//без трансформации
					}//определение транспорта для чеков
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
					XRCarCP[0] = 481; XRCarCP[32] = 481;//BMX
					XRCarCP[5] = 464;//RC
					XRCarCP[8] = 476;//Rustler
				}
				case 18:
				{
					XRCPs = 23;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					new xrmodel;
					xrmodel = random(20);XRCarCP[3] = XRCars9[xrmodel];
					xrmodel = random(20);XRCarCP[14] = XRCars9[xrmodel];
					XRCarCP[0] = 468; XRCarCP[21] = 468;//sanchez
					XRTypeCP[XRCPs-1] = 4;//воздушный финиш
				}
				case 19:
				{
					XRCPs = 37;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					new xrmodel;
					xrmodel = random(20);XRCarCP[1] = XRCars9[xrmodel];
					xrmodel = random(20);XRCarCP[13] = XRCars9[xrmodel];
					xrmodel = random(20);XRCarCP[25] = XRCars9[xrmodel];
					XRCarCP[0] = 571;//kart
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 20:
				{
					XRCPs = 33;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//наземные чеки
					}//определение транспорта для чеков
					new xrmodel;
					for(new i = 1; i < XRCPs; i+=6)
					{//определение транспорта для чеков
						xrmodel = random(20);XRCarCP[i] = XRCars9[xrmodel];
					}//определение транспорта для чеков
					XRCarCP[0] = 522;//nrg
					XRTypeCP[XRCPs-1] = 1;//наземный финиш
				}
				case 21:
				{
					XRCPs = 22;//кол-во чекпоинтов вместе со стартом и финишем
					for(new i = 0; i < XRCPs; i++)
					{//определение транспорта для чеков
						XRCarCP[i] = -1;//без трансформации
						XRTypeCP[i] = 0;//обычные чеки
					}//определение транспорта для чеков
					XRCarCP[0] = 522;//стартовый транспорт - nrg 500
					XRCarCP[1] = 411;//cp 1 - infernus
					XRCarCP[3] = 446;//cp 3 - squalo
					XRCarCP[5] = 541;//cp 5 - bullet
					XRCarCP[8] = 522;//cp 8 - nrg 500

					XRTypeCP[XRCPs-1] = 1;//наземный финиш
					XRTypeCP[3] = 3;
				}
				
				}//switch
			}
			return 1;
		}//Изменение легенды
		
		case DIALOG_ACHANGEFLAG:
		{//Изменение ctf
		    if (!response) return ChangeDialog(playerid);
		    if (TDMTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить TDM - он не объявлен!");
		    if (listitem == 0) listitem = random(MAX_TDM) + 1;
		    if (listitem < 1 || listitem > MAX_TDM) return 1;
		    if (listitem == TDMid) return 1;
		    if (TDMTimer > 2 && TDMTimer < 300)
			{
				new String[140];TDMid = listitem;PrevTDM = listitem;
				format(String,sizeof(String),"Командный десматч был изменен на <<{FFFFFF}%s{04B486}>>",TDMName[TDMid]);
				SendClientMessageToAll(COLOR_TDM,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение ctf
		/*
		case DIALOG_ACHANGEPDM:
		{//Изменение ctf
		    if (!response) return ChangeDialog(playerid);
		    if (PDMTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить PDM - он не объявлен!");
		    if (listitem == 0) listitem = random(MAX_PDM) + 1;
		    if (listitem < 1 || listitem > MAX_PDM) return 1;
		    if (listitem == PDMid) return 1;
		    if (PDMTimer > 2 && PDMTimer < 300)
			{
				new String[140];PDMid = listitem;PrevPDM = listitem;
				format(String,sizeof(String),"Командный десматч был изменен на <<{FFFFFF}%s{04B486}>>",PDMName[PDMid]);
				SendClientMessageToAll(COLOR_PDM,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение ctf
		*/
        case DIALOG_ACHANGEPR:
		{//Изменение паркур
		    if (!response) return ChangeDialog(playerid);
		    if (PRTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить паркур пока он не объявлен");
		    if (listitem == 0) listitem = random(MAX_PARK) + 1;
		    if (listitem < 1 || listitem > MAX_PARK) return 1;
		    if (listitem == PRid) return 1;
            if (PRTimer > 2 && PRTimer < 300)
			{
				new String[140];PRid = listitem;PrevPR = listitem;
				format(String,sizeof(String),"Паркур был изменен на <<{FFFFFF}%s{58FAF4}>>",PRName[PRid]);
				SendClientMessageToAll(COLOR_PARK,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
			}
			return 1;
		}//Изменение паркур
		
		case DIALOG_ACHANGEDRACE:
		{//Изменение ГВ
		    if (!response) return ChangeDialog(playerid);
		    if (DRTimer > 300) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Нельзя изменить гонку на выживание пока она не объявлена");
		    if (listitem == 0) listitem = random(MAX_DRACE) + 1;
		    if (listitem < 1 || listitem > MAX_DRACE) return 1;
		    if (listitem == DRid) return 1;
            if (DRTimer > 2 && DRTimer < 300)
			{
				new String[140];DRid = listitem;PrevDR = listitem;
				format(String,sizeof(String),"Гонка на выживание была изменена на <<{FFFFFF}%s{4C73E6}>>",DRName[DRid]);
				SendClientMessageToAll(COLOR_DRACE,String);
				Player[playerid][EventChangeTime] = unixtime+3600;
				SetRandomGVVeh();
			}
		}//Изменение ГВ

		case DIALOG_TURBOSPEED:
		{//Автомастерская TurboSpeed
		    if (response)
		    {
		    	if (listitem == 0) ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDNITRO, 2, "Нитро", "[{FFFF00}50 000${FFFFFF}] Бесконечное Нитро\n[{FFFF00}300 000${FFFFFF}] UberNitro", "ОК", "Назад");
				if (listitem == 1) ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDNEON, 2, "Неон", "[{FFFF00}50 000${FFFFFF}] Красный\n[{FFFF00}50 000${FFFFFF}] Синий\n[{FFFF00}50 000${FFFFFF}] Зеленый\n[{FFFF00}50 000${FFFFFF}] Желтый\n[{FFFF00}50 000${FFFFFF}] Розовый\n[{FFFF00}50 000${FFFFFF}] Белый", "ОК", "Назад");
				if (listitem == 2) ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDFIRE, 0, "Подтверждение:", "{ffffff}Вы действительно хотите приобрести '{ff0000}Огненные колеса{ffffff}' за {00ff00}500.000$?", "ДА", "НЕТ");
                if (listitem == 3) ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDSIR, 0, "Подтверждение:", "{ffffff}Вы действительно хотите приобрести '{ff0000}Сирена{ffffff}' за {00ff00}100.000$?", "ДА", "НЕТ");
                if (listitem == 4) ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDMIG, 2, "Выбор мигалки", "[{FFFF00}Тип 1{FFFFFF}] Большая красно-синяя\n[{FFFF00}Тип 2{FFFFFF}] Малая красно-синяя\n[{FFFF00}Тип 3{FFFFFF}] Двойная красная\n[{FFFF00}Тип 4{FFFFFF}] Круглая маленькая", "ОК", "Назад");
                if (listitem == 5) ShowModelSelectionMenu(playerid, MenuCarWheels, "Wheels");
				if (listitem == 6)
				{//Удалить компонент тюнинга
				    if (Player[playerid][CarActive] < 1 || Player[playerid][CarActive] > 2) return SendClientMessage(playerid,COLOR_RED,"Удалять компоненты тюнинга можно только с личных автомобилей!");
				    new StringZ[1024];
				    if (Player[playerid][CarActive] == 1)
				    {//Класс 1
  				   		if (Player[playerid][CarSlot1Component0] == 0) strcat(StringZ, "{AFAFAF}Спойлер\n"); else strcat(StringZ, "{FFFFFF}Спойлер\n");
  				   		if (Player[playerid][CarSlot1Component1] == 0) strcat(StringZ, "{AFAFAF}Капот\n"); else strcat(StringZ, "{FFFFFF}Капот\n");
  				   		if (Player[playerid][CarSlot1Component2] == 0) strcat(StringZ, "{AFAFAF}Крыша\n"); else strcat(StringZ, "{FFFFFF}Крыша\n");
  				   		if (Player[playerid][CarSlot1Component3] == 0) strcat(StringZ, "{AFAFAF}Боковые юбки\n"); else strcat(StringZ, "{FFFFFF}Боковые юбки\n");
  				   		if (Player[playerid][CarSlot1Component4] == 0) strcat(StringZ, "{AFAFAF}Фары\n"); else strcat(StringZ, "{FFFFFF}Фары\n");
  				   		if (Player[playerid][CarSlot1Component5] == 0) strcat(StringZ, "{AFAFAF}Нитро\n"); else strcat(StringZ, "{FFFFFF}Нитро\n");
  				   		if (Player[playerid][CarSlot1Component6] == 0) strcat(StringZ, "{AFAFAF}Выхлопная труба\n"); else strcat(StringZ, "{FFFFFF}Выхлопная труба\n");
  				   		if (Player[playerid][CarSlot1Component7] == 0) strcat(StringZ, "{AFAFAF}Диски\n"); else strcat(StringZ, "{FFFFFF}Диски\n");
  				   		if (Player[playerid][CarSlot1Component8] == 0) strcat(StringZ, "{AFAFAF}Стерео\n"); else strcat(StringZ, "{FFFFFF}Стерео\n");
  				   		if (Player[playerid][CarSlot1Component9] == 0) strcat(StringZ, "{AFAFAF}Гидравлика\n"); else strcat(StringZ, "{FFFFFF}Гидравлика\n");
  				   		if (Player[playerid][CarSlot1Component10] == 0) strcat(StringZ, "{AFAFAF}Передний бампер\n"); else strcat(StringZ, "{FFFFFF}Передний бампер\n");
  				   		if (Player[playerid][CarSlot1Component11] == 0) strcat(StringZ, "{AFAFAF}Задний бампер\n"); else strcat(StringZ, "{FFFFFF}Задний бампер\n");
  				   		if (Player[playerid][CarSlot1Component12] == 0) strcat(StringZ, "{AFAFAF}Правый вент\n"); else strcat(StringZ, "{FFFFFF}Правый вент\n");
  				   		if (Player[playerid][CarSlot1Component13] == 0) strcat(StringZ, "{AFAFAF}Левый вент\n"); else strcat(StringZ, "{FFFFFF}Левый вент\n");
  				   		if (Player[playerid][CarSlot1PaintJob] == -1) strcat(StringZ, "{AFAFAF}Покрасочные работы\n"); else strcat(StringZ, "{FFFFFF}Покрасочные работы\n");
  				   		if (Player[playerid][CarSlot1Neon] == 0) strcat(StringZ, "{AFAFAF}Неон\n"); else strcat(StringZ, "{FFFFFF}Неон\n");
  				   		if (Player[playerid][CarSlot1Fire] == 0) strcat(StringZ, "{AFAFAF}Огненные колеса\n"); else strcat(StringZ, "{FFFFFF}Огненные колеса\n");
  				   		if (Player[playerid][CarSlot1Sir] == 0) strcat(StringZ, "{AFAFAF}Сирена\n"); else strcat(StringZ, "{FFFFFF}Сирена\n");
  				   		if (Player[playerid][CarSlot1Mig] == 0) strcat(StringZ, "{AFAFAF}Мигалка\n"); else strcat(StringZ, "{FFFFFF}Мигалка\n");
						return ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDDELETE, 2, "Удалить компонент", StringZ, "Удалить", "Назад");
					}//Класс 1
  				    if (Player[playerid][CarActive] == 2)
				    {//Класс 2
				        if (Player[playerid][CarSlot2Component0] == 0) strcat(StringZ, "{AFAFAF}Спойлер\n"); else strcat(StringZ, "{FFFFFF}Спойлер\n");
  				   		if (Player[playerid][CarSlot2Component1] == 0) strcat(StringZ, "{AFAFAF}Капот\n"); else strcat(StringZ, "{FFFFFF}Капот\n");
  				   		if (Player[playerid][CarSlot2Component2] == 0) strcat(StringZ, "{AFAFAF}Крыша\n"); else strcat(StringZ, "{FFFFFF}Крыша\n");
  				   		if (Player[playerid][CarSlot2Component3] == 0) strcat(StringZ, "{AFAFAF}Боковые юбки\n"); else strcat(StringZ, "{FFFFFF}Боковые юбки\n");
  				   		if (Player[playerid][CarSlot2Component4] == 0) strcat(StringZ, "{AFAFAF}Фары\n"); else strcat(StringZ, "{FFFFFF}Фары\n");
  				   		if (Player[playerid][CarSlot2Component5] == 0) strcat(StringZ, "{AFAFAF}Нитро\n"); else strcat(StringZ, "{FFFFFF}Нитро\n");
  				   		if (Player[playerid][CarSlot2Component6] == 0) strcat(StringZ, "{AFAFAF}Выхлопная труба\n"); else strcat(StringZ, "{FFFFFF}Выхлопная труба\n");
  				   		if (Player[playerid][CarSlot2Component7] == 0) strcat(StringZ, "{AFAFAF}Диски\n"); else strcat(StringZ, "{FFFFFF}Диски\n");
  				   		if (Player[playerid][CarSlot2Component8] == 0) strcat(StringZ, "{AFAFAF}Стерео\n"); else strcat(StringZ, "{FFFFFF}Стерео\n");
  				   		if (Player[playerid][CarSlot2Component9] == 0) strcat(StringZ, "{AFAFAF}Гидравлика\n"); else strcat(StringZ, "{FFFFFF}Гидравлика\n");
  				   		if (Player[playerid][CarSlot2Component10] == 0) strcat(StringZ, "{AFAFAF}Передний бампер\n"); else strcat(StringZ, "{FFFFFF}Передний бампер\n");
  				   		if (Player[playerid][CarSlot2Component11] == 0) strcat(StringZ, "{AFAFAF}Задний бампер\n"); else strcat(StringZ, "{FFFFFF}Задний бампер\n");
  				   		if (Player[playerid][CarSlot2Component12] == 0) strcat(StringZ, "{AFAFAF}Правый вент\n"); else strcat(StringZ, "{FFFFFF}Правый вент\n");
  				   		if (Player[playerid][CarSlot2Component13] == 0) strcat(StringZ, "{AFAFAF}Левый вент\n"); else strcat(StringZ, "{FFFFFF}Левый вент\n");
  				   		if (Player[playerid][CarSlot2PaintJob] == -1) strcat(StringZ, "{AFAFAF}Покрасочные работы\n"); else strcat(StringZ, "{FFFFFF}Покрасочные работы\n");
  				   		if (Player[playerid][CarSlot2Neon] == 0) strcat(StringZ, "{AFAFAF}Неон\n"); else strcat(StringZ, "{FFFFFF}Неон\n");
  				   		if (Player[playerid][CarSlot2Fire] == 0) strcat(StringZ, "{AFAFAF}Огненные колеса\n"); else strcat(StringZ, "{FFFFFF}Огненные колеса\n");
  				   		if (Player[playerid][CarSlot2Sir] == 0) strcat(StringZ, "{AFAFAF}Сирена\n"); else strcat(StringZ, "{FFFFFF}Сирена\n");
  				   		if (Player[playerid][CarSlot2Mig] == 0) strcat(StringZ, "{AFAFAF}Мигалка\n"); else strcat(StringZ, "{FFFFFF}Мигалка\n");
                        return ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDDELETE, 2, "Удалить компонент", StringZ, "Удалить", "Назад");
				    }//Кдасс 2
				}//Удалить компонент тюнинга
				if (listitem == 7)
				{
				    if (Player[playerid][CarActive] != 2) {SendClientMessage(playerid,COLOR_GREY,"Доступно только для 2 класса!"); ShowPlayerTSDialog(playerid); return 1;}
				    if(Player[playerid][Type] < 1) return SendClientMessage(playerid,COLOR_GREY,"Недоступно.");
					new VehicleMD = GetVehicleModel(GetPlayerVehicleID(playerid)), bool:sucs=false;
					for(new i;i<MAX_VINCARS;i++)
					{
					    if(VehicleMD == VinilPos[i][CarType])
					    {
					        ShowPlayerDialog(playerid, DIALOG_TSVINIL, 1, "Введите текст для винила", "{FFFFFF}Введите текст для винила.\n{008E00}[Длина от 5 до 25 символов]\n\n{ffffff}Оставьте поле пустым, чтобы удалить винил.", "Создать", "Отмена");
							sucs=true;
							break;
						}
					}
                    if(!sucs) SendClientMessage(playerid,COLOR_GREY,"Винилы недоступны для этой модели.");
					return true;
				}
			}
		}//Автомастерская TurboSpeed
		
		case DIALOG_TSVINIL:
		{
		    if (!response) return ShowPlayerTSDialog(playerid);
		    if (Player[playerid][CarActive] != 2) {SendClientMessage(playerid,COLOR_GREY,"Доступно только для 2 класса!"); ShowPlayerTSDialog(playerid); return 1;}
		    if(!strlen(inputtext))
		    {
		        if(!strcmp(Player[playerid][Vinil], "Null")) {ShowPlayerTSDialog(playerid); SendClientMessage(playerid,COLOR_GREY,"У вас не установлены винилы!"); return 1;}
		        new vehicleid = GetPlayerVehicleID(playerid);
		        strmid(Player[playerid][Vinil], "Null", 0, strlen("Null"), 30);
		    	if (VVinil[vehicleid][0] != -1){DestroyDynamicObject(VVinil[vehicleid][0]);VVinil[vehicleid][0] = -1;}
				if (VVinil[vehicleid][1] != -1){DestroyDynamicObject(VVinil[vehicleid][1]);VVinil[vehicleid][1] = -1;}
				
				new query[100];
				mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Vinil` = 'Null' WHERE `SID` = '%d'",Player[playerid][SID]);
				mysql_tquery(connects, query);
				return 1;
			}
			if(strlen(inputtext) < 5 || strlen(inputtext) > 25) return ShowPlayerDialog(playerid, DIALOG_TSVINIL, 1, "Введите текст для винила", "{ff0000}Ошибка! Неверная длина текста!\n{FFFFFF}Введите текст для винила.\n{008E00}[Длина от 5 до 25 символов]\n\n{ffffff}Оставьте поле пустым, чтобы удалить винил.", "Создать", "Отмена");

			new AllowName = 1;
   			for (new i; i < strlen(inputtext); i++)
			{
   				if (inputtext[i] >= '0' && inputtext[i] <= '9') continue;
			    if (inputtext[i] >= 'A' && inputtext[i] <= 'Z') continue;
			    if (inputtext[i] >= 'a' && inputtext[i] <= 'z') continue;
			    if (inputtext[i] >= 'а' && inputtext[i] <= 'я') continue;
			    if (inputtext[i] >= 'А' && inputtext[i] <= 'Я') continue;
       			if (inputtext[i] == '_') continue;
       			if (inputtext[i] == '}') continue;
                if (inputtext[i] == '{') continue;
                if (inputtext[i] == '.') continue;
                if (inputtext[i] == '-') continue;
   				AllowName = 0;
			}
			if (!AllowName) return ShowPlayerDialog(playerid, DIALOG_TSVINIL, 1, "Введите текст для винила", "{ff0000}Ошибка! Вводить можно цифры, буквы и цвета в формате {RRGGBB}!\n{FFFFFF}Введите текст для винила.\n{008E00}[Длина от 5 до 25 символов]\n\n{ffffff}Оставьте поле пустым, чтобы удалить винил.", "Создать", "Отмена");
            new vehicleid = GetPlayerVehicleID(playerid);
			strmid(Player[playerid][Vinil], inputtext, 0, strlen(inputtext), 30);
			if (VVinil[vehicleid][0] != -1){DestroyDynamicObject(VVinil[vehicleid][0]);VVinil[vehicleid][0] = -1;}
			if (VVinil[vehicleid][1] != -1){DestroyDynamicObject(VVinil[vehicleid][1]);VVinil[vehicleid][1] = -1;}
			
			CreateVehVinil(playerid, vehicleid);
			
			new query[120];
			mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Vinil` = '%s' WHERE `SID` = '%d'", inputtext, Player[playerid][SID]);
			mysql_tquery(connects, query);

			return true;
		}

		case DIALOG_TURBOSPEEDDELETE:
		{//Автомастерская TurboSpeed - Удалить компонент
		    if (!response) return ShowPlayerTSDialog(playerid);
			if (Player[playerid][CarActive] == 1)
			{//Класс 1
				if (listitem == 0)
				{
				    if (Player[playerid][CarSlot1Component0] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен спойлер");
					Player[playerid][CarSlot1Component0] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 0);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Спойлер удален");
				}
				if (listitem == 1)
				{
				    if (Player[playerid][CarSlot1Component1] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен капот");
					Player[playerid][CarSlot1Component1] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 1);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Капот удален");
				}
				if (listitem == 2)
				{
				    if (Player[playerid][CarSlot1Component2] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена крыша");
					Player[playerid][CarSlot1Component2] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 2);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Крыша удалена");
				}
				if (listitem == 3)
				{
				    if (Player[playerid][CarSlot1Component3] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены боковые юбки");
					Player[playerid][CarSlot1Component3] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 3);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Боковые юбки удален");
				}
				if (listitem == 4)
				{
				    if (Player[playerid][CarSlot1Component4] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены фары");
					Player[playerid][CarSlot1Component4] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 4);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Фары удалены");
				}
				if (listitem == 5)
				{
				    if (Player[playerid][CarSlot1Component5] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлено нитро");
					Player[playerid][CarSlot1Component5] = 0;Player[playerid][CarSlot1NitroX] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 5);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Нитро удалено");
				}
				if (listitem == 6)
				{
				    if (Player[playerid][CarSlot1Component6] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена выхлопная труба");
					Player[playerid][CarSlot1Component6] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 6);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Выхлопная труба удален");
				}
				if (listitem == 7)
				{
				    if (Player[playerid][CarSlot1Component7] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены диски");
					Player[playerid][CarSlot1Component7] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 7);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Диски удалены");
				}
				if (listitem == 8)
				{
				    if (Player[playerid][CarSlot1Component8] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлено стерео");
					Player[playerid][CarSlot1Component8] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 8);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Стерео удалено");
				}
				if (listitem == 9)
				{
				    if (Player[playerid][CarSlot1Component9] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена гидравлика");
					Player[playerid][CarSlot1Component9] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 9);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Гидравлика удалена");
				}
				if (listitem == 10)
				{
				    if (Player[playerid][CarSlot1Component10] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен передний бампер");
					Player[playerid][CarSlot1Component10] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 10);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Передний бампер удален");
				}
				if (listitem == 11)
				{
				    if (Player[playerid][CarSlot1Component11] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен задний бампер");
					Player[playerid][CarSlot1Component11] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 11);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Задний бампер удален");
				}
				if (listitem == 12)
				{
				    if (Player[playerid][CarSlot1Component12] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен правый вент");
					Player[playerid][CarSlot1Component12] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 12);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Правый вент удален");
				}
				if (listitem == 13)
				{
				    if (Player[playerid][CarSlot1Component13] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен левый вент");
					Player[playerid][CarSlot1Component13] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 13);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Левый вент удален");
				}
				if (listitem == 14)
				{
				    if (Player[playerid][CarSlot1PaintJob] == -1) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлено покрасочных работ");
					Player[playerid][CarSlot1PaintJob] = -1;
					DestroyVehicle(GetPlayerVehicleID(playerid));CallCar1(playerid);
					SendClientMessage(playerid,COLOR_GREY,"Покрасочные работы удалены");
				}
				if (listitem == 15)
				{
				    if (Player[playerid][CarSlot1Neon] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен неон");
					Player[playerid][CarSlot1Neon] = 0; new vehicleid = GetPlayerVehicleID(playerid);
					if (NeonObject1[vehicleid] != -1){DestroyDynamicObject(NeonObject1[vehicleid]);NeonObject1[vehicleid] = -1;}
					if (NeonObject2[vehicleid] != -1){DestroyDynamicObject(NeonObject2[vehicleid]);NeonObject2[vehicleid] = -1;}
					SendClientMessage(playerid,COLOR_GREY,"Неон удален");
				}
				if (listitem == 16)
				{
				    if (Player[playerid][CarSlot1Fire] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены огненные колеса!");
					Player[playerid][CarSlot1Fire] = 0; new vehicleid = GetPlayerVehicleID(playerid);
					//if (Fire1[vehicleid] != -1){DestroyDynamicObject(Fire1[vehicleid]);Fire1[vehicleid] = -1;}
					//if (Fire2[vehicleid] != -1){DestroyDynamicObject(Fire2[vehicleid]);Fire2[vehicleid] = -1;}
					if (Fire3[vehicleid] != -1){DestroyDynamicObject(Fire3[vehicleid]);Fire3[vehicleid] = -1;}
					if (Fire4[vehicleid] != -1){DestroyDynamicObject(Fire4[vehicleid]);Fire4[vehicleid] = -1;}
					SendClientMessage(playerid,COLOR_GREY,"Огненные колеса убраны");
				}
				if (listitem == 17)
				{
				    if (Player[playerid][CarSlot1Sir] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена сирена");
					Player[playerid][CarSlot1Sir] = 0; new vehicleid = GetPlayerVehicleID(playerid);
                    DestroyVehicle(vehicleid);CallCar1(playerid);
					SendClientMessage(playerid,COLOR_GREY,"Сирена удалена");
				}
				if (listitem == 18)
				{
        			if (Player[playerid][CarSlot1Mig] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена мигалка");
					Player[playerid][CarSlot1Mig] = 0; new vehicleid = GetPlayerVehicleID(playerid);
					if (MigObj[vehicleid] != -1){DestroyDynamicObject(MigObj[vehicleid]);MigObj[vehicleid] = -1;}
					SendClientMessage(playerid,COLOR_GREY,"Мигалка удалена");
				}
			}//Класс 1
            if (Player[playerid][CarActive] == 2)
			{//Класс 2
				if (listitem == 0)
				{
				    if (Player[playerid][CarSlot2Component0] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен спойлер");
					Player[playerid][CarSlot2Component0] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 0);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Спойлер удален");
				}
				if (listitem == 1)
				{
				    if (Player[playerid][CarSlot2Component1] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен капот");
					Player[playerid][CarSlot2Component1] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 1);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Капот удален");
				}
				if (listitem == 2)
				{
				    if (Player[playerid][CarSlot2Component2] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена крыша");
					Player[playerid][CarSlot2Component2] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 2);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Крыша удалена");
				}
				if (listitem == 3)
				{
				    if (Player[playerid][CarSlot2Component3] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены боковые юбки");
					Player[playerid][CarSlot2Component3] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 3);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Боковые юбки удален");
				}
				if (listitem == 4)
				{
				    if (Player[playerid][CarSlot2Component4] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены фары");
					Player[playerid][CarSlot2Component4] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 4);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Фары удалены");
				}
				if (listitem == 5)
				{
				    if (Player[playerid][CarSlot2Component5] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлено нитро");
					Player[playerid][CarSlot2Component5] = 0;Player[playerid][CarSlot2NitroX] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 5);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Нитро удалено");
				}
				if (listitem == 6)
				{
				    if (Player[playerid][CarSlot2Component6] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена выхлопная труба");
					Player[playerid][CarSlot2Component6] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 6);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Выхлопная труба удален");
				}
				if (listitem == 7)
				{
				    if (Player[playerid][CarSlot2Component7] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены диски");
					Player[playerid][CarSlot2Component7] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 7);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Диски удалены");
				}
				if (listitem == 8)
				{
				    if (Player[playerid][CarSlot2Component8] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлено стерео");
					Player[playerid][CarSlot2Component8] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 8);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Стерео удалено");
				}
				if (listitem == 9)
				{
				    if (Player[playerid][CarSlot2Component9] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена гидравлика");
					Player[playerid][CarSlot2Component9] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 9);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Гидравлика удалена");
				}
				if (listitem == 10)
				{
				    if (Player[playerid][CarSlot2Component10] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен передний бампер");
					Player[playerid][CarSlot2Component10] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 10);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Передний бампер удален");
				}
				if (listitem == 11)
				{
				    if (Player[playerid][CarSlot2Component11] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен задний бампер");
					Player[playerid][CarSlot2Component11] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 11);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Задний бампер удален");
				}
				if (listitem == 12)
				{
				    if (Player[playerid][CarSlot2Component12] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен правый вент");
					Player[playerid][CarSlot2Component12] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 12);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Правый вент удален");
				}
				if (listitem == 13)
				{
				    if (Player[playerid][CarSlot2Component13] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен левый вент");
					Player[playerid][CarSlot2Component13] = 0;
					new component = GetVehicleComponentInSlot(GetPlayerVehicleID(playerid), 13);
					if (component != 0) RemoveVehicleComponent(GetPlayerVehicleID(playerid), component);
					SendClientMessage(playerid,COLOR_GREY,"Левый вент удален");
				}
				if (listitem == 14)
				{
				    if (Player[playerid][CarSlot2PaintJob] == -1) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлено покрасочных работ");
					Player[playerid][CarSlot2PaintJob] = -1;
					DestroyVehicle(GetPlayerVehicleID(playerid));CallCar2(playerid);
					SendClientMessage(playerid,COLOR_GREY,"Покрасочные работы удалены");
				}
				if (listitem == 15)
				{
				    if (Player[playerid][CarSlot2Neon] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлен неон");
					Player[playerid][CarSlot2Neon] = 0; new vehicleid = GetPlayerVehicleID(playerid);
					if (NeonObject1[vehicleid] != -1){DestroyDynamicObject(NeonObject1[vehicleid]);NeonObject1[vehicleid] = -1;}
					if (NeonObject2[vehicleid] != -1){DestroyDynamicObject(NeonObject2[vehicleid]);NeonObject2[vehicleid] = -1;}
					SendClientMessage(playerid,COLOR_GREY,"Неон удален");
				}
				if (listitem == 16)
				{
				    if (Player[playerid][CarSlot2Fire] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлены огненные колеса!");
					Player[playerid][CarSlot2Fire] = 0; new vehicleid = GetPlayerVehicleID(playerid);
					//if (Fire1[vehicleid] != -1){DestroyDynamicObject(Fire1[vehicleid]);Fire1[vehicleid] = -1;}
					//if (Fire2[vehicleid] != -1){DestroyDynamicObject(Fire2[vehicleid]);Fire2[vehicleid] = -1;}
					if (Fire3[vehicleid] != -1){DestroyDynamicObject(Fire3[vehicleid]);Fire3[vehicleid] = -1;}
					if (Fire4[vehicleid] != -1){DestroyDynamicObject(Fire4[vehicleid]);Fire4[vehicleid] = -1;}
					SendClientMessage(playerid,COLOR_GREY,"Огненные колеса убраны");
				}
				if (listitem == 17)
				{
				    if (Player[playerid][CarSlot2Sir] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена сирена");
					Player[playerid][CarSlot2Sir] = 0; new vehicleid = GetPlayerVehicleID(playerid);
                    DestroyVehicle(vehicleid);CallCar2(playerid);
					SendClientMessage(playerid,COLOR_GREY,"Сирена удалена");
				}
				if (listitem == 18)
				{
        			if (Player[playerid][CarSlot2Mig] == 0) return SendClientMessage(playerid,COLOR_GREY,"У вас не установлена мигалка");
					Player[playerid][CarSlot2Mig] = 0; new vehicleid = GetPlayerVehicleID(playerid);
					if (MigObj[vehicleid] != -1){DestroyDynamicObject(MigObj[vehicleid]);MigObj[vehicleid] = -1;}
					SendClientMessage(playerid,COLOR_GREY,"Мигалка удалена");
				}
			}//Класс 2
		    SaveTune(playerid);


		    //Заново показ менюшки удаления компонентов
		    new StringZ[1024];
			if (Player[playerid][CarActive] == 1)
			{//Класс 1
  				if (Player[playerid][CarSlot1Component0] == 0) strcat(StringZ, "{AFAFAF}Спойлер\n"); else strcat(StringZ, "{FFFFFF}Спойлер\n");
  				if (Player[playerid][CarSlot1Component1] == 0) strcat(StringZ, "{AFAFAF}Капот\n"); else strcat(StringZ, "{FFFFFF}Капот\n");
  				if (Player[playerid][CarSlot1Component2] == 0) strcat(StringZ, "{AFAFAF}Крыша\n"); else strcat(StringZ, "{FFFFFF}Крыша\n");
  				if (Player[playerid][CarSlot1Component3] == 0) strcat(StringZ, "{AFAFAF}Боковые юбки\n"); else strcat(StringZ, "{FFFFFF}Боковые юбки\n");
  				if (Player[playerid][CarSlot1Component4] == 0) strcat(StringZ, "{AFAFAF}Фары\n"); else strcat(StringZ, "{FFFFFF}Фары\n");
  				if (Player[playerid][CarSlot1Component5] == 0) strcat(StringZ, "{AFAFAF}Нитро\n"); else strcat(StringZ, "{FFFFFF}Нитро\n");
  				if (Player[playerid][CarSlot1Component6] == 0) strcat(StringZ, "{AFAFAF}Выхлопная труба\n"); else strcat(StringZ, "{FFFFFF}Выхлопная труба\n");
  				if (Player[playerid][CarSlot1Component7] == 0) strcat(StringZ, "{AFAFAF}Диски\n"); else strcat(StringZ, "{FFFFFF}Диски\n");
  				if (Player[playerid][CarSlot1Component8] == 0) strcat(StringZ, "{AFAFAF}Стерео\n"); else strcat(StringZ, "{FFFFFF}Стерео\n");
  				if (Player[playerid][CarSlot1Component9] == 0) strcat(StringZ, "{AFAFAF}Гидравлика\n"); else strcat(StringZ, "{FFFFFF}Гидравлика\n");
  				if (Player[playerid][CarSlot1Component10] == 0) strcat(StringZ, "{AFAFAF}Передний бампер\n"); else strcat(StringZ, "{FFFFFF}Передний бампер\n");
  				if (Player[playerid][CarSlot1Component11] == 0) strcat(StringZ, "{AFAFAF}Задний бампер\n"); else strcat(StringZ, "{FFFFFF}Задний бампер\n");
  				if (Player[playerid][CarSlot1Component12] == 0) strcat(StringZ, "{AFAFAF}Правый вент\n"); else strcat(StringZ, "{FFFFFF}Правый вент\n");
  				if (Player[playerid][CarSlot1Component13] == 0) strcat(StringZ, "{AFAFAF}Левый вент\n"); else strcat(StringZ, "{FFFFFF}Левый вент\n");
                if (Player[playerid][CarSlot1PaintJob] == -1) strcat(StringZ, "{AFAFAF}Покрасочные работы\n"); else strcat(StringZ, "{FFFFFF}Покрасочные работы\n");
                if (Player[playerid][CarSlot1Neon] == 0) strcat(StringZ, "{AFAFAF}Неон\n"); else strcat(StringZ, "{FFFFFF}Неон\n");
                if (Player[playerid][CarSlot1Fire] == 0) strcat(StringZ, "{AFAFAF}Огненные колеса\n"); else strcat(StringZ, "{FFFFFF}Огненные колеса\n");
				return ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDDELETE, 2, "Удалить компонент", StringZ, "Удалить", "Назад");
			}//Класс 1
  			if (Player[playerid][CarActive] == 2)
			{//Класс 2
				if (Player[playerid][CarSlot2Component0] == 0) strcat(StringZ, "{AFAFAF}Спойлер\n"); else strcat(StringZ, "{FFFFFF}Спойлер\n");
  				if (Player[playerid][CarSlot2Component1] == 0) strcat(StringZ, "{AFAFAF}Капот\n"); else strcat(StringZ, "{FFFFFF}Капот\n");
  				if (Player[playerid][CarSlot2Component2] == 0) strcat(StringZ, "{AFAFAF}Крыша\n"); else strcat(StringZ, "{FFFFFF}Крыша\n");
  				if (Player[playerid][CarSlot2Component3] == 0) strcat(StringZ, "{AFAFAF}Боковые юбки\n"); else strcat(StringZ, "{FFFFFF}Боковые юбки\n");
  				if (Player[playerid][CarSlot2Component4] == 0) strcat(StringZ, "{AFAFAF}Фары\n"); else strcat(StringZ, "{FFFFFF}Фары\n");
  				if (Player[playerid][CarSlot2Component5] == 0) strcat(StringZ, "{AFAFAF}Нитро\n"); else strcat(StringZ, "{FFFFFF}Нитро\n");
  				if (Player[playerid][CarSlot2Component6] == 0) strcat(StringZ, "{AFAFAF}Выхлопная труба\n"); else strcat(StringZ, "{FFFFFF}Выхлопная труба\n");
  				if (Player[playerid][CarSlot2Component7] == 0) strcat(StringZ, "{AFAFAF}Диски\n"); else strcat(StringZ, "{FFFFFF}Диски\n");
  				if (Player[playerid][CarSlot2Component8] == 0) strcat(StringZ, "{AFAFAF}Стерео\n"); else strcat(StringZ, "{FFFFFF}Стерео\n");
  				if (Player[playerid][CarSlot2Component9] == 0) strcat(StringZ, "{AFAFAF}Гидравлика\n"); else strcat(StringZ, "{FFFFFF}Гидравлика\n");
  				if (Player[playerid][CarSlot2Component10] == 0) strcat(StringZ, "{AFAFAF}Передний бампер\n"); else strcat(StringZ, "{FFFFFF}Передний бампер\n");
  				if (Player[playerid][CarSlot2Component11] == 0) strcat(StringZ, "{AFAFAF}Задний бампер\n"); else strcat(StringZ, "{FFFFFF}Задний бампер\n");
  				if (Player[playerid][CarSlot2Component12] == 0) strcat(StringZ, "{AFAFAF}Правый вент\n"); else strcat(StringZ, "{FFFFFF}Правый вент\n");
  				if (Player[playerid][CarSlot2Component13] == 0) strcat(StringZ, "{AFAFAF}Левый вент\n"); else strcat(StringZ, "{FFFFFF}Левый вент\n");
                if (Player[playerid][CarSlot2PaintJob] == -1) strcat(StringZ, "{AFAFAF}Покрасочные работы\n"); else strcat(StringZ, "{FFFFFF}Покрасочные работы\n");
                if (Player[playerid][CarSlot2Neon] == 0) strcat(StringZ, "{AFAFAF}Неон\n"); else strcat(StringZ, "{FFFFFF}Неон\n");
                if (Player[playerid][CarSlot1Fire] == 0) strcat(StringZ, "{AFAFAF}Огненные колеса\n"); else strcat(StringZ, "{FFFFFF}Огненные колеса\n");
				return ShowPlayerDialog(playerid, DIALOG_TURBOSPEEDDELETE, 2, "Удалить компонент", StringZ, "Удалить", "Назад");
			}//Кдасс 2
		}//Автомастерская TurboSpeed - Удалить компонент

		case DIALOG_TURBOSPEEDNITRO:
		{//Автомастерская TurboSpeed - Нитро
		    	if (!response) return ShowPlayerTSDialog(playerid);
                if (Player[playerid][CarActive] < 1 || Player[playerid][CarActive] > 2) return SendClientMessage(playerid,COLOR_RED,"Установить нитро можно только на личный автомобиль 1-го или 2-го класса!");
				if (listitem == 0)
				{//Бесконечное нитро
				    if (Player[playerid][CarActive] > 0 && Player[playerid][CarActive] < 3)
				    {//игрок в авто класса 1, 2
				        if (Player[playerid][Cash] < 50000) return ShowMoneyWant(playerid,1,"50.000");
        				if (Player[playerid][Level] < 65) return SendClientMessage(playerid, COLOR_RED, "Вы должны быть как минимум 65-го уровня");
					    if (Player[playerid][CarActive] == 1)
				        {
				            Player[playerid][CarSlot1Component5] = 1010; Player[playerid][CarSlot1NitroX] = 1;AddVehicleComponent(GetPlayerVehicleID(playerid), 1010);
							SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели Бесконечное Нитро за 50 000$ для автомобиля 1-го класса.");
				        }
				        else if (Player[playerid][CarActive] == 2)
				        {
				            Player[playerid][CarSlot2Component5] = 1010; Player[playerid][CarSlot2NitroX] = 1;AddVehicleComponent(GetPlayerVehicleID(playerid), 1010);
				            SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели Бесконечное Нитро за 50 000$ для автомобиля 2-го класса.");
				        }
				        Player[playerid][Cash] -= 50000;SaveTune(playerid);
				    }//игрок в авто класса 1, 2
				}//Бесконечное нитро
				if (listitem == 1)
				{//UberNitro
				    if (Player[playerid][CarActive] > 0 && Player[playerid][CarActive] < 3)
				    {//игрок в авто класса 1, 2
				        if (Player[playerid][Cash] < 300000) return ShowMoneyWant(playerid,1,"300.000");
			            if (Player[playerid][Level] < 80) return SendClientMessage(playerid, COLOR_RED, "Вы должны быть как минимум 80-го уровня");
					    if (Player[playerid][CarActive] == 1)
				        {
				            Player[playerid][CarSlot1Component5] = 1010; Player[playerid][CarSlot1NitroX] = 2;AddVehicleComponent(GetPlayerVehicleID(playerid), 1010);
							SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели Бесконечное UberNitro за 300 000$ для автомобиля 1-го класса.");
				        }
				        else if (Player[playerid][CarActive] == 2)
				        {
				            Player[playerid][CarSlot2Component5] = 1010; Player[playerid][CarSlot2NitroX] = 2;AddVehicleComponent(GetPlayerVehicleID(playerid), 1010);
				            SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели Бесконечное UberNitro за 300 000$ для автомобиля 2-го класса.");
				        }
				        Player[playerid][Cash] -= 300000;SaveTune(playerid);
					}//игрок в авто класса 1,2
				}//UberNitro
		}//Автомастерская TurboSpeed - Нитро

		case DIALOG_TURBOSPEEDNEON:
		{//Автомастерская TurboSpeed - Неон
		    if (!response) return ShowPlayerTSDialog(playerid);
			if (Player[playerid][Prestige] < 4) return SendClientMessage(playerid,COLOR_RED, "Вы должны быть как минимум 4 уровня Престижа чтобы установить неон");
			if (Player[playerid][Cash] < 50000) return ShowMoneyWant(playerid,1,"50.000");
            if (Player[playerid][CarActive] < 1 || Player[playerid][CarActive] > 2) return SendClientMessage(playerid,COLOR_RED,"Установить неон можно только на личный автомобиль 1-го или 2-го класса!");

			new model = GetVehicleModel(GetPlayerVehicleID(playerid));
			switch (model)
			{
			    case 417, 425, 447, 460, 469, 476, 487, 488, 497, 511, 512, 513, 519, 520, 548, 553, 563, 577, 592, 593, //Air
			    509, 481, 510, 462, 448, 581, 522, 461, 521, 523, 463, 486, 468, 471, /*Bikes*/ 472, 473, 493, 595, 484, 430, 453, 452, 446, 454, //Boats
			    435, 441, 449, 450, 464, 465, 501, 530, 485, 457, 532, 537, 538, 564, 569, 570, 571, 572, 584, 590, 591, 594, 606, 607, 608, 610, 611: //Прочее
			    return SendClientMessage(playerid, COLOR_RED, "Нельзя установить неон на эту модель транспорта!");
			}

			if (Player[playerid][CarActive] == 1)
			{//авто класса 1
				switch(listitem)
				{
				    case 0: Player[playerid][CarSlot1Neon] = 18647; case 1: Player[playerid][CarSlot1Neon] = 18648; case 2: Player[playerid][CarSlot1Neon] = 18649;
				    case 3: Player[playerid][CarSlot1Neon] = 18650; case 4: Player[playerid][CarSlot1Neon] = 18651; case 5: Player[playerid][CarSlot1Neon] = 18652;
				}
			    new vehicleid = PlayerCarID[playerid];
			   	if (NeonObject1[vehicleid] != -1) DestroyDynamicObject(NeonObject1[vehicleid]);
				if (NeonObject2[vehicleid] != -1) DestroyDynamicObject(NeonObject2[vehicleid]);
			    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
			    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели неон за 50 000$ для автомобиля 1-го класса.");
			}//авто класса 1
			if (Player[playerid][CarActive] == 2)
			{//авто класса 2
				switch(listitem)
				{
				    case 0: Player[playerid][CarSlot2Neon] = 18647; case 1: Player[playerid][CarSlot2Neon] = 18648; case 2: Player[playerid][CarSlot2Neon] = 18649;
				    case 3: Player[playerid][CarSlot2Neon] = 18650; case 4: Player[playerid][CarSlot2Neon] = 18651; case 5: Player[playerid][CarSlot2Neon] = 18652;
				}
			    new vehicleid = PlayerCarID[playerid];
			   	if (NeonObject1[vehicleid] != -1) DestroyDynamicObject(NeonObject1[vehicleid]);
				if (NeonObject2[vehicleid] != -1) DestroyDynamicObject(NeonObject2[vehicleid]);
			    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
			    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
			    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели неон за 50 000$ для автомобиля 2-го класса.");
			}//авто класса 2
			Player[playerid][Cash] -= 50000; SaveTune(playerid);
		}//Автомастерская TurboSpeed - Неон
		case DIALOG_TURBOSPEEDFIRE:
		{
			if (!response) return ShowPlayerTSDialog(playerid);
        	if (Player[playerid][CarActive] < 1 || Player[playerid][CarActive] > 2) return SendClientMessage(playerid,COLOR_RED,"Установить огненные колеса можно только на личный автомобиль 1-го или 2-го класса!");
        	if (Player[playerid][Prestige] < 3) return SendClientMessage(playerid,COLOR_RED, "Вы должны быть как минимум 3 уровня Престижа чтобы установить огненные колеса");
			if (Player[playerid][Cash] < 500000) return ShowMoneyWant(playerid,1,"500.000");
        	new model = GetVehicleModel(GetPlayerVehicleID(playerid));
			switch (model)
			{
			    case 417, 425, 447, 460, 469, 476, 487, 488, 497, 511, 512, 513, 519, 520, 548, 553, 563, 577, 592, 593, //Air
			    509, 481, 510, 462, 448, 581, 522, 461, 521, 523, 463, 486, 468, 471, /*Bikes*/ 472, 473, 493, 595, 484, 430, 453, 452, 446, 454, //Boats
			    435, 441, 449, 450, 464, 465, 501, 530, 485, 457, 532, 537, 538, 564, 569, 570, 571, 572, 584, 590, 591, 594, 606, 607, 608, 610, 611: //Прочее
			    return SendClientMessage(playerid, COLOR_RED, "Нельзя установить огненные колеса на эту модель транспорта!");
			}
			if (Player[playerid][CarActive] == 1)
			{//авто класса 1
			    new vehicleid = PlayerCarID[playerid];
			    //if (Fire1[vehicleid] != -1){DestroyDynamicObject(Fire1[vehicleid]);Fire1[vehicleid] = -1;}
				//if (Fire2[vehicleid] != -1){DestroyDynamicObject(Fire2[vehicleid]);Fire2[vehicleid] = -1;}
				if (Fire3[vehicleid] != -1){DestroyDynamicObject(Fire3[vehicleid]);Fire3[vehicleid] = -1;}
				if (Fire4[vehicleid] != -1){DestroyDynamicObject(Fire4[vehicleid]);Fire4[vehicleid] = -1;}

			    //Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);

			    Player[playerid][CarSlot1Fire] = 1;
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели огненные колеса за 500 000$ для автомобиля 1-го класса.");
			}//авто класса 1

			if (Player[playerid][CarActive] == 2)
			{//авто класса 2
			    new vehicleid = PlayerCarID[playerid];
			    //if (Fire1[vehicleid] != -1){DestroyDynamicObject(Fire1[vehicleid]);Fire1[vehicleid] = -1;}
				//if (Fire2[vehicleid] != -1){DestroyDynamicObject(Fire2[vehicleid]);Fire2[vehicleid] = -1;}
				if (Fire3[vehicleid] != -1){DestroyDynamicObject(Fire3[vehicleid]);Fire3[vehicleid] = -1;}
				if (Fire4[vehicleid] != -1){DestroyDynamicObject(Fire4[vehicleid]);Fire4[vehicleid] = -1;}

			    //Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);

                Player[playerid][CarSlot2Fire] = 1;
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели огненные колеса за 500 000$ для автомобиля 2-го класса.");
			}//авто класса 2
			Player[playerid][Cash] -= 500000; SaveTune(playerid);
		}

		case DIALOG_TURBOSPEEDSIR:
		{
			if (!response) return ShowPlayerTSDialog(playerid);
			if (Player[playerid][Level] < 20) return SendClientMessage(playerid,COLOR_RED, "Вы должны быть как минимум 20 уровня чтобы установить сирену!");
			if (Player[playerid][Cash] < 100000) return ShowMoneyWant(playerid,1,"100.000");
            if (Player[playerid][CarActive] < 1 || Player[playerid][CarActive] > 2) return SendClientMessage(playerid,COLOR_RED,"Установить сирену можно только на личный автомобиль 1-го или 2-го класса!");

            if (Player[playerid][CarActive] == 1)
			{//авто класса 1
				Player[playerid][CarSlot1Sir] = 1;
                DestroyVehicle(GetPlayerVehicleID(playerid));CallCar1(playerid);
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели сирену за 100 000$ для автомобиля 1-го класса.");
			    SendClientMessage(playerid, COLOR_YELLOW, "Резко нажмите 'Caps Lock' или 'H' (англ.) для активации.");
			}//авто класса 1
			if (Player[playerid][CarActive] == 2)
			{//авто класса 2
				Player[playerid][CarSlot2Sir] = 1;
                DestroyVehicle(GetPlayerVehicleID(playerid));CallCar2(playerid);
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели сирену за 100 000$ для автомобиля 2-го класса.");
			    SendClientMessage(playerid, COLOR_YELLOW, "Резко нажмите 'Caps Lock' или 'H' (англ.) для активации.");
			}//авто класса 2
			Player[playerid][Cash] -= 100000; SaveTune(playerid);
		}

		case DIALOG_TURBOSPEEDMIG:
		{//Автомастерская TurboSpeed - Неон
		    if (!IsPlayerInAnyVehicle(playerid)) return 1;
		    if (!response) return ShowPlayerTSDialog(playerid);
			if (Player[playerid][Level] < 50) return SendClientMessage(playerid,COLOR_RED, "Вы должны быть как минимум 50 уровня чтобы установить мигалку");
			if (Player[playerid][Cash] < 200000) return ShowMoneyWant(playerid,1,"200.000");
            if (Player[playerid][CarActive] < 1 || Player[playerid][CarActive] > 2) return SendClientMessage(playerid,COLOR_RED,"Установить мигалку можно только на личный автомобиль 1-го или 2-го класса!");

			new model = GetVehicleModel(GetPlayerVehicleID(playerid));
			new access = 0;
			for (new i=0;i<MAX_MIG;i++)
			{
				if(MigPosInf[i][vhid] == model) access = i;
			}
			if (access == 0) return SendClientMessage(playerid, COLOR_RED, "На этот транспорт нельзя установить мигалку!");
			new migmod = 0;
			switch(listitem)
			{
			    case 0: migmod = 19419;
			    case 1: migmod = 19620;
			    case 2: migmod = 11701;
			    case 3: migmod = 18646;
			}
			if (Player[playerid][CarActive] == 1)
			{//авто класса 1
			    Player[playerid][CarSlot1Mig] = migmod;
			    new vehicleid = PlayerCarID[playerid];
			    if (vehicleid < 0) return SendClientMessage(playerid, COLOR_RED, "Произошла ошибка!");
			   	if (MigObj[vehicleid] != -1) DestroyDynamicObject(MigObj[vehicleid]);
			    MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Mig], 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
			  	AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели мигалку за 200 000$ для автомобиля 1-го класса.");
			}//авто класса 1
			if (Player[playerid][CarActive] == 2)
			{//авто класса 2
				Player[playerid][CarSlot2Mig] = migmod;
			    new vehicleid = PlayerCarID[playerid];
			   	if (MigObj[vehicleid] != -1) DestroyDynamicObject(MigObj[vehicleid]);
			    MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Mig], 0, 0, 0, 0, 0, 0, GetPlayerVirtualWorld(playerid), GetPlayerInterior(playerid), -1, 300.0);
			  	AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
			    SendClientMessage(playerid, COLOR_YELLOW, "Вы приобрели мигалку за 200 000$ для автомобиля 2-го класса.");
			}//авто класса 2
			Player[playerid][Cash] -= 200000; SaveTune(playerid);
		}//Автомастерская TurboSpeed - Неон
		
		

		case DIALOG_GPS:
		{//GPS
		    if (!response) return 1;
		    if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно в соревнованиях.");
		    if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно на работе и при выполнении заданий.");
		    if (listitem == 0)
			{//Работа
			    new String[1024];
			    strcat(String, "{00CCCC}Ур. 1: {FFFFFF}Доставщик Пиццы (2400 XP, 144 000$)\n{00CCCC}Ур. 1: {FFFFFF}Грузчик (2700 XP, 108 000$)\n{00CCCC}Ур. 14: {FFFFFF}Домушник (2880 XP, 360 000$)\n{00CCCC}Ур. 21: {FFFFFF}Комбайнер (3240 XP, 270 000$)");
				strcat(String, "\n{00CCCC}Ур. 28: {FFFFFF}Дальнобойщик (3420 XP, 540 000$)\n{00CCCC}Ур. 35: {FFFFFF}Капитан Корабля (3600 XP, 396 000$)\n{00CCCC}Ур. 42: {FFFFFF}Инкассатор (2400 XP, 900 000$)");
				return ShowPlayerDialog(playerid, DIALOG_GPSWORK, 2, "GPS - Работа", String, "ОК", "Назад");//Работа
			}//Работа
			if (listitem == 1)
			{//Банк
			    new Closest = 0, Float: fDistance = 99999999.9;
                for(new i = 0; i < 6; i++)
				{//цикл - находим ближайший банк
				    if (GetPlayerDistanceFromPoint(playerid, BANKENTERS[i][0], BANKENTERS[i][1], BANKENTERS[i][2]) < fDistance)
				    {//Расстояние до банка i меньше, чем fDistance
				        fDistance = GetPlayerDistanceFromPoint(playerid, BANKENTERS[i][0], BANKENTERS[i][1], BANKENTERS[i][2]);
				        Closest = i;
				    }//Расстояние до банка i меньше, чем fDistance
				}//цикл - находим ближайший банк
			    SetPlayerCheckpoint(playerid, BANKENTERS[Closest][0], BANKENTERS[Closest][1], BANKENTERS[Closest][2], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Ближайший банк был отмечен на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Банк
			if (listitem == 2)
			{//Казино
			    SetPlayerCheckpoint(playerid, 2019.3174, 1007.8547, 10.8203, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Казино было отмечено на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Казино
		    if (listitem == 3) return ShowPlayerDialog(playerid, DIALOG_GPSTUNE, 2, "GPS - Автомастерские", "Transfender ({AFAFAF}для большинства машин{FFFFFF})\nLowrider\nArch Angels\nTurboSpeed", "ОК", "Назад");//Автомастерские
			if (listitem == 4)
			{//Магазин Одежды
			    new Closest = 0, Float: fDistance = 99999999.9;
                for(new i = 0; i < 4; i++)
				{//цикл - находим ближайший магазин одежды
				    if (GetPlayerDistanceFromPoint(playerid, CLOTHESENTERS[i][0], CLOTHESENTERS[i][1], CLOTHESENTERS[i][2]) < fDistance)
				    {//Расстояние до магазина i меньше, чем fDistance
				        fDistance = GetPlayerDistanceFromPoint(playerid, CLOTHESENTERS[i][0], CLOTHESENTERS[i][1], CLOTHESENTERS[i][2]);
				        Closest = i;
				    }//Расстояние до магазина i меньше, чем fDistance
				}//цикл - находим ближайший магазин одежды
			    SetPlayerCheckpoint(playerid, CLOTHESENTERS[Closest][0], CLOTHESENTERS[Closest][1], CLOTHESENTERS[Closest][2], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Ближайший магазин одежды был отмечен на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Магазин Одежды
			if (listitem == 5)
			{//Аэропорт
			    new Closest = 0, Float: fDistance = 99999999.9;
                for(new i = 0; i < 3; i++)
				{//цикл - находим ближайший магазин одежды
				    if (GetPlayerDistanceFromPoint(playerid, AIRPORTENTERS[i][0], AIRPORTENTERS[i][1], AIRPORTENTERS[i][2]) < fDistance)
				    {//Расстояние до магазина i меньше, чем fDistance
				        fDistance = GetPlayerDistanceFromPoint(playerid, AIRPORTENTERS[i][0], AIRPORTENTERS[i][1], AIRPORTENTERS[i][2]);
				        Closest = i;
				    }//Расстояние до магазина i меньше, чем fDistance
				}//цикл - находим ближайший магазин одежды
			    SetPlayerCheckpoint(playerid, AIRPORTENTERS[Closest][0], AIRPORTENTERS[Closest][1], AIRPORTENTERS[Closest][2], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Ближайший аэропорт был отмечен на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Аэропорт
			if (listitem == 6)
			{//Личный Дом
				if (Player[playerid][Home] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас нет дома!");
				new houseid = Player[playerid][Home];
				SetPlayerCheckpoint(playerid, Property[houseid][pPosEnterX], Property[houseid][pPosEnterY], Property[houseid][pPosEnterZ], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Ваш дом был отмечен на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Личный Дом
			if (listitem == 7)
			{//Штаб Клана
				if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы не состоите в клане!");
				new clanid = Player[playerid][MyClan], baseid = Clan[clanid][cBase];
				if (baseid <= 0 || baseid >= MAX_BASE) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вашего клана нет штаба!");
				SetPlayerCheckpoint(playerid, Base[baseid][bPosEnterX], Base[baseid][bPosEnterY], Base[baseid][bPosEnterZ], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Штаб вашего клана был отмечен на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Штаб Клана
			if (listitem == 8)
			{//Казино
			    SetPlayerCheckpoint(playerid, -245.9217,-1720.6550,3.0766, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Остров FarCry был отмечен на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Казино
			/*if (listitem == 9)
			{//Казино
			    SetPlayerCheckpoint(playerid, 2122.1238,1277.2410,10.3003, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Новогодняя Елка была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Казино*/
			if (listitem == 9)
		    {//Убрать отметку
		        if (GPSUsed[playerid] == 0) return SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} На вашем радаре не установлено никаких маркеров.");
		        DisablePlayerCheckpoint(playerid); GPSUsed[playerid] = 0;
		        return SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Маркер успешно удален.");
		    }//Убрать отметку
		}//GPS

		case DIALOG_GPSWORK:
		{//GPS - Работа
		    if (!response) {callcmd::gps(playerid, ""); return 1;}
		    if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно в соревнованиях.");
		    if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно на работе и при выполнении заданий.");
		    if (listitem == 0)
			{//Доставщик пиццы
			    SetPlayerCheckpoint(playerid, 2397.7632, -1899.1389, 13.5469, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Доставщик Пиццы>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Доставщик пиццы
			if (listitem == 1)
			{//Грузчик
			    SetPlayerCheckpoint(playerid, 2729.3267, -2451.4578, 17.5937, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Грузчик>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Грузчик
			if (listitem == 2)
			{//Домушник
			    SetPlayerCheckpoint(playerid, -1972.5024, -1020.2568, 32.1719, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Домушник>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Домушник
			if (listitem == 3)
			{//Комбайнер
			    SetPlayerCheckpoint(playerid, -1061.6104, -1195.4755, 129.8281, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Комбайнер>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Комбайнер
			if (listitem == 4)
			{//Дальнобойщик
			    SetPlayerCheckpoint(playerid, 2484.6682, -2120.8743, 13.5469, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Дальнобойщик>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Дальнобойщик
			if (listitem == 5)
			{//Капитан корабля
			    SetPlayerCheckpoint(playerid, -1713.1389, -61.8556, 3.5547, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Капитан Корабля>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Капитан корабля
			if (listitem == 6)
			{//Инкассатор
			    SetPlayerCheckpoint(playerid, 2364.8955, 2382.8770, 10.8203, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Работа <<Инкассатор>> была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Инкассатор
		}//GPS - Работа

		case DIALOG_GPSTUNE:
		{//GPS - Автомастерские
		    if (!response) {callcmd::gps(playerid, ""); return 1;}
		    if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно в соревнованиях.");
		    if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно на работе и при выполнении заданий.");
		    if (listitem == 0)
			{//Transfender
			    new Closest = 0, Float: fDistance = 99999999.9;
                for(new i = 0; i < 3; i++)
				{//цикл - находим ближайшую автомастерскую Transfender
				    if (GetPlayerDistanceFromPoint(playerid, TRANSFENDER[i][0], TRANSFENDER[i][1], TRANSFENDER[i][2]) < fDistance)
				    {//Расстояние до transfender i меньше, чем fDistance
				        fDistance = GetPlayerDistanceFromPoint(playerid, TRANSFENDER[i][0], TRANSFENDER[i][1], TRANSFENDER[i][2]);
				        Closest = i;
				    }//Расстояние до transfender i меньше, чем fDistance
				}//цикл - находим ближайшую автомастерскую Transfender
			    SetPlayerCheckpoint(playerid, TRANSFENDER[Closest][0], TRANSFENDER[Closest][1], TRANSFENDER[Closest][2], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Ближайшая автомастерская Transfender была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Transfender
		    if (listitem == 1)
			{//Lowrider
			    SetPlayerCheckpoint(playerid, 2645.1233, -2034.3359, 13.5540, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Автомастерская Lowrider была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Lowrider
		    if (listitem == 2)
			{//Arch Angels
			    SetPlayerCheckpoint(playerid, -2711.2119, 217.4269, 4.1955, 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Автомастерская Arch Angels была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//Arch Angels
		    if (listitem == 3)
			{//TurboSpeed

			    new Closest = 0, Float: fDistance = 99999999.9;
                for(new i = 0; i < MAX_TS; i++)
				{//цикл - находим ближайшую автомастерскую
				    if (GetPlayerDistanceFromPoint(playerid, TSPosInf[i][fPosX], TSPosInf[i][fPosY], TSPosInf[i][fPosZ]) < fDistance)
				    {//Расстояние до i меньше, чем fDistance
				        fDistance = GetPlayerDistanceFromPoint(playerid, TSPosInf[i][fPosX], TSPosInf[i][fPosY], TSPosInf[i][fPosZ]);
				        Closest = i;
				    }//Расстояние до i меньше, чем fDistance
				}//цикл - находим ближайшую автомастерскую
			    SetPlayerCheckpoint(playerid, TSPosInf[Closest][fPosX], TSPosInf[Closest][fPosY], TSPosInf[Closest][fPosZ], 5); GPSUsed[playerid] = 1;
				SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Автомастерская TurboSpeed была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);

			    //SetPlayerCheckpoint(playerid, -2026.9071, 133.2521, 28.8359, 5); GPSUsed[playerid] = 1;
				//SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Автомастерская TurboSpeed была отмечена на радаре {FF0000}красным маркером{FFFF00}.");
				//return PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//TurboSpeed
		}//GPS - Автомастерские

        case DIALOG_WORKGRUZSTOP:
        {//прекращении работы грузчика
        	if(!response) return 1;
            SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Грузчик{FFCC00}>> прервана.");// Выводим текст
            DisablePlayerCheckpoint(playerid); QuestActive[playerid] = 0;
            ApplyAnimation(playerid,"PED","IDLE_tired",4.1,0,1,1,0,1);// Обнуляем анимацию
            RemovePlayerAttachedObject(playerid,8);// Удаляем объект из рук
            DeletePVar(playerid,"WorkStage");// Удаляем PVar с моментом работы
            DeletePVar(playerid,"WorkCount");// Удаляем PVar с колличеством вещей
        }//прекращении работы грузчика

        case DIALOG_WORKSTOP:
        {//Вызов рабочего транспорта или прекращение работы
            if (!response) return 1;
            if (listitem == 0)
            {//Вызов рабочего транспорта
                new rtime = TimeTransform[playerid]-unixtime;
                if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6); format(String,sizeof(String),"Вы не можете вызывать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);return SendClientMessage(playerid,COLOR_RED,String);}
				if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid, COLOR_RED, "Нельзя вызывать транспорт в помещениях!");//Игрок в интерьерах или в банке
                new Float: x, Float: y, Float: z, Float: angle; GetPlayerPos(playerid, x, y, z); GetPlayerFacingAngle(playerid, angle);
                if (QuestActive[playerid] == 2) QuestCar[playerid] = LCreateVehicle(448, x, y, z, angle, 3, 3, 0);
                if (QuestActive[playerid] == 4) QuestCar[playerid] = LCreateVehicle(609, x, y, z, angle, 25, 25, 0);
 				if (QuestActive[playerid] == 5) QuestCar[playerid] = LCreateVehicle(532, x, y, z + 1, angle, 25, 25, 0);
 				if (QuestActive[playerid] == 6) {QuestCar[playerid] = LCreateVehicle(515, x, y, z + 1, angle, 4, 4, 0); if (GetPVarInt(playerid, "WorkTruckStage") == 1) CallTrailer(QuestCar[playerid], 584);}
                if (QuestActive[playerid] == 7) QuestCar[playerid] = LCreateVehicle(452, x, y, z + 1, angle, 1, 2, 0);
                if (QuestActive[playerid] == 8) QuestCar[playerid] = LCreateVehicle(428, x, y, z + 1, angle, 227, 4, 0);
				PutPlayerInVehicle(playerid,QuestCar[playerid], 0); TimeTransform[playerid] = unixtime+3;
            }//Вызов рабочего транспорта
            if (listitem == 1)
            {//Прервать работу
				if (QuestActive[playerid] == 2) SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Доставщик Пиццы{FFCC00}>> прервана.");
                if (QuestActive[playerid] == 4)
                {
                    RemovePlayerAttachedObject(playerid,8); DeletePVar(playerid,"WorkDomStage");
                    SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Домушник{FFCC00}>> прервана.");
                }
                if (QuestActive[playerid] == 5)
                {
                    GangZoneHideForPlayer(playerid,WorkZoneCombine);
                    SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Комбайнер{FFCC00}>> прервана.");
                }
                if (QuestActive[playerid] == 6)
				{
				    DeletePVar(playerid,"WorkTruckStage");
					SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Дальнобойщик{FFCC00}>> прервана.");
				}
				if (QuestActive[playerid] == 7)
				{
				    DeletePVar(playerid,"WorkWaterStage");
					SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Капитан Корабля{FFCC00}>> прервана.");
				}
				if (QuestActive[playerid] == 8)
                {
                    DeletePVar(playerid,"WorkBankStage");
                    SendClientMessage(playerid,COLOR_QUEST,"Работа <<{FFFFFF}Инкассатор{FFCC00}>> прервана.");
                }
				QuestActive[playerid] = 0; DisablePlayerCheckpoint(playerid); DisablePlayerRaceCheckpoint(playerid);
            }//Прервать работу
        }//Вызов рабочего транспорта или прекращение работы

        case DIALOG_LEAVEZM:
        {//Покинуть Зомби-Выживание?
            if (!response) return 1;
            JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			ZMStarted[playerid] = 0;
			ZMIsPlayerIsZombie[playerid] = 0;
			ZMIsPlayerIsTank[playerid] = 0;
			SendClientMessage(playerid,COLOR_ZOMBIE,"Вы покинули зомби-выживание.");
			GangZoneHideForPlayer(playerid,ZZones[ZMid-1]);
			ZMPlayers--;
			Player[playerid][LeaveZM] = 1800;//Запрещаем час ходить на зомби
			SetPlayerVirtualWorld(playerid,0);
			ResetPlayerWeapons(playerid);
			//SetPlayerWorldBounds(playerid, 20000.0000, -20000.0000, 20000.0000, -20000.0000);
			LSpawnPlayer(playerid);
			ShowClanZones(playerid);
			new String[120];
			format(String,sizeof(String),"%s[%d] покинул зомби-выживание.", PlayerName[playerid], playerid);
			foreach(Player, cid) if (cid != playerid && JoinEvent[cid] == EVENT_ZOMBIE) SendClientMessage(cid,COLOR_ZOMBIE,String);
        }//Покинуть Зомби-Выживание?
		/*case DIALOG_LEAVEF:
        {//Покинуть ctf?
            if (!response) return 1;
            JoinEvent[playerid] = 0; InEvent[playerid] = 0; //TDMStarted[playerid] = 0;
			SendClientMessage(playerid,COLOR_TDM,"Вы покинули командный десматч.");
			TDMPlayers--;
			//LostFlag(playerid);
			SetPlayerVirtualWorld(playerid,0);
			ResetPlayerWeapons(playerid);
			LSpawnPlayer(playerid);
			new String[120]; format(String,sizeof(String),"%s[%d] покинул командный десматч.", PlayerName[playerid], playerid);
			foreach(Player, cid) if (cid != playerid && JoinEvent[cid] == EVENT_TDM) SendClientMessage(cid,COLOR_TDM,String);
        }//Покинуть ctf?*/
		case DIALOG_CLANRENAME:
		{//переименовать клан
			if(response)
			{//респонс
				if(!strlen(inputtext) || strlen(inputtext) < 2 || strlen(inputtext) > 20) return ShowPlayerDialog(playerid, DIALOG_CLANRENAME, 1, "Введите название клана", "{FF0000}ОШИБКА: Неверная длина названия..\n\n{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "ОК", "Отмена"); //если длина некорректна

				new AllowName = 1;
			    for (new i; i < strlen(inputtext); i++)
				{//Проверка каждого символа в нике на допустимость
				    if (inputtext[i] >= '0' && inputtext[i] <= '9') continue;
				    if (inputtext[i] >= 'A' && inputtext[i] <= 'Z') continue;
				    if (inputtext[i] >= 'a' && inputtext[i] <= 'z') continue;
                    if (inputtext[i] == '_') continue;
				    AllowName = 0;
				}//Проверка каждого символа в нике на допустимость
				if (!AllowName)  return ShowPlayerDialog(playerid, DIALOG_CLANRENAME, 1, "Введите название клана", "{FF0000}ОШИБКА: В названии допускаются только латинские буквы, цифры и символ '_'.\n\n{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "ОК", "Отмена");

				for(new i = 1; i < MAX_CLAN; i++)
				{//все возможные id`ы кланов
					if (Clan[i][cLevel] == 0) continue; //Пропускаем несуществующие кланы
                    if(!strcmp(Clan[i][cName], inputtext, true)) return ShowPlayerDialog(playerid, DIALOG_CLANRENAME, 1, "Введите название клана", "{FF0000}ОШИБКА: Клан с таким именем уже существует.\n\n{FFFFFF}Введите название клана.\n{008E00}[Длина от 2 до 20 символов]", "ОК", "Отмена");
				}//все возможные id`ы кланов
				if (Player[playerid][Cash] < 500000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет {FFFFFF}500 000{FF0000}$");
				Player[playerid][Cash] -= 500000;

				new clanid = Player[playerid][MyClan];
                strmid(Clan[clanid][cName], inputtext, 0, strlen(inputtext), 20);
				SaveClan(clanid); SavePlayer(playerid);

				if (Clan[clanid][cBase] > 0 && Clan[clanid][cBase] < MAX_BASE)
				{//У клана есть штаб
				    new baseid = Clan[clanid][cBase], text3d[MAX_3DTEXT];
				    format(text3d, sizeof(text3d), "{007FFF}Штаб ({FFFFFF}%d${007FFF})\n{008E00}Клан:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Base[baseid][bPrice], Clan[clanid][cName]);
					UpdateDynamic3DTextLabelText(BaseText3D[baseid], 0xFFFFFFFF, text3d);
				}//У клана есть штаб

				new ChatMes[120]; format(ChatMes, sizeof(ChatMes), "{008E00}Вы изменили название клана на '{FFFFFF}%s{008E00}'", inputtext);
				SendClientMessage(playerid,COLOR_GREEN, ChatMes);
			}//респонс
		}//ввод названия клана

		case DIALOG_BASEMENUPRICE:
		{//цена дома
			if(response)
			{//респонс
			    new clanid = Player[playerid][MyClan], baseid = Clan[clanid][cBase], entered = strval(inputtext);
			    if (baseid <= 0 ||Base[baseid][bClan] != clanid) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш штаб");
			    if (Player[playerid][Leader] < 100) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Только лидер клана может увеличить цену штаба");
				if (entered <= 0) return SendClientMessage(playerid,COLOR_RED,"Введенная сумма некорректна");
				if (entered > Player[playerid][Cash]) entered = Player[playerid][Cash];
				new BankFree = 80000000 - Base[baseid][bPrice]; if (BankFree < entered) entered = BankFree;
				if (entered == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Стоимость штаба уже достигла максимума");
				Base[baseid][bPrice] += entered;Player[playerid][Cash] -= entered; SavePlayer(playerid); SaveBase(baseid);
				new text3d[MAX_3DTEXT], String[140], ccolor = Clan[clanid][cColor];
				format(text3d, sizeof(text3d), "{007FFF}Штаб ({FFFFFF}%d${007FFF})\n{008E00}Клан:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Base[baseid][bPrice], Clan[clanid][cName]);
				UpdateDynamic3DTextLabelText(BaseText3D[baseid], 0xFFFFFFFF, text3d);
				format(String,sizeof(String),"%s[%d] увеличил цену штаба на %d$", PlayerName[playerid], playerid, entered);
				foreach(Player, cid) if (Player[cid][Member] != 0 && Player[cid][MyClan] == Player[playerid][MyClan] && Logged[cid] == 1) SendClientMessage(cid,ClanColor[ccolor],String);
			}//респонс
			else ShowPlayerDialog(playerid, DIALOG_BASEMENU, 2, "{007FFF}Штаб", "{008D00}Войти в штаб{FFFFFF}\nИнформация о штабе\nКупить штаб\nПродать штаб\nУвеличить цену штаба\nСделать местом респавна\n{FF0000}Отмена", "ОК", "");
		}//цена дома

        case DIALOG_CHATNAME:
		{//разноцветный ник для чата
		    if (!response || !strlen(inputtext)) return 1;
		    if (strlen(inputtext) > 79) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы ввели слишком много символов!");
		    if ((strfind(inputtext, "'", true)!=-1) || (strfind(inputtext, "`", true)!=-1) || (strfind(inputtext, "=", true)!=-1) || (strfind(inputtext, "server", true)!=-1) || (strfind(inputtext, "admin", true)!=-1) || (strfind(inputtext, "moder", true)!=-1)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: В тексте запрещенные символы или слова!");
		    new BasicNick[80], allowed;
			//Сначала проверяем введенные коды цвета на корректность. Пример правильного кода *FF0000*
			for(new i = 0; i < strlen(inputtext); i++)
			{//цикл
				if(inputtext[i] == '*' || inputtext[i] == '{')
				{//Если нашло "*" в тексте
				    if (inputtext[i+7] == '*' || inputtext[i+7] == '}')
				    {//Найдена вторая * на нужном месте (закрывающая скобка)
						inputtext[i] = '{'; inputtext[i+7] = '}';
						for (new u = i+1; u < i+7; u++)
						{//цикл для символов внутри скобок
							allowed = 0;
							if (inputtext[u] >= '0' && inputtext[u] <= '9') allowed = 1;
							if (inputtext[u] >= 'A' && inputtext[u] <= 'F') allowed = 1; //A - F
							if (inputtext[u] >= 'a' && inputtext[u] <= 'f') allowed = 1;//a - f
							if (allowed == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Один из кодов цвета указан неверно!");
						}//цикл для символов внутри скобок
						i += 7; continue;
				    }//Найдена вторая * на нужном месте (закрывающая скобка)
				    else return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Один из кодов цвета указан неверно!");
				}//Если нашло "*" в тексте
			}//цикл

			//Теперь проверяем введенный ник на корректность (совпадает ли с настоящим)
			if (Player[playerid][Admin] < 4 && Player[playerid][SPN2] == 0)
			{//гл. админ сможет сделать себе какой угодно ник
	            strmid(BasicNick, inputtext, 0, strlen(inputtext), 80);
				for(new i = 0; i < strlen(BasicNick); i++)
				{//цикл
					if(BasicNick[i] == '{') strdel(BasicNick, i, i + 8);//удаляем коды цвета
				}//цикл
				if(strcmp(BasicNick, PlayerName[playerid], false)) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Введенный вами ник отличается от вашего настоящего ника!");
				if(strlen(BasicNick) < strlen(PlayerName[playerid])) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы ввели неверный или пустой ник!");
			}//гл. админ сможет сделать себе какой угодно ник

            strmid(ChatName[playerid], inputtext, 0, strlen(inputtext), 80);
            //---сохраним
            new query[200];
			mysql_format(connects,query,sizeof(query),"UPDATE `accounts` SET `ChatName` = '%s' WHERE `SID` = '%i'",ChatName[playerid], Player[playerid][SID]);
			mysql_tquery(connects, query);
			//SavePlayer(playerid);//сохраняем новый ник
		    new String[140];
			format(String, sizeof String, "%s {FFFFFF}- Так выглядит ваш новый ник.", inputtext);
		    SendClientMessage(playerid, GetPlayerColor(playerid), String);
		}//разноцветный ник для чата

		case DIALOG_CHANGEPASS:
		{//смена пароля
		    new String[480];
		    if (!response)
		    {
		        format(String,sizeof(String), "SERVER: {AFAFAF}%s[%d] отказался изменять пароль.", PlayerName[playerid], playerid);
				foreach(Player, cid) if (Player[cid][Admin] >= 4 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
				return 1;
		    }
		    if(!strlen(inputtext) || strlen(inputtext) < 6 || strlen(inputtext) > 24)
			{
				format(String, sizeof(String), "{FFFFFF}Введите новый пароль:\n\n     {008000}Примечания:\n     - Пароль должен быть сложным (Пример: s9cQ17)\n     {FF0000}- Длина пароля должна быть от 6 до 24 символов\n     {FF0000}- Запрещено использовать '=' в пароле");
				return ShowPlayerDialog(playerid, DIALOG_CHANGEPASS, DIALOG_STYLE_INPUT, "{FF0000}Смена пароля", String, "ОК", "Отмена");
			}
			for (new i; i < strlen(inputtext); i++)
			{
	   			if (inputtext[i] == '=')
	   			{//В пароле есть символ =
    				format(String, sizeof(String), "{FFFFFF}Введите новый пароль:\n\n     {008000}Примечания:\n     - Пароль должен быть сложным (Пример: s9cQ17)\n     {FF0000}- Длина пароля должна быть от 6 до 24 символов\n     {FF0000}- Запрещено использовать '=' в пароле");
					return ShowPlayerDialog(playerid, DIALOG_REGISTER, DIALOG_STYLE_INPUT, "{FFD700}Смена пароля", String, "ОК", "Отмена");
	   			}//В пароле есть символ =
	   		}
	   		strmid(PlayerPass[playerid], inputtext, 0, strlen(inputtext), MAX_PASSWORD);
	   		//-----
	   		new query[100];
			format(query,sizeof(query),"UPDATE `accounts` SET `Password` = '%s' WHERE `SID` = '%i'",PlayerPass[playerid],Player[playerid][SID]);
			mysql_tquery(connects, query);
			//-----
	   		//SavePlayer(playerid);

	   		format(String,sizeof(String), "SERVER: {AFAFAF}%s[%d] изменил свой пароль.", PlayerName[playerid], playerid);
			foreach(Player, cid) if (Player[cid][Admin] >= 4 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
			format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   %s[%d] изменил пароль на %s", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, inputtext);
			WriteLog("GlobalLog", String); WriteLog("PasswordChanges", String);
		}//смена пароля

		case DIALOG_CASINORULET:
		{//Рулетка на деньги
		    if(response)
			{//респонс
			    if(listitem == 0) {CasinoBet[playerid] = 37; ShowPlayerDialog(playerid,DIALOG_CASINORULETBETSIZE,1,"Размер ставки","Введите размер ставки","ОК","Назад");}//красное (37)
			    if(listitem == 1) {CasinoBet[playerid] = 38; ShowPlayerDialog(playerid,DIALOG_CASINORULETBETSIZE,1,"Размер ставки","Введите размер ставки","ОК","Назад");}//черное (38)
			    if(listitem == 2) {CasinoBet[playerid] = 41; ShowPlayerDialog(playerid,DIALOG_CASINORULETBETSIZE,1,"Размер ставки","Введите размер ставки","ОК","Назад");}//первая треть (41)
			    if(listitem == 3) {CasinoBet[playerid] = 42; ShowPlayerDialog(playerid,DIALOG_CASINORULETBETSIZE,1,"Размер ставки","Введите размер ставки","ОК","Назад");}//вторая треть (42)
			    if(listitem == 4) {CasinoBet[playerid] = 43; ShowPlayerDialog(playerid,DIALOG_CASINORULETBETSIZE,1,"Размер ставки","Введите размер ставки","ОК","Назад");}//первая треть (43)
			    if(listitem == 5) ShowPlayerDialog(playerid,DIALOG_CASINORULETBETNUMBER,1,"Ставка на число","Введите число, на которое хотите сделать ставку (0-36)","ОК","Назад");//на число (0 - 37)
			}//респонс
		}//Рулетка на деньги

		case DIALOG_CASINORULETBETNUMBER:
		{//ставка на число
			if(response)
			{//респонс
			    new entered = strval(inputtext);
			    if (entered < 0 || entered > 36)
			    {
			        ShowPlayerDialog(playerid,DIALOG_CASINORULETBETNUMBER,1,"Ставка на число","Введите число, на которое хотите сделать ставку (0-36)\n\n{FF0000}Ошибка: Введено неверное число","ОК","Назад");
			        return 1;
				}
				CasinoBet[playerid] = entered;
				ShowPlayerDialog(playerid,DIALOG_CASINORULETBETSIZE,1,"Размер ставки","Введите размер ставки","ОК","Назад");
			}//респонс
			else
			{
       			new String[180], MaxBet;
		  		if (Player[playerid][Level] < 39) MaxBet = 100000; //1 - 38 лвл: 100 000$
	   			else if (Player[playerid][Level] < 53) MaxBet = 250000; //39 - 52 лвл: 250 000$
	   			else if (Player[playerid][Level] < 66) MaxBet = 500000; //53 - 65 лвл: 500 000$
	   			else MaxBet = 1000000; //66+ лвл: 1 000 000$
 	   			if (Player[playerid][Prestige] >= 9) MaxBet = 100000000; //Престиж 9: 100 000 000$
				format(String,sizeof(String),"{AFAFAF}Максимальная Ставка: {FFFFFF}%d", MaxBet);
				ShowPlayerDialog(playerid, DIALOG_CASINORULET, 2, String, "{FFFFFF}Поставить на {FF0000}Красное\n{FFFFFF}Поставить на {AFAFAF}Черное\n{FFFFFF}Поставить на {FFFF00}1-12\n{FFFFFF}Поставить на {FFFF00}13-24\n{FFFFFF}Поставить на {FFFF00}25-36\n{FFFFFF}Поставить на {FFFF00}Число", "ОК", "Отмена");
			}
		}//ставка на число

		case DIALOG_CASINORULETBETSIZE:
		{//ввод размера ставки
   			new String[180], MaxBet, BetColor;
   		 		if (Player[playerid][Level] < 39) MaxBet = 100000; //1 - 38 лвл: 100 000$
	   			else if (Player[playerid][Level] < 53) MaxBet = 250000; //39 - 52 лвл: 250 000$
	   			else if (Player[playerid][Level] < 66) MaxBet = 500000; //53 - 65 лвл: 500 000$
	   			else MaxBet = 1000000; //66+ лвл: 1 000 000$
    			if (Player[playerid][Prestige] >= 9) MaxBet = 100000000; //Престиж 8: 100 000 000$

			if(response)
			{//респонс
				new entered = strval(inputtext);new StringB[120], Result;
				if (entered > Player[playerid][Cash]) entered = Player[playerid][Cash];
				if (entered <= 0) return SendClientMessage(playerid,COLOR_RED,"Введенная сумма некорректна или у вас нет денег!");
				if (entered > MaxBet) entered = MaxBet;//макс. ставка
				Player[playerid][Cash] -= entered; Player[playerid][CasinoBalance] -= entered;
				if (CasinoBet[playerid] == 37 || CasinoBet[playerid] == 38)
				{//Ставка на красное или черное
					if (CasinoBet[playerid] == 37){format(StringB,sizeof(StringB),"{FFFF00}Вы поставили {FFFFFF}%d${FFFF00} на Красное.", entered);}
					if (CasinoBet[playerid] == 38){format(StringB,sizeof(StringB),"{FFFF00}Вы поставили {FFFFFF}%d${FFFF00} на Черное.", entered);}
					SendClientMessage(playerid,COLOR_YELLOW,StringB);
				}//Ставка на красное или черное

				if (CasinoBet[playerid] == 41 || CasinoBet[playerid] == 42  || CasinoBet[playerid] == 43)
				{//ставка на тройки
				    if (CasinoBet[playerid] == 41){format(StringB,sizeof(StringB),"{FFFF00}Вы поставили {FFFFFF}%d${FFFF00} на 1-12.", entered);}
				    if (CasinoBet[playerid] == 42){format(StringB,sizeof(StringB),"{FFFF00}Вы поставили {FFFFFF}%d${FFFF00} на 13-24.", entered);}
				    if (CasinoBet[playerid] == 43){format(StringB,sizeof(StringB),"{FFFF00}Вы поставили {FFFFFF}%d${FFFF00} на 25-36.", entered);}
				    SendClientMessage(playerid,COLOR_YELLOW,StringB);
				}//ставка на тройки

                if (CasinoBet[playerid] >= 0 && CasinoBet[playerid] <= 36)
				{//ставка на число
				    format(StringB,sizeof(StringB),"{FFFF00}Вы поставили {FFFFFF}%d${FFFF00} на %d", entered, CasinoBet[playerid]);
				    SendClientMessage(playerid,COLOR_YELLOW,StringB);
				}//ставка на число

				Result = random(37);

				if (CasinoBet[playerid] == 37)
				{//если была ставка на красное
					switch(Result)
					{
						case 0: BetColor = 0;//зеленый
						case 1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35: BetColor = 1;//красный
						case 2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36: BetColor = 2;//черный
					}

				    if(BetColor == 1)
				    {//победа - выпало красное
				        Player[playerid][Cash] += entered*2; Player[playerid][CasinoBalance] += entered*2;
				        format(StringB,sizeof(StringB),"Вы выиграли! На барабане: %d (Красное)", Result);
				        SendClientMessage(playerid,COLOR_YELLOW,StringB);
				        format(StringB, sizeof StringB, "+%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_GREEN, 10.0, 2000);
				        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
				    }//победа - выпало красное
				    if(BetColor == 2)
				    {//проигрыш - выпало черное
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: %d (Черное)", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
                        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш - выпало черное
				    if(BetColor == 0)
				    {//проигрыш - выпало черное
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: 0", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш - выпало черное
				}//если была ставка на красное

				if (CasinoBet[playerid] == 38)
				{//если была ставка на черное
					switch(Result)
					{
						case 0: BetColor = 0;//зеленый
						case 1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35: BetColor = 1;//красный
						case 2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36: BetColor = 2;//черный
					}

				    if(BetColor == 1)
				    {//проигрыш - выпало красное
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: %d (Красное)", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш - выпало красное
				    if(BetColor == 2)
				    {//победа - выпало черное
				        Player[playerid][Cash] += entered*2; Player[playerid][CasinoBalance] += entered*2;
				        format(StringB,sizeof(StringB),"Вы выиграли! На барабане: %d (Черное)", Result);
				        SendClientMessage(playerid,COLOR_YELLOW,StringB);
				        format(StringB, sizeof StringB, "+%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_GREEN, 10.0, 2000);
				        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
				    }//победа - выпало черное
				    if(BetColor == 0)
				    {//проигрыш - выпало черное
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: 0", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш - выпало черное
				}//если была ставка на черное

				if (CasinoBet[playerid] == 41)
				{//если была ставка на 1-12
				    if (Result >= 1 && Result <= 12)
					{//выигрыш 1-12
					    Player[playerid][Cash] += entered*3; Player[playerid][CasinoBalance] += entered*3;
				        format(StringB,sizeof(StringB),"Вы выиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_YELLOW,StringB);
				        format(StringB, sizeof StringB, "+%d$", entered*2); SetPlayerChatBubble(playerid, StringB, COLOR_GREEN, 10.0, 2000);
				        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
					}//выигрыш 1-12
					else
				    {//проигрыш
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш
				}//если была ставка на 1-12

				if (CasinoBet[playerid] == 42)
				{//если была ставка на 13-24
				    if (Result >= 13 && Result <= 24)
					{//выигрыш
					    Player[playerid][Cash] += entered*3; Player[playerid][CasinoBalance] += entered*3;
				        format(StringB,sizeof(StringB),"Вы выиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_YELLOW,StringB);
				        format(StringB, sizeof StringB, "+%d$", entered*2); SetPlayerChatBubble(playerid, StringB, COLOR_GREEN, 10.0, 2000);
				        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
					}//выигрыш
					else
				    {//проигрыш
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш
				}//если была ставка на 13-24

				if (CasinoBet[playerid] == 43)
				{//если была ставка на 25-36
				    if (Result >= 25 && Result <= 36)
					{//выигрыш
					    Player[playerid][Cash] += entered*3; Player[playerid][CasinoBalance] += entered*3;
				        format(StringB,sizeof(StringB),"Вы выиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_YELLOW,StringB);
				        format(StringB, sizeof StringB, "+%d$", entered*2); SetPlayerChatBubble(playerid, StringB, COLOR_GREEN, 10.0, 2000);
				        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
					}//выигрыш
					else
				    {//проигрыш
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш
				}//если была ставка на 25-36

				if (CasinoBet[playerid] >= 0 && CasinoBet[playerid] <= 36)
				{//если была ставка на число
				    if (Result == CasinoBet[playerid])
					{//выигрыш
					    Player[playerid][Cash] += entered*37; Player[playerid][CasinoBalance] += entered*37;
				        format(StringB,sizeof(StringB),"Вы выиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_YELLOW,StringB);
				        format(StringB, sizeof StringB, "+%d$", entered*36); SetPlayerChatBubble(playerid, StringB, COLOR_GREEN, 10.0, 2000);
				        PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//звук выигрыша
					}//выигрыш
					else
				    {//проигрыш
				        format(StringB,sizeof(StringB),"Вы проиграли! На барабане: %d", Result);
				        SendClientMessage(playerid,COLOR_GREY,StringB);
				        format(StringB, sizeof StringB, "-%d$", entered); SetPlayerChatBubble(playerid, StringB, COLOR_RED, 10.0, 2000);
				        PlayerPlaySound(playerid,1084,0.0,0.0,0.0);//звук проигрыша
				    }//проигрыш
				}//если была ставка на число

           	    if (Player[playerid][CasinoBalance] >= 100000000 && Player[playerid][Prestige] < 9)
				{
				    format(StringB, sizeof StringB, "%d.%d.%d в %d:%d:%d |   UpdatePlayer: Игрок %s[%d] разорил казино на 100 000 000$", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
					WriteLog("Casino", StringB);
					SendClientMessage(playerid, COLOR_RED, "ВЫ РАЗОРИЛИ КАЗИНО НА 100 000 000$");
				}

				QuestUpdate(playerid, 24, 1);//Обновление квеста Сделайте 20 ставок в казино
			}//респонс
			else
			{
				format(String,sizeof(String),"{AFAFAF}Максимальная Ставка: {FFFFFF}%d", MaxBet);
				ShowPlayerDialog(playerid, DIALOG_CASINORULET, 2, String, "{FFFFFF}Поставить на {FF0000}Красное\n{FFFFFF}Поставить на {AFAFAF}Черное\n{FFFFFF}Поставить на {FFFF00}1-12\n{FFFFFF}Поставить на {FFFF00}13-24\n{FFFFFF}Поставить на {FFFF00}25-36\n{FFFFFF}Поставить на {FFFF00}Число", "ОК", "Отмена");
			}
		}//ввод размера ставки

		case DIALOG_PRESTIGECOLOR:
		{//изменение своего цвета на радаре и в Tab (Престиж 7)
		    if (!response) return 1;
		    if (listitem <= 40)
			{
				Player[playerid][PrestigeColor] = listitem;
				SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно изменили свой цвет!");
                SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Изменен ваш цвет на радаре, а также цвет ника над головой и в Tab.");
                SendClientMessage(playerid,COLOR_CYAN,"Подсказка: Не работает при включенной невидимости и в чате!");
			}
		    else {Player[playerid][PrestigeColor] = -1; SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно вернули свой стандартный цвет!");}
		}//изменение своего цвета на радаре и в Tab (Престиж 7)

		case DIALOG_QUESTS:
		{//меню квестов
		    if (!response) return 1;
		    if (listitem < 3) {callcmd::quests(playerid, ""); return 1;}
		    if (listitem == 3) ObmenDialog(playerid);
		    if (listitem == 4) ShowMarafonDialog(playerid);
		    if (listitem > 4)
		    {
		        if(Player[playerid][SPN9] < 1) return ShowQuests(playerid);
          		if(Player[playerid][MenuTp] > unixtime) {SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Смена квестов еще недоступна!"); ShowQuests(playerid); return 1;}
                new qid = listitem - 5;
				if (QuestTime[playerid][qid] > 0) {SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Этот квест неактивен!"); ShowQuests(playerid); return 1;}

				new questid = Quest[playerid][qid];
                if (Player[playerid][CasinoBalance] < 100000000 || Player[playerid][Prestige] >= 9) //выбор нового квеста при доступном казино
		    	while(questid == Quest[playerid][0] || questid == Quest[playerid][1] || questid == Quest[playerid][2]) questid = random(MAX_QUESTS) + 1; //Выбираем новый квест
				else //выбор нового квеста при недоступном казино
			    while(questid == Quest[playerid][0] || questid == Quest[playerid][1] || questid == Quest[playerid][2] || questid == 24) questid = random(MAX_QUESTS) + 1; //Выбираем новый квест

				QuestScore[playerid][qid] = 0; Quest[playerid][qid] = questid; //Назначаем новый квест
				Player[playerid][MenuTp] = unixtime+3600;
				SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Квест изменен на случайный новый!");
				ShowQuests(playerid);
				return 1;
			}
		}//меню квестов
		
        case DIALOG_APLAY:
		{
		    if (!response) return 1;
			if(response)
			{
			    if(strlen(inputtext) > 120) return SendClientMessage(playerid, COLOR_WHITE, "SERVER: Длина ссылки не более 120 символов!.");
			    if (Player[playerid][Admin] < 3)
				{
					if(Player[playerid][Mrf1] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вам недоступна эта команда! Купить можно тут: /gold.");
					new mtime = gettime()-APlayTime;
					if(mtime < 300)
					{
		    			new string[120];
						format(string, sizeof string, "Заказ музыки будет доступен через {ffffff}%d{ff0000} сек.", 300-mtime);
		    			SendClientMessage(playerid,COLOR_RED,string);
		    			return 1;
					}
				}
				foreach(Player, i)
				{
				    if(Logged[i] == 1)
					{
					    if(Player[i][FindPack] == 1) {SendClientMessage(i, COLOR_GREY, "У вас выключено прослушивание музыки. Включить эту опцию можно в {ffffff}/config{afafaf}.");}
						else PlayAudioStreamForPlayer(i, inputtext);
					}
				}
            	APlayTime = gettime();
            	strmid(MusicString, inputtext, 0, strlen(inputtext), 120);
				new String[140];
            	if (Player[playerid][Admin] < 3) format(String, sizeof String, "MUSIC: Игрок {ffffff}%s{0080FF} включил для всех музыку! Введите {ffffff}/sm{0080FF} если хотите выключить.", PlayerName[playerid]);
				else format(String, sizeof String, "MUSIC: Администратор {ffffff}%s{0080FF} включил для всех музыку! Введите {ffffff}/sm{0080FF} если хотите выключить.", PlayerName[playerid]);
				SendClientMessageToAll(0x0080FFFF,String);
			}
			return 1;
		}
		
		case DIALOG_MEDALTRADE:
		{//обмен медалей
		    if (!response) {callcmd::quests(playerid, ""); return 1;}
		    
		    if (listitem == 0)
		    {//1 медаль = 200 XP
		        if (Player[playerid][Medals] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас нет медалей!");
		        Player[playerid][Medals]--; LGiveXP(playerid, 200);
		        ObmenDialog(playerid);
		        return SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно обменяли медаль на 200 XP!");
		    }//1 медаль = 200 XP
		    if (listitem == 1)
		    {//1 медаль = 50 000$
		        if (Player[playerid][Medals] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас нет медалей!");
		        Player[playerid][Medals]--; Player[playerid][Cash] += 50000;
		        ObmenDialog(playerid);
		        return SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно обменяли медаль на 50 000$");
		    }//1 медаль = 50 000$
		    if (listitem == 2)
		    {//4 медали = 25 очков кармы
		        if (Player[playerid][Medals] < 4) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас нет 4 медалей!");
		        if (Player[playerid][Karma] >= 1000) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас максимум кармы!");
		        Player[playerid][Medals] -= 4; Player[playerid][Karma] += 25;
		        ObmenDialog(playerid);
		        if (Player[playerid][Karma] >= 1000) Player[playerid][Karma] = 1000;
		        return SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно обменяли 4 медали на 25 очков кармы");
		    }//4 медали = 25 очков кармы
		    if (listitem == 3) {callcmd::prestige(playerid, ""); return 1;} //10 медалей - повысить Престиж
			if(listitem == 4)
			{//Неперекупаемый дом
				if (Player[playerid][Medals] < 14) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет 14 медалей");
			    new phouse = Player[playerid][Home], text3d[MAX_3DTEXT], String[140];
			    if (phouse == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет дома");
                if (Property[phouse][pBuyBlock] <= 0)
			    {//Покупка
			    	Property[phouse][pBuyBlock] = nowday + 7;
			        format(String, sizeof String, "Вы приобрели 'Неперекупаемый личный дом' до {00CCCC}%s", IntDateToStringDate(Property[phouse][pBuyBlock]));
			        SendClientMessage(playerid, COLOR_YELLOW, String); SendClientMessage(playerid, COLOR_YELLOW, "Если вы хотите продлить услугу, то просто купите её еще раз!");
			    }//Покупка
			    else
			    {//Продление
			    	Property[phouse][pBuyBlock] += 7;
			        format(String, sizeof String, "Вы продлили 'Неперекупаемый личный дом' до {00CCCC}%s", IntDateToStringDate(Property[phouse][pBuyBlock]));
			        SendClientMessage(playerid, COLOR_YELLOW, String);
			    }//Продление
			    UpdatePropertyInterior(phouse);
			    Player[playerid][Medals] -= 14; SaveProperty(phouse); SavePlayer(playerid);
			    ObmenDialog(playerid);
			    format(text3d, sizeof(text3d), "{00FF00}Дом ({FF0000}Не продается{00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[phouse][pOwner]);
			    UpdateDynamic3DTextLabelText(PropertyText3D[phouse], 0xFFFFFFFF, text3d);
			}//Неперекупаемый дом
			if (listitem == 5)
		    {//1 медаль = 1GG
		        if (Player[playerid][Banned] != 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Обмен медалей на рубли недоступен для забаненных игроков");
				if (Player[playerid][SPrest] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны иметь как минимум 1 уровень суперпрестижа");
				if (Player[playerid][Medals] < 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас нет медалей!");
				if (Player[playerid][GGFromMedals] >= 2 && Player[playerid][SPrest] == 1) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: 1 суперпрестиж может обменивать 2 медали в день! Повторите попытку завтра!");
				if (Player[playerid][GGFromMedals] >= 3 && Player[playerid][SPrest] == 2) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: 2 суперпрестиж может обменивать 3 медали в день! Повторите попытку завтра!");
				if (Player[playerid][GGFromMedals] >= 4 && Player[playerid][SPrest] == 3) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: 3 и более суперпрестиж может обменивать 4 медали в день! Повторите попытку завтра!");
		        Player[playerid][Medals]--; Player[playerid][GameGold] += 1.0; Player[playerid][GameGoldTotal] += 1.0;
				Player[playerid][GGFromMedals] += 1.0; Player[playerid][GGFromMedalsTotal] += 1.0;
		        return SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Вы успешно обменяли медаль на 1 рубль!");
		    }//1 медаль = 1GG
			
		}//обмен медалей

		case DIALOG_SELLHOUSE: if (response) {callcmd::sellhouse(playerid, ""); return 1;}
		case DIALOG_SELLBASE: if (response) {callcmd::sellbase(playerid, ""); return 1;}
		case DIALOG_CLANTAG:
		{
		    if(response)
		    {
		        if(listitem == 0)
		        {
					if(Player[playerid][Cash] < 5000000)
					{
					    ShowMoneyWant(playerid,1,"5.000.000");
					    ShowClanControlMenu(playerid);
						return 1;
					}
					else
					{
					    ClanTagInputShow(playerid);
					}
				}
				else
				{
				    SendClientMessage(playerid, COLOR_YELLOW, "Клановый тег удален!");
				    strmid(Clan[Player[playerid][MyClan]][cTag], "Пусто", 0, strlen("Пусто"), 25);
				    ShowClanControlMenu(playerid);
				    SaveClan(Player[playerid][MyClan]);
				    return 1;
				}
			}
			else ShowClanControlMenu(playerid);
		}
		case DIALOG_CLANTAGCHANGE:
		{
	    	if(response)
	    	{
	    		if(!strlen(inputtext) || strlen(inputtext) < 2 || strlen(inputtext) > 5)
				{
		 		    SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Длина тега от 2 до 5 символов!");
				    ClanTagInputShow(playerid);
					return 1;
				}
				new AllowName = 1;
				for (new i; i < strlen(inputtext); i++)
				{//Проверка каждого символа в нике на допустимость
					if (inputtext[i] >= '0' && inputtext[i] <= '9') continue;
					if (inputtext[i] >= 'A' && inputtext[i] <= 'Z') continue;
					if (inputtext[i] >= 'a' && inputtext[i] <= 'z') continue;
        			if (inputtext[i] == '[') continue;
        			if (inputtext[i] == ']') continue;
        			if (inputtext[i] == ')') continue;
        			if (inputtext[i] == '(') continue;
        			if (inputtext[i] == '.') continue;
					AllowName = 0;
				}//Проверка каждого символа в нике на допустимость
				if (!AllowName)
				{
		    		SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Обнаружены недопустимые символы!");
		    		ClanTagInputShow(playerid);
					return 1;
				}

				if (Player[playerid][Cash] < 5000000) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: У вас нет {FFFFFF}5 000 000{FF0000}$");
				Player[playerid][Cash] -= 5000000;
				new clanid = Player[playerid][MyClan];
            	strmid(Clan[clanid][cTag], inputtext, 0, strlen(inputtext), 20);
				SaveClan(clanid);
				SavePlayer(playerid);

				new ChatMes[120];
				format(ChatMes, sizeof(ChatMes), "{008E00}Вы изменили клановый тег на '{FFFFFF}%s{008E00}'", inputtext);
				SendClientMessage(playerid, COLOR_GREEN, ChatMes);
			}
			else ShowClanControlMenu(playerid);
		}
		case DIALOG_WINMAR:
		{
		    if(response)
		    {
		        if(listitem == 10)
				{
				    new String[1024];
			    	strcat(String, "{ffff00}• 2 этап:{ffffff} если у вас 10 престиж, приз заменяется на +70 LVL\n{ffff00}• 4 этап:{ffffff} если у вас 20 VIP, приз заменяется на +70 рублей в /shop\n{ffff00}• 6 этап:{ffffff} если ваш уровень больше 75, вам выдается 100 уровень и рубли взамен недостающих уровней\n{ffff00}• 9 этап:{ffffff} статус модератора получит только первый прошедший его игрок");
					strcat(String, "\n\n{ffff00}• 7 этап:{ffffff} Махинатор - 1 раз в час вы можете менять 1 квест в /quests.");
					ShowPlayerDialog(playerid, 999, 0, "{74DF00}Информация об этапах:", String, "ОК", "");
					return 1;
				}
		        else {ShowMarafonDialog(playerid); return 1;}
			}
		}
		case DIALOG_SCONF:
		{
		    if(response)
		    {
		        if (Player[playerid][Admin] < 4) return true;
		        if(listitem == 1)
		        {
		            if(ServConf[0] == 0) {ServConf[0] = 1; SendClientMessageToAll(COLOR_GREEN,"SERVER: Администратор включил удвоенный опыт!");}
					else {ServConf[0] = 0; SendClientMessageToAll(COLOR_RED,"SERVER: Администратор выключил удвоенный опыт.");}
					ConfigDialog(playerid);
		            SaveServerConfig();
		            return 1;
				}
				if(listitem == 2)
		        {
		            if(ServConf[1] == 0) {ServConf[1] = 1; SendClientMessage(playerid, COLOR_GREEN, "Режим разработчика включен.");}
					else {ServConf[1] = 0; SendClientMessage(playerid, COLOR_RED, "Режим разработчика выключен.");}
					ConfigDialog(playerid);
		            return 1;
				}
				
				if(listitem == 3)
		        {
		            if(ServConf[3] == 0) {ServConf[3] = 1; SendClientMessage(playerid, COLOR_GREEN, "Удвоенный опыт в топ включен.");}
					else {ServConf[3] = 0; SendClientMessage(playerid, COLOR_RED, "Удвоенный опыт в топ выключен.");}
					ConfigDialog(playerid);
		            return 1;
				}
				
				if(listitem == 4)
		        {
		            if(ServConf[4] == 0) {ServConf[4] = 1; SendClientMessage(playerid, COLOR_GREEN, "Ускоренный марафон включен.");}
					else {ServConf[4] = 0; SendClientMessage(playerid, COLOR_RED, "Ускоренный марафон выключен.");}
					ConfigDialog(playerid);
		            return 1;
				}
				
				if(listitem == 5)
		        {
		            ServConf[5] += 50; SendClientMessage(playerid, COLOR_GREEN, "Добавлено 50 билетов на продажу.");
					ConfigDialog(playerid);
		            return 1;
				}
				
				if(listitem == 6)
				{
					SaveServerConfig();
					SendClientMessage(playerid, COLOR_GREEN, "Конфигурация сохранена.");
					SaveAllClans();
					SendClientMessage(playerid, COLOR_GREEN, "Кланы сохранены.");
					SaveAllProperty();
					SendClientMessage(playerid, COLOR_GREEN, "Дома сохранены.");
					SaveAllBase();
					SendClientMessage(playerid, COLOR_GREEN, "Базы сохранены.");
					SaveAllZones();
					SendClientMessage(playerid, COLOR_GREEN, "Зоны сохранены.");
					foreach(Player, gid) if (Logged[gid] == 1) {SavePlayer(gid);}
					SendClientMessage(playerid, COLOR_GREEN, "Игроки сохранены.");
					return 1;
				}
				if(listitem == 7)
				{
					UpdateTopOperationXP();//обновим топ по хп
					UpdateTopOperationGG();//обновим топ по донату
                    FinishTopOperationXP();
			    	FinishTopOperationGG();
			    	SendClientMessageToAll(-1, "Администратор выдал награды за месячный рейтинг! Рейтинг обнулен!");
			    	return 1;
				}
				if(listitem == 8)
				{
				    SendClientMessage(playerid, COLOR_GREEN, "Лотерея отключена.");
				    ServConf[5] = 0;
				    SaveServerConfig();
				}
			}
		}
		case DIALOG_EVENTS:
		{
		    if(response)
		    {
		    	switch(listitem)
				{
				    case 0: callcmd::bt(playerid, "");
					case 1: callcmd::dm(playerid, "");
					case 2: callcmd::derby(playerid, "");
					case 3: callcmd::zombie(playerid, "");
					case 4: callcmd::race(playerid, "");
					case 5: callcmd::gungame(playerid, "");
					case 6: callcmd::xrace(playerid, "");
					case 7: callcmd::tdm(playerid, "");
					case 8: callcmd::park(playerid, "");
					case 9: callcmd::drace(playerid, "");
//					case 10: callcmd::point(playerid, "");
					case 10: callcmd::out(playerid, "");
				}
		    }
		    return 1;
		}
		case DIALOG_ZINFO:
		{
            if(response)
		    {
		        if (InEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно в соревнованиях.");
		    	if (QuestActive[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: GPS недоступно на работе и при выполнении заданий.");
				new zid = listitem+1, ChatMes[140];
				if (OnZone[playerid] == zid) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы и так на этой территории.");
		        GPSUsed[playerid] = 1;
		        //SetPVarInt(playerid, "ZoneGPS", zid);
		        ZoneGPS[playerid] = zid;
		        SetPlayerCheckpoint(playerid, GPSZone[zid][0], GPSZone[zid][1], GangZones[zid][ZHeigh], 5);
                format(ChatMes, sizeof(ChatMes), "{008E00}GPS: Территория '{FFFFFF}%s{008E00}' была отмечена на карте {FF0000}красным маркером{FFFF00}.", GangZones[zid][GZName]);
				SendClientMessage(playerid, COLOR_GREEN, ChatMes);
				return 1;
	  		}
		}
		case DIALOG_CLANSTAT:
		{
		    if(response) ShowClanMembers(playerid, PlClanID[playerid]);
		    PlClanID[playerid] = 0;
		    return 1;
		}
		case DIALOG_COMMANDS:
		{
		    if(Logged[playerid] == 0) return 1;
		    if(!response) return 1;
		    new String[1500],stropt[50];
			switch(listitem)
			{
			    case 0:
			    {
			        strcat(stropt, "{0080FF}Основные:");
			    	strcat(String, "{ff0000}/shop{ffff00}\t\t- внутриигровой магазин\n{ffffff}/quests\t- список заданий игрока\n/help\t\t- помощь по серверу\n/config\t\t- личные настройки\n/stats\t\t- личная статистика\n");
			    	strcat(String, "/givecash\t- передать деньги\n/gps\t\t- навигация по карте\n/skydive\t- прыгнуть с парашютом\n/jetpack\t- использовать джетпак\n/buygun\t- купить оружие\n/prestige\t- повысить престиж (нужен 100 ур.)\n");
                    strcat(String, "/karma\t\t- инфо о карме\n/admins\t- администрация онлайн\n/afk\t\t- игроки на паузе\n/pvp\t\t- принять дуэль\n/mycolor\t- цвет ника\n/paint\t\t- цвет авто (случайный)\n/paintid\t- цвет авто (по ид)\n/mytime\t- время в игре\n");
                    strcat(String, "/myskin\t- сменить скин\n/myskinid\t- сменить скин (по ид)\n/myspawn\t- настройка спавна\n/myweather\t- личная погода\n/eject\t\t- выкинуть из авто\n/style\t\t- стиль боя\n/version\t- последнее обновление\n");
                    strcat(String, "/invisible\t- невидимость на карте\n/specp\t\t- следить за игроком\n/specoff\t- закончить слежение\n/vip\t\t- возможности VIP\n/vips\t\t- VIP онлайн\n/radio\t\t- слушать радио\n/aplay\t\t- включить музыку для всех\n/sm\t\t- откл. музыку\n/marafon\t- статистика марафона (если активен)");
                    strcat(String, "\n/lastplay\t- слушать последний заказанный трек\n/gold\t\t- Gold-магазин (супернавыки)\n/top\t\t- топ игроков/кланов");
				}
				case 1:
				{
				    strcat(stropt, "{0080FF}Соревнования:");
				    strcat(String, "{ffffff}/events\t- список активных соревнований\n");
				    strcat(String, "/out\t\t- покинуть соревнование\n\n");
				    strcat(String, "{ffcc00}/dm{FFFFFF}\t\t- присоединиться к ДесМатчу\n");
					strcat(String, "{ff0000}/zombie{FFFFFF}\t- присоединиться к зомби\n");
					strcat(String, "{457EFF}/gungame{FFFFFF}\t- присоединиться к ГанГейму\n");
					strcat(String, "{d162ff}/derby{FFFFFF}\t\t- присоединиться к Дерби\n");
					strcat(String, "{0066ff}/race{FFFFFF}\t\t- присоединиться к гонке\n");
					strcat(String, "{ffd800}/xrace{FFFFFF}\t\t- присоединиться к лег.гонке\n");
					strcat(String, "{04B486}/tdm{FFFFFF}\t\t- присоединиться к командному ДМ\n");
					strcat(String, "{58FAF4}/park{FFFFFF}\t\t- присоединиться к паркуру\n");
					strcat(String, "{4C73E6}/drace{FFFFFF}\t\t- присоединиться к гонке на выживание\n");
					strcat(String, "{58FA82}/point{FFFFFF}\t\t- присоединиться к захвату точки\n");
				}
				case 2:
				{
					strcat(stropt, "{0080FF}Банды:");
				    strcat(String, "{ffffff}/clan\t\t- главное меню клана (управление, информация)\n/claninfo\t- информация о клане (по ид)\n/members\t- список членов клана\n/ranginfo\t- информация о рангах\n\n{0066ff}Территории:{ffffff}\n/zones\t\t- информация и навигация по территориям\n/zoneinfo\t- информация о текущей территории\n/attack\t\t- начать атаку/защиту текущей территории") ;
				}
				case 3:
				{
				    strcat(stropt, "{0080FF}Чат:");
			    	strcat(String, "{FFFFFF}/pm\t\t- отправить личное сообщение\n");
					strcat(String, "@text\t\t- написать администраторам\n");
					strcat(String, "#text\t\t- написать 'шепотом'\n");
					strcat(String, "!text\t\t- сообщение клану\n");
					strcat(String, "/chatname\t- ник в чате\n/pt\t\t- поприветсвовать всех\n/bb\t\t- попрощаться со всеми\n");
					strcat(String, "/me\t\t- действие от вашего лица\n");
				}
				case 4:
				{
				    strcat(stropt, "{0080FF}Анимации:");
				    strcat(String, "{ffffff}/action\t\t- основные действия\n/anim\t\t- список дополнительных анимаций\n/kiss id\t- поцелуй\n/hi id\t\t- поздороваться по-братски");
				}
				case 5:
				{
				    strcat(stropt, "{0080FF}Модератор/администратор:");
				    strcat(String, "{66CDAA}Модератор:{ffffff}\n");
				    strcat(String, "/say\t\t- чат от имени модера/админа\t/tele to - тп к игроку\n");
				    strcat(String, "/specp\t\t- начать слежку за игроком\t\t/specoff - окончить слежку\n");
				    strcat(String, "/ban\t\t- забанить игрока\t\t\t/unban - разбанить игрока\n");
				    strcat(String, "/kick\t\t- кикнуть игрока\t\t\t/mute - заткнуть игрока в чате\n");
				    strcat(String, "/unmute\t- снять затычку\t\t\t/cc - очистить чат\n");
				    strcat(String, "/incar\t\t- тп к игроку в авто\t\t\t/gmtest - проверка на гм\n");
				    strcat(String, "/sinfo\t\t- инфо о сервере\t\t\t/pinfo - инфо об игроке\n");
				    strcat(String, "/id <часть ника> - поиск ID игрока по нику/части\n");
				    strcat(String, "/oban <ник>\t- оффлайн бан\t\t\t/ounban <ник> - оффлайн разбан\n");
				    strcat(String, "/ot <id> <сообщение>\t- ответ игроку\n");
				    strcat(String, "{9ACD32}Супермодератор:{ffffff}\n");
				    strcat(String, "/tele to\t\t- тп к игроку\t\t/tele here - тп игрока к себе\n");
				    strcat(String, "/banip\t\t- забанить по ип\t/setweather - установить погоду\n");
				    strcat(String, "/crash\t\t- краш игры\t\t/setskin - уставновить скин\n");
				    strcat(String, "{00BFFF}Админстратор:{ffffff}\n");
			     	strcat(String, "/change\t- сменить соревнование\t/ssay - чат от SERVER\n");
			     	strcat(String, "/akill\t\t- убить игрока\t\t\t/givegun - выдать оружие\n");
			     	strcat(String, "/setworld\t- уставновить вирт. мир\t/supermute - беск. затычка\n");
				    strcat(String, "{FF7F50}Главный администратор:{ffffff}\n");
				    strcat(String, "/killserver, /restart, /arcon, /agivecash, /sconfig, /setclvl\n/setlevel, /levelup, /agivexp, /setadmin, /start, /changepass");
				}
				default: return 1;
			}
			ShowPlayerDialog(playerid, DIALOG_CMDOPTION, 0, stropt, String, "Назад", "Закрыть");
			return 1;
		}
		case DIALOG_CMDOPTION:
		{
		    if(response) return DialogCommands(playerid);
		}
		case DIALOG_CHANGEPASS1:
		{//смена пароля
		    if (!response) {callcmd::config(playerid, ""); return 1;}
		    if(strcmp(PlayerPass[playerid], inputtext, true)) return ShowPlayerDialog(playerid, DIALOG_CHANGEPASS1, 1, "Смена пароля", "{FF0000}Вы уверены, что хотите сменить пароль?\n{FFFFFF}Для продолжения введите ваш {ff0000}текущий{ffffff} пароль:\n\n{ff0000}НЕВЕРНЫЙ ПАРОЛЬ!{ffffff} Повторите попытку.","ОК","Назад");
		    ShowPlayerDialog(playerid, DIALOG_CHANGEPASS2, 1, "Смена пароля", "{FFFFFF}Введите новый пароль:\n\n     {008000}Примечания:\n     - Пароль должен быть сложным (Пример: s9cQ17)\n     - Длина пароля должна быть от 6 до 24 символов\n     - Разрешены только латинские буквы и цифры","ОК","Отмена");
			return 1;
		}//смена пароля
		case DIALOG_CHANGEPASS2:
		{//смена пароля
		    new String[480];

		    if(!strlen(inputtext) || strlen(inputtext) < 6 || strlen(inputtext) > 24)
			{
				format(String, sizeof(String), "{FFFFFF}Введите новый пароль:\n\n     {008000}Примечания:\n     - Пароль должен быть сложным (Пример: s9cQ17)\n     {FF0000}- Длина пароля должна быть от 6 до 24 символов\n     {008000}- Разрешены только латинские буквы и цифры");
				return ShowPlayerDialog(playerid, DIALOG_CHANGEPASS2, DIALOG_STYLE_INPUT, "{FF0000}Смена пароля", String, "ОК", "Отмена");
			}
			for(new i = strlen(inputtext)-1; i != -1; i--)
        	{
            	switch(inputtext[i])
            	{
                	case '0'..'9', 'a'..'z', 'A'..'Z': continue;
                	default:
				 	{
				 	    format(String, sizeof(String), "{FFFFFF}Введите новый пароль:\n\n     {008000}Примечания:\n     - Пароль должен быть сложным (Пример: s9cQ17)\n     - Длина пароля должна быть от 6 до 24 символов\n     {FF0000}- Разрешены только латинские буквы и цифры");
						return ShowPlayerDialog(playerid, DIALOG_CHANGEPASS2, DIALOG_STYLE_INPUT, "{FF0000}Смена пароля", String, "ОК", "Отмена");
		 			}
				}
        	}
        	
        	format(String, sizeof(String), "SERVER: Вы успешно сменили пароль! Новый пароль: {ffffff}%s {008000}- сделайте скрин (F8) или запишите его!",inputtext);
        	SendClientMessage(playerid, 0x008000FF, String);
	   		strmid(PlayerPass[playerid], inputtext, 0, strlen(inputtext), MAX_PASSWORD);
	   		//-----
	   		new query[100];
			format(query,sizeof(query),"UPDATE `accounts` SET `Password` = '%s' WHERE `SID` = '%i'",PlayerPass[playerid],Player[playerid][SID]);
			mysql_tquery(connects, query);
			//-----
	   		format(String,sizeof(String), "SERVER: {AFAFAF}%s[%d] изменил свой пароль.", PlayerName[playerid], playerid);
			foreach(Player, cid) if (Player[cid][Admin] >= 4 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
			format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   %s[%d] изменил пароль на %s", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, inputtext);
			WriteLog("GlobalLog", String);
			WriteLog("PasswordChanges", String);
		}//смена пароля
		//new year
		case DIALOG_UPDATE:
		{
			if (Player[playerid][Time] > 10800 && Player[playerid][Bonus] != 4)
			{
				ShowPlayerDialog(playerid, 999, 0, "{ffffff}ТВОЙ ПОДАРОК!", "Ты еще не забрал свой {ffff00}Новогодний Подарок{ffffff}!\n\nЧтобы забрать его, направляйся к пирамиде в ЛВ!\nПодарок будет возле елки!", "БЕГУ", "");
			}
		}
		case DIALOG_TOP:
		{
		    if(response)
		    {
		    	switch(listitem)
		    	{
		    		case 0:
	    			{
		        		new header[64]; format(header, sizeof header, "{FF8800}Топ по опыту{AFAFAF} (%s)", LastTopUpdate);
						ShowPlayerDialog(playerid, DIALOG_OPXP, DIALOG_STYLE_TABLIST_HEADERS, header, TopOperationXP, "{FF8800}Награды", "Назад");
		    		}
		    		case 1:
		    		{
		    		    new header[64]; format(header, sizeof header, "{FF8800}Топ по донату{AFAFAF} (%s)", LastTopUpdate);
						ShowPlayerDialog(playerid, DIALOG_OPGG, DIALOG_STYLE_TABLIST_HEADERS, header, TopOperationGG, "{FF8800}Награды", "Назад");
		    		}
		    		case 2:
		    		{
		    		    new header[64]; format(header, sizeof header, "{FF8800}Топ 15 кланов{AFAFAF} (%s)", LastTopUpdate);
						ShowPlayerDialog(playerid, DIALOG_TOPCL, DIALOG_STYLE_TABLIST_HEADERS, header, TopClanArray, "Назад","");
		    		}
		    		//case 3:
		    		//{
		        	//	new header[64]; format(header, sizeof header, "{FF8800}Топ 10 игроков сервера{AFAFAF} (%s)", LastTopUpdate);
					//	ShowPlayerDialog(playerid, DIALOG_TOPUS, DIALOG_STYLE_TABLIST_HEADERS, header, TopUserArray, "Назад","");
		    		//}
    			}
		    }
		}
		
		case DIALOG_OPXP:
		{
		    if(response)
		    {
		        new String[800] = "";
				strcat(String, "{819FF7}Награды за рейтинг игроков по опыту:\n\n");
				strcat(String, "{ffffff}1-5 места: {F1C619}250 золота\n");
				strcat(String, "{ffffff}6-10 места: {F1C619}150 золота\n");
				strcat(String, "{ffffff}11-20 места: {F1C619}100 золота\n");
				strcat(String, "{ffffff}21-35 места: {F1C619}50 золота\n");
				strcat(String, "{ffffff}36-50 места: {F1C619}30 золота\n\n");
				strcat(String, "{FA5858}ВНИМАНИЕ! {819FF7}Награда начисляется в конце каждого месяца в 00:00!\n");
				strcat(String, "Посмотреть свою позицию можно в /top.\nОпыт, идущий от соклановцев не учитывается.\n\nПотратить золото можно в {F1C619}/gold");
				ShowPlayerDialog(playerid, 999, 0, "{F1C619}Награды за топ по ХП:", String, "ОК", "");
				return 1;
			}
			else {TopListDialog(playerid); return 1;}
		}
		case DIALOG_OPGG:
  		{
  			if(response)
		    {
		        new String[1000] = "";
				strcat(String, "{819FF7}Награды за рейтинг игроков по донату:\n\n");
				strcat(String, "{ffffff}1 место: {F1C619}800 золота\n");
				strcat(String, "{ffffff}2 место: {F1C619}700 золота\n");
				strcat(String, "{ffffff}3 место: {F1C619}600 золота\n");
				strcat(String, "{ffffff}4-6 место: {F1C619}400 золота\n");
				strcat(String, "{ffffff}7-10 место: {F1C619}350 золота\n");
				strcat(String, "{ffffff}11-20 место: {F1C619}300 золота\n");
				strcat(String, "{ffffff}21-30 место: {F1C619}150 золота\n");
				strcat(String, "{ffffff}31-50 место: {F1C619}100 золота\n\n");
				strcat(String, "{FA5858}ВНИМАНИЕ! {819FF7}Награда начисляется в конце каждого месяца в 00:00!\n");
				strcat(String, "Посмотреть свою позицию можно в /top.\nОпыт, идущий от соклановцев не учитывается.\n\nПотратить золото можно в {F1C619}/gold");
				ShowPlayerDialog(playerid, 999, 0, "{F1C619}Награды за топ по донату:", String, "ОК", "");
				return 1;
			}
			else {TopListDialog(playerid); return 1;}
  		}
        case DIALOG_TOPCL: if(response) {TopListDialog(playerid); return 1;}
        case DIALOG_GOLD:
        {
        	if(response)
		    {
		        switch(listitem)
		    	{
		    		case 0:
	    			{
	    			    if(Player[playerid][Gold] < 1200) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN2] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 1200;
	    			        Player[playerid][SPN2] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Маскарад'! Используйте /chatname, чтобы изменить ник в чате!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
		    		case 1:
	    			{
	    			    if(Player[playerid][Gold] < 950) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][Mrf1] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 950;
	    			        Player[playerid][Mrf1] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Плеер /aplay'! Теперь вы можете включать музыку для всех игроков!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
		    		case 2:
	    			{
	    			    if(Player[playerid][Gold] < 800) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
                        new cid = Player[playerid][MyClan];
	    			    if(cid > 0 && Player[playerid][Leader] == 100 && Clan[cid][Imm] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 800;
	    			        Clan[cid][Imm] = 1;
	    			        SaveClan(cid);
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Бессмертный полк'! Теперь ваш клан защищен от автоматического удаления!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        SendClanMessage(cid, "CLAN: Лидер банды купил защиту от удаления для клана!", COLOUR_GANG_CHAT);
	    			        GoldDialog(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Вы должны быть лидером клана или у вашего клана уже есть этот навык!"); return 1;}
					}
					
					case 3:
	    			{
	    			    if(Player[playerid][Gold] < 800) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN6] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 800;
	    			        Player[playerid][SPN6] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Мастер-оружейник'! Теперь в /mygun гораздо больше доступного оружия!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 4:
	    			{
	    			    if(Player[playerid][Gold] < 500) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN8] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 500;
	    			        Player[playerid][SPN8] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Телепортер'! Введите /tphere <id>, чтобы телепортировать игрока к себе!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 5:
	    			{
	    			    if(Player[playerid][Gold] < 500) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][Type] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 500;
	    			        Player[playerid][Type] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Авто-винилы'! Отправляйтесь в TurboSpeed чтобы установить надпись!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 6:
	    			{
	    			    if(Player[playerid][Gold] < 400) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN7] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 400;
	    			        Player[playerid][SPN7] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Авто-призрак'! Введите /prizrak, чтобы сделать ваше авто невидимым.!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 7:
	    			{
	    			    if(Player[playerid][Gold] < 300) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN1] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 300;
	    			        Player[playerid][SPN1] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Пушка-телепорт'! Активация - /pgun.!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					
					case 8:
	    			{
	    			    if(Player[playerid][Gold] < 300) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN4] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 300;
	    			        Player[playerid][SPN4] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Грабитель'! Деньги от убитого игрока будут идти сразу вам на счет!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 9:
	    			{
	    			    if(Player[playerid][Gold] < 150) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN3] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 150;
	    			        Player[playerid][SPN3] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Король чата'! Вам доступно: /me, /bb, /pt, 10 сек между цв. сообщениями!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 10:
	    			{
	    			    if(Player[playerid][Gold] < 150) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
	    			    if(Player[playerid][SPN5] < 1)
	    			    {
	    			        Player[playerid][Gold] -= 150;
	    			        Player[playerid][SPN5] = 1;
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Дизайнер'! Теперь можно менять иконку и пикап у своего дома (в меню Улучшения)!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        GoldDialog(playerid);
	    			        SavePlayer(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: У вас уже есть этот навык!"); return 1;}
					}
					
					case 11:
	    			{
	    			    if(Player[playerid][Gold] < 100) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
                        new cid = Player[playerid][MyClan];
	    			    if(cid > 0 && Player[playerid][Leader] == 100 && Clan[cid][cSlots] < 25)
	    			    {
	    			        Player[playerid][Gold] -= 100;
	    			        Clan[cid][cSlots]++;
	    			        SaveClan(cid);
	    			        SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 'Доп. слот в клане'!");
	    			        PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			        SendClanMessage(cid, "CLAN: Лидер банды купил доп. слот для клана!", COLOUR_GANG_CHAT);
	    			        GoldDialog(playerid);
						}
						else {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Вы должны быть лидером клана или у вашего клана уже максимум (25) слотов!"); return 1;}
					}
					case 12:
	    			{
	    			    if(Player[playerid][Gold] < 50) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: Недостаточно золота для покупки этой опции!"); return 1;}
                        if(Player[playerid][Level] > 99 && Player[playerid][Prestige] < 10) {GoldDialog(playerid);SendClientMessage(playerid, COLOR_RED, "GOLDSHOP: На данный момент эта опция недоступна, т.к. вы 100 уровень и меньше 10 престижа!"); return 1;}
	    		        Player[playerid][Gold] -= 50;
	    		        Player[playerid][Exp] += 25000;
	    		        if (Player[playerid][Exp] >= NeedXP[playerid] && (0 < Player[playerid][Level] < 100 || Player[playerid][Prestige] >= 10)) PlayerLevelUp(playerid);
	    			    SendClientMessage(playerid, COLOR_GOLDSHOP, "GOLDSHOP: Вы купили опцию 25.000 хп на прокачку!");
	    			    PlayerPlaySound(playerid,1057,0.0,0.0,0.0);
	    			    GoldDialog(playerid);
					}
				}
				return 1;
			}
        }
        
        case DIALOG_HOUSEUPD:
        {
            if(response)
		    {
            switch(listitem)
		    	{
		    		case 0:
	    			{
	    			    if(Player[playerid][SPN5] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вам нужен навык Дизайнер! Приобрести его можно в {ffffff}/gold{ff0000}.");
	    			    if(Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
            			ShowModelSelectionMenu(playerid, MenuHousePick, "Pickups");
	    			    return 1;
	    			}
	    			case 1:
	    			{
	    			    if(Player[playerid][SPN5] == 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вам нужен навык Дизайнер! Приобрести его можно в {ffffff}/gold{ff0000}.");
	    			    if(Player[playerid][Cash] < 1000000) return ShowMoneyWant(playerid,1,"1.000.000");
	    			    ShowModelSelectionMenu(playerid, MenuHouseIcon, "Icons");
	    			    return 1;
	    			}
    			}
   			}
   			else ShowHouseDialog(playerid);
            return 1;
		}
		
		case DIALOG_BASEUPD:
        {
            if(response)
		    {
            switch(listitem)
		    	{
		    		case 0:
	    			{
	    			    if (Player[playerid][Leader] < 5) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны иметь как минимум 5 ранг в клане.");
	    			    if(JoinEvent[playerid] > 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Сначала покиньте соревнование (/out)");
	    			    if (GetPlayerVirtualWorld(playerid) != 0) return 1;
	    			    PlayerChangeBaseInterior(playerid);
	    			    return 1;
	    			}
    			}
   			}
   			else ShowHouseDialog(playerid);
            return 1;
		}
		case DIALOG_INVENT:
		{
			if(BTStarted[playerid] != 1) return 1;
			if(response)
		    {
            	switch(listitem)
		    	{
		    		case 0:
	    			{
						if(PlayerInv[playerid][0] == -1) return SendClientMessage(playerid,COLOR_YELLOW," BT: В этом слоте нет оружия.");
						RemovePlayerWeapon(playerid, Loot[PlayerInv[playerid][0]][LWeapon]);
						//SetPlayerAmmo(playerid, Loot[PlayerInv[playerid][0]][LWeapon], 0);
						new Float: nl[3], String[140];
						GetPlayerPos(playerid, nl[0], nl[1], nl[2]);
                        CreateLoot(nl[0], nl[1], nl[2]-0.87, float(random(360)), PlayerInv[playerid][0], Slot1Bullets[playerid]);
                        format(String,sizeof(String), " BT: Вы выбросили из 1 слота оружие {ffffff}%s (%d)", Loot[PlayerInv[playerid][0]][LName],Slot1Bullets[playerid]);
                        SendClientMessage(playerid,COLOR_YELLOW,String);
                        ApplyAnimation(playerid, "BOMBER", "BOM_Plant", 4.0, 0, 0, 0, 0, 700);
	    			    PlayerInv[playerid][0] = -1;
						Slot1Bullets[playerid] = 0;
						ShowPlayerBTInventory(playerid);
	    			}
	    			case 1:
	    			{
						if(PlayerInv[playerid][1] == -1) return SendClientMessage(playerid,COLOR_YELLOW," BT: В этом слоте нет оружия.");
						RemovePlayerWeapon(playerid, Loot[PlayerInv[playerid][1]][LWeapon]);
						//SetPlayerAmmo(playerid, Loot[PlayerInv[playerid][1]][LWeapon], 0);
						new Float: nl[3], String[140];
						GetPlayerPos(playerid, nl[0], nl[1], nl[2]);
                        CreateLoot(nl[0], nl[1], nl[2]-0.87, float(random(360)), PlayerInv[playerid][1], Slot2Bullets[playerid]);
                        format(String,sizeof(String), " BT: Вы выбросили из 2 слота оружие {ffffff}%s (%d)", Loot[PlayerInv[playerid][1]][LName],Slot2Bullets[playerid]);
                        SendClientMessage(playerid,COLOR_YELLOW,String);
                        ApplyAnimation(playerid, "BOMBER", "BOM_Plant", 4.0, 0, 0, 0, 0, 700);
	    			    PlayerInv[playerid][1] = -1;
						Slot2Bullets[playerid] = 0;
						ShowPlayerBTInventory(playerid);
	    			}
	    			case 2:
	    			{
						if(PlayerInv[playerid][3] == -1) return SendClientMessage(playerid,COLOR_YELLOW," BT: У вас нет метательного оружия.");
						//SetPlayerAmmo(playerid, Loot[PlayerInv[playerid][3]][LWeapon], 0);
						RemovePlayerWeapon(playerid, Loot[PlayerInv[playerid][3]][LWeapon]);
						new Float: nl[3], String[140];
						GetPlayerPos(playerid, nl[0], nl[1], nl[2]);
                        CreateLoot(nl[0], nl[1], nl[2]-0.87, 0.0, PlayerInv[playerid][3], ThrowCount[playerid]);
                        format(String,sizeof(String), " BT: Вы выбросили метательное оружие {ffffff}%s (%d)", Loot[PlayerInv[playerid][3]][LName],ThrowCount[playerid]);
                        SendClientMessage(playerid,COLOR_YELLOW,String);
                        ApplyAnimation(playerid, "BOMBER", "BOM_Plant", 4.0, 0, 0, 0, 0, 700);
	    			    PlayerInv[playerid][3] = -1;
						ThrowCount[playerid] = 0;
						ShowPlayerBTInventory(playerid);
	    			}
	    			case 3:
	    			{
						if(PlayerInv[playerid][2] == -1) return SendClientMessage(playerid,COLOR_YELLOW," BT: У вас нет холодного оружия.");
						RemovePlayerWeapon(playerid, Loot[PlayerInv[playerid][2]][LWeapon]);
						new Float: nl[3], String[140];
						GetPlayerPos(playerid, nl[0], nl[1], nl[2]);
                        CreateLoot(nl[0], nl[1], nl[2]-0.87, float(random(360)), PlayerInv[playerid][2], 1);
                        format(String,sizeof(String), " BT: Вы выбросили холодное оружие {ffffff}%s", Loot[PlayerInv[playerid][2]][LName]);
                        SendClientMessage(playerid,COLOR_YELLOW,String);
                        ApplyAnimation(playerid, "BOMBER", "BOM_Plant", 4.0, 0, 0, 0, 0, 700);
	    			    PlayerInv[playerid][2] = -1;
	    			    ShowPlayerBTInventory(playerid);
	    			}
					case 4:
					{
					    if(PlayerInv[playerid][0] == -1 && PlayerInv[playerid][1] == -1) return SendClientMessage(playerid,COLOR_YELLOW," BT: Слоты пусты.");
						new lstw = PlayerInv[playerid][0], lstb = Slot1Bullets[playerid];
						PlayerInv[playerid][0] = PlayerInv[playerid][1]; Slot1Bullets[playerid] = Slot2Bullets[playerid];
						PlayerInv[playerid][1] = lstw; Slot2Bullets[playerid] = lstb;
						ShowPlayerBTInventory(playerid);
						return SendClientMessage(playerid,COLOR_YELLOW," BT: Вы поменяли местами оружие в 1 и 2 слотах.");
					}
				}
			}
		}

	}//switch
	}
	return 1;
}

public OnPlayerClickMap(playerid, Float:fX, Float:fY, Float:fZ)
{
	if (InEvent[playerid] != 0 || QuestActive[playerid] != 0) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Нельзя использовать телепорт по карте во время работы или соревнований!");
	new rtime = MapTPTime[playerid] - unixtime;
	if (rtime > 0) {new String[140]; format(String,sizeof(String),"Телепорт по карте будет доступен через %d секунд", rtime); return SendClientMessage(playerid,COLOR_RED,String);}
    if (Player[playerid][GPremium] >= 14 || Player[playerid][Admin] >= 4)
    {//14 ViP либо глав. админ
		MapTP[playerid] = 1; MapTPTry[playerid] = 0; MapTPx[playerid] = fX; MapTPy[playerid] = fY;
		SetPlayerPos(playerid, fX, fY, -5);
    }//14 ViP либо глав. админ

	return 1;
}

public OnPlayerClickPlayer(playerid, clickedplayerid, source)
{
	if (Logged[playerid] == 0){SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны авторизироваться, чтобы открывать меню быстрого доступа");return 1;}
	if (SkinChangeMode[playerid] == 1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Данная функция недоступна при выборе модели персонажа");
	if (playerid == clickedplayerid)
	{//если кликнул сам на себя
		ShowPlayerAltMenu(playerid);
	}//если кликнул сам на себя
	else
	{//кликнул на другого игрока
		new pname[24];GetPlayerName(clickedplayerid, pname, sizeof(pname));
		if (Player[playerid][Prestige] < 5) ShowPlayerDialog(playerid, DIALOG_TABMENU, 2, PlayerName[clickedplayerid], "Статистика игрока\nСтатистика клана игрока\nОтправить сообщение игроку\nПередать деньги игроку\nВызвать на дуэль (PvP)\n{007FFF}Пригласить игрока в клан\n{FF0000}Объявить войну клану игрока", "ОК", "Отмена");
		else ShowPlayerDialog(playerid, DIALOG_TABMENU, 2, PlayerName[clickedplayerid], "Статистика игрока\nСтатистика клана игрока\nОтправить сообщение игроку\nПередать деньги игроку\nВызвать на дуэль (PvP)\n{007FFF}Пригласить игрока в клан\n{FF0000}Объявить войну клану игрока\n{008D00}Телепортироваться к игроку", "ОК", "Отмена");
		ClickedPid[playerid] = clickedplayerid;
	}//кликнул на другого игрока
	return 1;
}


public OnPlayerTakeDamage(playerid, issuerid, Float:amount, weaponid, bodypart)
{
    //Обычные пули синхронизируются в OnPlayerWeaponShot, холодное оружие в OnPlayerGiveDamage.
	if (!IsPlayerConnected(issuerid) || issuerid == playerid) {Player[playerid][PHealth] -= amount; return 1;}//Получил урон не от другого игрока (например падение с высоты или разные косяки с синхронизацией)

	//------- Ниже идет обработка урона, полученного от другого(!) игрока
	if ((weaponid == 51 || weaponid == 37 || weaponid == 49 || weaponid == 50) || ((weaponid == 31 || weaponid == 38) && IsPlayerInAnyVehicle(issuerid)) || (GetPlayerState(issuerid) == 2 && (weaponid == 28 || weaponid == 29 || weaponid == 32)))
	{//Взрывы, огонь, дб на машине, дб на вертолете, оружие на возд. транспорте
		if (InPeacefulZone[playerid] == 1 || InPeacefulZone[issuerid] == 1)
		{//В мирной зоне
			SetPlayerArmedWeapon(issuerid,0); ApplyAnimation(issuerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);
			if (IsPlayerInAnyVehicle(issuerid)) RemovePlayerFromVehicle(issuerid);
			return SendClientMessage(issuerid, COLOR_RED, "Нельзя драться в мирной зоне!");
		}//В мирной зоне
		if (PrestigeGM[issuerid] == 1)
		{//нельзя убивать если ты в режиме бога
		    if (InEvent[issuerid] == 0)
			{//не в соревнованиях
			    if (IsPlayerInAnyVehicle(issuerid)) RemovePlayerFromVehicle(issuerid);
    			ApplyAnimation(issuerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);
				return SendClientMessage(issuerid,COLOR_RED,"Запрещено пользоваться оружием в Режиме Бога");
			}//не в соревнованиях
		}//нельзя убивать если ты в режиме бога
		if (Player[playerid][PHealth] <= 0.0) return 1;//Игрок, которому наносят урон, уже мертв
		if (NOPSetPlayerHealth[issuerid] > 5 || NOPSetPlayerArmour[issuerid] > 5) return SendClientMessage(issuerid, COLOR_RED, "Ваше здоровье или броня рассинхронизированы! Урон от вашего оружия не засчитан.");

		//Само нанесение урона
		if (Player[playerid][PArmour] > amount) Player[playerid][PArmour] -= amount;
		else
		{//Если брони меньше, чем наносимый урон
		    amount -= Player[playerid][PArmour];
			Player[playerid][PHealth] -= amount; Player[playerid][PArmour] = 0.0;
		}//Если брони меньше, чем наносимый урон

		SetPlayerHealth(playerid, Player[playerid][PHealth]);
		SetPlayerArmour(playerid, Player[playerid][PArmour]);
		//Записываем жертве от кого он получил последний урон
		LastDamageFrom[playerid] = issuerid;


		if (Player[playerid][PHealth] <= 1.0 && IsPlayerConnected(issuerid) && issuerid != playerid)
		{//Убийство игрока
			OnPlayerDeathFromPlayer(playerid, issuerid, weaponid);
	        SetPlayerHealth(playerid,0.0);//Чтобы не было бага с застыванием игрока (не срабатывает OnPlayerDeath). Но с огнем глючит.
		}//Убийство игрока
	}//Взрывы, огонь, дб на машине, дб на вертолете, оружие на возд. транспорте

	return 1;
}

public OnPlayerGiveDamage(playerid, damagedid, Float:amount, weaponid, bodypart)
{
 	//new szString[140];
    //format(szString, sizeof(szString), "GiveDamage | playerid: %i   damagedid: %i   amount: %0.2f   weaponid: %i   bodypart: %i", playerid, damagedid, amount, weaponid, bodypart);
    //SendClientMessageToAll(-1, szString);

    if (weaponid < 0 || weaponid > 15) return 1;//Урон от ПУЛЬ синхронизируется в OnPlayerWeaponShot, остальной урон в TakeDamage
    //Через GiveDamage идет только урон от холодного оружия
    if (weaponid > 0 && Weapons[playerid][weaponid] == 0) return 1;//Удар из начитеренного оружия
    new Float: fX, Float: fY, Float: fZ; GetPlayerPos(damagedid, fX, fY, fZ);
	new Float: fDistance = GetPlayerDistanceFromPoint(playerid, fX, fY, fZ); if (fDistance > 3) return 1;//расстояние между игроками слишком большое (не могло задеть холодное оружие)
	if (Player[damagedid][PHealth] <= 0.0) return 1;//Игрок, которому наносят урон, уже мертв
	if (LAFK[damagedid] > 3 ||  LAFK[playerid] > 3) return 1;//Игрок, которому наносят урон, афк больше 3 или наносящий урон в афк (чит)
	if (InPeacefulZone[damagedid] == 1 || InPeacefulZone[playerid] == 1)
	{//В мирной зоне
		SetPlayerArmedWeapon(playerid,0); ApplyAnimation(playerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);
		return SendClientMessage(playerid, COLOR_RED, "Нельзя драться в мирной зоне!");
	}//В мирной зоне
	if (PrestigeGM[playerid] == 1)
	{//нельзя убивать если ты в режиме бога
	    if (InEvent[playerid] == 0)
		{//не в соревнованиях
			ApplyAnimation(playerid,"PED","KO_SKID_BACK",4.0,0,0,0,0,0,1);
			return SendClientMessage(playerid,COLOR_RED,"Запрещено пользоваться оружием в Режиме Бога");
		}//не в соревнованиях
	}//нельзя убивать если ты в режиме бога
	if (NOPSetPlayerHealth[playerid] > 5 || NOPSetPlayerArmour[playerid] > 5) return SendClientMessage(playerid, COLOR_RED, "Ваше здоровье или броня рассинхронизированы! Урон от вашего оружия не засчитан.");


	amount = ColdWeaponDamage[weaponid];//получаем значение урона от оружия ближнего боя
	//------------- Изменение наносимого урона
	if (InEvent[playerid] > 0)
	{//Игрок в соревнованиях
		if (ZMStarted[damagedid] > 0)
		{//Зомби-Выживание
			if (ZMStarted[playerid] == 1 && ZMIsPlayerIsZombie[playerid] == 0 && ZMIsPlayerIsZombie[damagedid] == 0) return SendClientMessage(playerid,COLOR_RED,"Не бейте своих!");
			//if (InEvent[playerid] == EVENT_TDM && TDMTeam[playerid] == TDMTeam[damagedid]) return SendClientMessage(playerid,COLOR_RED,"Не бейте своих!");
			if (ZMIsPlayerIsZombie[playerid] > 0 && weaponid != 0) return ResetPlayerWeapons(playerid);
			if (ZMIsPlayerIsZombie[playerid] > 0 && ZMIsPlayerIsZombie[damagedid] == 0) amount = 35;//Зомби наносят по 35 урона за удар
			if (ZMIsPlayerIsTank[playerid] > 0  && ZMIsPlayerIsZombie[damagedid] == 0) amount = 65;//Прыгуны наносят по 65 урона за удар
		}//Зомби-Выживание
		if (InEvent[playerid] == EVENT_TDM && TDMTeam[playerid] == TDMTeam[damagedid]) return SendClientMessage(playerid,COLOR_RED,"Не бейте своих!");
		//if (InEvent[playerid] == EVENT_PDM && PDMTeam[playerid] == PDMTeam[damagedid]) return SendClientMessage(playerid,COLOR_RED,"Не бейте своих!");
    }//Игрок в соревнованиях
	//------------- Изменение наносимого урона

	//------------- Нанесение урона и убийство
	if (Player[damagedid][PArmour] > amount) Player[damagedid][PArmour] -= amount;
	else
	{//Если брони меньше, чем наносимый урон
	    amount -= Player[damagedid][PArmour];
		Player[damagedid][PHealth] -= amount; Player[damagedid][PArmour] = 0.0;
	}//Если брони меньше, чем наносимый урон
	SetPlayerHealth(damagedid, Player[damagedid][PHealth]);
	SetPlayerArmour(damagedid, Player[damagedid][PArmour]);
	//Записываем жертве от кого он получил последний урон
	LastDamageFrom[damagedid] = playerid;

	if (Player[damagedid][PHealth] <= 1.0)
	{//Убийство игрока
		OnPlayerDeathFromPlayer(damagedid, playerid, weaponid);
        SetPlayerHealth(damagedid,0.0);//Чтобы не было бага с застыванием игрока (не срабатывает OnPlayerDeath)
	}//Убийство игрока
	//------------- Нанесение урона и убийство

	return 1;
}

public OnPlayerWeaponShot(playerid, weaponid, hittype, hitid, Float:fX, Float:fY, Float:fZ)
{//Стрельба из огнестрельного оружия пешком или с ПАССАЖИРСКОГО места
 	//new szString[140];
    //format(szString, sizeof(szString), "SHOT | playerid: %i   weaponid: %i   hittype: %i   hitid: %i   pos: %f, %f, %f", playerid, weaponid, hittype, hitid, fX, fY, fZ);
    //SendClientMessageToAll(-1, szString);

    //Ниже идет серия проверок на то, что выстрел не сделан читом
    if ((weaponid < 22 || weaponid > 34) && weaponid != 38) return 0;//Выстрел сделан НЕ с огрестрельного оружия.
	if (Weapons[playerid][weaponid] == 0) return 0;//Выстрел из начитеренного оружия
    if (hittype == BULLET_HIT_TYPE_PLAYER && (!(-10.0 < fX < 10.0) || !(-10.0 < fY < 10.0) || !(-10.0 < fZ < 10.0))) return 0; //Anti Bullet Crasher
	new Float: amount = WeaponShotDamage[weaponid];//получаем значение урона от пули
	WeaponShotsLastSecond[playerid]++;//+1 к кол-ву выстрелов за последнюю секунду
	if (WeaponShotsLastSecond[playerid] > WeaponShotsPerSecond[weaponid])  return 0; //Превышено макс. кол-во выстрелов за 1 секунду

    if (weaponid == 34) SetPlayerAmmo(playerid, weaponid, GetPlayerAmmo(playerid) - 1);
    
    if (weaponid == 23 && PGunActiv[playerid] == 1)
    {
        if(InEvent[playerid] == 0 && GetPlayerInterior(playerid) == 0 && GetPlayerState(playerid)==PLAYER_STATE_ONFOOT)
        {
            PGunActiv[playerid] = 0;
            if(GetPlayerDistanceFromPoint(playerid, fX, fY, fZ) > 300) {SendClientMessage(playerid, COLOR_RED, "Слишком большая дистанция! Пушка не сработала."); RemovePlayerAttachedObject(playerid,7); return 0;}
            AdminTPCantKill[playerid] = 2;
            SetPlayerPos(playerid, fX, fY, fZ+0.5);
            SetPlayerChatBubble(playerid, "Использовал пушку-телепорт", COLOR_GREEN, 300.0, 3000);
            PGunTime[playerid] = unixtime+5;
            if(Player[playerid][Slot2]!=0) GiveWeapon(playerid,Player[playerid][Slot2],200);
            SetPlayerArmedWeapon(playerid, 0);
            RemovePlayerAttachedObject(playerid,7);
			PlayerPlaySound(playerid,40408,0.0,0.0,0.0);
            return 0;
        }
    }

    if (InPeacefulZone[playerid] == 1)
	{//В мирной зоне
		SetPlayerArmedWeapon(playerid,0); ApplyAnimation(playerid,"CRACK","crckdeth1",4.1,0,0,0,0,1,1);
		SendClientMessage(playerid, COLOR_RED, "Нельзя драться в мирной зоне!"); return 0;
	}//В мирной зоне
	if (PrestigeGM[playerid] == 1)
	{//нельзя убивать если ты в режиме бога
	    if (InEvent[playerid] == 0)
		{//не в соревнованиях
			SetPlayerArmedWeapon(playerid,0); ApplyAnimation(playerid,"CRACK","crckdeth1",4.1,0,0,0,0,1,1);
			SendClientMessage(playerid,COLOR_RED,"Запрещено пользоваться оружием в Режиме Бога"); return 0;
		}//не в соревнованиях
	}//нельзя убивать если ты в режиме бога

    new Float: var; GetPlayerLastShotVectors(playerid, var, var, var, fX, fY, fZ);
    if (GetPlayerDistanceFromPoint(playerid, fX, fY, fZ) > 300) return 1;//расстояние полета пули слишком большое (у всего оружия кроме снайперки хватает 225)
	if (weaponid >= 25 && weaponid <= 27 && GetPlayerDistanceFromPoint(playerid, fX, fY, fZ) > 35) return 1;//слишком большое расстояние для дробовика

    /*if (weaponid == 24)
    {
    CreateExplosion(Float:fX, Float:fY, Float:fZ, 12, 1.5);
    }*/
    //патроны на ПУБГе
	if(BTStarted[playerid] > 0)
	{
		if(PlayerInv[playerid][0] != -1 && weaponid == Loot[PlayerInv[playerid][0]][LWeapon])
		{
		    Slot1Bullets[playerid]--;
		    if(Slot1Bullets[playerid] == 0) return 0;
		}
		else if(PlayerInv[playerid][1] != -1 && weaponid == Loot[PlayerInv[playerid][1]][LWeapon])
		{
		    Slot2Bullets[playerid]--;
		    if(Slot2Bullets[playerid] == 0) return 0;
		}
	}
	
	if(hittype == 1 && hitid != playerid || IsPlayerConnected(hitid) && Player[hitid][PHealth] > 0.0)
	{//Выстрел по другому игроку
	    if (GetPlayerDistanceFromPoint(hitid, fX, fY, fZ) > 5) return 1;//игрока нет там, куда попала пуля
	    if (weaponid == 38 && Player[hitid][Level] < 60 && InEvent[hitid] == 0) //стрельба с минигана по игроку ниже 40 лвл
			{SendClientMessage(playerid,COLOR_RED,"С минигана нельзя убивать игроков, не достигших 60-го уровня!"); SetPlayerArmedWeapon(playerid, 0);  return 0;}
        if (LAFK[hitid] > 3 ||  LAFK[playerid] > 3) return 1;//Игрок, которому наносят урон, уже мертв или AFK или наносят урон из афк (чит)
        if (Player[hitid][PHealth] <= 0.0) return 1;//Игрок, которому наносят урон, уже мертв
 		if (NOPSetPlayerHealth[playerid] > 5 || NOPSetPlayerArmour[playerid] > 5) return SendClientMessage(playerid, COLOR_RED, "Ваше здоровье или броня рассинхронизированы! Урон от вашего оружия не засчитан.");

        PlayerPlaySound(playerid,40401,0.0,0.0,0.0);
		//Изменение наносимого урона
		if (InEvent[playerid] > 0)
		{//Игрок в соревнованиях
			if(InEvent[playerid] == EVENT_DM && (DMid == 9 || DMid == 11)) amount = 500;//На дм Мясорубка, Ферма
			if (ZMStarted[playerid] == 1 && ZMStarted[hitid] == 1)
			{//Зомби-Выживание
			    if (ZMIsPlayerIsZombie[playerid] > 0 || ZMIsPlayerIsTank[playerid] > 0) {ResetPlayerWeapons(playerid); return 0;} //стрельба, будучи зомби или танком
 				if (ZMIsPlayerIsZombie[playerid] == 0 && ZMIsPlayerIsZombie[hitid] == 0) {SendClientMessage(playerid,COLOR_RED,"Не стреляйте по своим!"); return 0;}
			}//Зомби-Выживание
			
			if (InEvent[playerid] == EVENT_TDM && InEvent[hitid] == EVENT_TDM)
			{//tdm
                if(TDMTeam[playerid] == TDMTeam[hitid]) {SendClientMessage(playerid,COLOR_RED,"Не стреляйте по своим!"); return 0;}
			}//tdm
			/*if (InEvent[playerid] == EVENT_PDM && InEvent[hitid] == EVENT_PDM)
			{//pdm
                if(PDMTeam[playerid] == PDMTeam[hitid]) {SendClientMessage(playerid,COLOR_RED,"Не стреляйте по своим!"); return 0;}
			}//pdm
			*/
	    }//Игрок в соревнованиях
        //Изменение наносимого урона

        //------------- Нанесение урона и убийство
		if (Player[hitid][PArmour] > amount) Player[hitid][PArmour] -= amount;
		else
		{//Если брони меньше, чем наносимый урон
		    amount -= Player[hitid][PArmour];
			Player[hitid][PHealth] -= amount; Player[hitid][PArmour] = 0.0;
		}//Если брони меньше, чем наносимый урон
		//Записываем жертве от кого он получил последний урон
		LastDamageFrom[hitid] = playerid;

		if (Player[hitid][PHealth] <= 1.0)
		{//Убийство игрока
			OnPlayerDeathFromPlayer(hitid, playerid, weaponid);
	        SetPlayerHealth(hitid,0.0);//Чтобы не было бага с застыванием игрока (не срабатывает OnPlayerDeath)
	        PlayerPlaySound(playerid,31000,0.0,0.0,0.0);
		}//Убийство игрока
		//------------- Нанесение урона и убийство
	}//Выстрел по другому игроку

	if(hittype == 2 && hitid > 35 && hitid <= MAX_VEHICLES && Vehicle[hitid][Health] > 0.0)
	{//Выстрел по транспорту (кроме авто для угона)
        Vehicle[hitid][Health] -= amount;
	}//Выстрел по транспорту (кроме авто для угона)

    return 1;
}//Стрельба из огнестрельного оружия пешком или с ПАССАЖИРСКОГО места

/*
public OnPlayerEnterDynamicRaceCP(playerid, checkpointid)
{
	return 1;
}

public OnPlayerEnterDynamicCP(playerid, checkpointid)//checkpointid
{
	return 1;
}

public OnPlayerLeaveDynamicCP(playerid, checkpointid)
{
	return 1;
}
*/
//------------ SpawnStyle
forward SpawnStylePub(playerid);
public SpawnStylePub(playerid)
{//начало паба
	if (InEvent[playerid] > 0 && JoinEvent[playerid] > 0) return 1;
	if (Player[playerid][SpawnStyle] == 1)
	{//спавн на авто класса 1
		CallCar1(playerid);//вызов авто класса 1
	}//спавн на авто класса 1
	if (Player[playerid][SpawnStyle] == 2)
	{//спавн на авто класса 2
		CallCar2(playerid);//вызов авто класса 2
	}//spawn на авто класса 2
	if (Player[playerid][SpawnStyle] == 4)
	{//спавн на авто класса 3
		CallCar3(playerid);//вызов авто класса 3
	}//spawn на авто класса 3
	if (Player[playerid][SpawnStyle] == 5)
	{//спавн на джетпаке
	    JetpackUsed[playerid] = 1;SetPlayerSpecialAction(playerid,SPECIAL_ACTION_USEJETPACK);
	}//спавн на джетпаке
	if (OnStartEvent[playerid] == 0) GiveMyGunWeapons(playerid);//загрузка личного оружия
	if (Logged[playerid] > 0) SetCameraBehindPlayer(playerid);
	if (WorldSpawn[playerid] > 0) SetPlayerVirtualWorld(playerid, WorldSpawn[playerid]); //Чтобы в штабах и в домах точно ставился нужный мир
	if (Logged[playerid] == 0) SetPlayerVirtualWorld(playerid,playerid+1);
	SetPlayerHealth(playerid,100);
	return 1;
}//конец паба
//------------ SpawnStyle

stock GiveMyGunWeapons(playerid)
{
    new ammo;
	if (Player[playerid][Slot1] > 0) GiveWeapon(playerid,Player[playerid][Slot1],1);//Слот 1 - Бензопила, Катана, Вибратор
	if (Player[playerid][Slot2] > 0)
	{//Слот 2 - Пистолеты
		GiveWeapon(playerid,Player[playerid][Slot2],1);
		if (Player[playerid][Level] < 31) ammo = 70;
		else if (Player[playerid][Level] < 71) ammo = 140;
		else if (Player[playerid][Level] < 82) ammo = 210;
		else if (Player[playerid][Level] < 92) ammo = 280;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot2], ammo);
	}//Слот 2 - Пистолеты
	if (Player[playerid][Slot3] > 0)
	{//Слот 3 - Дробовики
		GiveWeapon(playerid,Player[playerid][Slot3],1);
		if (Player[playerid][Level] < 33) ammo = 28;
		else if (Player[playerid][Level] < 72) ammo = 56;
		else if (Player[playerid][Level] < 83) ammo = 84;
		else if (Player[playerid][Level] < 93) ammo = 112;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot3], ammo);
	}//Слот 3 - Дробовики
	if (Player[playerid][Slot4] > 0)
	{//Слот 4 - ПП
		GiveWeapon(playerid,Player[playerid][Slot4],1);
		if (Player[playerid][Level] < 37) ammo = 500;
		else if (Player[playerid][Level] < 73) ammo = 1000;
		else if (Player[playerid][Level] < 84) ammo = 1500;
		else if (Player[playerid][Level] < 94) ammo = 2000;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot4], ammo);
	}//Слот 4 - ПП
	if (Player[playerid][Slot5] > 0)
	{//Слот 5 - Автоматы
		GiveWeapon(playerid,Player[playerid][Slot5],1);
		if (Player[playerid][Level] < 41) ammo = 90;
		else if (Player[playerid][Level] < 74) ammo = 180;
		else if (Player[playerid][Level] < 86) ammo = 270;
		else if (Player[playerid][Level] < 95) ammo = 360;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot5], ammo);
	}//Слот 5 - Автоматы
	if (Player[playerid][Slot6] > 0)
	{//Слот 6 - Винтовки
	    if (Player[playerid][Slot6] == 34 && Player[playerid][Karma] <= -800) SendClientMessage(playerid, COLOR_RED, "Снайперская винтовка не выдана из-за слишком низкой кармы.");
	    else
	    {
			GiveWeapon(playerid,Player[playerid][Slot6],1);
			if (Player[playerid][Level] < 44) ammo = 15;
			else if (Player[playerid][Level] < 77) ammo = 30;
			else if (Player[playerid][Level] < 88) ammo = 45;
			else if (Player[playerid][Level] < 97) ammo = 60;
			else ammo = 20000;
			SetPlayerAmmo(playerid, Player[playerid][Slot6], ammo);
		}
	}//Слот 6 - Винтовки
	if (Player[playerid][Slot7] == 35)
	{//Слот 7 - RPG
		GiveWeapon(playerid,35,1);
		if (Player[playerid][Level] < 46) ammo = 10;
		else if (Player[playerid][Level] < 79) ammo = 20;
		else if (Player[playerid][Level] < 89) ammo = 30;
		else if (Player[playerid][Level] < 98) ammo = 40;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot7], ammo);
	}//Слот 7 - RPG
	
	//extra
	if (Player[playerid][Slot7] == 36)
	{//Слот 7 - RPG HS
		GiveWeapon(playerid,36,1);
		if (Player[playerid][Level] < 46) ammo = 10;
		else if (Player[playerid][Level] < 79) ammo = 20;
		else if (Player[playerid][Level] < 89) ammo = 30;
		else if (Player[playerid][Level] < 98) ammo = 40;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot7], ammo);
	}//Слот 7 - RPG HS
	
	if (Player[playerid][Slot7] == 37)
	{//Слот 7 - огнемет
		GiveWeapon(playerid,37,1);
		if (Player[playerid][Level] < 46) ammo = 200;
		else if (Player[playerid][Level] < 79) ammo = 400;
		else if (Player[playerid][Level] < 89) ammo = 600;
		else if (Player[playerid][Level] < 98) ammo = 900;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot7], ammo);
	}//Слот 7 - огнемет
	//
	
	if (Player[playerid][Slot7] == 38)
	{//Слот 7 - Миниган
		GiveWeapon(playerid,38,1);
		if (Player[playerid][Level] < 82) ammo = 1000;
		else if (Player[playerid][Level] < 81) ammo = 2000;
		else if (Player[playerid][Level] < 99) ammo = 3000;
		else ammo = 20000;
		SetPlayerAmmo(playerid, Player[playerid][Slot7], ammo);
	}//Слот 7 - Миниган
	if (Player[playerid][Slot8] > 0)
	{//Слот 8 - Метательное (кроме молотова)
		GiveWeapon(playerid,Player[playerid][Slot8],1);
		if (Player[playerid][Level] < 43) ammo = 10;
		else if (Player[playerid][Level] < 76) ammo = 20;
		else if (Player[playerid][Level] < 87) ammo = 30;
		else if (Player[playerid][Level] < 96) ammo = 40;
		else ammo = 1000;
		SetPlayerAmmo(playerid, Player[playerid][Slot8], ammo);
	}//Слот 8 - Метательное (кроме молотова)
	//Player[playerid][Slot9] используется для стиля драки
	if (Player[playerid][Slot10] > 0)
	{//Прочее
		if(Player[playerid][Slot10] == 46){GiveWeapon(playerid,46,1);}
		if(Player[playerid][Slot10] == 42){GiveWeapon(playerid,42,20000);}
		if(Player[playerid][Slot10] == 41){GiveWeapon(playerid,41,5000);}
		if(Player[playerid][Slot10] == 43){GiveWeapon(playerid,43,100);}
	}//Прочее
	return 1;
}

stock SecFreeze(playerid, count = 1)
{
    TogglePlayerControllable(playerid,0);
    SetTimerEx("UnFreeze" , 1000 * count, false, "i", playerid);
	return 1;
}

stock EndEventFreeze(playerid)
{
    TogglePlayerControllable(playerid,0);
    SetTimerEx("UnFreeze" , 3000, false, "i", playerid);
    SendClientMessage(playerid,COLOR_YELLOW,"Соревнование завершается. Пожалуйста, подождите..");
    ResetPlayerWeapons(playerid);
	return 1;
}

public UnFreeze(playerid) {TogglePlayerControllable(playerid,1);return 1;}
public UnLock(playerid, vehicleid) {SetVehicleParamsForPlayer(vehicleid, playerid, 0, 0);return 1;}
public SideCameraSpecpUpdate(playerid, vehicleid){if (LSpecID[playerid] != -1) PlayerSpectateVehicle(playerid, vehicleid, LSpecMode[playerid]);return 1;}

public PrestigeCarTP(playerid, class, seat1, seat2, seat3)
{
	new Float: x, Float: y, Float: z;GetPlayerPos(playerid,x,y,z);SetPlayerPosFindZ(playerid, x, y, 3000.0);
    if (class == 1){CallCar1(playerid);}
	if (class == 2){CallCar2(playerid);}
	if (class == 3){CallCar3(playerid);}
	if (seat1 != -1){PutPlayerInVehicle(seat1, PlayerCarID[playerid], 1);}
	if (seat2 != -1){PutPlayerInVehicle(seat2, PlayerCarID[playerid], 2);}
	if (seat3 != -1){PutPlayerInVehicle(seat3, PlayerCarID[playerid], 3);}
	TimeTransform[playerid] = 0;TogglePlayerControllable(playerid,1);
	SetCameraBehindPlayer(playerid);
	return 1;
}

public PrestigeCarTPx(playerid, class, seat1, seat2, seat3, Float: vel1, Float: vel2, Float: vel3)
{
	new Float: x, Float: y, Float: z;GetPlayerPos(playerid,x,y,z);SetPlayerPosFindZ(playerid, x, y, 3000.0);
    if (class == 1){CallCar1(playerid);}
	if (class == 2){CallCar2(playerid);}
	if (class == 3){CallCar3(playerid);}
	if (seat1 != -1){PutPlayerInVehicle(seat1, PlayerCarID[playerid], 1);}
	if (seat2 != -1){PutPlayerInVehicle(seat2, PlayerCarID[playerid], 2);}
	if (seat3 != -1){PutPlayerInVehicle(seat3, PlayerCarID[playerid], 3);}
	TimeTransform[playerid] = 0;TogglePlayerControllable(playerid,1);
	SetVehicleVelocity(GetPlayerVehicleID(playerid), vel1, vel2, vel3);
	SetCameraBehindPlayer(playerid);
	return 1;
}

public SpecTextDrawPub(playerid)
{//---------- TextDraw в спектре
	if (LSpecID[playerid] != -1)
	{//Игрок gid следит за кем-то
        SetTimerEx("SpecTextDrawPub" , 500, false, "i", playerid);
		PlayerTextDrawHide(playerid, PSpecInfo[playerid]);
		PlayerTextDrawHide(playerid, SpecInfoVeh[playerid]);
		LSpecCanFastChange[playerid] = 1;//Доступна быстрая смена ID через стрелочки
        //Награды за слежку
		if (Player[playerid][Admin] > 0 && unixtime > GetPVarInt(playerid, "SpecTime"))
		{//5 минут в слежке
		    SetPVarInt(playerid, "SpecTime", unixtime); LSpecCount[playerid]++;
		    if (LSpecCount[playerid] == 300)
		    {
			    LSpecCount[playerid] = 0;
			    
			    new Float:NewVector[3];
				GetPlayerCameraFrontVector(playerid, NewVector[0], NewVector[1], NewVector[2]);
				
			    if(NewVector[0] != SpecVector[playerid][0] && NewVector[1] != SpecVector[playerid][1])
			    {
			    	SendClientMessage(playerid, COLOR_YELLOW, "Вы получили 600 XP и 20 000$ за 5 минут непрерывной слежки");
			    	LGiveXP(playerid, 600); Player[playerid][Cash] += 20000;
			    	PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
                    SpecVector[playerid][0] = NewVector[0]; SpecVector[playerid][1] = NewVector[1];
				}
		    }
		}//5 минут в слежке
		new vid = LSpecID[playerid], String[240];
		new Float: hp;GetPlayerHealth(vid, hp);new Float: arm;GetPlayerArmour(vid, arm);
		new hpX = floatround(hp, floatround_round);new armX = floatround(arm, floatround_round);new vehX;
		new ammo = GetPlayerAmmo(vid);new weaponname[48];GetWeaponName(GetPlayerWeapon(vid),weaponname,sizeof(weaponname));
		new PPing = GetPlayerPing(vid);
		if(IsPlayerInAnyVehicle(vid))
		{//Если игрок в авто
	        format(String,sizeof(String),"~Y~Player: ~W~%s~Y~[%~W~%d~Y~]    ~Y~Level: ~W~%d    ~Y~Health: ~W~%d    ~Y~Armour: ~W~%d   Ping: %d",PlayerName[vid], vid, Player[vid][Level], hpX, armX, PPing);
			PlayerTextDrawSetString(playerid, PSpecInfo[playerid], String);
			PlayerTextDrawShow(playerid, PSpecInfo[playerid]);
		    new vehname[32], vehid = GetPlayerVehicleID(vid);new Float: vehhealth; GetVehicleHealth(vehid, vehhealth);
			vehX = floatround(vehhealth, floatround_round);
			new model = GetVehicleModel(vehid) - 400;
			if (model == -400) vehname = "None";
			else format(vehname,sizeof(vehname),"%s", PlayerVehicleName[model]);
			//speedo
			new Float:SPD, Float:vx, Float:vy, Float:vz;
		    GetVehicleVelocity(GetPlayerVehicleID(vid), vx,vy,vz);
		    SPD = floatsqroot(((vx*vx)+(vy*vy))+(vz*vz))*200;
			new speed = floatround(SPD, floatround_round);
			//speedo
			new MaxSpeed = GetVehicleMaxSpeed(GetPlayerVehicleID(vid));
			format(String,sizeof(String),"~B~Vehicle: ~W~%s    ~B~Health: ~W~%d    ~B~Speed: ~W~%d    ~B~Max Speed: ~W~%d",vehname, vehX, speed, MaxSpeed);
			PlayerTextDrawSetString(playerid, SpecInfoVeh[playerid], String);PlayerTextDrawShow(playerid, SpecInfoVeh[playerid]);
		}//Если игрок в авто
		else
		{//Игрок пешком
			if (GetPlayerWeapon(vid) == 0) format(String,sizeof(String),"~Y~Player: ~W~%s~Y~[%~W~%d~Y~]    ~Y~Level: ~W~%d    ~Y~Health: ~W~%d    ~Y~Armour: ~W~%d  Ping: %d",PlayerName[vid], vid, Player[vid][Level], hpX, armX,PPing); //нет оружия
			else if ( 15 < GetPlayerWeapon(vid) < 39) format(String,sizeof(String),"~Y~Player: ~W~%s~Y~[%~W~%d~Y~]    ~Y~Level: ~W~%d    ~Y~Health: ~W~%d    ~Y~Armour: ~W~%d    ~Y~Weapon: ~W~%s ~Y~(~W~%d~Y~)   Ping: %d",PlayerName[vid], vid, Player[vid][Level], hpX, armX, weaponname, ammo,PPing); //оружие с патронами
			else format(String,sizeof(String),"~Y~Player: ~W~%s~Y~[%~W~%d~Y~]    ~Y~Level: ~W~%d    ~Y~Health: ~W~%d    ~Y~Armour: ~W~%d    ~Y~Weapon: ~W~%s   Ping: %d",PlayerName[vid], vid, Player[vid][Level], hpX, armX, weaponname,PPing); //оружие, в котором не нужно следить за кол-вом патронов
			PlayerTextDrawSetString(playerid, PSpecInfo[playerid], String);
			PlayerTextDrawShow(playerid, PSpecInfo[playerid]);
		}//Игрок пешком

	}//Игрок gid следит за кем-то
	else{PlayerTextDrawHide(playerid, PSpecInfo[playerid]);PlayerTextDrawHide(playerid, SpecInfoVeh[playerid]);}
	return 1;
}//---------- TextDraw в спектре


public ParaEnd(playerid)
{
    new Float: x, Float: y, Float: z, Float:a;GetPlayerPos(playerid,x,y,z);GetPlayerFacingAngle(playerid,a);
	SetPlayerPosFindZ(playerid,x,y,z);SendClientMessage(playerid,COLOR_YELLOW,"Вы успешно приземлились.");
	ApplyAnimation(playerid,"PED","FALL_land",4.1,0,0,0,0,1,1);SetPlayerChatBubble(playerid, "Приземлился", COLOR_GREEN, 100.0, 3000);
	return 1;
}

stock ShowStats(playerid,targetid)
{
	if (Logged[playerid] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны авторизироваться, чтобы просматривать статистику");
	new String[1600] = "", String2[240], clanid = Player[targetid][MyClan];
	
	if(Player[targetid][SPrest] > 0) {format(String2,sizeof(String2),"{9A2EFE}....:::: Элитный игрок {ffffff}%d-го{9A2EFE} уровня суперпрестижа ::::....\n\n", Player[targetid][SPrest]); strcat(String, String2);}
	if (Player[targetid][Admin] > 0 && Player[targetid][Admin] < 5)
	{
        format(String2,sizeof(String2),"{FFFF00}Статистика игрока {FFFFFF}%s [SID:{ffff00}%d{ffffff}] [%s%s{FFFFFF}]\n\n",PlayerName[targetid],Player[targetid][SID],AdminInfo[Player[targetid][Admin]][StrColor],AdminInfo[Player[targetid][Admin]][StatName]);
	}
	else if(Player[targetid][SPrest] > 0) format(String2,sizeof(String2),"{FFFF00}Статистика игрока {FFFFFF}%s [SID:{ffff00}%d{ffffff}] [{9A2EFE}Элитный игрок{ffffff}]\n",PlayerName[targetid],Player[targetid][SID]);
	else format(String2,sizeof(String2),"{FFFF00}Статистика игрока {FFFFFF}%s [SID:{ffff00}%d{ffffff}]\n",PlayerName[targetid],Player[targetid][SID]);
	strcat(String, String2);
	
	if (clanid > 0)
	{
	    if(Player[targetid][Leader] == 100) format(String2,sizeof(String2),"{FFFF00}Клан: [{FFFFFF}%s{FFFF00}] Ранг:{FF0000} Лидер\n\n",Clan[clanid][cName]);
	    else format(String2,sizeof(String2),"{FFFF00}Клан: [{FFFFFF}%s{FFFF00}] Ранг:{FFFFFF} %d\n\n",Clan[clanid][cName],Player[targetid][Leader]);
	    strcat(String, String2);
	}

 	new hours = Player[targetid][Time] / 3600;
	if (hours > 0) format(String2,sizeof(String2),"{AFAFAF}[На сервере проведено: {FFFFFF}%d{AFAFAF} часов]\n", hours);
	else format(String2,sizeof(String2),"{AFAFAF}[На сервере проведено: Менее одного часа]\n", hours);
	strcat(String, String2);

	if (Player[targetid][Prestige] > 0 && Player[targetid][GPremium] == 0){format(String2,sizeof(String2),"{FFFF00}[Престиж {FFFFFF}%d{FFFF00}-го уровня]\n",Player[targetid][Prestige]);strcat(String, String2);}
	if (Player[targetid][Prestige] == 0 && Player[targetid][GPremium] > 0){format(String2,sizeof(String2),"{FFFF00}[ViP {FFFFFF}%d{FFFF00}-го уровня]\n",Player[targetid][GPremium]);strcat(String, String2);}
	if (Player[targetid][Prestige] > 0  && Player[targetid][GPremium] > 0){format(String2,sizeof(String2),"{FFFF00}[Престиж {FFFFFF}%d{FFFF00}-го уровня] {FFFF00}[ViP {FFFFFF}%d{FFFF00}-го уровня]\n",Player[targetid][Prestige],Player[targetid][GPremium]);strcat(String, String2);}

    if (Player[targetid][Banned] != 0)
    {//аккаунт забанен
        format(String2,sizeof(String2),"\n{FF0000}Аккаунт заблокирован. Бан выдал: {FFFFFF}%s\n{FF0000}Причина: {FFFFFF}%s\n", BannedBy[targetid], BanReason[targetid]);
        strcat(String, String2);
    }//аккаунт забанен

    if (Player[targetid][Muted] != 0)
    {//у игрока затычка чата
        if (Player[targetid][Muted] > 0) format(String2,sizeof(String2),"\n{FF0000}Чат заблокирован. Затычку выдал: {FFFFFF}%s\n{FF0000}Блокировка будет снята через {FFFFFF}%d {FF0000}минут.\n", MutedBy[targetid], Player[targetid][Muted]/60 + 1); //Простой мут
        else format(String2,sizeof(String2),"\n{FF0000}Чат заблокирован. Затычку выдал: {FFFFFF}%s\n{FF0000}Блокировка выдана на неопределенный срок.\n", MutedBy[targetid]); //Супермут
        strcat(String, String2);
    }//у игрока затычка чата

    if (Player[targetid][Level] > 0 && (Player[targetid][Level] < 100 || Player[targetid][Prestige] >= 10))
    {//О прокачке
		format(String2,sizeof(String2),"\n{007FFF}XP набрано на уровне: {FFFFFF}%d   {FF8C00}XP осталось набрать: {FFFFFF}%d\n",Player[targetid][Exp],NeedXP[targetid] - Player[targetid][Exp]);
		strcat(String, String2);
 		format(String2,sizeof(String2),"{AFAFAF}Получено XP от клана за этот час: {FFFFFF}%d\n\n",Player[targetid][LastHourReferalExp]);
 		strcat(String, String2);
	}//О прокачке

	if (Player[playerid][Admin] >= 4 || playerid == targetid) format(String2,sizeof(String2),"{FFFF00}Уровень: {FFFFFF}%d   {FFFF00}Денег: {FFFFFF}%d$   {FFFF00}Банк: {FFFFFF}%d$   {FFFF00}Медали: {FFFFFF}%d\n",Player[targetid][Level], Player[targetid][Cash], Player[targetid][Bank], Player[targetid][Medals]);
	else format(String2,sizeof(String2),"{FFFF00}Уровень: {FFFFFF}%d\n",Player[targetid][Level]);
	strcat(String, String2);

	if (Player[targetid][Karma] < 0) format(String2,sizeof(String2),"{FFFF00}Карма: {FF0000}%d   {FFFF00}Заданий выполнено:{FFFFFF} %d\n", Player[targetid][Karma], Player[targetid][CompletedQuests]);
	else format(String2,sizeof(String2),"{FFFF00}Карма: {008E00}+%d   {FFFF00}Заданий выполнено:{FFFFFF} %d\n", Player[targetid][Karma], Player[targetid][CompletedQuests]);
	strcat(String, String2);

	if (Player[targetid][Spawn] == 0)
	{
		if (Player[targetid][Level] < 3){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Grove Street   ");}
		if (Player[targetid][Level] >= 3 && Player[targetid][Level] < 15){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Лос Сантос   ");}
		if (Player[targetid][Level] >= 15 && Player[targetid][Level] < 25){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Сан Фиерро   ");}
		if (Player[targetid][Level] >= 25 && Player[targetid][Level] < 73){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Лас Вентурас   ");}
		if (Player[targetid][Level] >= 73){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Гора Chilliad   ");}
	}
	if (Player[targetid][Spawn] == 4){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Личный дом (Снаружи)   ");}
	if (Player[targetid][Spawn] == 5){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Штаб клана   ");}
	if (Player[targetid][Spawn] == 6){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Личный дом (Внутри)   ");}
	if (Player[targetid][Spawn] == 7){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Личная позиция (ViP)   ");}
	if (Player[targetid][Spawn] == 8){strcat(String, "{FFFF00}Место спавна: {FFFFFF}Штаб клана (Внутри)   ");}
	if (Player[targetid][SpawnStyle] == 0){strcat(String, "{FFFF00}Стиль спавна: {FFFFFF}Нет\n");}
	if (Player[targetid][SpawnStyle] == 1){strcat(String, "{FFFF00}Стиль спавна: {FFFFFF}На авто класса 1\n");}
	if (Player[targetid][SpawnStyle] == 2){strcat(String, "{FFFF00}Стиль спавна: {FFFFFF}На авто класса 2\n");}
	if (Player[targetid][SpawnStyle] == 4){strcat(String, "{FFFF00}Стиль спавна: {FFFFFF}На авто класса 3\n");}
	if (Player[targetid][SpawnStyle] == 5){strcat(String, "{FFFF00}Стиль спавна: {FFFFFF}На JetPack\n");}

	new veh1[30]; if(Player[targetid][CarSlot1] == 0){veh1 = "";}else{new mid = Player[targetid][CarSlot1] - 400;format(veh1,sizeof(veh1),"%s", PlayerVehicleName[mid]);}
    new veh2[30]; if(Player[targetid][CarSlot2] == 0){veh2 = "";}else{new mid = Player[targetid][CarSlot2] - 400;format(veh2,sizeof(veh2),"%s", PlayerVehicleName[mid]);}
    new veh3[30]; if(Player[targetid][CarSlot3] == 0){veh3 = "";}else{new mid = Player[targetid][CarSlot3] - 400;format(veh3,sizeof(veh3),"%s", PlayerVehicleName[mid]);} if(Player[targetid][CarSlot3] == 539){format(veh3,sizeof(veh3),"%s{9966CC}Uber{007FFF}Vortex");}
    if(strlen(veh1) == 0 && strlen(veh2) == 0 && strlen(veh3) == 0) veh1 = "Нет";//Если вообще нет транспорта
    format(String2,sizeof(String2),"{FFFF00}Транспорт:{FFFFFF} %s   %s   %s\n", veh1, veh2, veh3);
	strcat(String, String2);
	
	if(Player[targetid][SlivBlock] !=-1) {format(String2,sizeof(String2),"{007FFF}Защита от потери денег:{FFFFFF} %d {007FFF}дней(-я)\n", Player[targetid][SlivBlock]-nowday);	strcat(String, String2);}
	
	new ttr;
	String2 = "";
	if(Player[targetid][Type] > 0) {strcat(String2, "{F7FE2E}[винилы] "); ttr++;}
	if(Player[targetid][Mrf1] > 0) {strcat(String2, "{FACC2E}[/aplay] "); ttr++;}
	if(Player[targetid][SPN1] > 0) {strcat(String2, "{FE9A2E}[пушка-телепорт] ");}
	if(Player[targetid][SPN2] > 0) {strcat(String2, "{FE9A2E}[маскарад] "); ttr++;}
	if(Player[targetid][SPN6] > 0) {strcat(String2, "{FE9A2E}[оружейник] "); ttr++;ttr++; if(ttr>2) strcat(String2,"\n\t\t");}
	if(Player[targetid][SPN7] > 0) {strcat(String2, "{FE9A2E}[призрак] "); ttr++;}
	if(Player[targetid][SPN8] > 0) {strcat(String2, "{FE9A2E}[Телепортер] "); ttr++;}
	if(Player[targetid][SPN9] > 0) {strcat(String2, "{FE9A2E}[Махинатор] "); ttr++;}
	if(ttr == 0) strcat(String2, "НЕТ");
    format(String2,sizeof(String2),"\n{2E9AFE}Уникальное:{FFFFFF} %s.", String2);
    strcat(String, String2);
    
    format(String2,sizeof(String2),"\n\n{ffff00}Лотерея:{FFFFFF} %d.", Player[targetid][Lottery]);
    strcat(String, String2);
    
	ShowPlayerDialog(playerid, 999, 0, "Статистика", String, "ОК", "");
	return 1;
}


stock ShowKarma(playerid)
{
	new String[1024], Caption[40];

	if (Player[playerid][Karma] < 0) format(Caption,sizeof Caption,"Ваша карма: {FF0000}%d", Player[playerid][Karma]);
	else format(Caption,sizeof Caption,"Ваша карма: {008E00}+%d", Player[playerid][Karma]);

	strcat(String, "{FFFF00}Штрафы и бонусы кармы:\n{008E00}");

    strcat(String, "+800 и выше: Стоимость личного транспорта снижена в два раза.\n");
    strcat(String, "+600 и выше: Аптечки и броня бесплатны.\n");
	strcat(String, "+400 и выше: Команда {FFFFFF}/skydive{008E00} бесплатна.{FF0000}\n\n");

    strcat(String, "-400 и ниже: Невидимость недоступна.\n");
    strcat(String, "-600 и ниже: Броня недоступна.\n");
    strcat(String, "-800 и ниже: Снайперская винтовка недоступна.\n");

    strcat(String, "\n{FFFF00}Ваша карма изменяется соответственно вашему поведению на сервере.\n");
    strcat(String, "{008E00}+ Увеличивается со временем, если вы ведете себя мирно и никого не убиваете.\n");
    strcat(String, "{FF0000}- Уменьшается когда вы убиваете других игроков за пределами соревнований.\n");

	ShowPlayerDialog(playerid, 999, 0, Caption, String, "ОК", "");
	return 1;
}

stock ShowPInfo(playerid, targetid)
{
	if (Player[targetid][Admin] == 5 && Player[playerid][Admin] > 0) goto dalee;
	if (Player[playerid][Admin] < Player[targetid][Admin]) return 1;//админы ниже статусом не могут смотреть инфу выбранного админа, когда тот в хайде
	dalee:
	new String[1500] = ""; new String2[240];
	format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}%s\n",PlayerName[targetid]);
	if (Player[targetid][Admin] == 1){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}%s [{66CDAA}Модератор{FFFFFF}]\n",PlayerName[targetid]);}
	if (Player[targetid][Admin] == 2){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}%s [{9ACD32}Супер-Модератор{FFFFFF}]\n",PlayerName[targetid]);}
	if (Player[targetid][Admin] == 3){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}%s [{00BFFF}Администратор{FFFFFF}]\n",PlayerName[targetid]);}
	if (Player[targetid][Admin] == 4){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}%s [{FF7F50}Главный Администратор{FFFFFF}]\n",PlayerName[targetid]);}

	new clanid = Player[targetid][MyClan];
	if (clanid > 0){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}[{008E00}%s{FFFFFF}] %s\n",Clan[clanid][cName],PlayerName[targetid]);}
	if (clanid > 0 && Player[targetid][Admin] == 1){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}[{008E00}%s{FFFFFF}] %s [{66CDAA}Модератор{FFFFFF}]\n",Clan[clanid][cName],PlayerName[targetid]);}
	if (clanid > 0 && Player[targetid][Admin] == 2){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}[{008E00}%s{FFFFFF}] %s [{9ACD32}Супер-Модератор{FFFFFF}]\n",Clan[clanid][cName],PlayerName[targetid]);}
	if (clanid > 0 && Player[targetid][Admin] == 3){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}[{008E00}%s{FFFFFF}] %s [{00BFFF}Администратор{FFFFFF}]\n",Clan[clanid][cName],PlayerName[targetid]);}
	if (clanid > 0 && Player[targetid][Admin] == 4){format(String2,sizeof(String2),"{FFFF00}Скрытые данные игрока {FFFFFF}[{008E00}%s{FFFFFF}] %s [{FF7F50}Главный Администратор{FFFFFF}]\n",Clan[clanid][cName],PlayerName[targetid]);}
	strcat(String, String2);

    if (Player[targetid][Admin] > 4) strcat(String, "{FF0000}IP-Адрес: {FFFFFF}34.85.55.223\n");
	else {format(String2,sizeof(String2),"{FF0000}IP-Адрес: {FFFFFF}%s\n", PlayerIP[targetid]); strcat(String, String2);}
	
 	if (Player[playerid][Admin] == 4)
	{
		format(String2,sizeof(String2),"{FF0000}Рублей: {FFFFFF}%0.2f   {FF0000}Рублей за все время: {FFFFFF}%0.2f\n", Player[targetid][GameGold], Player[targetid][GameGoldTotal]); strcat(String, String2);
	    format(String2,sizeof(String2),"{FF0000}Казино: {FFFFFF}%d$", Player[targetid][CasinoBalance]); strcat(String, String2);
	}

	//Погода и время
	if(PlayerTime[targetid] == -1) format(String2,sizeof(String2),"{FF0000}Игровое время: {FFFFFF}Серверное   ");
	else {format(String2,sizeof(String2),"{FF0000}Игровое время: {FFFFFF}%d:00   ",PlayerTime[targetid]);}strcat(String, String2);
	if(PlayerWeather[targetid] == -1) format(String2,sizeof(String2),"{FF0000}Погода: {FFFFFF}Серверная\n");
	else {format(String2,sizeof(String2),"{FF0000}Погода: {FFFFFF}%d\n",PlayerWeather[targetid]);}strcat(String, String2);

	//О регистрации
	strcat(String, "\n{FFFF00}Регистрационные данные\n");
	if (Registered[targetid] == 0) strcat(String, "{AFAFAF}Не зарегистрирован.\n");
	else
	{//Зарегистрирован
		format(String2, sizeof(String2), "{AFAFAF}Дата регистрации: {FFFFFF}%s   {AFAFAF}IP: {FFFFFF}%s\n", RegisterDate[targetid], RegisterIP[targetid]);
		strcat(String, String2);
	}//Зарегистрирован

	ShowPlayerDialog(playerid, 999, 0, "Скрытые Данные", String, "ОК", "");
	return 1;
}

stock ShowServerInfo(playerid)
{
    LastProperty = 1; OwnedProperty = 0; SuperProperty = 0;
    for(new i = 1; i < MAX_PROPERTY; i++)
	{
	    if(strcmp(Property[i][pOwner], "Unknown")) OwnedProperty++;
	    if(Property[i][pBuyBlock] > 0) SuperProperty++;
		LastProperty++;
	}
	LastBase = 1, OwnedBase = 0;
	for(new i = 1; i < MAX_BASE; i++)
	{
	    if(Base[i][bClan] > 0) OwnedBase++;
		LastBase++;
	}
	new clans, LastClan;
	for(new i = 1; i < MAX_CLAN; i++)
	{
	    if(Clan[i][cLevel] > 0) clans++;
	    LastClan++;
	}
	//------------------------------------
	new String[1500] = "", String2[240];
	format(String2,sizeof(String2),"{FFFF00}Домов занято: {FFFFFF}%d из %d{FFFF00}   Неперекупаемых домов: {FFFFFF}%d\n", OwnedProperty, LastProperty - 1, SuperProperty);strcat(String, String2);
	format(String2,sizeof(String2),"{FFFF00}Штабов занято: {FFFFFF}%d из %d{FFFF00}\n", OwnedBase, LastBase - 1);strcat(String, String2);
	format(String2,sizeof(String2),"{FFFF00}Кланов на сервере: {FFFFFF}%d{FFFF00}   {FFFF00}Максимум: {FFFFFF}%d\n\n", clans, LastClan);strcat(String, String2);

    format(String2,sizeof(String2),"{FFFF00}Игроков на сервере: {FFFFFF}%d   {FFFF00}Максимальный ID транспорта: {FFFFFF}%d\n\n", PlayersOnline, MaxVehicleUsed);strcat(String, String2);

	format(String2,sizeof(String2),"{FF0000}Последний рестарт был %s",RestartDate);strcat(String, String2);

	ShowPlayerDialog(playerid, 999, 0, "Статистика сервера", String, "ОК", "");
	return ;
}





stock ShowClanStats(playerid, clanid)
{//ShowClanStats
 	new Free = 0,slts = Clan[clanid][cSlots]+1;
 	if (clanid < 1 || clanid > MaxClanID || Clan[clanid][cLevel] < 1) return SendClientMessage(playerid, COLOR_RED, "Клан с таким ID не зарегистрирован!");
    PlClanID[playerid] = clanid;
    for(new memb=1; memb<slts; memb++)
	{
	    if(!strcmp(CMember[clanid][memb], "No", true)) Free++;
	}

	new StringX[1024], StringZ[140], cNeedXP;
	switch(Clan[clanid][cLevel])
	{
	    case 0..5: cNeedXP = 35000;
	    case 6..10: cNeedXP = 50000;
	    case 11..20: cNeedXP = 80000;
        case 21..50: cNeedXP = 100000;
        case 51..100: cNeedXP = 150000;
        default: cNeedXP = 200000;
	}
	format(StringZ,sizeof(StringZ),"{008E00}Статистика клана {FFFFFF}%s {008E00}[ID:{FFFFFF}%d{008E00}]\n",Clan[clanid][cName], clanid);
	strcat(StringX, StringZ);
	//Строка ниже - уведомление, что нужно купить штаб, чтобы клан не был распущен
	if (Clan[clanid][cLastDay] != 0 && Clan[clanid][Imm] == 0) {format(StringZ, sizeof StringZ, "{FF0000}Клан будет распущен %s если у него не появится штаб!\nКроме того, при отсутствии штаба цвет клана не работает!\n", IntDateToStringDate(Clan[clanid][cLastDay])); strcat(StringX, StringZ);}
	Free = slts-1-Free;//наоборот высчитывает сколько занято

	//Обновление уровня и его отображение
	if (Clan[clanid][cXP] >= cNeedXP) {Clan[clanid][cXP] -= cNeedXP; Clan[clanid][cLevel] += 1; SaveClan(clanid); /*cNeedXP += 100000;*/}
	format(StringZ,sizeof(StringZ),"\n{FF7F50}Уровень клана: {FFFFFF}%d   {AFAFAF}Цвет № {FFFFFF}%d\n",Clan[clanid][cLevel], Clan[clanid][cColor]);

	strcat(StringX, StringZ);
	format(StringZ,sizeof(StringZ),"{AFAFAF}XP набрано: {FFFFFF}%d   {AFAFAF}XP осталось набрать: {FFFFFF}%d\n\n",Clan[clanid][cXP], cNeedXP - Clan[clanid][cXP]);
	if (Clan[clanid][cLevel] < 100) strcat(StringX, StringZ);
	
	if(Clan[clanid][cLevel] > 19)
 	{
 	    format(StringZ,sizeof(StringZ),"{0080FF}Клановый тег: {FFFFFF}%s\n",Clan[clanid][cTag]);
		strcat(StringX, StringZ);
 	}
    format(StringZ,sizeof(StringZ),"{0080FF}Денег в казне: {FFFFFF}%d${0080FF}\nЗон захвачено: {FFFFFF}%d\n{0080FF}Очки влияния: {FFFFFF}%d",Clan[clanid][ClanBank],Clan[clanid][ClanZones],Clan[clanid][InfPoints]);
	strcat(StringX, StringZ);

 	
	if (Clan[clanid][cBase] == 0){format(StringZ,sizeof(StringZ),"\n\n{007FFF}Лидер клана: {FFFF00}%s   {007FFF}Штаб: {FFFF00}Нет\n{008E00}Мест занято: %d / %d\n",Clan[clanid][cLider],Free,slts-1);}
	if (Clan[clanid][cBase] > 0){format(StringZ,sizeof(StringZ),"\n\n{007FFF}Лидер клана: {FFFF00}%s   {007FFF}Штаб: {FFFF00}Есть\n{008E00}Мест занято: %d / %d\n",Clan[clanid][cLider],Free,slts-1);}
	if (Clan[clanid][cBase] > MAX_BASE){format(StringZ,sizeof(StringZ),"\n\n{007FFF}Лидер клана: {FFFF00}%s   {007FFF}Штаб: {FF0000}Перекуплен\n{008E00}Мест занято: %d / %d    Члены клана:\n",Clan[clanid][cLider],slts-1);}
	strcat(StringX, StringZ);

	/*format(StringZ,sizeof(StringZ),"{AFAFAF}%s   %s   %s   %s\n",CMember[clanid][1],CMember[clanid][2],CMember[clanid][3],CMember[clanid][4]);
	strcat(StringX, StringZ);
	format(StringZ,sizeof(StringZ),"%s   %s   %s   %s\n",CMember[clanid][5],CMember[clanid][6],CMember[clanid][7],CMember[clanid][8]);
	strcat(StringX, StringZ);
	format(StringZ,sizeof(StringZ),"%s   %s   %s   %s\n",CMember[clanid][9],CMember[clanid][10],CMember[clanid][11],CMember[clanid][12]);
	strcat(StringX, StringZ);
	format(StringZ,sizeof(StringZ),"%s   %s   %s   %s\n",CMember[clanid][13],CMember[clanid][14],CMember[clanid][15],CMember[clanid][16]);
	strcat(StringX, StringZ);
	format(StringZ,sizeof(StringZ),"%s   %s   %s   %s\n",CMember[clanid][17],CMember[clanid][18],CMember[clanid][19],CMember[clanid][20]);
	strcat(StringX, StringZ);*/
	ShowPlayerDialog(playerid, DIALOG_CLANSTAT, 0, "Статистика клана", StringX, "Состав", "Закрыть");
	return 1;
}//ShowClanStats

stock ShowClanMembers(playerid, clanid)
{
    if (clanid < 1 || clanid > MaxClanID || Clan[clanid][cLevel] < 1) return SendClientMessage(playerid, COLOR_RED, "Ошибка! Клан не существует.");
    new StringX[1500],String[120],slots = Clan[clanid][cSlots];
    strcat(StringX, "Ник\tРанг\tСтатус\n");
    if (COnline[clanid][0] == 0) format(String,sizeof(String),"%s\t{ffff00}Лидер\t\n",Clan[clanid][cLider]);
    else format(String,sizeof(String),"%s\t{ffff00}Лидер\t{3ADF00}[Online]\n",Clan[clanid][cLider]);
    strcat(StringX, String);
    for(new i=1; i < slots+1; i++)
    {
        if (!strcmp(CMember[clanid][i], "No", true)) continue;
        if (COnline[clanid][i] == 0) format(String,sizeof(String),"%s\t%d\t\n",CMember[clanid][i],CRangs[clanid][i]);
        else format(String,sizeof(String),"%s\t%d\t{3ADF00}[Online]\n",CMember[clanid][i],CRangs[clanid][i]);
        strcat(StringX, String);
	}
	format(String,sizeof(String),"{ffffff}Состав клана {ffff00}%s{ffffff} [ID:%d]",Clan[clanid][cName],clanid);
    ShowPlayerDialog(playerid, 999, 5, String, StringX, "Закрыть", "");
	return 1;
}
stock ShowEvents(playerid)
{//ShowEvents
	new StringX[2048], String[180];
	strcat(StringX, "Соревнование\tКарта\tДо старта\tИгроков\n");
	//PUBG
	if (BTTimer <= 300 && BTTimer > 0) {format (String, sizeof(String),"{01DF01}Битва до последнего\t'BATTLEGROUNDS'\t{afafaf}%d сек\t{01DF01}%d\n", BTTimer, BTPlayers);}
	else {format (String, sizeof(String),"{01DF01}Битва до последнего\t{ffffff}Идет матч, ожидайте\t{afafaf}Этап: %d\t{afafaf}%d\n", BTStage, BTPlayers);}
	strcat(StringX, String);
	
	//dm
    if (DMTimer <= 180 && DMTimer > 0){format (String, sizeof(String),"{FF8C00}Десматч\t'%s'\t{afafaf}%d сек\t{FF8C00}%d / 25\n",DMName[DMid],DMTimer, DMPlayers);}
 	else if (DMTimeToEnd > 0){format (String, sizeof(String),"{FF8C00}Десматч\t'%s'\t{ffffff}До конца: %d сек\t{FF8C00}%d / 25\n",DMName[DMid], DMTimeToEnd, DMPlayers);}
	else {format (String, sizeof(String),"{FF8C00}Десматч\t{afafaf}[не активно]\t\t\n");}
	strcat(StringX, String);
	
	//derby
	if (DerbyTimer <= 180 && DerbyTimer > 0) {format (String, sizeof(String),"{9966CC}Дерби\t'%s'\t{afafaf}%d сек\t{9966CC}%d / 25\n",DerbyName[Derbyid], DerbyTimer, DerbyPlayers);}
	else {format (String, sizeof(String),"{9966CC}Дерби\t{afafaf}[не активно]\t \t{afafaf}%d\n", DerbyPlayers);}
	strcat(StringX, String);
	
	//zombie
	if (ZMTimer <= 180 && ZMTimer > 0) {format (String, sizeof(String),"{E60020}Зомби-выживание\t'%s'\t{afafaf}%d сек\t{E60020}%d / 25\n",ZMName[ZMid], ZMTimer, ZMPlayers);}
	else {format (String, sizeof(String),"{E60020}Зомби-выживание\t{afafaf}[не активно]\t \t{afafaf}%d\n", ZMPlayers);}
	strcat(StringX, String);
	
	//race
	if (FRTimer <= 180 && FRTimer > 0) {format (String, sizeof(String),"{007FFF}Гонка\t%s - %s\t{afafaf}%d сек\t{007FFF}%d / 25\n",FRName[FRStart],FRName[FRFinish],FRTimer, FRPlayers);}
	else {format (String, sizeof(String),"{007FFF}Гонка\t{afafaf}[не активно]\t \t{afafaf}%d\n", FRPlayers);}
	strcat(StringX, String);
	
	//gg
	if (GGTimer <= 180 && GGTimer > 0){format (String, sizeof(String),"{FF6666}Гонка вооружений\t'%s'\t{afafaf}%d сек\t{FF6666}%d / 25\n",GGName[GGid], GGTimer, GGPlayers);}
 	else if (GGTimeToEnd > 0){format (String, sizeof(String),"{FF6666}Гонка вооружений\t'%s'\t{ffffff}[Активно]\t{FF6666}%d / 25\n",GGName[GGid], GGPlayers);}
	else {format (String, sizeof(String),"{FF6666}Гонка вооружений\t{afafaf}[не активно]\t\t\n");}
	strcat(StringX, String);
	
	//xrace
	if (XRTimer <= 180 && XRTimer > 0) {format (String, sizeof(String),"{FFD700}Легендарная гонка\t'%s'\t{afafaf}%d сек\t{FFD700}%d / 25\n",XRName[XRid], XRTimer, XRPlayers);}
	else {format (String, sizeof(String),"{FFD700}Легендарная гонка\t{afafaf}[не активно]\t \t{afafaf}%d\n", XRPlayers);}
	strcat(StringX, String);
	
	//team dm
	if (TDMTimer <= 180 && TDMTimer > 0) {format (String, sizeof(String),"{04B486}Командный ДМ\t'%s'\t{afafaf}%d сек\t{04B486}%d / 24\n",TDMName[TDMid], TDMTimer,TDMPlayers);}
	else if (TDMTimeToEnd > 0){format (String, sizeof(String),"{04B486}Командный ДМ\t'%s'\t{ffffff}До конца: %d сек\t{04B486}%d / 24\n",TDMName[TDMid], TDMTimeToEnd, TDMPlayers);}
	else {format (String, sizeof(String),"{04B486}Командный ДМ\t{afafaf}[не активно]\t\t\n");}
	strcat(StringX, String);
	
	//park
	if (PRTimer <= 180 && PRTimer > 0) {format (String, sizeof(String),"{58FAF4}Паркур\t'%s'\t{afafaf}%d сек\t{58FAF4}%d / 20\n",PRName[PRid], PRTimer,PRPlayers);}
	else {format (String, sizeof(String),"{58FAF4}Паркур\t{afafaf}[не активно]\t \t{afafaf}%d\n", PRPlayers);}
	strcat(StringX, String);
	
	//drace
	if (DRTimer <= 180 && DRTimer > 0) {format (String, sizeof(String),"{4C73E6}Гонка на выживание\t'%s'\t{afafaf}%d сек\t{4C73E6}%d / 25\n",DRName[DRid], DRTimer, DRPlayers);}
	else {format (String, sizeof(String),"{4C73E6}Гонка на выживание\t{afafaf}[не активно]\t \t{afafaf}%d\n", DRPlayers);}
	strcat(StringX, String);
	
	//point dm
	/*
	if (PDMTimer <= 180 && PDMTimer > 0) {format (String, sizeof(String),"{58FA82}Захват точки\t'%s'\t{afafaf}%d сек\t{58FA82}%d / 24\n",PDMName[PDMid], PDMTimer,PDMPlayers);}
	else if (PDMTimeToEnd > 0){format (String, sizeof(String),"{58FA82}Захват точки\t'%s'\t{ffffff}До конца: %d сек\t{58FA82}%d / 24\n",PDMName[PDMid], PDMTimeToEnd, PDMPlayers);}
	else {format (String, sizeof(String),"{58FA82}Захват точки\t{afafaf}[не активно]\t\t\n");}
	strcat(StringX, String);
	*/
	strcat(StringX, "{ff0000}Покинуть соревнование");
	
	ShowPlayerDialog(playerid, DIALOG_EVENTS, 5, "{5858FA}Соревнования:", StringX, "Выбрать", "Выход");
	return 1;
}//ShowEvents

stock ShowQuests(playerid)
{//ShowQuests
	new StringX[1024], String[180];
	
    strcat(StringX, "Задание\tПрогресс\n");
	for (new i = 0; i <= 2; i++)
	{//цикл
	    if (QuestTime[playerid][i] > 0) format(String, sizeof String, "{FB98DA}Новое задание через %d минут\t\n", QuestTime[playerid][i] / 60 + 1);
	    else switch (Quest[playerid][i])
	    {//switch
	        case 1: format(String, sizeof String, "{FFFFFF}Убейте 40 игроков в десматче:\t {007FFF}%d{FFFFFF} / 40\n", QuestScore[playerid][i]);
	        case 2: format(String, sizeof String, "{FFFFFF}Убейте 5 игроков при помощи холодного оружия:\t {007FFF}%d{FFFFFF} / 5\n", QuestScore[playerid][i]);
	        case 3: format(String, sizeof String, "{FFFFFF}Убейте 15 зомби в зомби-выживании:\t {007FFF}%d{FFFFFF} / 15\n", QuestScore[playerid][i]);
	        case 4: format(String, sizeof String, "{FFFFFF}Убейте 15 игроков в гонке вооружений:\t {007FFF}%d{FFFFFF} / 15\n", QuestScore[playerid][i]);
	        case 5: format(String, sizeof String, "{FFFFFF}Убейте 5 игроков за пределами соревнований:\t {007FFF}%d{FFFFFF} / 5\n", QuestScore[playerid][i]);
	        case 6: format(String, sizeof String, "{FFFFFF}Убейте 50 игроков:\t {007FFF}%d{FFFFFF} / 50\n", QuestScore[playerid][i]);
	        case 7: format(String, sizeof String, "{FFFFFF}Совершите 10 убийств из любого пистолета:\t {007FFF}%d{FFFFFF} / 10\n", QuestScore[playerid][i]);
	        case 8: format(String, sizeof String, "{FFFFFF}Совершите 10 убийств из любого дробовика:\t {007FFF}%d{FFFFFF} / 10\n", QuestScore[playerid][i]);
	        case 9: format(String, sizeof String, "{FFFFFF}Совершите 10 убийств из любого пистолет-пулемета:\t {007FFF}%d{FFFFFF} / 10\n", QuestScore[playerid][i]);
	        case 10: format(String, sizeof String, "{FFFFFF}Совершите 10 убийств из любого автомата:\t {007FFF}%d{FFFFFF} / 10\n", QuestScore[playerid][i]);
	        case 11: format(String, sizeof String, "{FFFFFF}Примите участие в 3 десматчах:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 12: format(String, sizeof String, "{FFFFFF}Примите участие в 3 дерби:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 13: format(String, sizeof String, "{FFFFFF}Примите участие в 3 зомби-выживаниях:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 14: format(String, sizeof String, "{FFFFFF}Примите участие в 3 гонках:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 15: format(String, sizeof String, "{FFFFFF}Подарите другим игрокам 50 000$:\t {007FFF}%d{FFFFFF} / 50000\n", QuestScore[playerid][i]);
	        case 16: format(String, sizeof String, "{FFFFFF}Примите участие в 3 легендарных гонках:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 17: format(String, sizeof String, "{FFFFFF}Примите участие в 3 гонках вооружений:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 18: format(String, sizeof String, "{FFFFFF}Примите участие в 5 любых соревнованиях:\t {007FFF}%d{FFFFFF} / 5\n", QuestScore[playerid][i]);
	        case 19: format(String, sizeof String, "{FFFFFF}Ограбьте других игроков на сумму 10 000$:\t {007FFF}%d{FFFFFF} / 10000\n", QuestScore[playerid][i]);
	        case 20: format(String, sizeof String, "{FFFFFF}Выживите в 2 зомби-выживаниях:\t {007FFF}%d{FFFFFF} / 2\n", QuestScore[playerid][i]);
	        case 21: format(String, sizeof String, "{FFFFFF}Найдите 5 кейсов:\t {007FFF}%d{FFFFFF} / 5\n", QuestScore[playerid][i]);
	        case 22: format(String, sizeof String, "{FFFFFF}Примите участие в 5 PvP:\t {007FFF}%d{FFFFFF} / 5\n", QuestScore[playerid][i]);
	        case 23: format(String, sizeof String, "{FFFFFF}Выиграйте 3 PvP:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 24: format(String, sizeof String, "{FFFFFF}Сделайте 2 ставки в казино:\t {007FFF}%d{FFFFFF} / 2\n", QuestScore[playerid][i]);
	        case 25: format(String, sizeof String, "{FFFFFF}Проведите на сервере 60 минут:\t {007FFF}%d{FFFFFF} / 60\n", QuestScore[playerid][i]);
	        case 26: format(String, sizeof String, "{FFFFFF}Наберите 3 000 XP:\t {007FFF}%d{FFFFFF} / 3000\n", QuestScore[playerid][i]);
	        case 27: format(String, sizeof String, "{FFFFFF}Проведите 15 минут на любой работе:\t {007FFF}%d{FFFFFF} / 15\n", QuestScore[playerid][i]);
	        case 28: format(String, sizeof String, "{FFFFFF}Примите участие в 3 командных ДМ:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
	        case 29: format(String, sizeof String, "{FFFFFF}Трансформируйте транспорт 30 раз:\t {007FFF}%d{FFFFFF} / 30\n", QuestScore[playerid][i]);
	        case 30: format(String, sizeof String, "{FFFFFF}Потратьте 25 000$ в оружейном магазине:\t {007FFF}%d{FFFFFF} / 25000\n", QuestScore[playerid][i]);
	        case 31: format(String, sizeof String, "{FFFFFF}Принять участие в гонке на выживание:\t {007FFF}%d{FFFFFF} / 4\n", QuestScore[playerid][i]);
	        case 32: format(String, sizeof String, "{FFFFFF}Принять участие в паркуре:\t {007FFF}%d{FFFFFF} / 3\n", QuestScore[playerid][i]);
			default: format(String, sizeof String, "{FF0000}Произошла ошибка при обновлении задания! Сообщите администрации!\t\n");
	    }//switch

	    strcat(StringX, String);
	}//цикл
	
	strcat(StringX, "{FFCC00}Обменять медали\t\n");
    if (MrfDate > 0) strcat(StringX, "{74DF00}ЗАДАНИЯ МАРАФОНА\t\n");
    else strcat(StringX, "\t\n");

    if(Player[playerid][SPN9] > 0)
    {
        if(Player[playerid][MenuTp] > unixtime) {format(String, sizeof String, "{afafaf}Смена квеста будет доступна через {007FFF}%s\t\n", TimeConvert(Player[playerid][MenuTp]- unixtime)); strcat(StringX, String);}
        else strcat(StringX, "{FFCC00}* Сменить 1 квест\t\n{FFCC00}* Сменить 2 квест\t\n{FFCC00}* Сменить 3 квест\t\n");
    }
	else strcat(StringX, "{afafaf}Хочешь менять квесты? Приобретай навык Махинатор в /marafon!\t\n");
    
	format(String, sizeof String, "{AFAFAF}Доступные задания (Медали: {FFFF00}%d{AFAFAF})", Player[playerid][Medals]);
	ShowPlayerDialog(playerid, DIALOG_QUESTS, 5, String, StringX, "Выбрать", "Закрыть");
	return 1;
}//ShowQuests

stock CallCar1(playerid)
{//вызов авто класса 1
    if (Player[playerid][CarSlot1] == 0) return SendClientMessage(playerid,COLOR_RED,"У вас нет автомобиля 1-го класса");
	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid, COLOR_RED, "Нельзя вызывать транспорт в помещениях!");//Игрок в интерьерах или в банке
	if (GetPlayerWeapon(playerid) == 46) return SendClientMessage(playerid,COLOR_RED,"Смените оружие! Нельзя вызывать автомобиль с парашютом за спиной.");
	if (InEvent[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать машину в соревнованиях!");
	if (QuestActive[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать личный транспорт на работе!");
	new rtime = TimeTransform[playerid]-unixtime;
	if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6);format(String,sizeof(String),"Вы не можете вызвать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);SendClientMessage(playerid,COLOR_RED,String);return 1;}
    if (OnFly[playerid] == 1) StopFly(playerid);
	Player[playerid][CarActive] = 1; SetPlayerSpecialAction(playerid, 0); //чтобы не было бага с дюпом авто
    new Float: x, Float: y, Float: z, Float: Angle; GetPlayerPos(playerid,x,y,z);
	new wrld = GetPlayerVirtualWorld(playerid); GetPlayerFacingAngle(playerid, Angle);
	PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot1], x, y, z, Angle, Player[playerid][CarSlot1Color1], Player[playerid][CarSlot1Color2], 0, Player[playerid][CarSlot1Sir]);
	SetVehicleVirtualWorld(PlayerCarID[playerid], wrld);PutPlayerInVehicle(playerid, PlayerCarID[playerid], 0);
    if (Player[playerid][CarSlot1PaintJob] > -1){ChangeVehiclePaintjob(PlayerCarID[playerid], Player[playerid][CarSlot1PaintJob]);}
	//Загрузка компонентов тюнинга
    if (Player[playerid][CarSlot1Component0] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component0]);
    if (Player[playerid][CarSlot1Component1] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component1]);
    if (Player[playerid][CarSlot1Component2] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component2]);
    if (Player[playerid][CarSlot1Component3] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component3]);
    if (Player[playerid][CarSlot1Component4] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component4]);
    if (Player[playerid][CarSlot1Component5] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component5]);
    if (Player[playerid][CarSlot1Component6] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component6]);
    if (Player[playerid][CarSlot1Component7] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component7]);
    if (Player[playerid][CarSlot1Component8] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component8]);
    if (Player[playerid][CarSlot1Component9] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component9]);
    if (Player[playerid][CarSlot1Component10] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component10]);
    if (Player[playerid][CarSlot1Component11] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component11]);
    if (Player[playerid][CarSlot1Component12] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component12]);
    if (Player[playerid][CarSlot1Component13] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot1Component13]);
	LinkVehicleToInterior(PlayerCarID[playerid],GetPlayerInterior(playerid));
	if (Player[playerid][CarSlot1Neon] != 0 && Player[playerid][Prestige] >= 4)
	{//Создание неона
	    new vehicleid = PlayerCarID[playerid];
	    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
	    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
	    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
	    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
	}//Создание неона
	if (Player[playerid][CarSlot1Fire] != 0 && Player[playerid][Prestige] >= 3)
			{
				//new wrld = GetPlayerVirtualWorld(playerid);
			    new vehicleid = PlayerCarID[playerid];
				//Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
			}
    if (Player[playerid][CarSlot1Mig] != 0 && Player[playerid][Level] >= 50)
	{//Создание migalki
	    new vehicleid = PlayerCarID[playerid];
	    new model = GetVehicleModel(vehicleid);
	    new access = 0;
		for (new i=0;i<MAX_MIG;i++)
		{
			if(MigPosInf[i][vhid] == model) access = i;
		}
	    MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot1Mig], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
	    AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
	}//Создание migalki
	TimeTransform[playerid] = unixtime+5;
	//QuestUpdate(playerid, 28, 1);//Обновление квеста Вызовите личный транспорт 30 раз
	return 1;
}//вызов авто класса 1

stock CallCar2(playerid)
{//вызов авто класса 2
    if (Player[playerid][CarSlot2] == 0) return SendClientMessage(playerid,COLOR_RED,"У вас нет автомобиля 2-го класса");
	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid, COLOR_RED, "Нельзя вызывать транспорт в помещениях!");//Игрок в интерьерах или в банке
	if (GetPlayerWeapon(playerid) == 46) return SendClientMessage(playerid,COLOR_RED,"Смените оружие! Нельзя вызывать автомобиль с парашютом на спине.");
	if (InEvent[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать машину в соревнованиях!");
	if (QuestActive[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать личный транспорт на работе!");
	new rtime = TimeTransform[playerid]-unixtime;
	if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6); format(String,sizeof(String),"Вы не можете вызвать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);SendClientMessage(playerid,COLOR_RED,String);return 1;}
    if (OnFly[playerid] == 1) StopFly(playerid);
	Player[playerid][CarActive] = 2; SetPlayerSpecialAction(playerid, 0); //чтобы не было бага с дюпом авто
    new Float: x, Float: y, Float: z, Float: Angle; GetPlayerPos(playerid,x,y,z);
	new wrld = GetPlayerVirtualWorld(playerid); GetPlayerFacingAngle(playerid, Angle);
	PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot2], x, y, z, Angle, Player[playerid][CarSlot2Color1], Player[playerid][CarSlot2Color2], 0, Player[playerid][CarSlot2Sir]);
	SetVehicleVirtualWorld(PlayerCarID[playerid], wrld);PutPlayerInVehicle(playerid, PlayerCarID[playerid], 0);
	if (Player[playerid][CarSlot2PaintJob] > -1){ChangeVehiclePaintjob(PlayerCarID[playerid], Player[playerid][CarSlot2PaintJob]);}
	//Загрузка компонентов тюнинга
    if (Player[playerid][CarSlot2Component0] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component0]);
    if (Player[playerid][CarSlot2Component1] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component1]);
    if (Player[playerid][CarSlot2Component2] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component2]);
    if (Player[playerid][CarSlot2Component3] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component3]);
    if (Player[playerid][CarSlot2Component4] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component4]);
    if (Player[playerid][CarSlot2Component5] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component5]);
    if (Player[playerid][CarSlot2Component6] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component6]);
    if (Player[playerid][CarSlot2Component7] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component7]);
    if (Player[playerid][CarSlot2Component8] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component8]);
    if (Player[playerid][CarSlot2Component9] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component9]);
    if (Player[playerid][CarSlot2Component10] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component10]);
    if (Player[playerid][CarSlot2Component11] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component11]);
    if (Player[playerid][CarSlot2Component12] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component12]);
    if (Player[playerid][CarSlot2Component13] != 0) AddVehicleComponent(PlayerCarID[playerid], Player[playerid][CarSlot2Component13]);
    LinkVehicleToInterior(PlayerCarID[playerid],GetPlayerInterior(playerid));
    if (Player[playerid][CarSlot2Neon] != 0 && Player[playerid][Prestige] >= 4)
	{//Создание неона
	    new vehicleid = PlayerCarID[playerid];
	    NeonObject1[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
	    NeonObject2[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Neon], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
	    AttachDynamicObjectToVehicle(NeonObject1[vehicleid], vehicleid, -0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
	    AttachDynamicObjectToVehicle(NeonObject2[vehicleid], vehicleid, 0.8, 0.0, -0.70, 0.0, 0.0, 0.0);
	}//Создание неона
	if (Player[playerid][CarSlot2Fire] != 0 && Player[playerid][Prestige] >= 3)
			{
				//new wrld = GetPlayerVirtualWorld(playerid);
			    new vehicleid = PlayerCarID[playerid];
				//Fire1[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//Fire2[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire3[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				Fire4[vehicleid] = CreateDynamicObject(18694, 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
				//AttachDynamicObjectToVehicle(Fire1[vehicleid], vehicleid, -0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				//AttachDynamicObjectToVehicle(Fire2[vehicleid], vehicleid, 0.8, 2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire3[vehicleid], vehicleid, -0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
				AttachDynamicObjectToVehicle(Fire4[vehicleid], vehicleid, 0.8, -2.0, -2.0, 0.0, 0.0, 0.0);
			}
    if (Player[playerid][CarSlot2Mig] != 0 && Player[playerid][Level] >= 50)
	{//Создание migalki
	    new vehicleid = PlayerCarID[playerid];
	    new model = GetVehicleModel(vehicleid);
	    new access = 0;
		for (new i=0;i<MAX_MIG;i++)
		{
			if(MigPosInf[i][vhid] == model) access = i;
		}
	    MigObj[vehicleid] = CreateDynamicObject(Player[playerid][CarSlot2Mig], 0, 0, 0, 0, 0, 0, wrld, GetPlayerInterior(playerid), -1, 300.0);
	    AttachDynamicObjectToVehicle(MigObj[vehicleid], vehicleid, MigPosInf[access][fPosX], MigPosInf[access][fPosY], MigPosInf[access][fPosZ], 0.0, 0.0, 0.0);
	}//Создание migalki
	
	if (Player[playerid][Type] != 0)
	{//Создание vinil
		if(strcmp(Player[playerid][Vinil], "Null"))
 		{
  			new vehicleid = PlayerCarID[playerid];
			CreateVehVinil(playerid, vehicleid);
		}
	}//Создание vinil

	TimeTransform[playerid] = unixtime+5;
	//QuestUpdate(playerid, 28, 1);//Обновление квеста Вызовите личный транспорт 30 раз
    return 1;
}//вызов авто класса 2

stock CallCar3(playerid)
{//вызов авто класса 3
    if (Player[playerid][CarSlot3] == 0) return SendClientMessage(playerid,COLOR_RED,"У вас нет автомобиля 3-го класса");
	if (GetPlayerInterior(playerid) != 0 || IsPlayerInRangeOfPoint(playerid, 13.0, 2311.6953,-7.4206,26.7422)) return SendClientMessage(playerid, COLOR_RED, "Нельзя вызывать транспорт в помещениях!");//Игрок в интерьерах или в банке
	if (GetPlayerWeapon(playerid) == 46) return SendClientMessage(playerid,COLOR_RED,"Смените оружие! Нельзя вызывать автомобиль с парашютом на спине.");
	if (InEvent[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать машину в соревнованиях!");
	if (QuestActive[playerid] > 0) return SendClientMessage(playerid,COLOR_RED,"Нельзя вызывать личный транспорт на работе!");
	new rtime = TimeTransform[playerid]-unixtime;
	if (rtime > 0){new String[120];format(String, sizeof String, "~b~%d sec", rtime); GameTextForPlayer(playerid, String, 1000, 6);format(String,sizeof(String),"Вы не можете вызвать транспорт еще {FFFFFF}%d{FF0000} секунд",rtime);SendClientMessage(playerid,COLOR_RED,String);return 1;}
    if (OnFly[playerid] == 1) StopFly(playerid);
	Player[playerid][CarActive] = 3; SetPlayerSpecialAction(playerid, 0); //чтобы не было бага с дюпом авто
    new Float: x, Float: y, Float: z, Float: Angle; GetPlayerPos(playerid,x,y,z);
	new wrld = GetPlayerVirtualWorld(playerid); GetPlayerFacingAngle(playerid, Angle);
	PlayerCarID[playerid] = LCreateVehicle(Player[playerid][CarSlot3], x, y, z + 2, Angle, Player[playerid][CarSlot3Color1], Player[playerid][CarSlot3Color2], 0);
	SetVehicleVirtualWorld(PlayerCarID[playerid], wrld);PutPlayerInVehicle(playerid, PlayerCarID[playerid], 0);
    LinkVehicleToInterior(PlayerCarID[playerid],GetPlayerInterior(playerid));
	TimeTransform[playerid] = unixtime+5;
	//QuestUpdate(playerid, 28, 1);//Обновление квеста Вызовите личный транспорт 30 раз
    return 1;
}//вызов авто класса 3

stock OnPlayerLogin(playerid)
{//при успешной АВТОРИЗАЦИИ
	if(strcmp(PlayerLimitXPDate[playerid], ServerLimitXPDate))
	{
	    if (Player[playerid][LastHourExp] > 0)
		{
			new String[180];
		    format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   STATISTICS: Игрок %s[%d] получил %d XP за один час", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, Player[playerid][LastHourExp]);
			WriteLog("StatisticsXP", String);
		}
		if (Player[playerid][LastHourReferalExp] > 0)
		{
			new String[180];
		    format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   STATISTICS: Игрок %s[%d] получил от клана %d XP за один час", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, Player[playerid][LastHourReferalExp]);
			WriteLog("StatisticsClanXP", String);
		}
		Player[playerid][LastHourExp] = 0;
		Player[playerid][LastHourReferalExp] = 0;
	}
	format(PlayerLimitXPDate[playerid], 80, "%s", ServerLimitXPDate);
    StopAudioStreamForPlayer(playerid); LoadPlayerClan(playerid);//Загрузка клана

	UpdatePlayer(playerid); ShopUpdate(playerid);
    PlayerWeather[playerid] = -1; PlayerTime[playerid] = -1;//Серверные погода и время после логина

    //Pack_OnPlayerLogin(playerid); //загружаем радар

	if (Player[playerid][Home] > 0)
	{//Сообщение о потере дома
		new myhome = Player[playerid][Home];
		if(strcmp(Property[myhome][pOwner], PlayerName[playerid], true))
		{//дом не принадлежит игроку
			Player[playerid][Home] = 0;
			if (Player[playerid][Spawn] == 4 || Player[playerid][Spawn] == 6 || Player[playerid][Spawn] == 7) Player[playerid][Spawn] = 0;
			SendClientMessage(playerid, COLOR_YELLOW, "Ваш дом перекупили! Деньги были возвращены на ваш банковский счет.");
		}//дом не принадлежит игроку
	}//Сообщение о потере дома

	if (Player[playerid][Level] == 0)
	{//При прошлом заходе не дошел обучение до конца
	    //Запускаем обучение заново
		new String[1024];TutorialStep[playerid] = 1;
		strcat(String, "{007FFF}Обучение: Вызов транспорта{FFFFFF}\n\n");
		strcat(String, "Каждому игроку на сервере с самого начала выдается свой личный автомобиль. Изначально это мопед.\n");
		strcat(String, "Для того, чтобы сесть на него, нажмите клавишу {00FF00}Alt{FFFFFF} и выберите <<{FFFF00}Сесть в машину [Класс 1]{FFFFFF}>>");
		return ShowPlayerDialog(playerid, DIALOG_TUTORIAL, 0, "Обучение", String, "ОК, сейчас", "");
	}//При прошлом заходе не дошел обучение до конца
	
	if(Player[playerid][ReadObnovlenie] != LAST_UPD)
    {
       	Player[playerid][ReadObnovlenie] = LAST_UPD;
      	ShowObovDialog(playerid);
    }
    //new year

	else if(Player[playerid][Bonus] != 4) ShowPlayerDialog(playerid, 999, 0, "{ffffff}ТВОЙ ПОДАРОК!", "Ты еще не забрал свой {ffff00}Новогодний Подарок{ffffff}!\n\nЧтобы забрать его, направляйся к пирамиде в ЛВ!\nПодарок будет возле елки!", "БЕГУ", "");

    HealthTime[playerid] = 0; ArmourTime[playerid] = 0;
	return 1;
}//при успешной АВТОРИЗАЦИИ

stock SpecUpdate(playerid)
{//SpecUpdate
    foreach(Player, i)
	{//обновление спектра у тех, кто следит за игроком
	    if (LSpecID[i] == playerid)
	    {
			SetPlayerInterior(i,GetPlayerInterior(playerid));
			SetPlayerVirtualWorld(i,GetPlayerVirtualWorld(playerid));
			if (IsPlayerInAnyVehicle(playerid))
			{
				PlayerSpectateVehicle(i, GetPlayerVehicleID(playerid), LSpecMode[playerid]);
				//Исправление глюка, когда не сохранялся режим камеры сбоку
                SetTimerEx("SideCameraSpecpUpdate" , 100, false, "id", i, GetPlayerVehicleID(playerid));
			}
			else PlayerSpectatePlayer(i, playerid, LSpecMode[playerid]);
		}
	}//обновление спектра у тех, кто следит за игроком
}//SpecUpdate

//------------ Количество пассажирских сидений в транспорте
new VehiclePassengerSeats[] = {
3,1,1,1,3,3,0,1,1,3,1,1,1,3,1,1,3,1,3,1,3,3,1,1,1,0,3,3,3,1,0,1000,0,1,1,0,1,1000,3,1,3,0,1,1,1,3,0,1,
0,0,0,1,0,0,0,1,1,1,3,3,1,1,1,1,0,0,3,3,1,1,3,1,0,0,1,1,0,1,1,3,1,0,3,3,0,0,0,3,1,1,3,1,3,0,1,1,1,3,
3,1,1,0,1,1,1,1,1,3,1,0,0,1,0,0,1,1,3,1,1,0,0,1,1,1,1,1,1,1,1,3,0,0,0,1,1,1,1,1000,1000,0,3,1,1,1,1,1,
3,3,1,1,3,3,1,0,1,1,1,1,1,1,3,3,1,1,0,1,3,3,0,0,0,0,0,1,0,1,1,0,1,3,3,1,3,0,0,3,1,1,1,1,0,0,1000,1,1,
0,3,3,3,1,1,1,1,1,3,1,0,0,0,3,0,0};

stock GetPassengerSeats(vehicleid)
{
	if (vehicleid == -1) return 0;
	return VehiclePassengerSeats[(GetVehicleModel(vehicleid) - 400)];
}
//------------ Количество пассажирских сидений в транспорте

stock GiveGGWeapon(playerid)
{
	ResetPlayerWeapons(playerid);
	if (GGKills[playerid] < 1) GivePlayerWeapon(playerid, 24, 20000);
	if (GGKills[playerid] == 1) GivePlayerWeapon(playerid, 25, 20000);
	if (GGKills[playerid] == 2) GivePlayerWeapon(playerid, 26, 20000);
	if (GGKills[playerid] == 3) GivePlayerWeapon(playerid, 27, 20000);
	if (GGKills[playerid] == 4) GivePlayerWeapon(playerid, 29, 20000);
	if (GGKills[playerid] == 5) GivePlayerWeapon(playerid, 28, 20000);
	if (GGKills[playerid] == 6) GivePlayerWeapon(playerid, 32, 20000);
	if (GGKills[playerid] == 7) GivePlayerWeapon(playerid, 31, 20000);
	if (GGKills[playerid] == 8) GivePlayerWeapon(playerid, 30, 20000);
	if (GGKills[playerid] == 9) GivePlayerWeapon(playerid, 16, 20000);
	if (GGKills[playerid] == 10) GivePlayerWeapon(playerid, 34, 20000);
	if (GGKills[playerid] == 11) GivePlayerWeapon(playerid, 35, 20000);
	if (GGKills[playerid] == 12 || GGKills[playerid] == 13) GivePlayerWeapon(playerid, 38, 20000);
	if (GGKills[playerid] == 14) GivePlayerWeapon(playerid, 8, 1);//дать катану
	return 1;
}

stock GetPlayerSpeed(playerid)
{//для LAC flyhack
	new Float:Coord[4];
	GetPlayerVelocity(playerid, Coord[0], Coord[1], Coord[2]);
	Coord[3] = floatsqroot(floatpower(floatabs(Coord[0]), 2.0) + floatpower(floatabs(Coord[1]), 2.0) + floatpower(floatabs(Coord[2]), 2.0)) * 213.3;
	return floatround(Coord[3]);
}//для LAC flyhack

stock LGiveXP(playerid, standartxp)
{//добавление XP
    if(Player[playerid][Exp] < 0) Player[playerid][Exp]=0;//исправляет странный баг
    new XPToLevel, String[140], XPBonus = 0, MBonus = 0;
	if(ServConf[0] == 1) XPToLevel = standartxp*2; //опыт х2
	else XPToLevel = standartxp;
	
	if (XPToLevel > 0)
	{//Начисление ХР до уровня
	    Player[playerid][Exp] += XPToLevel; //+хп
	    Player[playerid][LastHourExp] += XPToLevel; //+хп в час
		Player[playerid][OpXP] += standartxp; //+хп в топ
		if(ServConf[3] == 0) Player[playerid][OpXP] += standartxp;
		else Player[playerid][OpXP] += standartxp*2;
		//бонус
		if (Player[playerid][GPremium] >= 1 && Player[playerid][GPremium] < 5) XPBonus = XPToLevel * 15 / 100;//начисление бонуса 15%
		if (Player[playerid][GPremium] >= 5 && Player[playerid][GPremium] < 8) XPBonus = XPToLevel * 20 / 100;//начисление бонуса 20%
		if (Player[playerid][GPremium] >= 8 && Player[playerid][GPremium] < 10) XPBonus = XPToLevel * 35 / 100;//начисление бонуса 35%
		if (Player[playerid][GPremium] >= 10 && Player[playerid][GPremium] < 12)  XPBonus = XPToLevel * 50 / 100;//начисление бонуса 50%
		if (Player[playerid][GPremium] >= 12 && Player[playerid][GPremium] < 15) XPBonus = XPToLevel * 65 / 100;//начисление бонуса 65%
		if (Player[playerid][GPremium] >= 15 && Player[playerid][GPremium] < 17) XPBonus = XPToLevel * 75 / 100;//начисление бонуса 75%
		if (Player[playerid][GPremium] >= 17 && Player[playerid][GPremium] < 20) XPBonus = XPToLevel * 85 / 100;//начисление бонуса 85%
		if (Player[playerid][GPremium] >= 20) XPBonus = XPToLevel;//начисление бонуса 100%
		if (XPBonus > 0) Player[playerid][Exp] += XPBonus;//начисление ХР бонуса VIP

		//----------------------------------- Рефералка
		if (Player[playerid][MyClan] > 0)
		{//Если игрок в клане
		    new RefXP = XPToLevel / 10;//10% от полученного ХР дается соклановцам
		    if (RefXP > 0)
		    {//RefXP > 0
				foreach(Player, cid)
				{//цикл
					if(Player[cid][MyClan] == Player[playerid][MyClan] && cid != playerid && Logged[cid] == 1)
					{//пригласивший в сети
						Player[cid][Exp] += RefXP;
						Player[cid][LastHourReferalExp] += RefXP;
 						new clanid = Player[playerid][MyClan], ccolor = Clan[clanid][cColor];
						format(String, sizeof String, "Вы получили %d XP от игрока %s[%d].", RefXP, PlayerName[playerid], playerid);
						SendClientMessage(cid, ClanColor[ccolor], String);
						PlayerPlaySound(cid,1083,0.0,0.0,0.0);
                        if (NeedXP[cid] <= Player[cid][Exp]) PlayerLevelUp(cid);
					}//пригласивший в сети
				}//цикл
		    }//RefXP > 0
		}//Если игрока кто-то пригласил на сервер
		//----------------------------------- Рефералка

	}//Начисление ХР до уровня

/*	if (XPToMoney > 0)
	{//Начисление ХР в деньги при лимите
	    Player[playerid][Cash] += XPToMoney * 100;//Если из-за лимита не вошли 100хр, то получаешь 10 000 денег
		format(String,sizeof(String),"Лимит XP набран! Вместо них вы получили %d$",XPToMoney * 100);
		SendClientMessage(playerid,0x00FF00FF,String);
	}//Начисление ХР в деньги при лимите
*/
	if (Player[playerid][GPremium] >= 6 && Player[playerid][GPremium] < 9) MBonus = standartxp * 15;//ViP 6: x15 денег от XP
	if (Player[playerid][GPremium] >= 9 && Player[playerid][GPremium] < 16) MBonus = standartxp * 30;//ViP 9: x30 денег от XP
	if (Player[playerid][GPremium] >= 16) MBonus = standartxp * 60;//ViP 16: x60 денег от XP
	if (MBonus > 0)	Player[playerid][Cash] += MBonus;//начисление денежного бонуса VIP

	if (XPBonus > 0)
	{//Сообщения в чат о начисленных бонусах
		if (MBonus == 0) format(String,sizeof(String),"ViP: Вы получили бонус %d XP",XPBonus);
		else format(String,sizeof(String),"ViP: Вы получили бонус %d XP и %d$",XPBonus, MBonus);
		SendClientMessage(playerid,0x00FF00FF,String);
	}//Сообщения в чат о начисленных бонусах

	if (Player[playerid][MyClan] != 0)
	{//Прокачка клана
	    new clanid = Player[playerid][MyClan];
		Clan[clanid][cXP] += standartxp;
		Clan[clanid][cXP] += XPBonus;
	}//Прокачка клана

	if (Player[playerid][Exp] >= NeedXP[playerid] && (0 < Player[playerid][Level] < 100 || Player[playerid][Prestige] >= 10)) PlayerLevelUp(playerid); //Повышение уровня, если набрано достаточно XP
	QuestUpdate(playerid, 26, standartxp);//Обновление квеста Наберите 3 000 XP
    MarafonUpdate(playerid, 1, standartxp);
}//добавление XP


public RemoveRamp(playerid)
{
	if (rampid[playerid] != -1)
	{
	    DestroyDynamicObject(rampid[playerid]);
	    rampid[playerid] = -1;
	}
}

Float:GetOptimumRampDistance(playerid)
{
	new ping = GetPlayerPing(playerid), Float:dist;
	dist = floatpower(ping, 0.25);
	dist = dist*4.0;
	dist = dist+5.0;
	return dist;
}

Float:GetXYInFrontOfPlayer(playerid, &Float:x, &Float:y, Float:distance)
{
	new Float:a;
	GetPlayerPos(playerid, x, y, a);
	if (IsPlayerInAnyVehicle(playerid)) GetVehicleZAngle(GetPlayerVehicleID(playerid), a);
	else GetPlayerFacingAngle(playerid, a);
	x += (distance * floatsin(-a, degrees));
	y += (distance * floatcos(-a, degrees));
	return a;
}

public SpeedoUpdate(playerid)
{//Спидометр. Срабатывает два раза в секунду, если игрок в машине
	if (Logged[playerid] == 0 || !IsPlayerInAnyVehicle(playerid) || /*Player[playerid][ConSpeedo] == 0 ||*/ LSpecID[playerid] != -1)
	{
		PlayerTextDrawHide(playerid, TextDrawSpeedo[playerid]);
		LastSpeed[playerid] = 999;
		return 1;
	}
	else
	{//Игрок в машине, залогинен, не в спектре
	        SetTimerEx("SpeedoUpdate" , 500, false, "i", playerid);
	   		new Float:SPD, Float:vx, Float:vy, Float:vz, String[140], Float: x, Float: y, Float: z, vehicleid = GetPlayerVehicleID(playerid);
		    GetVehicleVelocity(vehicleid, vx,vy,vz);GetPlayerPos(playerid,x,y,z);
		    SPD = floatsqroot(((vx*vx)+(vy*vy))/*+(vz*vz)*/)*200;
			new speed = floatround(SPD, floatround_round);
			new MaxSpeed = GetVehicleMaxSpeed(vehicleid);
			if (z < LastPlayerSHZ[playerid] && speed > MaxSpeed && speed < MaxSpeed * 11/10 && LACSH[playerid] == 0) NeedSpeedDown[playerid] = 1;//при превышении макс. скорости не более, чем на 10% - занизить скорость
			if (NeedSpeedDown[playerid] > 0 && speed > MaxSpeed){SetVehicleSpeed(vehicleid, MaxSpeed*9/10); speed = MaxSpeed*9/10;} else NeedSpeedDown[playerid] = 0;
			//speedo
			if(Player[playerid][ConSpeedo] != 0)
			{
				if(speed < 150) format(String,sizeof(String),"%d Km/h~n~~w~%.0f HP", speed, Vehicle[vehicleid][Health]);
				else format(String,sizeof(String),"~r~%d Km/h~n~~w~%.0f HP", speed, Vehicle[vehicleid][Health]);
				PlayerTextDrawSetString(playerid, TextDrawSpeedo[playerid], String);
				PlayerTextDrawShow(playerid, TextDrawSpeedo[playerid]);
			}
			//anti speedhack test
            new kef = speed - LastSpeed[playerid], cheat = 0, vmodel = GetVehicleModel(vehicleid);
			if (LACSH[playerid] == 0) LastSpeed[playerid] = speed; else LastSpeed[playerid] = 999;
			new Float: VHealth;GetVehicleHealth(vehicleid,VHealth);//Эта и следующая строка исправляют ложное срабатывание при аварии (другой игрок поддает скорость толчком)
			if (VHealth < LastVHealth[playerid]){LastSpeed[playerid] = 999;if (LACSH[playerid] == 0) LACSH[playerid] = 1;}LastVHealth[playerid] = VHealth;
			if (kef > 80 && LACSH[playerid] == 0 && GetPlayerState(playerid) == PLAYER_STATE_DRIVER && Player[playerid][Banned] == 0 && vz >= 0.0) cheat = 1;//Прирост скорости больше 80 за пол секунды (На инфернусе получалось максимум +56, на гидре +76)
			switch(vmodel)
			{//Модель авто
				case 460, 476, 511, 512, 513, 519, 520, 553, 577, 592, 593: cheat = 0;//Не проверять скорость разгона на аэропланах
				case 448, 461, 462, 463, 468, 481, 509, 510, 521, 522, 523, 581, 586: MaxSpeed = 300;//Позволить разгоняться на мотоциклах на заднем колесе
			}//Модель авто
			if (speed > MaxSpeed + 5 && NeedSpeedDown[playerid] == 0 && LACSH[playerid] == 0 && GetPlayerState(playerid) == PLAYER_STATE_DRIVER && Player[playerid][Banned] == 0) cheat = 1;//скорость больше 300 и игрок не находится в падении вниз
            LastPlayerSHX[playerid] = x;LastPlayerSHY[playerid] = y;LastPlayerSHZ[playerid] = z;
			if (cheat == 1)
            {
                DestroyVehicle(vehicleid); TimeTransform[playerid] = unixtime+5; LACPanic[playerid]++;//LAC v2.0
				format(String,sizeof(String), "[АДМИНАМ]LAC:{AFAFAF} Транспорт игрока %s[%d] уничтожен. {FF0000}Причина: {AFAFAF}Возможно SpeedHack",PlayerName[playerid], playerid);
                foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
    			SendClientMessage(playerid, -1,"{FF0000}LAC:{AFAFAF} Ваш транспорт был уничтожен. {FF0000}Причина: {AFAFAF}Возможно чит SpeedHack");
				format(String, 140, "%d.%d.%d в %d:%d:%d |   LAC: Транспорт игрока %s[%d] уничтожен. Причина: Возможно чит SpeedHack", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
				WriteLog("GlobalLog", String);WriteLog("LAC", String);
			}
	}//Игрок в машине, залогинен, не в спектре
	return 1;
}//Спидометр. Срабатывает два раза в секунду, если игрок в машине

public OnUnoccupiedVehicleUpdate(vehicleid, playerid, passenger_seat, Float:new_x, Float:new_y, Float:new_z, Float:vel_x, Float:vel_y, Float:vel_z)
{
	//Код ниже блокирует любые попытки сдвинуть с места транспорт без водителя...
/*	new Float: fDistance = GetVehicleDistanceFromPoint(vehicleid, new_x, new_y, new_z);
	if (fDistance > 3)
	{//если местоположение транспорта рассинхронизировано на 3 метра и более - возвращаем его на место
	    GetVehiclePos(vehicleid, new_x, new_y, new_z);
		SetVehiclePos(vehicleid, new_x, new_y, new_z);
		SetVehicleVelocity(vehicleid, 0, 0, 0);
	}//если местоположение транспорта рассинхронизировано на 3 метра и более - возвращаем его на место
	return 0;*/
	return 1;
}

stock FailPVP(playerid)
{//игрок проиграл PVP
	new winer = PlayerPVP[playerid][Invite], String[200];
	format(String,sizeof(String),"{FF9E27}PVP: {AFAFAF}%s победил в дуэли против %s и выиграл %d$!", PlayerName[winer], PlayerName[playerid],PlayerPVP[playerid][Stavka]*2);
	foreach(Player, cid) if (Player[cid][ConMesPVP] == 1 || cid == playerid || cid == winer) SendClientMessage(cid,COLOR_RED,String);
	PlayerPVP[playerid][Status] = 0;
	PlayerPVP[playerid][Invite] = 0;
    PlayerPVP[playerid][PlayMap] = 0;
	PlayerPVP[playerid][PlayWeapon] = 0;
	PlayerPVP[playerid][PlayHealth] = 0;
	
	PlayerPVP[winer][Status] = 0;
	PlayerPVP[winer][Invite] = 0;
    PlayerPVP[winer][PlayMap] = 0;
	PlayerPVP[winer][PlayWeapon] = 0;
	PlayerPVP[winer][PlayHealth] = 0;
	
	Player[winer][Cash] += PlayerPVP[playerid][Stavka]*2;
	
    SetPlayerVirtualWorld(playerid,0);
	SetPlayerVirtualWorld(winer,0);
    SavePlayer(playerid);
	LSpawnPlayer(playerid);
	SavePlayer(winer);
	LSpawnPlayer(winer);
	JoinEvent[playerid] = 0;
	JoinEvent[winer] = 0;
    QuestUpdate(playerid, 22, 1);//Обновление квеста Примите участие в 5 PvP
    QuestUpdate(winer, 22, 1);//Обновление квеста Примите участие в 5 PvP
    QuestUpdate(winer, 23, 1);//Обновление квеста Выиграйте 3 PvP
	return 1;
}//игрок проиграл PVP

stock IsPlayerInPayNSpray(playerid)
{//проверка на то, что игрок в покрасочном гараже Pay N Spray
    if (IsPlayerInRangeOfPoint(playerid,7,2064.5986,-1831.6934,13.5469)) return 1; //LS 1
	if (IsPlayerInRangeOfPoint(playerid,7,1024.8928,-1024.6052,32.1016)) return 1; //LS 2
	if (IsPlayerInRangeOfPoint(playerid,7,487.3758,-1741.0320,11.1321)) return 1; //LS 3
	if (IsPlayerInRangeOfPoint(playerid,7,-1904.6287,285.5661,41.0469)) return 1; //SF 1
	if (IsPlayerInRangeOfPoint(playerid,7,-2425.6978,1020.8086,50.3977)) return 1; //SF 2
	if (IsPlayerInRangeOfPoint(playerid,7,1976.5468,2162.4783,11.0703)) return 1; //LV
	if (IsPlayerInRangeOfPoint(playerid,7,720.0233,-456.4514,16.3359)) return 1; //Dillimor
	if (IsPlayerInRangeOfPoint(playerid,7,-99.9693,1118.9204,19.7417)) return 1; //Fort Carson
	if (IsPlayerInRangeOfPoint(playerid,7,-1420.1829,2583.6006,55.8433)) return 1; //El Cebrados
	return 0;
}//проверка на то, что игрок в покрасочном гараже Pay N Spray

stock GetPlayerTuneStatus(playerid)
{//проверка на то, что игрок в тюнинг гараже
    if(GetPlayerInterior(playerid) != 0)
    {//Игрок в интерьере (может быть в тюнинге)
	    if (IsPlayerInRangeOfPoint(playerid,5,617.5347,-1.9909,1000.5783)) return 1; //в тюнинге Transfender
	    if (IsPlayerInRangeOfPoint(playerid,5,616.7845,-74.8150,997.8722)) return 2; //в тюнинге Lowrider
	    if (IsPlayerInRangeOfPoint(playerid,5,615.2812,-124.2390,997.6196)) return 3; //в тюнинге Arch Angels
    }//Игрок в интерьере (может быть в тюнинге)
    else
    {//игрок не в интерьере (может быть на въезде или выезде из тюнинга
	    if (IsPlayerInRangeOfPoint(playerid,15,1041.5431,-1016.8201,32.1075)) return -1; //на въезде в Transfender в LS
	    if (IsPlayerInRangeOfPoint(playerid,15,-1936.0847,245.9636,34.4609)) return -2; //на въезде в Transfender в SF
	    if (IsPlayerInRangeOfPoint(playerid,15,2386.7300,1051.5768,10.8203)) return -3; //на въезде в Transfender в LV
	    if (IsPlayerInRangeOfPoint(playerid,15,2644.6580,-2044.3076,13.6352)) return -4; //на въезде в Lowrider
	    if (IsPlayerInRangeOfPoint(playerid,15,-2723.5532,217.1511,4.4844)) return -5; //на въезде в Arch Angels
    }//игрок не в интерьере (может быть на въезде или выезде из тюнинга
	return 0;//игрок не в тюниге и не у въезда в тюнинг
}//проверка на то, что игрок в тюнинг гараже

stock ShopUpdate(playerid)
{//Срабатывает при авторизации И в начале каждого часа
	new xhouse = Player[playerid][Home];
	if (xhouse > 0 && Property[xhouse][pBuyBlock] == -1)
	{//Закончилась неперекупайка
	    Property[xhouse][pBuyBlock] = 0; UpdatePropertyInterior(xhouse); SaveProperty(xhouse);
	    for (new i = 1; i <= 2; i++) SendClientMessage(playerid, COLOR_RED, "Внимание! Закончилось время действия функции 'Неперекупаемый личный дом'");
	}//Закончилась неперекупайка

	if(Player[playerid][SPrest] > 0)
	{
		if (Player[playerid][GGFromMedalsLastDay] != nowday)
		{//Новый день - нужно обнулить счетчик GG за медали
	    	Player[playerid][GGFromMedalsLastDay] = nowday;
			new MxDay = Player[playerid][SPrest]+1;
			if (MxDay > 4) MxDay = 4;
	    	if (Player[playerid][GGFromMedals] == MxDay)
			{//У игрока был набран дневной лимит
				SendClientMessage(playerid, COLOR_YELLOW, "SERVER: Внимание! Обмен медалей на рубли теперь снова доступен!");
				PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
			}//У игрока был набран дневной лимит
	    	Player[playerid][GGFromMedals] = 0;
		}//Новый день - нужно обнулить счетчик GG за медали
	}
	return 1;
}//Срабатывает при авторизации И в начале каждого часа

stock GetEventRestartTime()
{
	/*
	new value, EventsAtOneTime; //кол-во соревнований, которое теоритически должно быть доступно на выбор игроку в каждый момент времени
	if (PlayersOnline < 30) EventsAtOneTime = 2; //При онлайне < 30 игроков должны быть доступны 2 соревнования на выбор
	else if (PlayersOnline < 50) EventsAtOneTime = 3;
	else if (PlayersOnline < 70) EventsAtOneTime = 4;
	else if (PlayersOnline < 90) EventsAtOneTime = 5;
	else if (PlayersOnline < 120) EventsAtOneTime = 6;
	else if (PlayersOnline < 150) EventsAtOneTime = 7;
	else EventsAtOneTime = 8; //При онлайне в 125-150 игроков - 8 соревнований

	value = (8 - EventsAtOneTime) * (240 / EventsAtOneTime);//8 - общее число всех соревнований, 240 - время, среднее время на проведение 1 соревнования
	*/
	/*После этих вычислений мы получаем модель, в которой игрок, после окончания соревнования сразу же стартует следующее
	Это никуда не годится. Нужно добавить дополнительные секунды для ожидания следующего соревнования*/
	//value += 125; //Теперь после окончания соревнования игрок старует следующее в среднем через 2 минуты
	//return value;
	return 90; //обновление 5.4
}

stock SetXmasTree(Float:x,Float:y,Float:z, Float: zAngle)
{//создание елки в новогоднем режиме
	CreateDynamicObject(19076, x, y, z-1.0, 0, 0, zAngle, -1, -1, -1, 300.0);//елка, подарки ниже
	CreateDynamicObject(19054, x, y+1.0, z-0.4, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox1
	CreateDynamicObject(19058, x+1.0, y, z-0.4, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox5
	CreateDynamicObject(19056, x, y-1.0, z-0.4, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox3
	CreateDynamicObject(19057, x-1.0, y, z-0.4, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox4
	CreateDynamicObject(19058, x-1.5, y+1.5, z-1.0, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox5
	CreateDynamicObject(19055, x+1.5, y-1.5, z-1.0, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox2
	CreateDynamicObject(19057, x+1.5, y+1.5, z-1.0, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox4
	CreateDynamicObject(19054, x-1.5, y-1.5, z-1.0, 0, 0, zAngle, -1, -1, -1, 300.0);//XmasBox1
	CreateDynamicObject(3526, x, y, z-1.0, 0, 0, zAngle, -1, -1, -1, 300.0);//Airportlight - объект для эффекта мигания елки
    CreateDynamicMapIcon(x, y, z, 37, 0, -1, -1, -1, 300 ); //Знак вопроса на карте
    Create3DTextLabel("{007FFF}Ёлка\n{FFFFFF}Нажмите [{FFFF00}Alt{FFFFFF}] чтобы получить подарок", COLOR_WHITE, x, y, z, 20, 0);
	return 1;
}//создание елки в новогоднем режиме

stock FindWeapon(playerid, weaponid)
{//функция для поиска оружия с определенным id. Возвращает true, если оружие с этим id есть у игрока
        new
            weapon,
            ammo;

        for (new i = 0; i < 13; i ++)
        {
            GetPlayerWeaponData(playerid, i, weapon, ammo);
            if (weapon == weaponid) return (true);
        }
        return (false);
}//функция для поиска оружия с определенным id. Возвращает true, если оружие с этим id есть у игрока

stock QuestUpdate(playerid, questid, score)
{//обновление задания
	for (new i = 0; i <= 2; i++)
	{//цикл
	    if (Quest[playerid][i] != questid || QuestTime[playerid][i] > 0) continue;//Квест недоступен по времени либо у игрока нет этого квеста
		QuestScore[playerid][i] += score;//Прибавляем нужное кол-во очков
		new bool: QuestCompleted = false;
		switch (questid)
		{//switch
		    case 1: if (QuestScore[playerid][i] >= 40) QuestCompleted = true;
		    case 2: if (QuestScore[playerid][i] >= 5) QuestCompleted = true;
		    case 3: if (QuestScore[playerid][i] >= 15) QuestCompleted = true;
		    case 4: if (QuestScore[playerid][i] >= 15) QuestCompleted = true;
		    case 5: if (QuestScore[playerid][i] >= 5) QuestCompleted = true;
		    case 6: if (QuestScore[playerid][i] >= 50) QuestCompleted = true;
		    case 7: if (QuestScore[playerid][i] >= 10) QuestCompleted = true;
		    case 8: if (QuestScore[playerid][i] >= 10) QuestCompleted = true;
		    case 9: if (QuestScore[playerid][i] >= 10) QuestCompleted = true;
		    case 10: if (QuestScore[playerid][i] >= 10) QuestCompleted = true;
		    case 11: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 12: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 13: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 14: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 15: if (QuestScore[playerid][i] >= 50000) QuestCompleted = true;
		    case 16: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 17: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 18: if (QuestScore[playerid][i] >= 5) QuestCompleted = true;
		    case 19: if (QuestScore[playerid][i] >= 10000) QuestCompleted = true;
		    case 20: if (QuestScore[playerid][i] >= 2) QuestCompleted = true;
		    case 21: if (QuestScore[playerid][i] >= 5) QuestCompleted = true;
		    case 22: if (QuestScore[playerid][i] >= 5) QuestCompleted = true;
		    case 23: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 24: if (QuestScore[playerid][i] >= 2) QuestCompleted = true;
		    case 25: if (QuestScore[playerid][i] >= 60) QuestCompleted = true;
		    case 26: if (QuestScore[playerid][i] >= 3000) QuestCompleted = true;
		    case 27: if (QuestScore[playerid][i] >= 15) QuestCompleted = true;
		    case 28: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		    case 29: if (QuestScore[playerid][i] >= 30) QuestCompleted = true;
      		case 30: if (QuestScore[playerid][i] >= 25000) QuestCompleted = true;
      		case 31: if (QuestScore[playerid][i] >= 4) QuestCompleted = true;
      		case 32: if (QuestScore[playerid][i] >= 3) QuestCompleted = true;
		}//switch
		if (QuestCompleted)
		{//Игрок выполнил задание
		    QuestTime[playerid][i] = 3600;//Следующий квест в этом слоте будет доступен через час
		    if (Player[playerid][CasinoBalance] < 100000000 || Player[playerid][Prestige] >= 9) //выбор нового квеста при доступном казино
		    	while(questid == Quest[playerid][0] || questid == Quest[playerid][1] || questid == Quest[playerid][2]) questid = random(MAX_QUESTS) + 1; //Выбираем новый квест
			else //выбор нового квеста при недоступном казино
			    while(questid == Quest[playerid][0] || questid == Quest[playerid][1] || questid == Quest[playerid][2] || questid == 24) questid = random(MAX_QUESTS) + 1; //Выбираем новый квест
		    QuestScore[playerid][i] = 0; Quest[playerid][i] = questid; //Назначаем новый квест
   		    SendClientMessage(playerid, COLOR_QUEST, "QUEST: Вы получили 350 XP, 50 000$ и медаль за успешное выполнение задания!");
		    Player[playerid][Medals]++; Player[playerid][CompletedQuests]++;
		    Player[playerid][Cash] += 50000; LGiveXP(playerid, 350);
		    MarafonUpdate(playerid, 3, 1);
		    PlayerPlaySound(playerid,1083,0.0,0.0,0.0);//Звук выигрыша
		}//Игрок выполнил задание

	}//цикл
	return 1;
}//обновление задания
/*
public SobeitCamCheck(playerid)
{
	new Float:x, Float:y, Float:z; GetPlayerCameraFrontVector(playerid, x, y, z);
	if(z < -0.8)
	{//обнаружен Sobeit (UnFreeze баг)
        new String[140];
		format(String,sizeof(String), "[АДМИНАМ]LAC: {AFAFAF}%s[%d] был автоматически кикнут. {FF0000}Причина: {AFAFAF}Обнаружен чит Sobeit",PlayerName[playerid], playerid);
        foreach(Player, cid) if (Player[cid][Admin] != 0 && Logged[cid] == 1) SendClientMessage(cid, COLOR_RED, String);
		format(String, 140, "%d.%d.%d в %d:%d:%d |   LAC: %s[%d] был автоматически кикнут. Причина: Обнаружен чит Sobeit", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid);
		WriteLog("GlobalLog", String);WriteLog("LACSobeit", String);
		SendClientMessage(playerid, COLOR_RED, "LAC: {AFAFAF}Обнаружен чит {FF0000}Sobeit{AFAFAF}! Удалите его и перезайдите в игру!");
		TogglePlayerControllable(playerid, 1); SetCameraBehindPlayer(playerid);
		CancelSelectTextDraw(playerid); return GKick(playerid);
	}//обнаружен Sobeit (UnFreeze баг)
	else
	{//Sobeit не обнаружен
	   	TogglePlayerControllable(playerid, 1); CancelSelectTextDraw(playerid);
		FirstSobeitCheck[playerid] = 3;//Проверка на собейт завершена
	   	SendClientMessage(playerid, COLOR_RED, "LAC: {AFAFAF}Проверка успешно завершена! Приятной игры!");
	   	//---------------
	   	if(Player[playerid][ReadObnovlenie] != LAST_UPD)
    	{
        	Player[playerid][ReadObnovlenie] = LAST_UPD;
        	ShowObovDialog(playerid);
    	}
		 else if(Player[playerid][Bonus] != 2)
		 	{
		 	ShowPlayerDialog(playerid, 999, 0, "{ffffff}ТВОЙ ПОДАРОК!", "Ты еще не забрал свой {ffff00}Новогодний Подарок{ffffff}!\n\nЧтобы забрать его, используй {ff0000}/gps - Новогодняя Елка", "БЕГУ", "");
		 	}
        	//акция

		//----------------
		TextDrawHideForPlayer(playerid, BlackScreen);//убираем черный экран
		return LSpawnPlayer(playerid);
	}//Sobeit не обнаружен
}
*/
public OnPlayerClickTextDraw(playerid, Text:clickedid)
{
    if((clickedid == Text:INVALID_TEXT_DRAW && GetPVarInt(playerid,"ChInt") != 0) || (clickedid == IntChangeTD[2] && GetPVarInt(playerid,"ChInt") != 0))
	{
	    SendClientMessage(playerid, COLOR_RED, "Выбор интерьера отменен.");
	    SetPVarInt(playerid, "ChInt", 0);
	    for(new i; i<6; i++) TextDrawHideForPlayer(playerid, IntChangeTD[i]);
	    CancelSelectTextDraw(playerid);
	    PlayerTextDrawDestroy(playerid, PIntChangeTD[playerid]);
	    SetPlayerInterior(playerid,0);
	    SetPlayerVirtualWorld(playerid, 0);
	    TogglePlayerControllable(playerid, 1);
	    SetCameraBehindPlayer(playerid);
	    new ib = LastBaseVisited[playerid];
		if (ib < 1 || ib == MAX_BASE) return 1;
	    SetPlayerPos(playerid, Base[ib][bPosEnterX], Base[ib][bPosEnterY], Base[ib][bPosEnterZ]);
	    SetPlayerFacingAngle(playerid, Base[ib][bPosEnterA] - 180.0);
	    return 1;
	}
	
	if(clickedid == IntChangeTD[1] && GetPVarInt(playerid,"ChInt") != 0)
	{
	    new cint = GetPVarInt(playerid,"ChInt")-1;
		if(cint == 0) cint = MAX_BASE_INT-1;
		else cint--;
		SetPVarInt(playerid, "ChInt", cint+1);
		
		SetPlayerCameraPos(playerid, BByuInfo[cint][ltX], BByuInfo[cint][ltY], BByuInfo[cint][ltZ]);
		SetPlayerCameraLookAt(playerid, BByuInfo[cint][ltoX], BByuInfo[cint][ltoY], BByuInfo[cint][ltoZ]);
		SetPlayerInterior(playerid,BIntInfo[cint][binter]);
		SetPlayerPos(playerid, BIntInfo[cint][inX],BIntInfo[cint][inY],BIntInfo[cint][inZ]);
		
		UpdateCostTD(playerid);
	    return 1;
	}
	
	if(clickedid == IntChangeTD[0] && GetPVarInt(playerid,"ChInt") != 0)
	{
	    new cint = GetPVarInt(playerid,"ChInt")-1;
		if(cint == MAX_BASE_INT-1) cint = 0;
		else cint++;
		SetPVarInt(playerid, "ChInt", cint+1);

		SetPlayerCameraPos(playerid, BByuInfo[cint][ltX], BByuInfo[cint][ltY], BByuInfo[cint][ltZ]);
		SetPlayerCameraLookAt(playerid, BByuInfo[cint][ltoX], BByuInfo[cint][ltoY], BByuInfo[cint][ltoZ]);
		SetPlayerInterior(playerid,BIntInfo[cint][binter]);
		SetPlayerPos(playerid, BIntInfo[cint][inX],BIntInfo[cint][inY],BIntInfo[cint][inZ]);
		
		UpdateCostTD(playerid);
	    return 1;
	}
	
	if(clickedid == IntChangeTD[3] && GetPVarInt(playerid,"ChInt") != 0)
 	{
 	    if (Player[playerid][MyClan] == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не в клане");
		if (Player[playerid][Leader] < 5) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы должны иметь как минимум 5 ранг в клане.");
		new ib = LastBaseVisited[playerid];
		if (ib < 1 || ib >= MAX_BASE) return 1;
		if (Base[ib][bClan] != Player[playerid][MyClan]) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Это не ваш штаб");
 	    new clanid = Player[playerid][MyClan], cint = GetPVarInt(playerid,"ChInt")-1,string[140];
 	    if(Base[ib][bInterior] == cint) return SendClientMessage(playerid, COLOR_RED, "ОШИБКА: У вас уже установлен этот интерьер.");
 	    if(Clan[clanid][InfPoints] < BByuInfo[cint][icost]) return SendClientMessage(playerid, COLOR_RED, "Недостаточно очков влияния для этого интерьера.");

        Clan[clanid][InfPoints] -= BByuInfo[cint][icost];
		SetPVarInt(playerid, "ChInt", 0);
	    for(new i; i<6; i++) TextDrawHideForPlayer(playerid, IntChangeTD[i]);
	    CancelSelectTextDraw(playerid);
	    PlayerTextDrawDestroy(playerid, PIntChangeTD[playerid]);
	    
		format(string,sizeof(string),"CLAN: Член банды %s[%d] изменил интерьер штаба за %d очков влияния.", PlayerName[playerid], playerid, BByuInfo[cint][icost]);
		SendClanMessage(clanid, string, COLOR_CLAN);
		Base[ib][bInterior] = cint;
	    SetPlayerVirtualWorld(playerid, 2000+ib);
	    TogglePlayerControllable(playerid, 1);
	    SetCameraBehindPlayer(playerid);
	    SaveBase(ib);
 	    return 1;
 	}
	
	return 1;
}


public DestroyCashPickup(pickupid)
{//уничтожение пикапа, который которого никто не успел подобрать
	DynamicPickup[pickupid][Type] = -1;//тип пикапа - деньги
	DynamicPickup[pickupid][ID] = -1;//сумма денег
	DynamicPickup[pickupid][DestroyTimerID] = -1;
	DestroyDynamicPickup(pickupid);
	return 1;
}//уничтожение пикапа, который которого никто не успел подобрать
//------
//stocks
//------
stock DialogToRegister(playerid)
{
	new string[600];
	strins(string,"{ffffff}\tДобро пожаловать на сервер {1e90ff}%s!\n",strlen(string));
    strins(string,"\t\n",strlen(string));
    strins(string,"{ffffff}Режим игры: {1e90ff}DeathMatch (with RPG)\n",strlen(string));
    strins(string,"{ffffff}Версия мода: {1e90ff} %s\n",strlen(string));
    strins(string,"\t\n",strlen(string));
    strins(string,"{ffffff}Ваш никнейм: {1e90ff}%s\n",strlen(string));
    strins(string,"{ffffff}Данный аккаунт {ff0000} НЕ зарегистрирован! {ffffff}Чтобы начать игру, создайте пароль!\n",strlen(string));
    strins(string,"\t\n",strlen(string));
    strins(string,"\t{1e90ff}Примечание:\n",strlen(string));
    strins(string,"\t{ffffff}- Длина пароля от 6 до 24 символов!\n",strlen(string));
    strins(string,"\t{ffffff}- пароль должен быть сложным!\n",strlen(string));
    strins(string,"\t\n",strlen(string));
    strins(string,"Администрация сервера желает вам приятной игры!",strlen(string));
	new Astring[600];
	format(Astring,sizeof(Astring),string, SERVER_NAME, MOD_VER, PlayerName[playerid]);
	ShowPlayerDialog(playerid, DIALOG_REGISTER, DIALOG_STYLE_INPUT, "{1e90ff}Регистрация:", Astring, "ОК", "Выход");
	return 1;
}

stock DialogToLogin(playerid)
{
	new string[500];
	format(string,sizeof(string),"{ffffff}\tДобро пожаловать на сервер {1e90ff}%s\n\
                    \t\n\
					{ffffff}Режим игры: {1e90ff}DeathMatch (with RPG)\n\
					{ffffff}Версия мода:{1e90ff} %s\n\
					\t\n\
					{ffffff}Ваш никнейм: {1e90ff}%s\n\
					{ffffff}Данный аккаунт {1e90ff}зарегистрирован! {ffffff}Чтобы начать игру, введите свой пароль!\n\
					\t\n\
					\t{1e90ff}Примечание:\n\
					\t{ffffff}- Пароль чувствителен к регистру!\n\
					\t\n\
					Администрация сервера желает вам приятной игры!\n\
					", SERVER_NAME, MOD_VER, PlayerName[playerid]);

	ShowPlayerDialog(playerid, DIALOG_LOGIN, DIALOG_STYLE_INPUT, "{1e90ff}Авторизация:", string, "Войти", "Выход");
	return 1;
}

stock ShowObovDialog(playerid)
{
	new String[1800] = ""; //МЕНЯТЬ!!!!!!!!!!!!!!
	strcat(String, "{FFFFFF}Название версии: {FFFF00} Exclusive 5.7{ffffff} (21.06.2018)\n\n");
	strcat(String, "- ЗАПУЩЕН ЛЕТНИЙ МАРАФОН! (до 10 сентября)\n");
	strcat(String, "- добавлен новый уникальный навык Махинатор (смена квестов) в марафон\n");
	strcat(String, "- уникальный навык Телепортер добавлен в /gold магазин\n");
	strcat(String, "- на дерби карта '4 пирамиды' заменена на 'На пирамидах'\n");
	strcat(String, "- исправлены баги в новом навыке\n");
	strcat(String, "- исправлен баг с пропаданием авто на 60 сек объявления о БТ\n");
	strcat(String, "- добавлена защита - ГМ 3 сек от убийства после спавна\n");
	strcat(String, "- исправлен баг с отсутствием КД при смене гонки (/change)\n");
	strcat(String, "- доработки Битвы до последнего\n");
	strcat(String, "- мелкие доработки и исправления\n");
	
	ShowPlayerDialog(playerid, DIALOG_UPDATE, 0, "{ffffff}Информация о последнем обновлении:", String, "ОК", "");
	return 1;
}
//----------
//functions
TimeConvert(time) {
    new minutes;
    new seconds;
    new string[128];
    if(time > 59){
        minutes = floatround(time/60);
        seconds = floatround(time - minutes*60);
        if(seconds>9)format(string,sizeof(string),"%d:%d",minutes,seconds);
        else format(string,sizeof(string),"%d:0%d",minutes,seconds);
    }
    else{
        seconds = floatround(time);
        if(seconds>9)format(string,sizeof(string),"0:%d",seconds);
        else format(string,sizeof(string),"0:0%d",seconds);
    }
    return string;
}


stock GiveRandomWeap(cid)
{
    new RandWeap;
	GiveWeapon(cid,24,70);//Всем обязательно дается Desert Eagle
	//Дальше идет выдача пистолет-пулемета либо дробововика
	RandWeap = random(6);
	switch(RandWeap)
	{
		case 0: GiveWeapon(cid,32,500); //Tec9
		case 1: GiveWeapon(cid,28,500); //Micro UZI
		case 2: GiveWeapon(cid,29,210); //MP5
		case 3: GiveWeapon(cid,25,60); //Shotgun
		case 4: GiveWeapon(cid,26,40); //Обрезы
		case 5: GiveWeapon(cid,27,42); //Combat Shotgun
	}
	//Дальше идет выдача автомата либо снайперской винтовки
	RandWeap = random(3);
	switch(RandWeap)
	{
		case 0: GiveWeapon(cid,30,210); //AK-47
		case 1: GiveWeapon(cid,31,200); //M4
		case 2: GiveWeapon(cid,34,8); //Снайперская винтовка
	}
}

/*stock ChatHere(playerid, text[], color)
{
foreach(new i: Player)
	{
		new Float:rdist;
		rdist = GetPlayerDistanceToPlayer(playerid,i);
		if (rdist > 20 || GetPlayerVirtualWorld(playerid) != GetPlayerVirtualWorld(i)) continue;
		new blc[150];
		format(blc, sizeof(blc), "{ff0000}БЧ{ffffff}! %s", text);
		SendClientMessage(i,color,blc);
	}
}*/

/*stock Float:GetPlayerDistanceToPlayer(playerid,nearplayerid)
{
	new Float:x,Float:y,Float:z;
	GetPlayerPos(nearplayerid,x,y,z);
	return GetPlayerDistanceFromPoint(playerid,x,y,z);
}*/

/*
stock MarafonUpdate(playerid, amount1, amount2, amount3, amount4)
{
    if (MrfDate < 1) return 1;
	new complete=0;
	if (Player[playerid][Type] == 4) return 1;
	switch(Player[playerid][Type])
	{
		case 0:
		{
		    if(amount1 == 0) return 1;
			Player[playerid][Mrf1]+=amount1;
			new String[140];
			format(String,sizeof(String),"MARAFON: Прогресс выполнения 1-го этапа: {ff0000}%d / 100.{afafaf} Подробнее в {ff0000}/marafon.", Player[playerid][Mrf1]);
			SendClientMessage(playerid,0xAFAFAFFF,String);

			if(Player[playerid][Mrf1] == 100)
			{
			    format(String,sizeof(String),"ВЕСЕННИЙ МАРАФОН: %s[%d] завершил 1-ый этап марафона и получил приз (+20 руб, +5000000$)!",PlayerName[playerid], playerid);
				SendClientMessageToAll(0x2ECCFAFF,String);
			    Player[playerid][GameGold] += 20.0;
			    Player[playerid][Bank] += 5000000;
				complete = 1;
			}
		}
		case 1:
		{
		    if(amount2 == 0) return 1;
			Player[playerid][Mrf1]+=amount2;
			new String[140];
			format(String,sizeof(String),"MARAFON: Прогресс выполнения 2-го этапа: {ff0000}%d / 45.{afafaf} Подробнее в {ff0000}/marafon.", Player[playerid][Mrf1]);
			SendClientMessage(playerid,0xAFAFAFFF,String);

			if(Player[playerid][Mrf1] == 45)
			{
			    format(String,sizeof(String),"ВЕСЕННИЙ МАРАФОН: %s[%d] завершил 2-ой этап марафона и получил приз (+50 руб, +15 level)!",PlayerName[playerid], playerid);
				SendClientMessageToAll(0x00FF00FF,String);
			    Player[playerid][GameGold] += 50.0;
			    if (Player[playerid][Level] > 85 && Player[playerid][Prestige] < 10)
				{
					Player[playerid][Level] = 100;
					Player[playerid][Medals] += 30;
					SendClientMessage(playerid,COLOR_GG,"Ваш приз заменен на 50 руб, 30 медалей и 100 уровнем, т.к. вы выше 84 уровня!");
				}
			    else Player[playerid][Level] += 15;
				complete = 1;
			}
		}
		case 2:
		{
		    if(amount3 == 0) return 1;
		    Player[playerid][Mrf1]+=amount3;
			new String[140];
			format(String,sizeof(String),"MARAFON: Прогресс выполнения 3-го этапа: {ff0000}%d / 4500000$.{afafaf} Подробнее в {ff0000}/marafon.", Player[playerid][Mrf1]);
			SendClientMessage(playerid,0xAFAFAFFF,String);

			if(Player[playerid][Mrf1] >= 4500000)
			{
			    format(String,sizeof(String),"ВЕСЕННИЙ МАРАФОН: %s[%d] завершил 3-ий этап марафона и получил приз (+1 ViP)!",PlayerName[playerid], playerid);
				SendClientMessageToAll(0xFFFF00FF,String);
			    Player[playerid][GPremium] += 1;
				complete = 1;
			}
		}
		case 3:
		{
		    if(amount4 == 0) return 1;
		    Player[playerid][Mrf1]+=amount4;
			new String[140];
			format(String,sizeof(String),"MARAFON: Прогресс выполнения 4-го этапа: {ff0000}%d / 150000.{afafaf} Подробнее в {ff0000}/marafon.", Player[playerid][Mrf1]);
			SendClientMessage(playerid,0xAFAFAFFF,String);

			if(Player[playerid][Mrf1] >= 150000)
			{
			    format(String,sizeof(String),"ВЕСЕННИЙ МАРАФОН: %s[%d] завершил 4-ый этап марафона и получил приз (+1 престиж)! Поздравляем!",PlayerName[playerid], playerid);
				SendClientMessageToAll(0xFF0000FF,String);
			    if(Player[playerid][Prestige] < 10) Player[playerid][Prestige] += 1;
			    else
				{
					Player[playerid][Level] += 50;
					SendClientMessageToAll(COLOR_GG,"Ваш приз заменен на +50 уровней, т.к. вы имеете 10 престиж!");
  				}
				complete = 1;
			}
		}
	}
	if(complete == 1)
		{
			Player[playerid][Type]+=1;
			Player[playerid][Mrf1]=0;

			new entry[256], i;
			format(entry,sizeof entry,"\r\n%s (%d)",PlayerName[playerid], Player[playerid][Type]);
			new File: hfile = fopen("Prizes3.ini", io_append);
			while (entry[i] != EOS) {fputchar(hfile,entry[i],false); i++;}
			fclose(hfile);
		}
	return 1;
}
*/
stock MarafonUpdate(playerid, etap, added)
{
/*
{
	{"Принять участие в соревнованиях", 2000, 	 "+20.000.000$ в банк"}, 	//0
	{"Заработать опыт", 				1100000, "+1 престиж"},				//1
	{"Выиграть в ивентах", 				250,	 "+35 руб. в /shop"},		//2
	{"Выполнить квесты (/quests)", 		230, 	 "+1 VIP"},			  		//3
	{"Найти кейсы", 					750, 	 "5 лотерейных билетов"},   //4
	{"Заработать деньги на ивентах", 	15000000,"+25 LVL, 10 Медалей"}, 	//5
 	{"Купить деньги для /shop",			500,	 "Мастер-оружейник"} 		//6
 	//завершить марафон - 200 золота //7
};
*/
    if (MrfDate < 1) return 1;
	if(PlayerMarafon[playerid][etap] == -1) return 1;
	
	PlayerMarafon[playerid][etap]+=added;
	
	if(PlayerMarafon[playerid][etap] >= EtapsInfo[etap][MAmont])
	{
	    new String[140];
        format(String,sizeof(String),"Марафон: {ffffff}%s [%d]{74DF00} завершил этап '%s'. Приз '{ffffff}%s{74DF00}'!",PlayerName[playerid],playerid,EtapsInfo[etap][Intent],EtapsInfo[etap][MPrize]);
		SendClientMessageToAll(MRF_COLOR,String);
	    PlayerMarafon[playerid][etap] = -1;
	    switch(etap)
	    {
	        case 0: Player[playerid][Bank] += 20000000;
			case 1:
			{
			    if(Player[playerid][Prestige] < 10) Player[playerid][Prestige] += 1;
			    else {SendClientMessage(playerid,0xAFAFAFFF,"Марафон: ваш приз заменен на +70 LVL т.к. у вас 10 или более престиж."); Player[playerid][Level] += 70;}
			}
			case 2: Player[playerid][GameGold] += 35.0;
			case 3:
			{
			    if(Player[playerid][GPremium] > 19) {SendClientMessage(playerid,0xAFAFAFFF,"Марафон: ваш приз заменен на +70р в /shop, т.к. у вас 20 или более VIP."); Player[playerid][GameGold] += 70.0;}
	            else
				{
					Player[playerid][GPremium]+=1;
					if (Player[playerid][GPremium] == 19) Player[playerid][Prestige] += 1;
				}
			}
			case 4: {Player[playerid][Lottery] += 5; SendClientMessage(playerid,0xAFAFAFFF,"Марафон: Активировать лотерейный билет - /lottery.");}
			case 5:
			{
				if(Player[playerid][Prestige] >= 10 || Player[playerid][Level] < 76) {Player[playerid][Level]+=25; Player[playerid][Exp]=0; Player[playerid][Medals] += 10;}
			    else {SendClientMessage(playerid,0xAFAFAFFF,"Марафон: Вы повышены до 100 lvl, +добавлены рубли за недостающие уровни (1р за 1)! См. /shop."); Player[playerid][GameGold]+=25.0-float(100-Player[playerid][Level]); Player[playerid][Level]=100; Player[playerid][Medals] += 10;}
			}
			case 6: {Player[playerid][SPN9] = 1; SendClientMessage(playerid,0xAFAFAFFF,"Марафон: Теперь вы можете менять квесты - /quests.");}
		}
		
		new ended = 1;
		for(new i=0; i<sizeof(EtapsInfo);i++) {if(PlayerMarafon[playerid][i] != -1) {ended = 0; continue;}}
		if(ended == 1)
		{
		    Player[playerid][Gold] += 200;
		    format(String,sizeof(String),"Марафон: {ffffff}%s [%d]{74DF00} завершил все этапы марафона и получил приз '{ffffff}200 золота{74DF00}'!",PlayerName[playerid],playerid);
			SendClientMessageToAll(MRF_COLOR,String);
			Player[playerid][MrfEnd] = 1;
			if(ServConf[2] != 1 && Player[playerid][Admin] < 1)
   			{
   			    Player[playerid][Admin] = 1;
   			    format(String,sizeof(String),"Марафон: Игрок {ffffff}%s [%d]{FFFF00} первым прошел марафон м получил статус модератора (исп. срок)!  Поздравляем!",PlayerName[playerid],playerid);
				SendClientMessageToAll(0xFFFF00FF,String);
				ServConf[2] = 1;
				SaveServerConfig();
   			}
		}
		SavePlayer(playerid);
		
		new entry[256], i;
		format(entry,sizeof entry,"\r\n%d.%d.%d в %d:%d:%d | %s (%d)", Day, Month, Year, hour, minute, second, PlayerName[playerid], etap);
		if(ended == 1) strcat(entry, " ЗАВЕРШИЛ");
		new File: hfile = fopen("Prizes10.ini", io_append);
		while (entry[i] != EOS) {fputchar(hfile,entry[i],false); i++;}
		fclose(hfile);
	}
	
	return 1;
}

stock ShowMarafonDialog(playerid)
{
    if (MrfDate < 1) return SendClientMessage(playerid,COLOR_YELLOW,"Марафон завершен! Информация недоступна.");
	new String[800],IntString[100];
	strcat(String, "Задание\tСтатус\tПриз\n");
	for(new i=0; i<sizeof(EtapsInfo);i++)
	{
	    if(PlayerMarafon[playerid][i] == -1) format(IntString,sizeof(IntString), "%s\t{afafaf}Завершен!\t{afafaf}%s\n", EtapsInfo[i][Intent],EtapsInfo[i][MPrize]);
	    else
		{
			//if (i == 4) format(IntString,sizeof(IntString), "%s\t[%d/%d]\t%s\n", EtapsInfo[i][Intent], PlayerMarafon[playerid][i]/3600, EtapsInfo[i][MAmont]/3600,EtapsInfo[i][MPrize]);
			format(IntString,sizeof(IntString), "%s\t%d / {2E9AFE}%d\t{afafaf}%s\n", EtapsInfo[i][Intent], PlayerMarafon[playerid][i], EtapsInfo[i][MAmont],EtapsInfo[i][MPrize]);
		}
		strcat(String, IntString);
	}
	
	//на завершение марафона
	if(Player[playerid][MrfEnd] == 0) strcat(String, "Полностью завершить марафон\t0 / {2E9AFE}1\t{afafaf}200 золота (/gold)\n");
	else if(Player[playerid][MrfEnd] == 1) strcat(String, "Полностью завершить марафон\t{afafaf}Завершен!\t{afafaf}200 золота (/gold)\n");
	
	if(ServConf[2] != 1 && Player[playerid][Admin] < 1)	{strcat(String, "{2E9AFE}ПЕРВЫМ ЗАВЕРШИТЬ МАРАФОН\t0 / {2E9AFE}1\t{afafaf}Статус модератора (исп. срок)\n");}
	else strcat(String, "\t\t\n");
	
	format(IntString,sizeof(IntString), "{74DF00}До конца марафона: {ff0000}%d{74DF00} ДНЕЙ!\t\t\n", MrfDate);
	strcat(String, IntString);

	strcat(String, "{74DF00}Описание этапов марафона");
    ShowPlayerDialog(playerid, DIALOG_WINMAR, 5, "{74DF00}Летний марафон:", String, "ОК", "Выход");
	return 1;
}
/*
stock ShowMarafonDialog(playerid)
{
    if (MrfDate < 1) return SendClientMessage(playerid,COLOR_YELLOW,"Марафон завершен! Информация не доступна.");
    new String[512] = "";
    strcat(String, "Задание\tСтатус\tПриз\n");
	switch(Player[playerid][Type])
	{
		case 0:
		{
    		strcat(String, "{ffff00}Принять участие в 100 ивентах\t{ff0000}%d / 100\t{ffff00}[20руб + 5kk $]\n");
    		strcat(String, "{afafaf}Выполнить 45 квестов в /quests\t0/45\t{afafaf}[50руб + 15 LVL]\n");
    		strcat(String, "{afafaf}Заработать 4.5млн $ на ивентах\t0/4500000\t{afafaf}[+1 ViP]\n");
    		strcat(String, "{afafaf}Заработать 150.000 опыта\t0/150000\t{afafaf}[+1 престиж]\n");
		}

    	case 1:
		{
    		strcat(String, "{ffffff}Принять участие в 100 ивентах\t[завершено]\t[20руб + 5kk $]\n");
    		strcat(String, "{ffff00}Выполнить 45 квестов в /quests\t{ff0000}%d/45\t{ffff00}[50руб + 15 LVL]\n");
    		strcat(String, "{afafaf}Заработать 4.5млн $ на ивентах\t0/4500000\t{afafaf}[+1 ViP]\n");
    		strcat(String, "{afafaf}Заработать 150.000 опыта\t0/150000\t{afafaf}[+1 престиж]\n");
		}
		case 2:
		{
    		strcat(String, "{ffffff}Принять участие в 100 ивентах\t[завершено]\t[20руб + 5kk $]\n");
    		strcat(String, "{ffffff}Выполнить 45 квестов в /quests\t[завершено]\t[50руб + 15 LVL]\n");
    		strcat(String, "{ffff00}Заработать 4.5млн $ на ивентах\t{ff0000}%d/4500000\t{ffff00}[+1 ViP]\n");
    		strcat(String, "{afafaf}Заработать 150.000 опыта\t0/150000\t{afafaf}[+1 престиж]\n");
		}
		case 3:
		{
    		strcat(String, "{ffffff}Принять участие в 100 ивентах\t[завершено]\t[20руб + 5kk $]\n");
    		strcat(String, "Выполнить 45 квестов в /quests\t[завершено]\t[50руб + 15 LVL]\n");
    		strcat(String, "Заработать 4.5млн $ на ивентах\t[завершено]\t[+1 ViP]\n");
    		strcat(String, "{ffff00}Заработать 150.000 опыта\t{ff0000}%d/150000\t{ffff00}[+1 престиж]\n");
		}
		default:
		{
    		strcat(String, "{ffffff}Принять участие в 100 ивентах\t[завершено]\t[20руб + 5kk $]\n");
    		strcat(String, "Выполнить 45 квестов в /quests\t[завершено]\t[50руб + 15 LVL]\n");
    		strcat(String, "Заработать 4.5 млн $ на ивентах\t[завершено]\t[+1 ViP]\n");
    		strcat(String, "Заработать 150.000 опыта\t[завершено]\t[+1 престиж]\n");
    		strcat(String, "{ffff00}Марафон завершен!\n");
		}
	}
	strcat(String, "\t\t\n");
	strcat(String, "{58FA58}ДО КОНЦА МАРАФОНА: {ff0000}%d{58FA58} ДНЕЙ!\n");

	if(Player[playerid][Type] == 4) format(String,sizeof(String), String, MrfDate);
	else format(String,sizeof(String), String, Player[playerid][Mrf1], MrfDate);

    ShowPlayerDialog(playerid, DIALOG_WINMAR, 5, "ВЕСЕННИЙ МАРАФОН", String, "ОК", "Выход");
	return 1;
}
*/

stock ShowBankDialog(playerid)
{
	new houseid = Player[playerid][Home];
	if (houseid <= 0) MaxBank[playerid] = 50000000;//макс 50 млн пока у игрока нет дома
	else if (Property[houseid][pPrice] >= 80000000) MaxBank[playerid] = 999999999; //дом за 80кк - 999кк
	else if (Property[houseid][pPrice] >= 60000000) MaxBank[playerid] = 400000000; //дом за 60кк - 400кк
	else if (Property[houseid][pPrice] >= 40000000) MaxBank[playerid] = 250000000; //дом за 40кк - 250кк
	else if (Property[houseid][pPrice] >= 20000000) MaxBank[playerid] = 150000000; //дом за 20кк - 150кк
	else MaxBank[playerid] = 100000000; //дом за 10кк - 100кк
    //Высчитывание макс. денег
	new String[120];
	format(String,sizeof(String),"{AFAFAF}Банк. На счете: {00FF00}%d{AFAFAF}. Максимум: {FFFFFF}%d{AFAFAF}.",Player[playerid][Bank],MaxBank[playerid]);
	if (Player[playerid][Member] == 0) ShowPlayerDialog(playerid, DIALOG_BANK, 2, String, "Положить деньги на счет\nСнять деньги со счета\n{AFAFAF}Общак банды {ff0000}(Недоступно)\n{AFAFAF}(?) Как увеличить максимум денег в банке", "ОК", "");
	else ShowPlayerDialog(playerid, DIALOG_BANK, 2, String, "Положить деньги на счет\nСнять деньги со счета\nОбщак банды\n{AFAFAF}(?) Как увеличить максимум денег в банке", "ОК", "");
	return 1;
}

stock ShowPlayerTSDialog(playerid)
{
    new String[512] = "";
    strcat(String, "Опция\tЦена\tМин. требования\n");
    strcat(String, "{ffffff}Нитро\t\t\n");
    strcat(String, "{ffffff}Неон\t{01DF01}[50.000$]\t{ffff00}[4 престиж]\n");
    strcat(String, "{ffffff}Огн. колеса\t{01DF01}[500.000$]\t{ffff00}[3 Престиж]\n");
    strcat(String, "{ffffff}Сирена\t{01DF01}[100.000$]\t{ffff00}[20 LVL]\n");
    strcat(String, "{ffffff}Мигалка\t{01DF01}[200.000$]\t{ffff00}[50 LVL]\n");
    strcat(String, "{ffffff}Колеса\t{01DF01}[20.000$]\t{ffff00}[10 LVL]\n");
    strcat(String, "{ff0000}Удалить компонент\t\t\n");
	if(Player[playerid][Type] > 0) strcat(String, "{ffff00}ВИНИЛЫ\n");
    ShowPlayerDialog(playerid, DIALOG_TURBOSPEED, 5, "Мастерская 'TurboSpeed'", String, "ОК", "Отмена");
	return 1;
}

stock ShowPlayerAltMenu(playerid)
{
    if (Player[playerid][Level] > 0)
    {
    	new String[512] = "";
    	new vehd[3][30];
		if(Player[playerid][CarSlot1] == 0){vehd[0] = "НЕТ";}else{new mid = Player[playerid][CarSlot1] - 400;format(vehd[0],30,"%s", PlayerVehicleName[mid]);}
		if(Player[playerid][CarSlot2] == 0){vehd[1] = "НЕТ";}else{new mid = Player[playerid][CarSlot2] - 400;format(vehd[1],30,"%s", PlayerVehicleName[mid]);}
		if(Player[playerid][CarSlot3] == 0){vehd[2] = "НЕТ";}else{new mid = Player[playerid][CarSlot3] - 400;format(vehd[2],30,"%s", PlayerVehicleName[mid]);}
		if(Player[playerid][CarSlot3] == 539){format(vehd[2],30,"UberVortex");}

    	strcat(String, "Опция\tКоманда\n");
    	strcat(String, "{FFFF79}Сесть в авто [1 класс]\t{ffff00}[%s]\n");
    	strcat(String, "{FFFF79}Сесть в авто [2 класс]\t{ffff00}[%s]\n");
    	strcat(String, "{FFFF79}Сесть в авто [3 класс]\t{ffff00}[%s]\n");
    	strcat(String, "Надеть джетпак\t{00BFFF}[/jetpack]\n");
    	strcat(String, "Список соревнований\t{00BFFF}[/events]\n");
    	strcat(String, "Купить оружие\t{00BFFF}[/bg]\n");
    	strcat(String, "Навигация\t{00BFFF}[/gps]\n");
    	strcat(String, "Мои настройки\t{00BFFF}[/config]\n");
    	strcat(String, "Моя статистика\t{00BFFF}[/stats]\n");
    	strcat(String, "{FFFF79}Мои задания\t{00BFFF}[/quests]\n");
    	strcat(String, "{ffff00}ОСТАЛЬНОЕ (КПК)\t\n");

    	format(String,sizeof(String), String, vehd[0], vehd[1], vehd[2]);
    	ShowPlayerDialog(playerid, 2, 5, "Меню быстрого доступа", String, "ОК", "Выход");
	}
	else ShowPlayerDialog(playerid, 2, 2, "Меню быстрого доступа", "Сесть в машину [Класс 1]", "ОК", "");
	return 1;
}

stock ShowPlayerKPK(playerid)
{
	new String[512];
	strcat(String, "Опция\tКоманда\n");
	strcat(String, "Личное оружие\t{00BFFF}[/mygun]\n");
	strcat(String, "Клан (управление)\t{00BFFF}[/clan]\n");
	strcat(String, "{FFCC00}Донат/Игровой магазин\t{00BFFF}[/shop]\n");
	strcat(String, "{FFCC00}Мои навыки\t\n");
	strcat(String, "{FFCC00}Изменить мой транспорт\t\n");
	strcat(String, "Стиль драки\t{00BFFF}[/style]\n");
	strcat(String, "Слушать радио\t{00BFFF}[/radio]\n");
	strcat(String, "Помощь по серверу\t{00BFFF}[/help]\n");
	strcat(String, "Настроить спавн\t{00BFFF}[/myspawn]\n");
	strcat(String, "Невидимость\t{00BFFF}[/invisible]\n");
	strcat(String, "Список территорий\t{00BFFF}[/zones]\n");
	strcat(String, "Прыгнуть с парашютом\t{00BFFF}[/skydive]\n");
    strcat(String, "Настройки PVP\t\n");
    ShowPlayerDialog(playerid, 8, 5, "{FFCC00}Мой КПК", String, "ОК", "В меню");
	return 1;
}

stock PlayerToKvadrat(playerid,Float:min_x,Float:min_y,Float:max_x,Float:max_y)
{
    new Float:xxp,Float:yyp,Float:zzp;
    GetPlayerPos(playerid, xxp, yyp, zzp);
    if((xxp <= max_x && xxp >= min_x) && (yyp <= max_y && yyp >= min_y)) return 1;
    return 0;
}
stock ShowClanControlMenu(playerid)
{
    if (Player[playerid][Leader] < 3)
	{
		SendClientMessage(playerid, COLOR_RED, "ОШИБКА: Вы должны быть как минимум 3 ранга, чтобы использовать это меню!");
		return 1;
	}

	new String[512];
	strcat(String, "Опция\tДоступ\n");
    if (Player[playerid][Leader] >= 100)
    {
		strcat(String, "Объявить об окончании войны\t{ffff00}[3 ранг]\n");
        strcat(String, "{ffffff}Изменить текст приветствия клана\t{ffff00}[3 ранг]\n");//*
        strcat(String, "{ffffff}Удалить игрока из клана\t{ffff00}[4 ранг]\n");//*
        strcat(String, "{ffffff}Изменить тег клана\t{ffff00}[5 ранг]\n");//*
        strcat(String, "{ffffff}Изменить цвет клана\t{ffff00}[5 ранг]\n");//*
        strcat(String, "{ffffff}Изменить название клана\t{ff0000}[Лидер]\n");//*
        strcat(String, "{F8E0E0}Управление рангами клана\t{ff0000}[Лидер]\n");//*
        strcat(String, "{F8E0E0}Распустить клан\t{ff0000}[Лидер]\n");
        strcat(String, "{F8E0E0}Изменить лидера\t{ff0000}[Лидер]");//*
		ShowPlayerDialog(playerid, DIALOG_CLANMANAGER, 5, "Управление кланом:", String, "Ок", "Отмена");
		return 1;
	}
	else
	{
		new LeaderLVL = Player[playerid][Leader];
	    if(LeaderLVL >= 3)
		{
			strcat(String, "Объявить об окончании войны\t{ffff00}[3 ранг]\n");
        	strcat(String, "{ffffff}Изменить текст приветствия клана\t{ffff00}[3 ранг]\n");
		}
		if(LeaderLVL >= 4)
		{
			strcat(String, "{ffffff}Удалить игрока из клана\t{ffff00}[4 ранг]\n");
		}
		if(LeaderLVL >= 5)
		{
		    strcat(String, "{ffffff}Изменить тег клана\t{ffff00}[5 ранг]\n");
        	strcat(String, "{ffffff}Изменить цвет клана\t{ffff00}[5 ранг]\n");
		}
		ShowPlayerDialog(playerid, DIALOG_CLANMANAGER, 5, "Управление кланом:", String, "Ок", "Отмена");
		return 1;
	}
	//return 1;
}

public OnPlayerEnterDynamicArea(playerid, areaid)
{
	if(Logged[playerid] == 0) return 1;
	if(areaid > MAX_AREAS) return 1;
	
	switch(AreaType[areaid])
	{
	    case 1:
	    {
	        if(areaid == ZoneGPS[playerid])
			{
		    	ZoneGPS[playerid] = -1;
				DisablePlayerCheckpoint(playerid);
				GPSUsed[playerid] = 0;
				PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
	    		SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Вы достигли места назначения.");
			}

			OnZone[playerid] = areaid;
			TextDrawShowForPlayer(playerid, ZoneStateTD[areaid]);
			return 1;
	    }
	    case 2:
	    {
	        if(areaid == BankCassaCP) {SetPVarInt(playerid, "BCassa", 1); return 1;}
			if(areaid == BankBiletCP) {SetPVarInt(playerid, "BBilet", 1); return 1;}
	    }
	    case 3:
	    {
	        SetPVarInt(playerid, "PLoot", areaid);
			return 1;
	    }
	    default:
	    {
	        if (areaid == BankOut) //выход из банка
    		{
				if(GetPlayerVirtualWorld(playerid) != 648 || GetPlayerInterior(playerid) != 61) return 1;
				new bnk = GetPVarInt(playerid, "LastBank");
				SetPlayerInterior(playerid, 0);
				SetPlayerVirtualWorld(playerid,0);
				SetPlayerPos(playerid, EXBANK[bnk][0],EXBANK[bnk][1],EXBANK[bnk][2]);
				SetPlayerFacingAngle(playerid,EXBANK[bnk][3]);
				DeletePVar(playerid, "LastBank");
				return 1;
			}
			/*if (areaid == PDMArea)
			{
			    SetPVarInt(playerid, "PDMop", 1);
			    if(PDMTeam[playerid] == 1) BlueOnPoint++;
			    else if(PDMTeam[playerid] == 2) RedOnPoint++;
			    return 1;
			}*/
		}
	}
	
	//terras
/*	if(AreaType[areaid] == 1)
	{
	    if(areaid == ZoneGPS[playerid])
		{
		    ZoneGPS[playerid] = -1;
			DisablePlayerCheckpoint(playerid);
			GPSUsed[playerid] = 0;
			PlayerPlaySound(playerid,1083,0.0,0.0,0.0);
	    	SendClientMessage(playerid, COLOR_RED, "GPS:{FFFF00} Вы достигли места назначения.");
		}
		
		OnZone[playerid] = areaid;
		TextDrawShowForPlayer(playerid, ZoneStateTD[areaid]);
		return 1;
	}
	
	//banks
	if(AreaType[areaid] == 2)
	{
		if(areaid == BankCassaCP) {SetPVarInt(playerid, "BCassa", 1); return 1;}
		if(areaid == BankBiletCP) {SetPVarInt(playerid, "BBilet", 1); return 1;}
	}
	
	if(AreaType[areaid] == 3)
	{
		SetPVarInt(playerid, "PLoot", areaid);
		return 1;
		//TextDrawShowForPlayer(playerid, BTMainTD[3]);
	}
*/
	
	/*if(AreaType[areaid] == 4)
	{
		SetPVarInt(playerid, "PBLoot", areaid);
	}*/
	
/*    if (areaid == BankOut) //выход из банка
    {
		if(GetPlayerVirtualWorld(playerid) != 648 || GetPlayerInterior(playerid) != 61) return 1;
		new bnk = GetPVarInt(playerid, "LastBank");
		SetPlayerInterior(playerid, 0);
		SetPlayerVirtualWorld(playerid,0);
		SetPlayerPos(playerid, EXBANK[bnk][0],EXBANK[bnk][1],EXBANK[bnk][2]);
		SetPlayerFacingAngle(playerid,EXBANK[bnk][3]);
		DeletePVar(playerid, "LastBank");
		return 1;
	}
*/
	/*if(areaid == DRemStats[RepZone])
	{
		if(DRemStats[IsRActived] == 0) return 1;
        new Float:VHhealth, Float:RndHealth, str[16];
        
        DRemStats[IsRActived] = 0;
        DestroyDynamicArea(DRemStats[RepZone]);
        DestroyDynamicObject(DRemStats[RepObj]);
        DestroyDynamic3DTextLabel(DRemStats[rtext]);
        
        DRemStats[PCTime]=DerbyTimeToEnd-30;
        RndHealth = float(random(40)+30);
        GetVehicleHealth(GetPlayerVehicleID(playerid), VHhealth);
        VHhealth=VHhealth+RndHealth;
        if(VHhealth > 650.0) {SetVehicleHealth(GetPlayerVehicleID(playerid), 650.0); format(str, sizeof str, "~r~FULL!");}
        else {SetVehicleHealth(GetPlayerVehicleID(playerid), VHhealth); format(str, sizeof str, "+ ~r~%.0f",RndHealth);}
        GameTextForPlayer(playerid,str,1500,6);
        return 1;
	}*/
	//new String[140];
    //format(String,sizeof(String), "Вы в ганг-зоне ИД: %d Всего терр: %d", areaid, LastZone);
	//SendClientMessage(playerid,-1,String);
    return 1;
}

public OnPlayerLeaveDynamicArea(playerid, areaid)
{
    if(Logged[playerid] == 0) return 1;
    if(areaid > MAX_AREAS) return 1;
    
    //терры
    if(AreaType[areaid] == 1)
	{
    	OnZone[playerid] = -1;
		TextDrawHideForPlayer(playerid, ZoneStateTD[areaid]);
		return 1;
	}
	
	//банк
	if(AreaType[areaid] == 2)
 	{
		if(areaid == BankCassaCP) {DeletePVar(playerid, "BCassa"); return 1;}
		if(areaid == BankBiletCP) {DeletePVar(playerid, "BBilet"); return 1;}
	}
	
	if(AreaType[areaid] == 3)
	{
		SetPVarInt(playerid, "PLoot", -1);
		//TextDrawShowForPlayer(playerid, BTMainTD[3]);
	}
	
	/*if (areaid == PDMArea)
	{
		SetPVarInt(playerid, "PDMop", 0);
		if(PDMTeam[playerid] == 1 && BlueOnPoint > 0) BlueOnPoint--;
		else if(PDMTeam[playerid] == 2 && RedOnPoint > 0) RedOnPoint--;
		return 1;
	}*/
	
	/*if(AreaType[areaid] == 4)
	{
		SetPVarInt(playerid, "PBLoot", -1);
	}*/
    return 1;
}

/*gnomeSort(_array[], size = sizeof _array){
    for( new j = 1, swap; j != size;  ){
        if(_array[ j - 1 ] >= _array[ j ]) ++ j;//max to min
        else{
            swap = _array[ j ];
            _array[ j ] = _array[ j - 1 ];
            _array[ j - 1 ] = swap ;
            -- j;

            if( j == 0)
                j = 1;
        }
    }
}*/



/*stock GetHighestScores(array[][rankingEnum], left, right)
{
    new
        tempLeft = left,
        tempRight = right,
        pivot = array[(left + right) / 2][r_Score],
        tempVar
    ;
    while(tempLeft <= tempRight)
    {
        while(array[tempLeft][r_Score] > pivot) tempLeft++;
        while(array[tempRight][r_Score] < pivot) tempRight--;

        if(tempLeft <= tempRight)
        {
            tempVar = array[tempLeft][r_Score], array[tempLeft][r_Score] = array[tempRight][r_Score], array[tempRight][r_Score] = tempVar;
            tempVar = array[tempLeft][r_ID], array[tempLeft][r_ID] = array[tempRight][r_ID], array[tempRight][r_ID] = tempVar;
            tempLeft++, tempRight--;
        }
    }
    if(left < tempRight) GetHighestScores(array, left, tempRight);
    if(tempLeft < right) GetHighestScores(array, tempLeft, right);
}

stock TopClanShow(playerid)
{
	new	ClanScores[MAX_CLAN][rankingEnum];
	new indexx, MCid=MaxClanID+1;
 	for (new i; i<MAX_CLAN; i++) ClanScores[i][r_ID]=-1;
	for(new i; i<MCid; i++)
	{
		if(Clan[i][cLevel] == 0) continue;
		ClanScores[indexx][r_Score] = Clan[i][cLevel];
		ClanScores[indexx++][r_ID] = i;
	}
	GetHighestScores(ClanScores, 0, indexx);
    new string[(53+24+2+3+11)*10];
    for(new i; i < 10; i++)
    {
        if(ClanScores[i][r_ID] == -1) format(string, sizeof(string), "%s{c0c0c0}%d место: {FFFFFF}не обнаружено\n\n", string, i+1);
        else
        {
            if(i==0 || i==1 || i==2)
            {
            	format(string, sizeof(string), "%s{ffff00}%d место: {FFFFFF}%s [ID: %d]. Уровень: %d\n\n", string, i+1, Clan[ClanScores[i][r_ID]][cName], ClanScores[i][r_ID],Clan[ClanScores[i][r_ID]][cLevel]);
			}
			else format(string, sizeof(string), "%s{c0c0c0}%d место: {FFFFFF}%s [ID: %d]. Уровень: %d\n\n", string, i+1, Clan[ClanScores[i][r_ID]][cName], ClanScores[i][r_ID],Clan[ClanScores[i][r_ID]][cLevel]);
		}
    }
    return ShowPlayerDialog(playerid, 999, DIALOG_STYLE_MSGBOX, "{ffff00}Топ 10 кланов сервера:", string, "OK", "");
}*/

stock ClanTagInputShow(playerid)
{
	new String[256];
	format(String, sizeof String, "{ffff00}Введите новый клановый тег!\n\n{ffffff}Текущий тег: {FFBF00}%s\n\n{ff0000}ВНИМАНИЕ! {ffffff}Длина тега от 2 до 5 символов!\nРазрешены: латинские буквы, знаки '( )', '[ ]', '.'\nНапример: .SRT. , [Pro], (W)", Clan[Player[playerid][MyClan]][cTag]);
	ShowPlayerDialog(playerid, DIALOG_CLANTAGCHANGE, 1, "{ffff00}Введите будущий тег:", String, "Готово", "Назад");
	return 1;
}

stock ShowShopDialog(playerid)
{
	new StringX[1024], String[120];
	format(String,sizeof(String),"{FFFFFF}Магазин [У вас {FACC2E}%0.2f{FFFFFF} рублей]",Player[playerid][GameGold]);
	strcat(StringX, "ОПЦИЯ\tСТОИМОСТЬ\n");
	strcat(StringX, "{ff0000}ПРОВЕРИТЬ МОИ ПЛАТЕЖИ\t\n");
	strcat(StringX, "{00FF00}Как получить рубли? Какие сейчас акции?{FFFFFF}\t\n");
	//VIP
	if (Player[playerid][GPremium] < 20) {strcat(StringX, " {ffffff}Повысить уровень ViP на 1 (/vip)\t{FACC2E}150\n");} else {strcat(StringX, " {afafaf}Повысить уровень ViP на 1 (/vip)\t{afafaf}150\n");}
	//LevelUp
	if (Player[playerid][Level] < 30) strcat(StringX, " {ffffff}Повыcить уровень на 1\t{FACC2E}10\n");
	else if (Player[playerid][Level] < 60) strcat(StringX, " {ffffff}Повыcить уровень на 1\t{FACC2E}15\n");
	else if (Player[playerid][Level] < 100 || Player[playerid][Prestige] >= 10) strcat(StringX, " {ffffff}Повыcить уровень на 1\t{FACC2E}20\n");
	else strcat(StringX, " {afafaf}Повыcить уровень на 1\t{afafaf}20\n");
	//Деньги
 	strcat(StringX, " {ffffff}Получить 1 000 000$\t{FACC2E}15\n");
	//Карма
	if (Player[playerid][Karma] < 1000){strcat(StringX, " {ffffff}Получить +50 к карме (/karma)\t{FACC2E}10\n");} else {strcat(StringX, " {afafaf}Получить +50 к карме (/karma)\t{afafaf}10\n");}
	//Смена ника
 	strcat(StringX, " {ffffff}Изменить игровой ник\t{FACC2E}100\n");
	//Разбан
	if (Player[playerid][Level] < 30 && Player[playerid][Prestige] == 0){if (Player[playerid][Banned] > 0){strcat(StringX, " {ffffff}Разблокировать аккаунт (разбан)\t{FACC2E}50\n");}else{strcat(StringX, " {afafaf}Разблокировать аккаунт (разбан)\t{afafaf}50\n");}}
	else if (Player[playerid][Level] < 60 && Player[playerid][Prestige] == 0){if (Player[playerid][Banned] > 0){strcat(StringX, " {ffffff}Разблокировать аккаунт (разбан)\t{FACC2E}100\n");}else{strcat(StringX, " {afafaf}Разблокировать аккаунт (разбан)\t{afafaf}100\n");}}
	else{if (Player[playerid][Banned] > 0){strcat(StringX, " {ffffff}Разблокировать аккаунт (разбан)\t{FACC2E}250\n");}else{strcat(StringX, " {afafaf}Разблокировать аккаунт (разбан)\t{afafaf}250\n");}}
	//несливайка
	if (Player[playerid][SlivBlock] == -1) {strcat(StringX, " {ffffff}Отключить потерю денег (7 дней)\t{FACC2E}35\n");} else {strcat(StringX, " {afafaf}Отключить потерю денег (7 дней)\t{afafaf}35\n");}
    if(ServConf[5] > 0)
	{
	    format(String,sizeof(String),"{ffff00}Лотерейный билет (ост. %d шт)\t{FACC2E}25\n",ServConf[5]);
		strcat(StringX, String);
    	strcat(StringX, "{FACC2E}Что можно выиграть в лотерею?\t\n");
	}
	format(String,sizeof(String),"{FFFFFF}Магазин [У вас {FACC2E}%0.2f{FFFFFF} рублей]",Player[playerid][GameGold]);
	ShowPlayerDialog(playerid, DIALOG_GGSHOP, 5, String, StringX, "ВЫБОР", "Закрыть");
	return 1;
}

publics Float:GetDistanceBetweenPlayers(p1,p2)
{
	new Float:x1,Float:y1,Float:z1,Float:x2,Float:y2,Float:z2;
	if(!IsPlayerConnected(p1) || !IsPlayerConnected(p2))
	{
		return -1.00;
	}
	GetPlayerPos(p1,x1,y1,z1);
	GetPlayerPos(p2,x2,y2,z2);
	return floatsqroot(floatpower(floatabs(floatsub(x2,x1)),2)+floatpower(floatabs(floatsub(y2,y1)),2)+floatpower(floatabs(floatsub(z2,z1)),2));
}

stock SetPosInFrontOfPlayer(playerid,giveplayerid,Float:distance)
{
	new Float:x,Float:y,Float:z,Float:a;
	GetPlayerPos(playerid, x, y,z);GetPlayerFacingAngle(playerid, a);
	x += (distance * floatsin(-a, degrees));
	y += (distance * floatcos(-a, degrees));
	SetPlayerPos(giveplayerid,x,y,z);
	SetPlayerFacingAngle(giveplayerid,a);
}

public FindPlayerInTable(playerid)
{
    new rows, fields, WelcomeString[120];
    cache_get_data(rows, fields);
	format(WelcomeString, sizeof WelcomeString, "Вас приветствует сервер {2E9AFE}%s{A9C4E4}!", SERVER_NAME);
	SendClientMessage(playerid,0xA9C4E4FF,WelcomeString);
	SendClientMessage(playerid,0xA9C4E4FF,"Меню сервера вызывается на клавишу {2E9AFE}Alt{A9C4E4}.");
    if(!rows)
    {
        LoginKickTime[playerid] = 180;
        DialogToRegister(playerid); //регистрация
    }
    else
    {
        Registered[playerid] = 1;
        LoginKickTime[playerid] = 120;
        cache_get_field_content(0, "Password", PlayerPass[playerid], connects, 31);
        DialogToLogin(playerid); 	//логин
    }
	TogglePlayerSpectating(playerid, 1);
	InterpolateCameraPos(playerid, -1785.9265, 1046.3872, 126.1708, -2121.3765, 819.0849, 126.1708, 30000);
	InterpolateCameraLookAt(playerid,-1785.9275, 1045.3860, 126.1908, -2120.4033, 818.8533, 126.1408, 30000);
    return 1;
}
public UploadPlayerAccountNumber(playerid) Player[playerid][SID] = cache_insert_id(connects);

public LoadPlayerAccount(playerid)
{
    Player[playerid][SID] = cache_get_field_content_int(0, "SID", connects);
    
    Player[playerid][Model] = cache_get_field_content_int(0, "Model", connects);
	Player[playerid][Admin] = cache_get_field_content_int(0, "Admin", connects);
	Player[playerid][Level] = cache_get_field_content_int(0, "Level", connects);
	Player[playerid][Exp] = cache_get_field_content_int(0, "Exp", connects);
	Player[playerid][Spawn] = cache_get_field_content_int(0, "Spawn", connects);
	Player[playerid][SpawnStyle] = cache_get_field_content_int(0, "SpawnStyle", connects);
	Player[playerid][Invisible] = cache_get_field_content_int(0, "Invisible", connects);
	Player[playerid][Time] = cache_get_field_content_int(0, "Time", connects);
	Player[playerid][Cash] = cache_get_field_content_int(0, "Cash", connects);
	Player[playerid][Bank] = cache_get_field_content_int(0, "Bank", connects);
	Player[playerid][Banned] = cache_get_field_content_int(0, "Banned", connects);
	cache_get_field_content(0, "BannedBy", BannedBy[playerid], connects, 25);
	cache_get_field_content(0, "BanReason", BanReason[playerid], connects, 41);
	Player[playerid][Muted] = cache_get_field_content_int(0, "Muted", connects);
	cache_get_field_content(0, "MutedBy", MutedBy[playerid], connects, 25);
	Player[playerid][Slot1] = cache_get_field_content_int(0, "Slot1", connects);
	Player[playerid][Slot2] = cache_get_field_content_int(0, "Slot2", connects);
	Player[playerid][Slot3] = cache_get_field_content_int(0, "Slot3", connects);
	Player[playerid][Slot4] = cache_get_field_content_int(0, "Slot4", connects);
	Player[playerid][Slot5] = cache_get_field_content_int(0, "Slot5", connects);
	Player[playerid][Slot6] = cache_get_field_content_int(0, "Slot6", connects);
	Player[playerid][Slot7] = cache_get_field_content_int(0, "Slot7", connects);
	Player[playerid][Slot8] = cache_get_field_content_int(0, "Slot8", connects);
	Player[playerid][Slot9] = cache_get_field_content_int(0, "Slot9", connects);
	Player[playerid][Slot10] = cache_get_field_content_int(0, "Slot10", connects);
	Player[playerid][MyClan] = cache_get_field_content_int(0, "MyClan", connects);
	Player[playerid][Member] = cache_get_field_content_int(0, "Member", connects);
	Player[playerid][Leader] = cache_get_field_content_int(0, "Leader", connects);
	Player[playerid][Home] = cache_get_field_content_int(0, "Home", connects);
	Player[playerid][MrfEnd] = cache_get_field_content_int(0, "Account", connects);
	Player[playerid][CarSlot1] = cache_get_field_content_int(0, "CarSlot1", connects);
	Player[playerid][CarSlot1Color1] = cache_get_field_content_int(0, "CS1Cl1", connects);
	Player[playerid][CarSlot1Color2] = cache_get_field_content_int(0, "CS1Cl2", connects);
	Player[playerid][CarSlot1PaintJob] = cache_get_field_content_int(0, "CS1PJ", connects);
	Player[playerid][CarSlot1Neon] = cache_get_field_content_int(0, "CS1Neon", connects);
	Player[playerid][CarSlot1Fire] = cache_get_field_content_int(0, "CS1Fire", connects);
	Player[playerid][CarSlot1Sir] = cache_get_field_content_int(0, "CS1Sir", connects);
	Player[playerid][CarSlot1Mig] = cache_get_field_content_int(0, "CS1Mig", connects);
	Player[playerid][CarSlot1Component0] = cache_get_field_content_int(0, "CS1C0", connects);
	Player[playerid][CarSlot1Component1] = cache_get_field_content_int(0, "CS1C1", connects);
	Player[playerid][CarSlot1Component2] = cache_get_field_content_int(0, "CS1C2", connects);
	Player[playerid][CarSlot1Component3] = cache_get_field_content_int(0, "CS1C3", connects);
	Player[playerid][CarSlot1Component4] = cache_get_field_content_int(0, "CS1C4", connects);
	Player[playerid][CarSlot1Component5] = cache_get_field_content_int(0, "CS1C5", connects);
	Player[playerid][CarSlot1Component6] = cache_get_field_content_int(0, "CS1C6", connects);
	Player[playerid][CarSlot1Component7] = cache_get_field_content_int(0, "CS1C7", connects);
	Player[playerid][CarSlot1Component8] = cache_get_field_content_int(0, "CS1C8", connects);
	Player[playerid][CarSlot1Component9] = cache_get_field_content_int(0, "CS1C9", connects);
	Player[playerid][CarSlot1Component10] = cache_get_field_content_int(0, "CS1C10", connects);
	Player[playerid][CarSlot1Component11] = cache_get_field_content_int(0, "CS1C11", connects);
	Player[playerid][CarSlot1Component12] = cache_get_field_content_int(0, "CS1C12", connects);
	Player[playerid][CarSlot1Component13] = cache_get_field_content_int(0, "CS1C13", connects);
	Player[playerid][CarSlot1NitroX] = cache_get_field_content_int(0, "CS1NitroX", connects);
	Player[playerid][CarSlot2] = cache_get_field_content_int(0, "CarSlot2", connects);
	Player[playerid][CarSlot2Color1] = cache_get_field_content_int(0, "CS2Cl1", connects);
	Player[playerid][CarSlot2Color2] = cache_get_field_content_int(0, "CS2Cl2", connects);
	Player[playerid][CarSlot2PaintJob] = cache_get_field_content_int(0, "CS2PJ", connects);
	Player[playerid][CarSlot2Neon] = cache_get_field_content_int(0, "CS2Neon", connects);
	Player[playerid][CarSlot2Fire] = cache_get_field_content_int(0, "CS2Fire", connects);
	Player[playerid][CarSlot2Sir] = cache_get_field_content_int(0, "CS2Sir", connects);
	Player[playerid][CarSlot2Mig] = cache_get_field_content_int(0, "CS2Mig", connects);
	Player[playerid][CarSlot2Component0] = cache_get_field_content_int(0, "CS2C0", connects);
	Player[playerid][CarSlot2Component1] = cache_get_field_content_int(0, "CS2C1", connects);
	Player[playerid][CarSlot2Component2] = cache_get_field_content_int(0, "CS2C2", connects);
	Player[playerid][CarSlot2Component3] = cache_get_field_content_int(0, "CS2C3", connects);
	Player[playerid][CarSlot2Component4] = cache_get_field_content_int(0, "CS2C4", connects);
	Player[playerid][CarSlot2Component5] = cache_get_field_content_int(0, "CS2C5", connects);
	Player[playerid][CarSlot2Component6] = cache_get_field_content_int(0, "CS2C6", connects);
	Player[playerid][CarSlot2Component7] = cache_get_field_content_int(0, "CS2C7", connects);
	Player[playerid][CarSlot2Component8] = cache_get_field_content_int(0, "CS2C8", connects);
	Player[playerid][CarSlot2Component9] = cache_get_field_content_int(0, "CS2C9", connects);
	Player[playerid][CarSlot2Component10] = cache_get_field_content_int(0, "CS2C10", connects);
	Player[playerid][CarSlot2Component11] = cache_get_field_content_int(0, "CS2C11", connects);
	Player[playerid][CarSlot2Component12] = cache_get_field_content_int(0, "CS2C12", connects);
	Player[playerid][CarSlot2Component13] = cache_get_field_content_int(0, "CS2C13", connects);
	Player[playerid][CarSlot2NitroX] = cache_get_field_content_int(0, "CS2NitroX", connects);
	Player[playerid][CarSlot3] = cache_get_field_content_int(0, "CarSlot3", connects);
	Player[playerid][CarSlot3Color1] = cache_get_field_content_int(0, "CS3Cl1", connects);
	Player[playerid][CarSlot3Color2] = cache_get_field_content_int(0, "CS3Cl2", connects);
	Player[playerid][GameGold] = cache_get_field_content_float(0, "GameGold", connects);
	Player[playerid][GameGoldTotal] = cache_get_field_content_float(0, "GGTotal", connects);
	Player[playerid][GPremium] = cache_get_field_content_int(0, "GPremium", connects);
	Player[playerid][SkillHP] = cache_get_field_content_int(0, "SkillHP", connects);
	Player[playerid][SkillRepair] = cache_get_field_content_int(0, "SkillRepair", connects);
	Player[playerid][ActiveSkillPerson] = cache_get_field_content_int(0, "ASPerson", connects);
	Player[playerid][ActiveSkillCar1] = cache_get_field_content_int(0, "ASCar1", connects);
    Player[playerid][ActiveSkillCar2] = cache_get_field_content_int(0, "ASCar2", connects);
    Player[playerid][ActiveSkillHCar1] = cache_get_field_content_int(0, "ASHCar1", connects);
    Player[playerid][ActiveSkillHCar2] = cache_get_field_content_int(0, "ASHCar2", connects);
	Player[playerid][Prestige] = cache_get_field_content_int(0, "Prestige", connects);
	Player[playerid][Karma] = cache_get_field_content_int(0, "Karma", connects);
	Player[playerid][KarmaTime] = cache_get_field_content_int(0, "KarmaTime", connects);
	Player[playerid][PosX] = cache_get_field_content_float(0, "PosX", connects);
	Player[playerid][PosY] = cache_get_field_content_float(0, "PosY", connects);
	Player[playerid][PosZ] = cache_get_field_content_float(0, "PosZ", connects);
	Player[playerid][PosA] = cache_get_field_content_float(0, "PosA", connects);
	Player[playerid][ConPM] = cache_get_field_content_int(0, "ConPM", connects);
	Player[playerid][ConInviteClan] = cache_get_field_content_int(0, "ConInviteClan", connects);
    Player[playerid][ConInvitePVP] = cache_get_field_content_int(0, "InvPVP", connects);
    Player[playerid][ConMesPVP] = cache_get_field_content_int(0, "ConMesPVP", connects);
    Player[playerid][ConMesEnterExit] = cache_get_field_content_int(0, "InvEnEx", connects);
    Player[playerid][ConSpeedo] = cache_get_field_content_int(0, "ConSpeedo", connects);
    Player[playerid][RadarSwitch] = cache_get_field_content_int(0, "Radar", connects);
    Player[playerid][Mrf1] = cache_get_field_content_int(0, "Mrf2", connects);
    Player[playerid][Type] = cache_get_field_content_int(0, "Types", connects);
    Player[playerid][LastHourExp] = cache_get_field_content_int(0, "LHxp", connects);
    Player[playerid][LastHourReferalExp] = cache_get_field_content_int(0, "LHRefxp", connects);
    cache_get_field_content(0, "LDate", PlayerLimitXPDate[playerid], connects, 80);
    Player[playerid][SPrest] = cache_get_field_content_int(0, "SPrest", connects);
    Player[playerid][EventChangeTime] = cache_get_field_content_int(0, "ECTime", connects);
    cache_get_field_content(0, "RegisterDate", RegisterDate[playerid], connects, 16);
    cache_get_field_content(0, "RegisterIP", RegisterIP[playerid], connects, 16);
    Player[playerid][LeaveZM] = cache_get_field_content_int(0, "LeaveZM", connects);
    Player[playerid][ClanWarTime] = cache_get_field_content_int(0, "ClanWarTime", connects);
    Player[playerid][CasinoBalance] = cache_get_field_content_int(0, "CasinoBalance", connects);
    //Player[playerid][GiveCashBalance] = cache_get_field_content_int(0, "GiveCashBalance", connects);
    cache_get_field_content(0, "ChatName", ChatName[playerid], connects, 80);
    Player[playerid][BuddhaTime] = cache_get_field_content_int(0, "BuddhaTime", connects);
    Player[playerid][PrestigeColor] = cache_get_field_content_int(0, "PrestigeColor", connects);
    Quest[playerid][0] = cache_get_field_content_int(0, "Quest1", connects);
    QuestScore[playerid][0] = cache_get_field_content_int(0, "Quest1Score", connects);
    QuestTime[playerid][0] = cache_get_field_content_int(0, "Quest1Time", connects);
    Quest[playerid][1] = cache_get_field_content_int(0, "Quest2", connects);
    QuestScore[playerid][1] = cache_get_field_content_int(0, "Quest2Score", connects);
    QuestTime[playerid][1] = cache_get_field_content_int(0, "Quest2Time", connects);
    Quest[playerid][2] = cache_get_field_content_int(0, "Quest3", connects);
    QuestScore[playerid][2] = cache_get_field_content_int(0, "Quest3Score", connects);
    QuestTime[playerid][2] = cache_get_field_content_int(0, "Quest3Time", connects);
    Player[playerid][Medals] = cache_get_field_content_int(0, "Medals", connects);
    Player[playerid][CompletedQuests] = cache_get_field_content_int(0, "CQuests", connects);
    Player[playerid][GGFromMedals] = cache_get_field_content_float(0, "GGFM", connects);
    Player[playerid][GGFromMedalsTotal] = cache_get_field_content_float(0, "GGMT", connects);
    Player[playerid][GGFromMedalsLastDay] = cache_get_field_content_float(0, "GGLD", connects);
    Player[playerid][FindPack] = cache_get_field_content_int(0, "FindPack", connects);
    Player[playerid][ReadObnovlenie] = cache_get_field_content_int(0, "ReadObnov", connects);
    Player[playerid][Bonus] = cache_get_field_content_int(0, "Bonus", connects);
    Player[playerid][SlivBlock] = cache_get_field_content_int(0, "SlivBlock", connects);
    //Player[playerid][RadarSwitch] = cache_get_field_content_int(0, "Radar", connects);
    Player[playerid][Tag] = cache_get_field_content_int(0, "Tag", connects);
    cache_get_field_content(0, "Vinil", Player[playerid][Vinil], connects, 30);
    Player[playerid][Gold] = cache_get_field_content_int(0, "Gold", connects);
    Player[playerid][SPN1] = cache_get_field_content_int(0, "SPNav1", connects);
    Player[playerid][SPN2] = cache_get_field_content_int(0, "SPNav2", connects);
    Player[playerid][SPN3] = cache_get_field_content_int(0, "SPNav3", connects);
    Player[playerid][SPN4] = cache_get_field_content_int(0, "SPNav4", connects);
    Player[playerid][SPN5] = cache_get_field_content_int(0, "SPNav5", connects);
    Player[playerid][SPN6] = cache_get_field_content_int(0, "SPNav6", connects);
    Player[playerid][SPN7] = cache_get_field_content_int(0, "SPNav7", connects);
    Player[playerid][SPN8] = cache_get_field_content_int(0, "SPNav8", connects);
    Player[playerid][SPN9] = cache_get_field_content_int(0, "SPN9", connects);
    Player[playerid][OpXP] = cache_get_field_content_int(0, "OpXP", connects);
    Player[playerid][OpGG] = cache_get_field_content_float(0, "OpGG", connects);
    Player[playerid][Lottery] = cache_get_field_content_int(0, "Lotr", connects);
    Player[playerid][MenuTp] = cache_get_field_content_int(0, "MenuTp", connects);
    new MrfString[60];
    
    cache_get_field_content(0, "Mrfon", MrfString, connects, 60);
    
    new idx;
    for(new x; x<sizeof(EtapsInfo); x++)
	{
	    PlayerMarafon[playerid][x] = strval(strtok(MrfString, idx));
	}
    
    Logged[playerid] = 1;

    new Lvl = Player[playerid][Level];
    if(Lvl > 100 && Player[playerid][Prestige] < 10) {Player[playerid][Level] = 100; Player[playerid][Exp] = 0;} //исправит баг с 100+ ур. и престижем меньше 10

	if (Player[playerid][Prestige] < 10 || Lvl < 100) NeedXP[playerid] = Levels[Lvl];
	else NeedXP[playerid] = (Lvl - 99) * 100 + 35000;
    
	new ChatMes[140];
	foreach(Player, gid)
	{//цикл
		if (Logged[gid] == 1 && Player[gid][Admin] > 0)
		{//если модер и выше
	    	format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] вошел в игру [IP-Адрес:{FFFFFF} %s{AFAFAF}].", PlayerName[playerid], playerid, PlayerIP[playerid]);
		}//если модер и выше
		else{format(ChatMes, sizeof(ChatMes), "SERVER: %s[%d] вошел в игру.", PlayerName[playerid],playerid);}
		if (Player[gid][ConMesEnterExit] == 1) SendClientMessage(gid, COLOR_GREY, ChatMes);
	}//цикл
	//Запись в лог. Например WriteLog("Файл", "Привет Мир!"); запишет в лог "Файл.ini" фразу "Привет Мир!"
 	format(ChatMes, sizeof ChatMes, "%d.%d.%d в %d:%d:%d |   %s[%d] вошел в игру [IP-Адрес: %s].", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, PlayerIP[playerid]);
	WriteLog("GlobalLog", ChatMes);

	//format(ChatMes, sizeof ChatMes, "%d", Player[playerid][LastHourExp]);
	//WriteLog("GlobalLog", ChatMes);

	SetPlayerVirtualWorld(playerid,0);
	LSpawnPlayer(playerid);
	if(Player[playerid][RadarSwitch] == 1) {TextDrawShowForPlayer(playerid, TextDrawTime), TextDrawShowForPlayer(playerid, TextDrawDate);}//дата и время
	SetTimerEx("SpeedoUpdate" , 500, false, "i", playerid);
	ShowClanZones(playerid);
	OnPlayerLogin(playerid);
	LoginKickTime[playerid] = 0;
	if (Player[playerid][Level] == 0) TutorialStep[playerid] = 1;//включается обучение если 0 лвл
    return 1;
}

stock acc_int_strcat(query[], len, name[], number)
{
	new string[100];
    format(string, sizeof(string), "`%s`='%d',",name, number);
    strcat(query, string, len);
    return true;
}
stock acc_str_strcat(query[], len, name[], str[])
{
	new string[256];
    format(string, sizeof(string), "`%s`='%s',",name, str);
    strcat(query, string, len);
    return true;
}
stock acc_float_strcat(query[], len, name[], Float:number)
{
	new string[100];
    format(string, sizeof(string), "`%s`='%.3f',", name, number);
    strcat(query, string, len);
    return true;
}

strtok(const string[], &index)
{
	new length = strlen(string);
	while ((index < length) && (string[index] <= ' '))
	{
		index++;
	}

	new offset = index;
	new result[20];
	while ((index < length) && (string[index] > ' ') && ((index - offset) < (sizeof(result) - 1)))
	{
		result[index - offset] = string[index];
		index++;
	}
	result[index - offset] = EOS;
	return result;
}

public MysqlCheckNameBuyName(playerid, name[])
{
	if(cache_get_row_count(connects)>0) return ShowPlayerDialog(playerid, DIALOG_CHANGENICK2, 1, "Смена ника", "{008E00}Отлично! Теперь введите ваш новый игровой ник:\n\n{FF0000}Аккаунт с таким именем уже существует!","ОК","Отмена");
	Player[playerid][GameGold] -= 100.0;
	RenamePlayer(playerid, name);
	return 1;
}
stock RenamePlayer(playerid, NewName[])
{
        new OldName[24];
		strmid(OldName, PlayerName[playerid], 0, strlen(PlayerName[playerid]), MAX_PLAYER_NAME);
  		strmid(PlayerName[playerid], NewName, 0, strlen(NewName), MAX_PLAYER_NAME);
		SetPlayerName(playerid, PlayerName[playerid]);
  		strmid(ChatName[playerid], PlayerName[playerid], 0, strlen(PlayerName[playerid]), MAX_PLAYER_NAME);
    	//Сохранение нового аккаунта
    	//Player[playerid][GameGold] -= 100.0;
		if (Player[playerid][Home] > 0)
		{//У игрока есть дом
  			new PlayerHouse = Player[playerid][Home], text3d[MAX_3DTEXT];
		    if(!strcmp(Property[PlayerHouse][pOwner], OldName, true))
		    {//Игроку ДЕЙСТВИТЕЛЬНО принадленал дом на старом нике
		        strmid(Property[PlayerHouse][pOwner], NewName, 0, strlen(NewName), MAX_PLAYER_NAME);
		        if(Property[PlayerHouse][pBuyBlock] > 0)
				{
					format(text3d, sizeof(text3d), "{00FF00}Дом ({FFFFFF}%d${00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[PlayerHouse][pPrice], Property[PlayerHouse][pOwner]);
                    UpdateDynamic3DTextLabelText(PropertyText3D[PlayerHouse], 0xFFFFFFFF, text3d);
					SaveProperty(PlayerHouse);
				}
				else
				{
					format(text3d, sizeof(text3d), "{00FF00}Дом ({FF0000}Не продается{00FF00})\n{007FFF}Владелец:{FFFFFF} %s\nНажмите [{FFFF00}Alt{FFFFFF}] чтобы использовать", Property[PlayerHouse][pOwner]);
                    UpdateDynamic3DTextLabelText(PropertyText3D[PlayerHouse], 0xFFFFFFFF, text3d);
					SaveProperty(PlayerHouse);
				}
		    }//Игроку ДЕЙСТВИТЕЛЬНО принадленал дом на старом нике
		}//У игрока есть дом
		if (Player[playerid][MyClan] != 0 && Player[playerid][Member] != 0)
		{//Игрок в клане
		    new clanid = Player[playerid][MyClan];
		    if (Player[playerid][Member] == -1) {strmid(Clan[clanid][cLider], NewName, 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);}
		    for(new memb=1; memb<MAX_CMEMBERS; memb++)
			{
			    if (Player[playerid][Member] == memb)
			    {
					strmid(CMember[clanid][memb], NewName, 0, MAX_PLAYER_NAME, MAX_PLAYER_NAME);
					break;
				}
			}
			SaveClan(clanid);
		}//Игрок в клане
		new MesString[256];
		format(MesString,sizeof(MesString),"{008E00}Вы успешно изменили ник за 100 рублей.{FFFF00}\nНовый ник: {FFFFFF}%s{FFFF00}\nНе забудьте ввести его, когда в следующий раз запустите samp.",NewName);
		ShowPlayerDialog(playerid, 999999, 0, "Смена ника", MesString,"ОК","");
		//----------save
		new query[220];
		mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `PName` = '%s', `GameGold` = '%f' WHERE `SID` = '%d';",PlayerName[playerid], Player[playerid][GameGold], Player[playerid][SID]);
		mysql_empty(connects, query);
		//cache_delete(cache, connects);
		//mysql_store_result();
		mysql_format(connects,query, sizeof(query), "UPDATE `pupdate` SET `PName` = '%s' WHERE `SID` = '%d';",PlayerName[playerid], Player[playerid][SID]);
		mysql_empty(connects, query);
		//--------- Ниже идет запись в Log
		new String[140]; format(String, sizeof String, "%d.%d.%d в %d:%d:%d |   SHOP: %s изменил ник на %s за 100 рублей", Day, Month, Year, hour, minute, second, OldName, NewName);
		WriteLog("Shop", String);
		WriteLog("NickChanges", String);
		return 1;
}

public MysqlCheckBanName(playerid, name[], reason[])
{
	if(cache_get_row_count(connects) < 1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Игрок с данным ником не обнаружен в базе данных.");
	new wasban = cache_get_field_content_int(0, "Banned", connects);
	if (wasban != 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Данный игрок уже был забанен.");
	new isadm = cache_get_field_content_int(0, "Admin", connects);
	if(isadm >= Player[playerid][Admin]) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не можете банить модератора/админа выше себя статусом.");

	new query[256];
	mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Banned`='1',`BannedBy`='%s',`BanReason`='%s' WHERE `PName` = '%s'",PlayerName[playerid], reason, name);
	mysql_empty(connects, query);
	
	new string[140];
	if (Player[playerid][Admin] <= 2) format(string, sizeof(string), "{AFAFAF}SERVER: %s был оффлайн забанен модератором %s[%d]. {FF0000}Причина: {AFAFAF}%s.", name, PlayerName[playerid], playerid, reason);
	else format(string, sizeof(string), "{AFAFAF}SERVER: %s был оффлайн забанен администратором %s[%d]. {FF0000}Причина: {AFAFAF}%s.", name, PlayerName[playerid], playerid, reason);
	if (Player[playerid][Admin] != 5) {SendClientMessageToAll(COLOR_MODER,string);}
	
	format(string, sizeof string, "%d.%d.%d в %d:%d:%d |   ADMIN: %s[%d] ввел /oban %s %s", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, name, reason);
	WriteLog("GlobalLog", string);WriteLog("Admin", string); WriteLog("Bans", string);
	
	return 1;
}

public MysqlCheckUnBanName(playerid, name[], reason[])
{
    if(cache_get_row_count(connects) < 1) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Игрок с данным ником не обнаружен в базе данных.");
	new wasban = cache_get_field_content_int(0, "Banned", connects);
	if (wasban == 0) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Данный игрок не забанен.");
	new AdmName[30];
	cache_get_field_content(0, "BannedBy", AdmName, connects, 32);
	if(strcmp(AdmName, PlayerName[playerid]) && Player[playerid][Admin] != 4) return SendClientMessage(playerid,COLOR_RED,"ОШИБКА: Вы не можете снимать чужие баны.");
	
	new query[256];
	mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Banned`='0',`BannedBy`='ПУСТ',`BanReason`='ПУСТ' WHERE `PName` = '%s'", name);
	mysql_empty(connects, query);
	
	new string[140];
	if (Player[playerid][Admin] <= 2) format(string, sizeof(string), "{AFAFAF}SERVER: %s был оффлайн разбанен модератором %s[%d]. {FF0000}Причина: {AFAFAF}%s.", name, PlayerName[playerid], playerid, reason);
	else format(string, sizeof(string), "{AFAFAF}SERVER: %s был оффлайн разбанен администратором %s[%d]. {FF0000}Причина: {AFAFAF}%s.", name, PlayerName[playerid], playerid, reason);
	if (Player[playerid][Admin] != 5) {SendClientMessageToAll(COLOR_MODER,string);}
	
	format(string, sizeof string, "%d.%d.%d в %d:%d:%d |   ADMIN: %s[%d] ввел /ounban %s %s", Day, Month, Year, hour, minute, second, PlayerName[playerid], playerid, name, reason);
	WriteLog("GlobalLog", string);WriteLog("Admin", string); WriteLog("Bans", string);
	
	return 1;
}



public OffHUpdate(owner[],pid)
{
	if(!cache_get_row_count(connects)) return 1;
	new PBank = cache_get_field_content_int(0, "Bank", connects);
	new PSpawn = cache_get_field_content_int(0, "Spawn", connects);
 	new query[120];
 	PBank += Property[pid][pPrice] / 100 * 85;
 	if (PSpawn == 4 || PSpawn == 6 || PSpawn == 7) PSpawn = 0;
	mysql_format(connects,query, sizeof(query), "UPDATE `accounts` SET `Bank` = '%d',`Spawn` = '%d' WHERE `PName` = '%s'",PBank,PSpawn,owner);
	mysql_empty(connects, query);
	return 1;
}

stock ShowMoneyWant(playerid,type,money[] = "")
{
	new str[140];
    if (type == 1) format(str, sizeof(str), "Недостаточно денег! Нужно {FFFFFF}%s$!{ff0000} Деньги можно приобрести в {ffffff}/shop{ff0000}!", money);
	else format(str, sizeof(str), "Недостаточно денег! Деньги можно приобрести в {ffffff}/shop{ff0000}!");
	SendClientMessage(playerid, COLOR_RED, str);
	return 1;
}

/*stock CreateRepairPoint(Float:x,Float:y,Float:z,world,interior)
{
 	if(DRemStats[IsRActived] == 1)
 	{
 	    DestroyDynamicArea(DRemStats[RepZone]);
        DestroyDynamicObject(DRemStats[RepObj]);
        DestroyDynamic3DTextLabel(DRemStats[rtext]);
	}
    DRemStats[IsRActived] = 1;
    DRemStats[RepZone] = CreateDynamicCylinder(x, y, z-20.0, z+20.0, 10.0, world, interior, -1);//CreateDynamicSphere(x, y, z-2.0, 12.0, world, interior, -1);
    DRemStats[RepObj] = CreateDynamicObject(19946, x, y, z-2.0, 0.0, 0.0, 0.0, world, interior, -1, 500.0, 500.0);
    DRemStats[rtext] = CreateDynamic3DTextLabel("[ {00ff00}Ремонт{ffffff} ]", 0xFFFFFF86, x, y, z, 50.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, 0, world, interior, -1, 80.0);
}*/

stock CreateVehVinil(playerid, vehicleid)
{
	new VehicleMD = GetVehicleModel(vehicleid),bool:sucs=false;
	for(new i;i<MAX_VINCARS;i++)
	{
 		if(VehicleMD == VinilPos[i][CarType])
 		{
 		    VVinil[vehicleid][0]=CreateDynamicObject(19477,	0.0, 	0.0, 	-10.0, 	-50.0, 	0.0, 	0.0, 	0, 0, -1, 500.0, 500.0);
			VVinil[vehicleid][1]=CreateDynamicObject(19477,	0.0, 	0.0, 	-10.0, 	-50.0, 	0.0, 	0.0, 	0, 0, -1, 500.0, 500.0);
	        AttachDynamicObjectToVehicle(VVinil[vehicleid][0], vehicleid, VinilPos[i][fvX], VinilPos[i][fvY], VinilPos[i][fvZ], 0.0, 0.0, 0.0);
			AttachDynamicObjectToVehicle(VVinil[vehicleid][1], vehicleid, VinilPos[i][nvX], VinilPos[i][nvY], VinilPos[i][nvZ], 0.0, 0.0, 180.0);
			sucs=true;
			break;
		}
	}
    if(!sucs)
	{
		//SendClientMessage(playerid,COLOR_GREY,"Винилы недоступны для этой модели.");
    	strmid(Player[playerid][Vinil], "Null", 0, strlen("Null"), 5);
		return 1;
	}
	SetDynamicObjectMaterialText(VVinil[vehicleid][0],0,Player[playerid][Vinil],OBJECT_MATERIAL_SIZE_256x128, "Arial", 26, 1, 0xFFFFFFFF, 0, 0);
	SetDynamicObjectMaterialText(VVinil[vehicleid][1],0,Player[playerid][Vinil],OBJECT_MATERIAL_SIZE_256x128, "Arial", 26, 1, 0xFFFFFFFF, 0, 0);
	return 1;
}


stock SaveServerConfig()
{
	new file = ini_openFile("config.ini");
    ini_setInteger(file, "DoubleXP", ServConf[0]); 		//x2 XP
	ini_setFloat(file, "DBonus", DBonus); 				//donate bonus
    ini_setInteger(file, "SPrize", ServConf[2]); 		//marafon 1st
    ini_setInteger(file, "DoubleXPTop", ServConf[3]); 	//x2 XP top
	ini_setInteger(file, "DoubleMrf", ServConf[4]); 	//x2 marafon
	ini_setInteger(file, "Lottery", ServConf[5]); 		//lottery
	ini_closeFile(file);
	return 1;
}

stock ConfigDialog(playerid)
{
	if(Player[playerid][Admin] < 4) return false;
    new StringX[512];
    strcat(StringX, "Опция\tСтатус\n");
	format(StringX,sizeof(StringX),"%sМножитель доната (/setdbonus)\t{01DF01}%.1f\n",StringX,DBonus);
	
	strcat(StringX, "x2 опыт\t");
	if(ServConf[0] == 0) strcat(StringX, "{ff0000}ВЫКЛ\n");
	else strcat(StringX, "{01DF01}ВКЛ\n");
	
	strcat(StringX, "Режим разработчика\t");
	if(ServConf[1] == 0) strcat(StringX, "{ff0000}ВЫКЛ\n");
	else strcat(StringX, "{01DF01}ВКЛ\n");
	
	strcat(StringX, "x2 опыт (/top)\t");
	if(ServConf[3] == 0) strcat(StringX, "{ff0000}ВЫКЛ\n");
	else strcat(StringX, "{01DF01}ВКЛ\n");
	
	strcat(StringX, "Ускоренный марафон\t");
	if(ServConf[4] == 0) strcat(StringX, "{ff0000}ВЫКЛ\n");
	else strcat(StringX, "{01DF01}ВКЛ\n");
	
	strcat(StringX, "Добавить 50 лот. билетов\t\n");
	
	strcat(StringX, "{FF0000}Сохранить данные сервера\t\n");
	
	strcat(StringX, "Выдать награды за рейтинг\t(НЕ НАЖИМАТЬ)\n");
	
	strcat(StringX, "Убрать лотерею из шоп\t\n");
	
    ShowPlayerDialog(playerid, DIALOG_SCONF, 5, "Конфигурация сервера:", StringX, "ВЫБОР", "Закрыть");
	return 1;
}

stock ShowZones(playerid)
{
    new StringX[2000], lstr[128];
    strcat(StringX, "Территория\tСтатус\tВладелец\tОпыт / Деньги\n");
    for(new i = 1; i < MAX_GZONE; i++)
    {
        if(GangZones[i][GZOwner] > 0){format(lstr,sizeof(lstr),"%s",Clan[GangZones[i][GZOwner]][cName]);} else {format(lstr,sizeof(lstr),"{afafaf}Нет");}
        if(GangZones[i][GZClanTime] != -10) {format(lstr,sizeof(lstr),"%s\t{ff0000}Недоступна: %s\t%s\t%d / %d\n",GangZones[i][GZName],TimeConvert(GangZones[i][GZClanTime]-unixtime),lstr, GangZones[i][GZExp], GangZones[i][GZCash]);}
		else if(GangZones[i][GZClanTime] == -10)
  		{
			switch(GangZones[i][ZoneAttacked])
			{
			    case 0: format(lstr,sizeof(lstr),"%s\t{3ADF00}Доступна\t%s\t%d / %d\n",GangZones[i][GZName],lstr, GangZones[i][GZExp], GangZones[i][GZCash]);
  		    	case 1: format(lstr,sizeof(lstr),"%s\t{FACC2E}Подготовка\t%s\t%d / %d\n",GangZones[i][GZName],lstr, GangZones[i][GZExp], GangZones[i][GZCash]);
  		    	case 2: format(lstr,sizeof(lstr),"%s\t{F5A9BC}Идет захват\t%s\t%d / %d\n",GangZones[i][GZName],lstr, GangZones[i][GZExp], GangZones[i][GZCash]);
  			}
		}
		strcat(StringX, lstr);
	}
	
    ShowPlayerDialog(playerid, DIALOG_ZINFO, 5, "Список территорий:", StringX, "GPS", "Закрыть");
	return 1;
}

stock ShowConfigPVP(playerid)
{
    new String[300], zWeapon[48], zMap[30];
	GetWeaponName(PlayerPVP[playerid][Weapon],zWeapon,sizeof(zWeapon));
	if (PlayerPVP[playerid][Weapon] == 0) zWeapon = "Без оружия";
	switch (PlayerPVP[playerid][Map])
	{
	    case 1: zMap = "Арена";
		case 2: zMap = "Под мостом";
		case 3: zMap = "Над мостом";
		case 4: zMap = "Молния";
		case 5: zMap = "Окопы";
		case 6: zMap = "Вертолетная площадка";
		case 7: zMap = "Две крыши";
		case 8: zMap = "Дамба";
		case 9: zMap = "Грузовой корабль";
		case 10: zMap = "Пирамида";
	}
	format(String,sizeof(String),"{457EFF}Случайные настройки\n{FFFF00}Карта:{FFFFFF} %s\n{FFFF00}Оружие:{FFFFFF} %s\n{FFFF00}Здоровье:{FFFFFF} %d\n{FFFF00}Ставка: {FFFFFF}%d$",zMap,zWeapon, PlayerPVP[playerid][Health],PlayerPVP[playerid][Stavka]);
	ShowPlayerDialog(playerid, DIALOG_PVP, 2, "Настройки PvP", String, "ОК", "Назад");
	return 1;
}

stock BanSet(playerid)
{
	new strban[256], ip3[16], paiko;
	GetPlayerIp(playerid, ip3, 16);
	for(new fh = 0; fh < strlen(ip3); fh++)
	{
		if(ip3[fh]=='.' && paiko+1==2) strdel(ip3, fh+1, strlen(ip3));
		if(ip3[fh]=='.' && paiko+1<2) paiko++;
	}
	format(strban, sizeof(strban), "banip %s*.*", ip3);
	SendRconCommand(strban);
	return 1;
}

stock MysqlSaveMember(clanid,slot,rang,name[])
{
    if (ServConf[1] == 1) return 1;
	if(slot > 25 || slot < 1) return 1;
	new query[128];
    mysql_format(connects,query, sizeof(query), "UPDATE `clans` SET `m%d`='%s',`r%d`='%d' WHERE `CID`='%d';",slot,name,slot,rang,clanid);
	mysql_tquery(connects, query);
	return 1;
}

stock DialogCommands(playerid)
{
	new String[256];
    format(String,sizeof(String),"[1] Основное\n[2] Соревнования\n[3] Банды\n[4] Чат\n[5] Анимации\n");
    if(Player[playerid][Admin] > 0) {strcat(String, "[6] Модератор/администратор");}
    ShowPlayerDialog(playerid, DIALOG_COMMANDS, 2, "Команды сервера:", String, "ОК", "Назад");
	return 1;
}

stock CreateAnotherAreas()
{
    BankCassaCP = CreateDynamicSphere(1104.7926,1528.5916,4452.4810, 1.5, 648, 61, -1);//CreateDynamicCP(246.4088,118.0237,1003.2188, 1.5, -1, 10);
    AreaType[BankCassaCP] = 2;
    BankBiletCP = CreateDynamicSphere(1112.4061,1528.1237,4452.4810, 1.5, 648, 61, -1);//CreateDynamicCP(240.4523,112.8100,1003.2188, 1.5, -1, 10);
    AreaType[BankBiletCP] = 2;
    BankOut = CreateDynamicSphere(1104.8020,1515.6584,4452.8071, 1.2, 648, 61, -1);
    //PDMArea = CreateDynamicCylinder(0.0, 0.0, 0.0, 0.0, 10.0, PDM_WORLD, -1, -1);
    return 1;
}

stock SetRandomGVVeh()
{
    new modelid;
    switch(DRid)
	{
		case 1..5: {modelid = random(sizeof(DRFastCars)); DRModelCar = DRFastCars[modelid];}
		case 6,7: {modelid = random(sizeof(MonsterCars)); DRModelCar = MonsterCars[modelid];}
	}
	
}

stock ChangeDialog(playerid)
{
    if (Player[playerid][Admin] < 3 && Player[playerid][GPremium] < 18) return 1;

	new String[240];
	if (DMTimer > 1 && DMTimer < 300) strcat(String, "{FF8C00}Десматч\n"); else strcat(String, "{AFAFAF}Десматч\n");
	if (DerbyTimer > 1 && DerbyTimer < 300) strcat(String, "{9966CC}Дерби\n"); else strcat(String, "{AFAFAF}Дерби\n");
	if (ZMTimer > 1 && ZMTimer < 300) strcat(String, "{E60020}Зомби-Выживание\n"); else strcat(String, "{AFAFAF}Зомби-Выживание\n");
	if (FRTimer > 1 && FRTimer < 300) strcat(String, "{007FFF}Гонка\n"); else strcat(String, "{AFAFAF}Гонка\n");
	if (GGTimer > 1 && GGTimer < 600) strcat(String, "{FF6666}Гонка Вооружений\n"); else strcat(String, "{AFAFAF}Гонка Вооружений\n");
	if (XRTimer > 1 && XRTimer < 600) strcat(String, "{FFD700}Легендарная Гонка\n"); else strcat(String, "{AFAFAF}Легендарная Гонка\n");
	if (TDMTimer > 1 && TDMTimer < 300) strcat(String, "{04B486}Командный ДМ\n"); else strcat(String, "{AFAFAF}Командный ДМ\n");
	if (PRTimer > 1 && PRTimer < 300) strcat(String, "{58FAF4}Паркур\n"); else strcat(String, "{AFAFAF}Паркур\n");
	if (DRTimer > 1 && DRTimer < 300) strcat(String, "{4C73E6}Гонка на выживание\n"); else strcat(String, "{AFAFAF}Гонка на выживание\n");
	//if (PDMTimer > 1 && PDMTimer < 300) strcat(String, "{58FA82}Захват точки\n"); else strcat(String, "{AFAFAF}Захват точки\n");
	return ShowPlayerDialog(playerid, DIALOG_ACHANGE, 2, "Изменить соревнование", String, "ОК", "Отмена");
}

stock GoldDialog(playerid)
{
	new mString[100],String[1800],cid = Player[playerid][MyClan];
	format(mString,sizeof(mString),"{FFFFFF}Gold-магазин. У вас {F1C619}%d{FFFFFF} золота:",Player[playerid][Gold]);
	strcat(String, "ОПЦИЯ\tСТОИМОСТЬ\tОПИСАНИЕ\n");
	if(Player[playerid][SPN2] < 1) strcat(String, "Маскарад\t{F1C619}1200\t{afafaf}Позволяет делать любой ник в чате\n"); else strcat(String, "{afafaf}Маскарад\t{afafaf}1200\t{afafaf}Позволяет делать любой ник в чате\n");
	if(Player[playerid][Mrf1] < 1) strcat(String, "Плеер /aplay\t{F1C619}950\t{afafaf}Позволяет включать музыку по ссылке для всех игроков\n"); else strcat(String, "{afafaf}Плеер /aplay\t{afafaf}950\t{afafaf}Позволяет включать музыку по ссылке для всех игроков\n");
	if(cid > 0 && Player[playerid][Leader] == 100 && Clan[cid][Imm] < 1) strcat(String, "Бессмертный полк\t{F1C619}800\t{afafaf}Ваш клан не зависит от штаба (лидер) + смена лидера раз в неделю\n"); else strcat(String, "{afafaf}Бессмертный полк\t{afafaf}800\t{afafaf}Ваш клан теперь не зависит от штаба (лидер) + смена лидера раз в неделю\n");
	if(Player[playerid][SPN6] < 1) strcat(String, "Мастер-оружейник\t{F1C619}800\t{afafaf}Доступно новое личное оружие (С4, огнемет, холодное  и т.д.)\n"); else strcat(String, "{afafaf}Мастер-оружейник\t{afafaf}800\t{afafaf}Доступно новое личное оружие (С4, огнемет, холодное  и т.д.)\n");
    if(Player[playerid][SPN8] < 1) strcat(String, "Телепортер\t{F1C619}500\t{afafaf}Позволяет телепортировать игроков к себе\n"); else strcat(String, "{afafaf}Телепортер\t{afafaf}500\t{afafaf}Позволяет телепортировать игроков к себе\n");
	if(Player[playerid][Type] < 1) strcat(String, "Авто-винилы\t{F1C619}500\t{afafaf}Позволяет делать надписи на авто 2-го класса (в TurboSpeed)\n"); else strcat(String, "{afafaf}Авто-винилы\t{afafaf}500\t{afafaf}Позволяет делать надписи на авто 2-го класса (в TurboSpeed)\n");
	if(Player[playerid][SPN7] < 1) strcat(String, "Авто-призрак\t{F1C619}400\t{afafaf}Позволяет делать невидимый автомобиль, /prizrak\n"); else strcat(String, "{afafaf}Авто-призрак\t{afafaf}400\t{afafaf}Позволяет делать невидимый автомобиль, /prizrak\n");
    if(Player[playerid][SPN1] < 1) strcat(String, "Пушка-телепорт\t{F1C619}300\t{afafaf}Позволяет телепортироваться в место выстрела, /pgun\n"); else strcat(String, "{afafaf}Пушка-телепорт\t{afafaf}300\t{afafaf}Позволяет телепортироваться в место выстрела, /pgun\n");
	if(Player[playerid][SPN4] < 1) strcat(String, "Грабитель\t{F1C619}300\t{afafaf}После убийства игрока его деньги сразу идут вам на счет\n"); else strcat(String, "{afafaf}Грабитель\t{afafaf}300\t{afafaf}После убийства игрока его деньги сразу идут вам на счет\n");
	if(Player[playerid][SPN3] < 1) strcat(String, "Король чата\t{F1C619}150\t{afafaf}Вам доступны команды /pt, /bb, /me, время между цв. сообщениями 10 сек\n"); else strcat(String, "{afafaf}Король чата\t{afafaf}150\t{afafaf}Вам доступны команды /pt, /bb, /me, время между цв. сообщениями 10 сек\n");
	if(Player[playerid][SPN5] < 1) strcat(String, "Дизайнер\t{F1C619}150\t{afafaf}Вы можете менять иконку и пикап (вход) у своего дома\n"); else strcat(String, "{afafaf}Дизайнер\t{afafaf}150\t{afafaf}Вы можете менять иконку и пикап (вход) у своего дома\n");
	if(cid > 0 && Player[playerid][Leader] == 100 && Clan[cid][cSlots] < 25) strcat(String, "Слот в клане\t{F1C619}100\t{afafaf}Добавляет +1 слот в клане. Максимум: 25 (лидер)\n"); else strcat(String, "{afafaf}Слот в клане\t{afafaf}100\t{afafaf}Добавляет +1 слот в клане. Максимум: 25 (лидер)\n");
	strcat(String, "25.000 XP\t{F1C619}50\t{afafaf}XP идет только на прокачку уровня\n");
	
//	if() strcat(String, "Доп. слот в клане {ff0000}(лидер)\t{FFEB00}10\n"); else strcat(String, "{afafaf}Доп. слот в клане (лидер)\t{afafaf}10\n");
	ShowPlayerDialog(playerid, DIALOG_GOLD, 5, mString, String, "ОК", "Отмена");
	return 1;
}

stock ShowHouseDialog(playerid)
{
    new id = LastHouseVisited[playerid];
	if (id < 1 || id == MAX_PROPERTY) return 1;
	if (PlayerToPoint(3.0,playerid, Property[id][pPosEnterX], Property[id][pPosEnterY], Property[id][pPosEnterZ]))
	{//игрок рядом с домом
		if (Player[playerid][Home] == id) //это его дом
			ShowPlayerDialog(playerid, DIALOG_HOUSEMENU, 2, "{00FF00}Дом", "{007FFF}Войти в дом{FFFFFF}\nИнформация о доме\nКупить дом\nПродать дом\nУвеличить цену дома\nОткрыть / Закрыть дом\nСделать местом респавна (Снаружи дома)\nСделать местом респавна (Внутри дома)\n{ff0000}Улучшения", "ОК", "Отмена");
		else
			ShowPlayerDialog(playerid, DIALOG_HOUSEMENU, 2, "{00FF00}Дом", "{007FFF}Войти в дом{FFFFFF}\nИнформация о доме\nКупить дом", "ОК", "Отмена");
		}//игрок рядом с домом
	return 1;
}

stock ShowBaseDialog(playerid)
{
	new i = LastBaseVisited[playerid], clanid = Player[playerid][MyClan];
	if (i < 1 || i == MAX_BASE) return 1;
	if (PlayerToPoint(3.0,playerid, Base[i][bPosEnterX], Base[i][bPosEnterY], Base[i][bPosEnterZ]))
	{//игрок рядом со штабом
		if (Clan[clanid][cBase] == i)//штаб клана игрока
			ShowPlayerDialog(playerid, DIALOG_BASEMENU, 2, "{007FFF}Штаб", "{008D00}Войти в штаб{FFFFFF}\nИнформация о штабе\nКупить штаб\nПродать штаб\nУвеличить цену штаба\nСделать местом респавна (Снаружи штаба)\nСделать местом респавна (Внутри штаба)\n{FFFF00}Улучшения", "ОК", "Отмена");
		else //чужой штаб
			ShowPlayerDialog(playerid, DIALOG_BASEMENU, 2, "{007FFF}Штаб", "{008D00}Войти в штаб{FFFFFF}\nИнформация о штабе\nКупить штаб", "ОК", "Отмена");
	}//игрок рядом со штабом
	return 1;
}


stock ObmenDialog(playerid)
{//Обмен медалей
	new String[120], StringX[480];
    strcat(StringX, "Опция\tСтоимость\n");
	strcat(StringX, "Получить 200 XP\t{FFCC00}1 Медаль\n");
    strcat(StringX, "Получить 50 000$\t{FFCC00}1 Медаль\n");
    strcat(StringX, "Получить 25 очков кармы\t{FFCC00}4 Медали\n");
    strcat(StringX, "Повысить уровень Престижа\t{FFCC00}10 Медалей\n");
	//Неперекупаемый дом
	new ph = Player[playerid][Home];
	if (ph == 0) strcat(StringX, "{afafaf}Неперекупаемый дом (неделя)\t{afafaf}14 Медалей\n");
	else
	{
	    if (Property[ph][pBuyBlock] <= 0) strcat(StringX, "Неперекупаемый дом (неделя)\t{FFCC00}14 Медалей\n");
		else
		{
		    new StrZ[140];
			format(StrZ, sizeof StrZ, "Неперекупаемый дом (опл. до {00CCCC}%s{FFFFFF})\t{FFCC00}14 Медалей\n", IntDateToStringDate(Property[ph][pBuyBlock]));
			strcat(StringX, StrZ);
		}
	}
    //Неперекупаемый дом
    //obmen medaley
    if(Player[playerid][SPrest] > 0)
	{
	    new MxDay = Player[playerid][SPrest]+1;
		if (MxDay > 4) MxDay = 4;
		format(String, sizeof String, "Получить 1 рубль ({00CCCC}%0.0f{FFFFFF} / %d за сегодня)\t{FFCC00}1 Медаль\n", Player[playerid][GGFromMedals], MxDay);
		strcat(StringX, String);
	}
    //obmen medaley
   	format(String, sizeof String, "Обменять Медали: {FFCC00}%d", Player[playerid][Medals]);
	ShowPlayerDialog(playerid, DIALOG_MEDALTRADE, 5, String, StringX, "Выбрать", "Назад");
	return 1;
}//Обмен медалей

stock LeaveEvent(playerid,type)
{
    if (JoinEvent[playerid] == EVENT_PVP) return 1;
    //JoinEvent[playerid] = 0;
	//InEvent[playerid] = 0;
    new String[120];
	switch(type)
	{
	    case EVENT_DM:
	    {
	        //if (DMTimer < 4 && DMTimeToEnd > 176) return SendClientMessage(playerid,COLOR_DM," Запрещен выход с этого ивента во время его старта.");
	    	SendClientMessage(playerid,COLOR_DM,"Вы покинули десматч.");
	    	JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			if (DMTimeToEnd > 0){ResetPlayerWeapons(playerid); ShowClanZones(playerid); LSpawnPlayer(playerid);}
			DMPlayers--;
			if (DMTimeToEnd > 0) LeaveDM[playerid] = unixtime+15;
			format(String,sizeof(String),"%s[%d] покинул десматч.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_DM) SendClientMessage(cid,COLOR_DM,String);
			}
	    }
	    case EVENT_DERBY:
	    {
	        //if (DerbyTimer < 4 && DerbyTimeToEnd > 856) return SendClientMessage(playerid,COLOR_DERBY," Запрещен выход с этого ивента во время его старта.");
	        SendClientMessage(playerid,COLOR_DERBY,"Вы покинули дерби.");
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			LACSH[playerid] = 5;DerbyPlayers--;
			if (DerbyTimeToEnd > 0){ResetPlayerWeapons(playerid); ShowClanZones(playerid); LSpawnPlayer(playerid);}
			format(String,sizeof(String),"%s[%d] покинул дерби.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_DERBY) SendClientMessage(cid,COLOR_DERBY,String);
			}
		}
	    case EVENT_ZOMBIE:
	    {
        	if (ZMTimeToEnd > 0)
			{
    			ShowPlayerDialog(playerid, DIALOG_LEAVEZM, 0, "Покинуть зомби-выживание?", "{FF0000}Внимание! Покинув зомби-выживание вы подставите свою команду!\nВ следствие чего вам будет запрещено участвовать в зомби-выживании в течение получаса!\n\n{FFFFFF}Вы уверены, что хотите покинуть зомби-выживание?", "Да", "Отмена");
				return 1;
			}
			
			JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			ZMStarted[playerid] = 0;
			ZMIsPlayerIsZombie[playerid] = 0;
			ZMIsPlayerIsTank[playerid] = 0;
			SendClientMessage(playerid,COLOR_ZOMBIE,"Вы покинули Зомби-Выживание.");
			ZMPlayers--;
			format(String,sizeof(String),"%s[%d] покинул зомби-выживание.", PlayerName[playerid], playerid);
			foreach(Player, cid) if (cid != playerid && JoinEvent[cid] == EVENT_ZOMBIE) SendClientMessage(cid,COLOR_ZOMBIE,String);
		}
	    case EVENT_RACE:
	    {
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
	        DestroyVehicle(FRCarID[playerid]);
			LACSH[playerid] = 5;FRPlayers--;
			FRStarted[playerid] = 0;
			SendClientMessage(playerid,COLOR_RACE,"Вы покинули гонку.");
			//DisableRemoteVehicleCollisions(playerid, 0);
			SetPlayerVirtualWorld(playerid,0);LSpawnPlayer(playerid);
			ShowClanZones(playerid);
			DisablePlayerCheckpoint(playerid);
			format(String,sizeof(String),"%s[%d] покинул гонку.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_RACE) SendClientMessage(cid,COLOR_RACE,String);
			}
	    }
	    case EVENT_XRACE:
	    {
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			DestroyVehicle(XRCarID[playerid]);XRCarID[playerid] = 0;
			LACSH[playerid] = 5;XRPlayers--;
			XRStarted[playerid] = 0;
			SendClientMessage(playerid,COLOR_XR,"Вы покинули легендарную гонку.");
			ShowClanZones(playerid);
			SetPlayerVirtualWorld(playerid,0);LSpawnPlayer(playerid);
			//DisableRemoteVehicleCollisions(playerid, 0);
			DisablePlayerRaceCheckpoint(playerid);
			format(String,sizeof(String),"%s[%d] покинул легендарную гонку.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_XRACE) SendClientMessage(cid,COLOR_XR,String);
			}
		}
	    case EVENT_GUNGAME:
	    {
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			SendClientMessage(playerid,COLOR_GG,"Вы покинули Гонку Вооружений."); GGPlayers--;
			if (GGTimeToEnd > 0){SetPlayerVirtualWorld(playerid,0);ResetPlayerWeapons(playerid);LSpawnPlayer(playerid); LeaveGG[playerid] = unixtime+15; ShowClanZones(playerid);}
			format(String,sizeof(String),"%s[%d] покинул гонку вооружений.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_GUNGAME) SendClientMessage(cid,COLOR_GG,String);
			}
		}
	    case EVENT_TDM:
	    {
	    	SendClientMessage(playerid,COLOR_TDM,"Вы покинули командный десматч.");
	    	JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			if (TDMTimeToEnd > 0)
			{
			    SetPVarInt(playerid, "LeaveTDM", unixtime+15);
				if(TDMTeam[playerid] == 1) TDMGrove--;
				else if(TDMTeam[playerid] == 2) TDMBallas--;
				ResetPlayerWeapons(playerid);LSpawnPlayer(playerid);
				TDMTeam[playerid] = 0;
				ShowClanZones(playerid);
			}
			TDMPlayers--;
			format(String,sizeof(String),"%s[%d] покинул командный десматч.", PlayerName[playerid], playerid);
			foreach(Player, cid) {if(cid != playerid && JoinEvent[cid] == EVENT_TDM) SendClientMessage(cid,COLOR_TDM,String);}
		}
	    case EVENT_PARK:
	    {
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
	        SendClientMessage(playerid,COLOR_PARK,"Вы покинули паркур.");
	    	PRPlayers--;
			PRStarted[playerid] = 0;
			if (PRTimeToEnd > 0)
			{
			    DisablePlayerCheckpoint(playerid);
				SetPlayerVirtualWorld(playerid,0);
				ResetPlayerWeapons(playerid);
				LSpawnPlayer(playerid);
				ShowClanZones(playerid);
				//DestroyDynamicPickup(PRPickup[playerid]);
			}
			format(String,sizeof(String),"%s[%d] покинул паркур.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_PARK) SendClientMessage(cid,COLOR_PARK,String);
			}
		}
	    case EVENT_DRACE:
	    {
	        //if (DRTimer < 4 && DRTimeToEnd > 856) return SendClientMessage(playerid,COLOR_DRACE," Запрещен выход с ивента во время его старта.");
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			SendClientMessage(playerid,COLOR_DRACE,"Вы покинули гонку на выживание.");
			LACSH[playerid] = 5;DRPlayers--;
			if (DRTimeToEnd > 0){ResetPlayerWeapons(playerid); LSpawnPlayer(playerid); ShowClanZones(playerid);}
			format(String,sizeof(String),"%s[%d] покинул гонку на выживание.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_DRACE) SendClientMessage(cid,COLOR_DRACE,String);
			}
		}
		case EVENT_BATTLE:
	    {
	        JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			SendClientMessage(playerid,COLOR_BATTLE,"Вы покинули битву до последнего."); BTPlayers--;
			BTStarted[playerid] = 0; BTPlayers--;
	
			if (/*BTTimeToEnd > 0*/BTTimer <= -1)
			{
				HideBtTDS(playerid);
				RemovePlayerFromVehicle(playerid); //исправляет баг
				SetPlayerVirtualWorld(playerid,0);
				ResetPlayerWeapons(playerid);
				LSpawnPlayer(playerid);
				ShowClanZones(playerid);
				SetPlayerSkillLevel(playerid, WEAPONSKILL_PISTOL, 999);
				SetPlayerSkillLevel(playerid, WEAPONSKILL_SAWNOFF_SHOTGUN, 999);
				SetPlayerSkillLevel(playerid, WEAPONSKILL_MICRO_UZI, 999);
				new alived[16]; format(alived, sizeof alived, "Players: %d", BTPlayers); TextDrawSetString(BTPlayersTD, alived);
			}
			format(String,sizeof(String),"%s[%d] покинул битву до последнего.", PlayerName[playerid], playerid);
			foreach(Player, cid)
			{
				if(cid != playerid && JoinEvent[cid] == EVENT_BATTLE) SendClientMessage(cid,COLOR_BATTLE,String);
			}
		}
		/*case EVENT_PDM:
	    {
	    	SendClientMessage(playerid,COLOR_PDM,"Вы покинули захват точки.");
	    	JoinEvent[playerid] = 0;
			InEvent[playerid] = 0;
			if (PDMTimeToEnd > 0)
			{
			    SetPVarInt(playerid, "LeavePDM", unixtime+15);
				if(PDMTeam[playerid] == 1) PDMBlue--;
				else if(PDMTeam[playerid] == 2) PDMRed--;
				ResetPlayerWeapons(playerid);LSpawnPlayer(playerid);
				PDMTeam[playerid] = 0;
				ShowClanZones(playerid);
			}
			PDMPlayers--;
			format(String,sizeof(String),"%s[%d] покинул захват точки.", PlayerName[playerid], playerid);
			foreach(Player, cid) {if(cid != playerid && JoinEvent[cid] == EVENT_PDM) SendClientMessage(cid,COLOR_PDM,String);}
		}*/
		default: return 1;
 	}
	return 1;
}

stock AddACashLost(playerid,amount)
{
	if(Player[playerid][SlivBlock] == -1)
	{
	    Player[playerid][SlivBlock] = nowday+amount;
	}
	else {Player[playerid][SlivBlock] += amount;}
	return 1;
}

//Месячный Рейтинг
stock UpdateTopOperationXP()
{
    mysql_function_query(connects, "SELECT * FROM `accounts` ORDER BY `OpXP` DESC LIMIT 100", true, "UpdateTopOperationXPCallback", "d", 0);
	return 1;
}

forward UpdateTopOperationXPCallback(int);
public UpdateTopOperationXPCallback(int)
{
	new rows, fields; cache_get_data(rows, fields);
	if (!rows) return 1; //Нет записей
	new str[80], opName[24], opXP;
	TopOperationXP = "№\tИгрок\tXP\n";

	for (new i = 0; i < rows; i++)
	{
		cache_get_field_content(i, "PName", opName, 1, 24);
		opXP = cache_get_field_content_int(i, "OpXP");

		//Отображает не более 100 игроков, но если есть Пустые строки, то не более 20
		if (opXP > 0)
		{
			format(str, sizeof str, "{FFFF00}%i \t%s \t{AFAFAF}%d \n", i+1, opName, opXP);
			strcat(TopOperationXP, str);
		}
		else if (i < 20)
		{
			format(str, sizeof str, "{FFFF00}%i \t{AFAFAF}- \t{AFAFAF}0 \n", i+1);
			strcat(TopOperationXP, str);
		}
	}

	format(str, sizeof str, "%d.%d.%d в %d:%d:%d |   TOP: Pейтинг игроков обновлен.", Day, Month, Year, hour, minute, second);
	WriteLog("GlobalLog", str); return 1;
}



stock UpdateTopOperationGG()
{
    mysql_function_query(connects, "SELECT * FROM `accounts` ORDER BY `OpGG` DESC LIMIT 100", true, "UpdateTopOperationGGCallback", "d", 0);
	return 1;
}

forward UpdateTopOperationGGCallback(int);
public UpdateTopOperationGGCallback(int)
{
	new rows, fields; cache_get_data(rows, fields);
	if (!rows) return 1; //Нет записей
	new str[80], opName[24], Float: opGG;
	TopOperationGG = "№\tИгрок\n";

	for (new i = 0; i < rows; i++)
	{
		cache_get_field_content(i, "PName", opName, 1, 24);
		opGG = cache_get_field_content_float(i, "OpGG");

		//Отображает не более 100 игроков, но если есть Пустые строки, то не более 20
		if (opGG > 0)
		{
			format(str, sizeof str, "{FFFF00}%i \t%s \n", i+1, opName);
			strcat(TopOperationGG, str);
		}
		else if (i < 20)
		{
			format(str, sizeof str, "{FFFF00}%i \t{AFAFAF}- \n", i+1);
			strcat(TopOperationGG, str);
		}
	}

	format(str, sizeof str, "%d.%d.%d в %d:%d:%d |   TOP: Pейтинг донатеров обновлен.", Day, Month, Year, hour, minute, second);
	WriteLog("GlobalLog", str); return 1;
}

stock GiveSecretSkillsReward(name[], score)
{
	new str[260];
	mysql_format(connects, str, sizeof str, "UPDATE `pupdate` SET `AGold`=`AGold`+'%d' WHERE `PName` = '%s';", score, name);
	mysql_query(connects, str, false);
}

stock FinishTopOperationXP()
{
	if (ServConf[1] == 1) return 1;
	//if (Server[TestMode] == 1) return print("[WARNING] Награды за рейтинг игроков не были выданы, так как сервер работает в тестовом режиме!");
    mysql_function_query(connects, "SELECT * FROM `accounts` ORDER BY `OpXP` DESC LIMIT 50", true, "FinishTopOperationXPCallback", "d", 0);
	return 1;
}

forward FinishTopOperationXPCallback(int);
public FinishTopOperationXPCallback(int)
{
	new rows, fields; cache_get_data(rows, fields);
	if (!rows) return 1; //Нет записей
	new str[80], opName[24], opXP;

	for (new i = 0; i < rows; i++)
	{
		cache_get_field_content(i, "PName", opName, 1, 24);
		opXP = cache_get_field_content_int(i, "OpXP");
		if (opXP <= 0) continue;

		if (i < 5) GiveSecretSkillsReward(opName, 250); //1 - 5 место
		else if (i < 10) GiveSecretSkillsReward(opName, 150); //6 - 10 место
		else if (i < 20) GiveSecretSkillsReward(opName, 100); //11 - 20
		else if (i < 35) GiveSecretSkillsReward(opName, 50); //21 - 35
		else GiveSecretSkillsReward(opName, 30); //36 - 50
	}

	foreach(Player, cid) Player[cid][OpXP] = 0; //Обнуляем рейтинг игроков
	mysql_query(connects, "UPDATE `accounts` SET `OpXP` = 0 WHERE 1", false); //Обнуляем рейтинг игроков
	UpdateTopOperationXP();
	format(str, sizeof str, "%d.%d.%d в %d:%d:%d |   TOP: Награды за рейтинг игроков начислены.", Day, Month, Year, hour, minute, second);
	WriteLog("GlobalLog", str); return 1;
}

stock FinishTopOperationGG()
{
    if (ServConf[1] == 1) return 1;
	//if (Server[TestMode] == 1) return print("[WARNING] Награды за рейтинг донатеров не были выданы, так как сервер работает в тестовом режиме!");
    mysql_function_query(connects, "SELECT * FROM `accounts` ORDER BY `OpGG` DESC LIMIT 50", true, "FinishTopOperationGGCallback", "d", 0);
	return 1;
}

forward FinishTopOperationGGCallback(int);
public FinishTopOperationGGCallback(int)
{
	new rows, fields; cache_get_data(rows, fields);
	if (!rows) return 1; //Нет записей
	new str[80], opName[24], Float: opGG;

	for (new i = 0; i < rows; i++)
	{
		cache_get_field_content(i, "PName", opName, 1, 24);
		opGG = cache_get_field_content_float(i, "OpGG");
		if (opGG <= 0.0) continue;

		if (i == 0) GiveSecretSkillsReward(opName, 800); //1 место
		else if (i == 1) GiveSecretSkillsReward(opName, 700); //2 место
		else if (i == 2) GiveSecretSkillsReward(opName, 600); //3 место
		else if (i < 6) GiveSecretSkillsReward(opName, 400); //4 - 6 место
		else if (i < 10) GiveSecretSkillsReward(opName, 350); //7 - 10 место
		else if (i < 20) GiveSecretSkillsReward(opName, 300); //11 - 20 место
		else if (i < 30) GiveSecretSkillsReward(opName, 150); //21 - 30 место
		else GiveSecretSkillsReward(opName, 100); //31 - 50 место
	}

	foreach(Player, cid) Player[cid][OpGG] = 0.0; //Обнуляем рейтинг донатеров
	mysql_query(connects, "UPDATE `accounts` SET `OpGG` = 0 WHERE 1", false); //Обнуляем рейтинг донатеров
	UpdateTopOperationGG();
	format(str, sizeof str, "%d.%d.%d в %d:%d:%d |   TOP: Награды за рейтинг донатеров начислены.", Day, Month, Year, hour, minute, second);
	WriteLog("GlobalLog", str); return 1;
}


stock TopListDialog(playerid)
{
	ShowPlayerDialog(playerid, DIALOG_TOP, 2, "Топ сервера:", "Топ игроков месяца по опыту (ХП)\nТоп игроков месяца по донату\nТоп кланы сервера", "Выбрать", "Закрыть");
	return 1;
}

stock UpdateTopClans()
{
    mysql_function_query(connects, "SELECT * FROM `clans` ORDER BY `Level` DESC LIMIT 15", true, "UpdateTopClansCallback", "d", 0);
	return 1;
}

forward UpdateTopClansCallback(int);
public UpdateTopClansCallback(int)
{
	new rows, fields; cache_get_data(rows, fields);
	if (!rows) return 1; //Нет записей
	new str[80], clName[50], clvl;
	TopClanArray = "№\tКлан\tУровень\n";

	for (new i = 0; i < rows; i++)
	{
		cache_get_field_content(i, "Name", clName, 1, 64);
		clvl = cache_get_field_content_int(i, "Level");

		//Отображает не более 100 игроков, но если есть Пустые строки, то не более 20
		if (clvl > 0)
		{
			format(str, sizeof str, "{FFFF00}%i \t%s \t{AFAFAF}%d \n", i+1, clName, clvl);
			strcat(TopClanArray, str);
		}
		else if (i < 5)
		{
			format(str, sizeof str, "{FFFF00}%i \t{AFAFAF}Нет \t{AFAFAF}0 \n", i+1);
			strcat(TopClanArray, str);
		}
	}

	format(str, sizeof str, "%d.%d.%d в %d:%d:%d |   TOP: Pейтинг кланов обновлен.", Day, Month, Year, hour, minute, second);
	WriteLog("GlobalLog", str); return 1;
}

stock SendClanMessage(clanid, stext[], tcolor)
{
    foreach(Player, cid) if (Player[cid][MyClan] == clanid && Logged[cid] == 1){SendClientMessage(cid, tcolor, stext);}
    return 1;
}

public OnVehicleDamageStatusUpdate(vehicleid, playerid)
{
    //new string[128];
    //format(string, sizeof(string), "Вы повредили транспорт номер %d", vehicleid);
    //SendClientMessage(playerid, COLOR_WHITE, string);
    return 1;
}

stock UpdateColor(playerid)
{
	if (playerid > MAX_PLAYERS || playerid < 0) return 0;
    if (Logged[playerid] == 0) SetPlayerColor(playerid,0xAFAFAFFF); //не залогинелся
    if (InEvent[playerid] == EVENT_TDM)
    {
        if(TDMTeam[playerid] == 1) SetPlayerColor(playerid,0xFFFFFFFF);
        else if(TDMTeam[playerid] == 2) SetPlayerColor(playerid,0x000000FF);
	}
	/*else if (InEvent[playerid] == EVENT_PDM)
    {
        if(PDMTeam[playerid] == 1) SetPlayerColor(playerid,0x5882FAFF);
        else if(PDMTeam[playerid] == 2) SetPlayerColor(playerid,0xFA5882FF);
	}*/
    else
    {
		new colorid = PlayerColor[playerid], clanid = Player[playerid][MyClan];
		if (clanid < 1 || (Clan[clanid][cBase] < 1 && Clan[clanid][Imm] == 0) ) colorid = 0; //Если игрок не в клане или если у клана нет штаба - цвет ника будет серым
		if (Player[playerid][Invisible] > 0 && Clan[clanid][NowWarZone] != 0) {Player[playerid][Invisible] = 0; SendClientMessage(playerid,COLOR_DRACE,"Невидимость отключена на время капта.");}
	    if (Player[playerid][Invisible] > 0 && InEvent[playerid] == 0) SetPlayerColor(playerid, ClanColorInvisible[colorid]);//С невидимостью
		else
		{//Без невидимости или в соревах
			if (Player[playerid][PrestigeColor] >= 0) colorid = Player[playerid][PrestigeColor]; //Цвет 7-го Престижа
			SetPlayerColor(playerid, ClanColor[colorid]);
			if (InEvent[playerid] == EVENT_ZOMBIE && ZMIsPlayerIsZombie[playerid] > 0 || DRStarted[playerid] == 1 || BTStarted[playerid] == 1) SetPlayerColor(playerid, ClanColorInvisible[colorid]);
		}//Без невидимости или в соревах
	}
    
	return 1;
}

stock GetClanMaxZones(clanid)
{
    new mzones;
	switch(Clan[clanid][cLevel])
	{
	    case 1..4: mzones = 0;
	    case 5..9: mzones = 1;
	    case 10..14: mzones = 2;
	    case 15..29: mzones = 3;
	    case 30..79: mzones = 4;
	    case 80..199: mzones = 5;
	    default: mzones = 6;
 	}
 	return mzones;
}

stock PlayerChangeBaseInterior(playerid)
{
    SendClientMessage(playerid, 0x008E00FF,"Нажимайте {FFFF00}<{008E00} и {FFFF00}>{008E00}, чтобы выбрать нужный интерьер.");
    SetPVarInt(playerid, "ChInt", 1);
    SetPlayerCameraPos(playerid, BByuInfo[0][ltX], BByuInfo[0][ltY], BByuInfo[0][ltZ]);
	SetPlayerCameraLookAt(playerid, BByuInfo[0][ltoX], BByuInfo[0][ltoY], BByuInfo[0][ltoZ]);
	SetPlayerInterior(playerid,BIntInfo[0][binter]);
	SetPlayerPos(playerid, BIntInfo[0][inX],BIntInfo[0][inY],BIntInfo[0][inZ]);
	SetPlayerVirtualWorld(playerid, 1999-playerid);
	TogglePlayerControllable(playerid, 0);
	for(new i; i<6; i++) TextDrawShowForPlayer(playerid, IntChangeTD[i]);
	
	PIntChangeTD[playerid] = CreatePlayerTextDraw(playerid, 319.516937, 338.750122, "ID: 1 ~g~0");
	PlayerTextDrawLetterSize(playerid, PIntChangeTD[playerid], 0.618330, 2.311665);
	PlayerTextDrawAlignment(playerid, PIntChangeTD[playerid], 2);
	PlayerTextDrawColor(playerid, PIntChangeTD[playerid], -1);
	PlayerTextDrawSetShadow(playerid, PIntChangeTD[playerid], 0);
	PlayerTextDrawSetOutline(playerid, PIntChangeTD[playerid], 1);
	PlayerTextDrawBackgroundColor(playerid, PIntChangeTD[playerid], 255);
	PlayerTextDrawFont(playerid, PIntChangeTD[playerid], 2);
	PlayerTextDrawSetProportional(playerid, PIntChangeTD[playerid], 1);
	PlayerTextDrawSetShadow(playerid, PIntChangeTD[playerid], 0);
	
	PlayerTextDrawShow(playerid, PIntChangeTD[playerid]);
	
	SelectTextDraw(playerid, 0x00FF00FF);
	return 1;
}

stock UpdateCostTD(playerid)
{
    new string[30], cint = GetPVarInt(playerid,"ChInt")-1, clanid = Player[playerid][MyClan];
    if(Clan[clanid][InfPoints] < BByuInfo[cint][icost]) format(string, sizeof(string), "ID: %d ~r~%d", cint+1, BByuInfo[cint][icost]);
    else format(string, sizeof(string), "ID: %d ~g~%d", cint+1, BByuInfo[cint][icost]);
    PlayerTextDrawSetString(playerid, PIntChangeTD[playerid], string);
	return 1;
}

stock LotteryPlayer(playerid)
{
	if(Player[playerid][Lottery] < 1) return SendClientMessage(playerid,COLOR_GREY,"LOTTERY: У вас нет лотерейных билетов! Купить их можно в /shop.");
    Player[playerid][Lottery]--;
	new ch = random(100),ch2 = random(2),String[140];
	switch(ch)
	{
	    case 94: //1%
	    {
			//add 600 gold OR +1 prestige or 100lvl
			if(ch2 == 0) {Player[playerid][Gold] += 600; format(String,sizeof(String),"LOTTERY: %s[%d] сорвал огромный куш в лотерее и выиграл 600 золота для /gold!", PlayerName[playerid], playerid);}
			else
			{
				if(Player[playerid][Prestige] < 10) {Player[playerid][Prestige] += 1; format(String,sizeof(String),"LOTTERY: %s[%d] сорвал огромный куш в лотерее и выиграл +1 престиж!", PlayerName[playerid], playerid);}
			    else {Player[playerid][Level] += 100; format(String,sizeof(String),"LOTTERY: %s[%d] сорвал огромный куш в лотерее и выиграл +100 уровней!", PlayerName[playerid], playerid);}
			}
			SendClientMessageToAll(COLOR_YELLOW,String);
		}
		case 1,2: //2%
		{
			//add +1 vip OR 500 gold
			if(ch2 == 0) {Player[playerid][GPremium] += 1; format(String,sizeof(String),"LOTTERY: %s[%d] сорвал куш в лотерее и выиграл +1 VIP!", PlayerName[playerid], playerid);}
			else {Player[playerid][Gold] += 300; format(String,sizeof(String),"LOTTERY: %s[%d] сорвал куш в лотерее и выиграл +300 золота для /gold!", PlayerName[playerid], playerid);}
            SendClientMessageToAll(COLOR_YELLOW,String);
		}
		case 3..5: //3%
		{
		    //add 100 gold OR 100 rub
		    if(ch2 == 0) {Player[playerid][GameGold] += 100; format(String,sizeof(String),"LOTTERY: %s[%d] выиграл в лотерее 100 RUB для /shop!", PlayerName[playerid], playerid);}
			else {Player[playerid][Gold] += 100; format(String,sizeof(String),"LOTTERY: %s[%d] выиграл в лотерее +100 золота для /gold!", PlayerName[playerid], playerid);}
            SendClientMessageToAll(COLOR_YELLOW,String);
		}
		case 6..10: //5%
		{
		    //add 45 RUB OR 50 gold
		    if(ch2 == 0) {Player[playerid][GameGold] += 45; format(String,sizeof(String),"LOTTERY: %s[%d] выиграл в лотерее 45 RUB для /shop!", PlayerName[playerid], playerid);}
			else {Player[playerid][Gold] += 50; format(String,sizeof(String),"LOTTERY: %s[%d] выиграл в лотерее +50 золота для /gold!", PlayerName[playerid], playerid);}
            SendClientMessageToAll(COLOR_YELLOW,String);
		}
		case 11..65: //40%
		{
		    //add 10 - 30 rub OR 500k - 1,5kk money
            if(ch2 == 0) {new Float:ch3 = 10.0 + float(random(18)); Player[playerid][GameGold] += ch3; format(String,sizeof(String),"LOTTERY: Ваш выигрыш: %.0f рублей для /shop!", ch3);}
			else {new ch3 = 500000 + random(1500000); Player[playerid][Cash] += ch3; format(String,sizeof(String),"LOTTERY: Ваш выигрыш: %d $!", ch3);}
            SendClientMessage(playerid,COLOR_YELLOW,String);
		}
		case 66..75: //10%
		{
		    //add 1 lottery
		    Player[playerid][Lottery] += 1;
		    SendClientMessage(playerid,COLOR_YELLOW,"LOTTERY: Ваш выигрыш: 1 лотерейный билет (/lottery)!");
		}
		case 76..88: //10%
		{
		    //add 2 lottery
		    Player[playerid][Cash] += 3000000;
		    SendClientMessage(playerid,COLOR_YELLOW,"LOTTERY: Ваш выигрыш: 3.000.000$!");
		}
		default: //10%
		{
		    //add 7 day no-money-lost
		    AddACashLost(playerid,7);
		    SendClientMessage(playerid,COLOR_YELLOW,"LOTTERY: Ваш выигрыш: 1 неделя несливайки!");
		}
 	}
 	format(String,sizeof(String),"LOTTERY: У вас осталось {ffffff}%d{afafaf} лотерейных билетов.", Player[playerid][Lottery]);
 	SendClientMessage(playerid,COLOR_GREY,String);
 	format(String,sizeof(String),"LOTTERY: Player %s get %d / %d.", PlayerName[playerid], ch, ch2);
 	WriteLog("Lottery", String);
	return 1;
}

stock UpdatePropertyInterior(houseid)
{
    if (houseid < 1 || houseid >= MAX_PROPERTY) return 1; //ошибочный ид
    if (Property[houseid][pInter] > 5) return 1; //особые инты
    if (Property[houseid][pBuyBlock] > 0) Property[houseid][pInter] = 5; //неперкупаемый
	else if (Property[houseid][pPrice] >= 80000000) Property[houseid][pInter] = 4; //80кк и более
	else if (Property[houseid][pPrice] >= 60000000) Property[houseid][pInter] = 3; //60кк
	else if (Property[houseid][pPrice] >= 40000000) Property[houseid][pInter] = 2; //40кк
	else if (Property[houseid][pPrice] >= 20000000) Property[houseid][pInter] = 1; //20кк
	else Property[houseid][pInter] = 0; //10кк
	return 1;
}

stock CreatePlayerTDS(playerid)
{
    PSpecInfo[playerid] = CreatePlayerTextDraw(playerid, 2, 436, "spectate");
	PlayerTextDrawFont(playerid, PSpecInfo[playerid] , 1);
	PlayerTextDrawLetterSize(playerid, PSpecInfo[playerid] , 0.3, 1.2);
	PlayerTextDrawColor(playerid, PSpecInfo[playerid] , 0xFFFF00FF);
	PlayerTextDrawSetOutline(playerid, PSpecInfo[playerid] , 1);
	PlayerTextDrawSetProportional(playerid, PSpecInfo[playerid] , true);
	PlayerTextDrawSetShadow(playerid, PSpecInfo[playerid] , 0);

	SpecInfoVeh[playerid] = CreatePlayerTextDraw(playerid, 2, 425, "car-spectate");
	PlayerTextDrawFont(playerid, SpecInfoVeh[playerid] , 1);
	PlayerTextDrawLetterSize(playerid, SpecInfoVeh[playerid] , 0.3, 1.2);
	PlayerTextDrawColor(playerid, SpecInfoVeh[playerid] , 0x457EFFFF);
	PlayerTextDrawSetOutline(playerid, SpecInfoVeh[playerid] , 1);
	PlayerTextDrawSetProportional(playerid, SpecInfoVeh[playerid] , true);
	PlayerTextDrawSetShadow(playerid, SpecInfoVeh[playerid] , 0);

	TextDrawSpeedo[playerid] = CreatePlayerTextDraw(playerid, 85.799591, 318.080932, "speedo");
	PlayerTextDrawLetterSize(playerid, TextDrawSpeedo[playerid], 0.408499, 0.967778);
	PlayerTextDrawTextSize(playerid, TextDrawSpeedo[playerid], 0.000000, 95.000000);
	PlayerTextDrawAlignment(playerid, TextDrawSpeedo[playerid], 2);
	PlayerTextDrawColor(playerid, TextDrawSpeedo[playerid], 10551295);
	PlayerTextDrawUseBox(playerid, TextDrawSpeedo[playerid], 1);
	PlayerTextDrawBoxColor(playerid, TextDrawSpeedo[playerid], 63);
	PlayerTextDrawSetOutline(playerid, TextDrawSpeedo[playerid], 1);
	PlayerTextDrawBackgroundColor(playerid, TextDrawSpeedo[playerid], 255);
	PlayerTextDrawFont(playerid, TextDrawSpeedo[playerid], 2);
	PlayerTextDrawSetProportional(playerid, TextDrawSpeedo[playerid], 1);

	//Таймер времени на работе
	TextDrawWorkTimer[playerid] = CreatePlayerTextDraw(playerid, 40, 300, "00:00");
	PlayerTextDrawFont(playerid, TextDrawWorkTimer[playerid] , 1);
	PlayerTextDrawLetterSize(playerid, TextDrawWorkTimer[playerid] , 0.6, 2.4);
	PlayerTextDrawColor(playerid, TextDrawWorkTimer[playerid] , 0x457EFFFF);
	PlayerTextDrawSetOutline(playerid, TextDrawWorkTimer[playerid] , 1);
	PlayerTextDrawSetProportional(playerid, TextDrawWorkTimer[playerid] , true);
	PlayerTextDrawSetShadow(playerid, TextDrawWorkTimer[playerid] , 0);
	
	//позиция на пубге
	PlayerPosTD[playerid] = CreatePlayerTextDraw(playerid, 0.0, 0.0, "ld_beat:cring");
}



stock CreateBTLoot()
{
	new LP = MAX_LOOT-2, LP2;
    for(new i=0;i<LP;i++)
    {
		//LP = random(10);
		//if(LP < 2) CreateLootBox(LootPos[i][fPosX], LootPos[i][fPosY], LootPos[i][fPosZ]-0.87, float(random(360)), "Ящик\nОткрыть [C]");
		CreateLoot(LootPos[i][fPosX], LootPos[i][fPosY], LootPos[i][fPosZ]-0.87, float(random(360)));
    }
    for(new i=0;i<15;i++)
    {
		LP = random(sizeof(LootPos)), LP2 = random(2);
		if(LP2 == 0) CreateLoot(LootPos[LP][fPosX]-frandom(2), LootPos[LP][fPosY]+frandom(2), LootPos[LP][fPosZ]-0.87, float(random(360)), 18);
		else CreateLoot(LootPos[LP][fPosX]+frandom(2), LootPos[LP][fPosY]-frandom(2), LootPos[LP][fPosZ]-0.87, float(random(360)), 19);
    }
    
	return 1;
}

stock DestroyLoot(lootid)
{
	foreach(Player, i) {if(GetPVarInt(i,"PLoot") == lootid) SetPVarInt(i,"PLoot",-1);}
    DestroyDynamicArea(lootid);
    DestroyDynamicObject(LootObj[lootid]);
    DestroyDynamic3DTextLabel(LootObj3D[lootid]);
    LootType[lootid] = -1; LootCount[lootid] = 0;
}

stock CreateLoot(Float: x, Float: y, Float: z, Float: Angle, loottype = -1, count = -1)
{
    if (loottype == -1) {loottype = random(MAX_WLOOT);}
    new PLCount = CreateDynamicSphere(x, y, z, 1.2, BATTLE_WORLD, -1, -1);
    AreaType[PLCount] = 3; //тип зоны - лут на БТ

	LootType[PLCount] = loottype;
    if(count == -1) LootCount[PLCount] = Loot[loottype][DAmount];
	else LootCount[PLCount] = count;
	
    new String[120]; format(String,sizeof(String),"%s (%d)\nПодобрать {2E64FE}[C]", Loot[loottype][LName], LootCount[PLCount]);
    LootObj3D[PLCount] = CreateDynamic3DTextLabel(String, 0xffffffAA, x, y, z+0.3, 10.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, -1, BATTLE_WORLD, 0, -1, 11.0);
    LootObj[PLCount] = CreateDynamicObject(Loot[loottype][LObj], x, y, z, 90.0, 0.0, Angle, BATTLE_WORLD, -1, -1, 50.0);
}

/*stock CreateLootBox(Float: x, Float: y, Float: z, Float: Angle, text[], items[5] = {-1})
{
    new PLCount = CreateDynamicSphere(x, y, z, 1.5, BATTLE_WORLD, -1, -1);
    AreaType[PLCount] = 4; //тип зоны - ящик с лутом
    LootObj3D[PLCount] = CreateDynamic3DTextLabel(text, 0xffffffAA, x, y, z+0.3, 10.0, INVALID_PLAYER_ID, INVALID_VEHICLE_ID, -1, BATTLE_WORLD, 0, -1, 11.0);
    LootObj[PLCount] = CreateDynamicObject(2358, x, y, z, 0.0, 0.0, Angle, BATTLE_WORLD, -1, -1, 50.0);
    for(new j = 0; j<sizeof(items); j++) { if(items[j] == -1) {LootBoxSlots[PLCount][j] = random(MAX_WLOOT);} else {LootBoxSlots[PLCount][j] = items[j];} }
}*/

stock ReplaceLoot(pointid, newloot, newsteck)
{
    LootType[pointid] = newloot;
    LootCount[pointid] = newsteck;
    new Float: oPos[3];
    GetDynamicObjectPos(LootObj[pointid], oPos[0], oPos[1], oPos[2]);
    DestroyDynamicObject(LootObj[pointid]);
    LootObj[pointid] = CreateDynamicObject(Loot[newloot][LObj], oPos[0], oPos[1], oPos[2], 90.0, 0.0, float(random(360)), BATTLE_WORLD, -1, -1, 50.0);
    new String[120]; format(String,sizeof(String),"%s (%d)\nПодобрать {2E64FE}[C]", Loot[newloot][LName], newsteck);
    UpdateDynamic3DTextLabelText(LootObj3D[pointid], 0xffffffAA, String);
}

stock UpdateBTPosTD(playerid, Float:x, Float:y)
{
	new Float:PsX, Float:PsY;
	PsY = 326.0 - 106.0 * y / 3000.0;
	PsX = 541.5 + 91.0 * x / 3000.0;

	PlayerTextDrawDestroy(playerid, PlayerPosTD[playerid]);

	PlayerPosTD[playerid] = CreatePlayerTextDraw(playerid, PsX, PsY, "ld_beat:cring"); //hud:arrow
	PlayerTextDrawLetterSize(playerid, PlayerPosTD[playerid], 0.0, 0.0);
	PlayerTextDrawTextSize(playerid, PlayerPosTD[playerid], 14.0, 20.0);
	PlayerTextDrawAlignment(playerid, PlayerPosTD[playerid], 1);
	PlayerTextDrawColor(playerid, PlayerPosTD[playerid], -16776961);
	PlayerTextDrawSetShadow(playerid, PlayerPosTD[playerid], 0);
	PlayerTextDrawSetOutline(playerid, PlayerPosTD[playerid], 0);
	PlayerTextDrawBackgroundColor(playerid, PlayerPosTD[playerid], 255);
	PlayerTextDrawFont(playerid, PlayerPosTD[playerid], 4);
	PlayerTextDrawSetProportional(playerid, PlayerPosTD[playerid], 0);
	PlayerTextDrawSetShadow(playerid, PlayerPosTD[playerid], 0);

	PlayerTextDrawShow(playerid, PlayerPosTD[playerid]);
}

/*stock ChangeCenterold(type)
{
	//OldX = CenX; OldY = CenY;
	switch(type)
	{
		case 1: {CenX = 1450.0 - float(random(2900)); CenY = 1450.0 - float(random(2900));} //1 зона 3100 x 3100
		case 2: {CenX = CenX + 600.0 - float(random(1200)); CenY = CenY + 600.0 - float(random(1200));} //2 зона 1900 x 1900
		case 3: {CenX = CenX + 525.0 - float(random(1050)); CenY = CenY + 525.0 - float(random(1050));} //3 зона 850 x 850
		case 4: {CenX = CenX + 200.0 - float(random(400)); CenY = CenY + 200.0 - float(random(400));} //4 зона 450 x 450
		case 5: {CenX = CenX + 200.0 - float(random(400)); CenY = CenY + 200.0 - float(random(400));} //5 зона 50 x 50
 	}
}*/

stock ChangeCenter(type)
{
    new Float:zsize = BTZone[type-1][ZoneSize]-BTZone[type][ZoneSize];
    CenX = CenX + zsize/2 - frandom(zsize);
    CenY = CenY + zsize/2 - frandom(zsize);
}

stock UpdFirstZone(Float:size, Float:cX, Float:cY, clr)
{
	//MAP
	new Float: SZ_LINE = 7.0;
	for (new i; i<4; i++) {GangZoneDestroy(FirstZone[i]); TextDrawDestroy(FirstZoneTD[i]);}

	FirstZone[0] = GangZoneCreate(cX-size/2, cY+size/2-SZ_LINE, cX+size/2, cY+size/2); // up
	FirstZone[1] = GangZoneCreate(cX-size/2, cY-size/2, cX+size/2, cY-size/2+SZ_LINE); // down
	FirstZone[2] = GangZoneCreate(cX+size/2-SZ_LINE, cY-size/2, cX+size/2, cY+size/2); // right
	FirstZone[3] = GangZoneCreate(cX-size/2, cY-size/2, cX-size/2+SZ_LINE, cY+size/2); // left

	//TD MAP
	//106 / 3000 = 0.035333, 91.0 / 3000.0 = 0.030333
	//457.562774, 232.583175 - map coords
	//182.000000, 212.000000 - map size
	cY = 338.583 - 0.035333 * cY; //new center Y
	cX = 548.563 + 0.030333 * cX; //new center X
	new Float:sizeX, Float:sizeY;
	sizeY = 0.035333*size; sizeX = 0.030333*size; //new sizeX, sizeY

	FirstZoneTD[0] = TextDrawCreate(cX-sizeX/2, cY-sizeY/2, "LD_SPAC:white"); //up
	TextDrawTextSize(FirstZoneTD[0], sizeX, 1.5);
	FirstZoneTD[1] = TextDrawCreate(cX+sizeX/2, cY-sizeY/2, "LD_SPAC:white"); //right
	TextDrawTextSize(FirstZoneTD[1], 1.5, sizeY);
	FirstZoneTD[2] = TextDrawCreate(cX-sizeX/2, cY+sizeY/2, "LD_SPAC:white"); //down
	TextDrawTextSize(FirstZoneTD[2], sizeX, -1.5);
	FirstZoneTD[3] = TextDrawCreate(cX-sizeX/2, cY-sizeY/2, "LD_SPAC:white"); //left
	TextDrawTextSize(FirstZoneTD[3], -1.5, sizeY);

	for (new i; i<4; i++)
	{
	    TextDrawAlignment(FirstZoneTD[i], 1);
		TextDrawColor(FirstZoneTD[i], clr);
		TextDrawFont(FirstZoneTD[i], 4);
	}
}

stock UpdSecondZone(Float:size, Float:cX, Float:cY, clr)
{
	new Float: SZ_LINE = 7.0;
	for (new i; i<4; i++) {GangZoneDestroy(SecondZone[i]); TextDrawDestroy(SecondZoneTD[i]);}
	ZoneXY[0] = cX-size/2;
	ZoneXY[1] = cX+size/2;
	ZoneXY[2] = cY-size/2;
	ZoneXY[3] = cY+size/2;
	SecondZone[0] = GangZoneCreate(ZoneXY[0], ZoneXY[3]-SZ_LINE, ZoneXY[1], ZoneXY[3]); // up
	SecondZone[1] = GangZoneCreate(ZoneXY[0], ZoneXY[2], ZoneXY[1], ZoneXY[2]+SZ_LINE); // down
	SecondZone[2] = GangZoneCreate(ZoneXY[1]-SZ_LINE, ZoneXY[2], ZoneXY[1], ZoneXY[3]); // right
	SecondZone[3] = GangZoneCreate(ZoneXY[0], ZoneXY[2], ZoneXY[0]+SZ_LINE, ZoneXY[3]); // left
	
	//TD MAP
	cY = 338.583 - 0.035333 * cY; //new center Y
	cX = 548.563 + 0.030333 * cX; //new center X
	new Float:sizeX, Float:sizeY;
	sizeY = 0.035333*size; sizeX = 0.030333*size; //new sizeX, sizeY

	SecondZoneTD[0] = TextDrawCreate(cX-sizeX/2, cY-sizeY/2, "ld_dual:white"); //up
	TextDrawTextSize(SecondZoneTD[0], sizeX, 1.5);
	SecondZoneTD[1] = TextDrawCreate(cX+sizeX/2, cY-sizeY/2, "ld_dual:white"); //right
	TextDrawTextSize(SecondZoneTD[1], 1.5, sizeY);
	SecondZoneTD[2] = TextDrawCreate(cX-sizeX/2, cY+sizeY/2, "ld_dual:white"); //down
	TextDrawTextSize(SecondZoneTD[2], sizeX, -1.5);
	SecondZoneTD[3] = TextDrawCreate(cX-sizeX/2, cY-sizeY/2, "ld_dual:white"); //left
	TextDrawTextSize(SecondZoneTD[3], -1.5, sizeY);

	for (new i; i<4; i++)
	{
	    TextDrawAlignment(SecondZoneTD[i], 1);
		TextDrawColor(SecondZoneTD[i], clr);
		TextDrawFont(SecondZoneTD[i], 4);
	}
}


stock ShowHideBTMap(playerid, hide = 1)
{
	if(hide == 1)
	{
	    SetPVarInt(playerid,"UseMap",1);
	    TextDrawShowForPlayer(playerid, BTMap);
	    UpdateBTPosTD(playerid, LastPlayerX[playerid], LastPlayerY[playerid]);
        if(BTTime <= BTZone[1][PZoneTime]) for(new i; i<4; i++) {TextDrawShowForPlayer(playerid, FirstZoneTD[i]); TextDrawShowForPlayer(playerid, SecondZoneTD[i]);}
	}
	else
	{
	    SetPVarInt(playerid,"UseMap",0);
        TextDrawHideForPlayer(playerid, BTMap);
        PlayerTextDrawHide(playerid, PlayerPosTD[playerid]);
        for (new i; i<4; i++) {TextDrawHideForPlayer(playerid, FirstZoneTD[i]); TextDrawHideForPlayer(playerid, SecondZoneTD[i]);}
	}
}

stock ShowPlayerBTInventory(playerid)
{
    new String[120], StringX[480];
    strcat(StringX, "Слот\tНазвание и кол-во\n");
    if(PlayerInv[playerid][0] == -1) strcat(StringX, "{D7DF01}Оружие 1:\t{afafaf}Пусто\n");
	else {format(String,sizeof(String),"{D7DF01}Оружие 1:\t{FFCC00}%s (%d)\n", Loot[PlayerInv[playerid][0]][LName], Slot1Bullets[playerid]); strcat(StringX, String);}
	
    if(PlayerInv[playerid][1] == -1) strcat(StringX, "{D7DF01}Оружие 2:\t{afafaf}Пусто\n");
	else {format(String,sizeof(String),"{D7DF01}Оружие 2:\t{FFCC00}%s (%d)\n", Loot[PlayerInv[playerid][1]][LName], Slot2Bullets[playerid]); strcat(StringX, String);}
	
    if(PlayerInv[playerid][3] == -1) strcat(StringX, "{D7DF01}Метательное:\t{afafaf}Пусто\n");
	else {format(String,sizeof(String),"{D7DF01}Метательное:\t{FFCC00}%s (%d)\n", Loot[PlayerInv[playerid][3]][LName],ThrowCount[playerid]); strcat(StringX, String);}

    if(PlayerInv[playerid][2] == -1) strcat(StringX, "{D7DF01}Холодное:\t{afafaf}Пусто\n");
	else {format(String,sizeof(String),"{D7DF01}Холодное:\t{FFCC00}%s\n", Loot[PlayerInv[playerid][2]][LName]); strcat(StringX, String);}

	strcat(StringX, "Поменять местами 1 и 2 слот\t\n");
	ShowPlayerDialog(playerid, DIALOG_INVENT, 5, "Мой инвентарь:", StringX, "Бросить", "Закрыть");
	return 1;
}



stock UpdatePlayerBTWeapons(playerid, nowweapon)
{
	new invent;
	for(new slot; slot<4; slot++)
	{
	    invent = PlayerInv[playerid][slot];
    	if(invent == -1) RemovePlayerAttachedObject(playerid,slot);
    	else if(nowweapon == Loot[invent][LWeapon]) RemovePlayerAttachedObject(playerid,slot);
    	else
    	{
        	switch(slot)
        	{
        	    case 0: SetPlayerAttachedObject(playerid, 0, Loot[invent][LObj], 1, 0.234999, -0.069999, -0.196999, -172.100067, -175.200164, 11.400026);
        	    case 1: SetPlayerAttachedObject(playerid, 1, Loot[invent][LObj], 1, 0.349000, -0.131999, 0.197999, 0.000000, -179.699783, 0.000000);
				case 2: SetPlayerAttachedObject(playerid, 2, Loot[invent][LObj], 7, -0.145000, 0.024999, -0.155999, 101.499969, 0.799999, 4.999999, 0.737999, 0.876000, 0.783000);
				case 3: SetPlayerAttachedObject(playerid, 3, Loot[invent][LObj], 8, 0.087000, 0.000000, 0.055000, -5.299999, -92.900001, 0.000000);
			}
    	}
  	}
	return 1;
}

stock PUBGRewardPlayer(playerid)
{//выдать награду игроку и завершить его участие в PUBG
	if (InEvent[playerid] != EVENT_BATTLE) return 1;

	//Награда за время
	new pmins = (unixtime - BTStartTime) / 60; //Количество минут, которое игрок выжил
	FarmedXP[playerid] = pmins * 75;

	//Награда за ранг: percentPos - позиция игрока в пересчете на 100 участников (каким было бы место игрока, если бы играло ровно 100 человек)
	new percentPos = BTPlayers * 100 / BTStartPlayers;
	new percentWinPlayers = 101 - percentPos; //Количество игроков, которых "обыграл" игрок, в пересчете на 100 участников + награда "за себя"
	FarmedXP[playerid] += percentWinPlayers * 20;

	//Награда за киллы
	FarmedXP[playerid] += BTKills[playerid] * 50;

	new str[140];
	//Награда за TOP 5
	if (BTPlayers == 1)
	{
		FarmedXP[playerid] += 100;
		format(str, sizeof str, "%s[%d] победил в Битве до последнего и получил %d XP и %d$ (Убийств: %d)", PlayerName[playerid], playerid, FarmedXP[playerid], FarmedXP[playerid] * 30, BTKills[playerid]);
		SendClientMessageToAll(COLOR_BATTLE, str);
	}
	else if (BTPlayers == 2)
	{
		FarmedXP[playerid] += 80;
		format(str, sizeof str, "%s[%d] занял второе место в Битве до последнего и получил %d XP и %d$ (Убийств: %d)", PlayerName[playerid], playerid, FarmedXP[playerid], FarmedXP[playerid] * 30, BTKills[playerid]);
		SendClientMessageToAll(COLOR_BATTLE, str);
	}
	else if (BTPlayers == 3)
	{
		FarmedXP[playerid] += 60;
		format(str, sizeof str, "%s[%d] занял третье место в Битве до последнего и получил %d XP и %d$ (Убийств: %d)", PlayerName[playerid], playerid, FarmedXP[playerid], FarmedXP[playerid] * 30, BTKills[playerid]);
		SendClientMessageToAll(COLOR_BATTLE, str);
	}
	else if (BTPlayers == 4)
	{
		FarmedXP[playerid] += 40;
		format(str, sizeof str, "%s[%d] занял четвертое место в Битве до последнего и получил %d XP и %d$ (Убийств: %d)", PlayerName[playerid], playerid, FarmedXP[playerid], FarmedXP[playerid] * 30, BTKills[playerid]);
		SendClientMessageToAll(COLOR_BATTLE, str);
	}
	else if (BTPlayers == 5)
	{
		FarmedXP[playerid] += 20;
		format(str, sizeof str, "%s[%d] занял пятое место в Битве до последнего и получил %d XP и %d$ (Убийств: %d)", PlayerName[playerid], playerid, FarmedXP[playerid], FarmedXP[playerid] * 30, BTKills[playerid]);
		SendClientMessageToAll(COLOR_BATTLE, str);
	}

	format(str,sizeof str, "За участие в Битве до последнего вы получили %d XP и %d$. Вы заняли: %d-ое место (Убийств: %d)", FarmedXP[playerid], FarmedXP[playerid] * 30, BTPlayers, BTKills[playerid]);
	SendClientMessage(playerid, COLOR_YELLOW, str);
	LGiveXP(playerid, FarmedXP[playerid]);
	Player[playerid][Cash] += FarmedXP[playerid] * 30;

	QuestUpdate(playerid, 18, 1);//Обновление квеста Примите участие в 5 соревнованиях
	MarafonUpdate(playerid, 0, 1);
	MarafonUpdate(playerid, 2, 1);
	MarafonUpdate(playerid, 5, FarmedXP[playerid]*30);
	//QuestUpdate(playerid, 32, 1);//Обновление квеста Примите участие в 3 битвах

	//убираем из ивента
	JoinEvent[playerid] = 0; BTStarted[playerid] = 0; InEvent[playerid] = 0; BTPlayers--;
	RemovePlayerFromVehicle(playerid); //исправляет баг
	HideBtTDS(playerid);
	for(new i;i<4;i++) {RemovePlayerAttachedObject(playerid,i);}
	SetPlayerSkillLevel(playerid, WEAPONSKILL_PISTOL, 999);
	SetPlayerSkillLevel(playerid, WEAPONSKILL_SAWNOFF_SHOTGUN, 999);
	SetPlayerSkillLevel(playerid, WEAPONSKILL_MICRO_UZI, 999);
	LSpawnPlayer(playerid);
	ShowClanZones(playerid);

	new alived[16]; format(alived, sizeof alived, "Players: %d", BTPlayers); TextDrawSetString(BTPlayersTD, alived);
	return 1;
}//выдать награду игроку и завершить его участие в PUBG

stock HideBtTDS(playerid)
{
    TextDrawHideForPlayer(playerid, BTTimeTD);
	TextDrawHideForPlayer(playerid, BTLineTD);
	TextDrawHideForPlayer(playerid, BTPlayersTD);
	TextDrawHideForPlayer(playerid, BTMap);
	PlayerTextDrawHide(playerid, PlayerPosTD[playerid]);
	//or(new i;i<3;i++) TextDrawHideForPlayer(playerid, BTMainTD[i]);
	for(new i;i<4;i++) {TextDrawHideForPlayer(playerid, BTMainTD[i]); TextDrawHideForPlayer(playerid, SecondZoneTD[i]); TextDrawHideForPlayer(playerid, FirstZoneTD[i]); GangZoneHideForPlayer(playerid, SecondZone[i]);GangZoneHideForPlayer(playerid, FirstZone[i]);}
}

stock RemovePlayerWeapon(playerid, weaponid, ammo = 0) //©Jeffry
{
    new w = GetPlayerWeapon(playerid), plyWeapons[13], plyAmmo[13];
    for(new slot = 0; slot <= 12; slot++)
    {
        GetPlayerWeaponData(playerid, slot, plyWeapons[slot], plyAmmo[slot]);
        if(plyWeapons[slot] == weaponid)
        {
            if(ammo == 0 || plyAmmo[slot] <= ammo)
            {
                if(w == plyWeapons[slot]) w = 0;
                plyAmmo[slot] = 0;
                plyWeapons[slot] = 0;
            }
            else plyAmmo[slot]-=ammo;
        }
    }
    ResetPlayerWeapons(playerid);
    for(new slot = 0; slot <= 12; slot++) GivePlayerWeapon(playerid, plyWeapons[slot], plyAmmo[slot]);
    SetPlayerArmedWeapon(playerid, w);
    return 1;
}

/*stock RandomEx(array[], array_size = sizeof array)
{
    assert array_size > 1;

    new idx, rand_val, i;

    do
    {
        idx += array[i];

        if(random(idx) < array[i])
            rand_val = i;
    }
    while i++ < array_size;

    return rand_val;
}*/

stock IsVehicleBtBoat(vehicleid)
{
	if(vehicleid == -1) return false;
    new vm = GetVehicleModel(vehicleid);
    if(vm == 472 || vm == 473 || vm == 595) return true;
    else return false;
}

stock CreateRandomBTVehicles()
{
	new modeldbt, carss = MAX_BTCARS-57, veh; //57 лодок
	for(new i; i<MAX_BTCARS;i++)
	{
		if(i < carss) //тачки
		{
     		modeldbt = random(sizeof(BtCarModels));
	    	//BtVehicle[i] = LCreateVehicle(BtCarModels[modeldbt], BTCars[i][CX], BTCars[i][CY], BTCars[i][CZ], BTCars[i][CA], -1, -1, 0);
	    	veh = LCreateVehicle(BtCarModels[modeldbt], BTCars[i][CX], BTCars[i][CY], BTCars[i][CZ], BTCars[i][CA], -1, -1, 0);
	    	SetVehicleVirtualWorld(veh, BATTLE_WORLD);
		}
		else //57 лодок
		{
		    modeldbt = random(sizeof(BtBoatModels));
	    	//BtVehicle[i] = LCreateVehicle(BtBoatModels[modeldbt], BTCars[i][CX], BTCars[i][CY], BTCars[i][CZ], BTCars[i][CA], -1, -1, 0);
	    	veh = LCreateVehicle(BtBoatModels[modeldbt], BTCars[i][CX], BTCars[i][CY], BTCars[i][CZ], BTCars[i][CA], -1, -1, 0);
	    	SetVehicleVirtualWorld(veh, BATTLE_WORLD);
		}
		//SetVehicleVirtualWorld(BtVehicle[i], BATTLE_WORLD);
		Vehicle[veh][VType] = 1; //тип авто - тачка на бт
	}
}

stock CreatePlaneRoute()
{
	new fwall = random(4);
	switch(fwall)
	{
	    case 0: {BTRouts[ffX] = -3000.0; BTRouts[ftoX] = 3000.0; BTRouts[ffY] = frandom(5000.0)-2500.0; BTRouts[ftoY] = frandom(3000.0)-1500.0; BTRouts[ftoA] = -90.0;} //слева направо
	    case 1: {BTRouts[ffX] = 3000.0; BTRouts[ftoX] = -3000.0; BTRouts[ffY] = frandom(5000.0)-2500.0; BTRouts[ftoY] = frandom(3000.0)-1500.0; BTRouts[ftoA] = 90.0;} //справа налево
	    case 2: {BTRouts[ffX] = frandom(5000.0)-2500.0; BTRouts[ftoX] = frandom(3000.0)-1500.0; BTRouts[ffY] = 3000.0; BTRouts[ftoY] = -3000.0; BTRouts[ftoA] = 90.0;} //сверху вниз
	    case 3: {BTRouts[ffX] = frandom(5000.0)-2500.0; BTRouts[ftoX] = frandom(3000.0)-1500.0; BTRouts[ffY] = -3000.0; BTRouts[ftoY] = 3000.0; BTRouts[ftoA] = -90.0;} //снизу вверх
	}
	BTRouts[ftoA] = atan((BTRouts[ftoY] - BTRouts[ffY]) / (BTRouts[ftoX] - BTRouts[ffX])) + BTRouts[ftoA];
}
